
#Region " K-Desktop "

Public Class FMenu

#Region " Variables "

#Region " Declaraciones "

    Private Declare Function GetActiveWindow Lib "user32" Alias "GetActiveWindow" () As IntPtr
    <Runtime.InteropServices.DllImport("user32.dll")> Public Shared Function LockWorkStation() As Boolean : End Function

    <Runtime.InteropServices.DllImport("Shell32.dll")> Public Shared Function SHEmptyRecycleBin(hwnd As IntPtr, pszRootPath As String, dwFlags As Integer) As Integer : End Function
    <Runtime.InteropServices.DllImport("user32.dll", SetLastError:=True)> Private Shared Function SetWindowPos(hWnd As IntPtr, hWndInsertAfter As IntPtr, X As Integer, Y As Integer, cx As Integer, cy As Integer, uFlags As Long) As Boolean : End Function
    <Runtime.InteropServices.DllImport("user32.dll", SetLastError:=True, CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function FindWindow(lpClassName As String, lpWindowName As String) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("user32.dll", SetLastError:=True, CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function GetWindow(hWnd As IntPtr, uCmd As UInt32) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("user32.dll", SetLastError:=True, CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function PostMessage(hWnd As IntPtr, Msg As UInteger, wParam As IntPtr, lParam As IntPtr) As Boolean : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Private Shared Function SetForegroundWindow(hWnd As IntPtr) As <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.Bool)> Boolean : End Function
    <Runtime.InteropServices.DllImport("user32.dll", EntryPoint:="BlockInput", SetLastError:=True, CharSet:=Runtime.InteropServices.CharSet.Auto, CallingConvention:=Runtime.InteropServices.CallingConvention.StdCall)> Friend Shared Function BlockInput(fBlockIt As Boolean) As Boolean : End Function
    <Runtime.InteropServices.DllImport("User32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function ShowWindow(hWnd As IntPtr, cmdShow As Short) As Integer : End Function
    Private Declare Function IsIconic Lib "user32" (hwnd As Long) As Long

    Private ReadOnly DeviceEnum As New NAudio.CoreAudioApi.MMDeviceEnumerator() : Private WithEvents NotificationClient As New NotificationClient
    Private NotifyClient As NAudio.CoreAudioApi.Interfaces.IMMNotificationClient = CType(NotificationClient, NAudio.CoreAudioApi.Interfaces.IMMNotificationClient)
    Private Function RegisterEndpointNotificationCallback(<Runtime.InteropServices.In> <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.[Interface])> client As NAudio.CoreAudioApi.Interfaces.IMMNotificationClient) As Integer
        Return DeviceEnum.RegisterEndpointNotificationCallback(client) : End Function
    Private Function UnRegisterEndpointNotificationCallback(<Runtime.InteropServices.In> <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.[Interface])> client As NAudio.CoreAudioApi.Interfaces.IMMNotificationClient) As Integer
        Return DeviceEnum.UnregisterEndpointNotificationCallback(client) : End Function

#End Region

#Region " Estructuras "

    Structure ComandosST
        Dim ID As String
        Dim Nombre As String
        Dim Sonido As String
        Dim EjecutarIniciar As Boolean
        Dim EjecutarSalir As Boolean
        Dim EjecutarSiempre As Boolean
        Dim Deshabilitar As Boolean
        Dim BloquearPulsacion As Boolean
        Dim CustomIcono As String
        Dim Oculto As Boolean
        Dim Hotkey() As String
        Dim Accion() As AccionST
        Dim Procesos() As String
        Dim EnEjecucion As Boolean
        Dim Thread_EjecutarComando As Threading.Thread
    End Structure

    Structure EjecutarComandoST
        Dim Proceso As Process_CL.ProcessST
        Dim Indice_Comando As Integer
        Dim ID_Comando As String
        Dim Sonido As String
        Dim Logger As String
        Dim Notas As String
    End Structure

    Structure AccionST
        Dim Proceso As Process_CL.ProcessST
        Dim Indice As Integer
        Dim Tipo As String
        Dim ID As String
        Dim ParentID As String
        Dim Settings As String
        Dim Sonido As String
        Dim Logger As String
        Dim Notas As String
        Dim EnEjecucion As Boolean
        Dim Thread_EjecutarAccion As Threading.Thread
        Dim Esperando As Boolean
    End Structure

    Structure KBoardST
        Dim Nombre As String
        Dim ID As String
        Dim ProcesoOn As String
        Dim ProcesoOff As String
        Dim TituloOn As String
        Dim TituloOff As String
        Dim Activo As Boolean
        Dim Keys() As String
        Dim Procesos() As String
        Dim AutoActivar As Boolean
        Dim Deshabilitado As Boolean
    End Structure

    Structure LogroST
        Dim Nombre As String
        Dim Texto As String
        Dim Imagen As Image
        Dim MaxValue As Integer
        Dim Tipo As String
        Dim Oculto As Boolean
        Dim Desbloqueado As Boolean
        Dim Fecha As String
        Dim Ignorar As Boolean
    End Structure

    Structure EstadisticasST
        Dim Comandos_Creados As Integer
        Dim Comandos_Eliminados As Integer
        Dim Comandos_Ejecutados As Integer

        Dim Acciones_Creadas As Integer
        Dim Acciones_Eliminadas As Integer
        Dim Acciones_Ejecutadas As Integer

        Dim KBoard_Creados As Integer
        Dim KBoard_Eliminados As Integer
        Dim KBoard_Ejecutados As Integer

        Dim QuickMenus_Creados As Integer
        Dim QuickMenus_Eliminados As Integer
        Dim QuickMenus_Abiertos As Integer

        Dim KDesktop_Iniciado As Integer
        Dim Papelera_Vaciada As Integer
        Dim Apagado_Equipo As Integer
        Dim DesactivadoEn As Integer
        Dim Archivos_Ocultados As Integer
        Dim Capturas_Pantalla As Integer
        Dim Grabaciones_Pantalla As Integer
        Dim Grabaciones_Audio As Integer
        Dim Enviado_Telegram As Integer
        Dim Comandos_UDP As Integer
        Dim Acciones_Unicas As String
        Dim Sonidos_Reproducidos As Integer

        Dim Macros_Grabadas As Integer
        Dim Macros_Ejecutadas As Integer
        Dim CMD_Ejecutados As Integer
        Dim Aplicaciones_Ejecutadas As Integer
        Dim Paginas_Webs As Integer
        Dim Carpetas_Abiertas As Integer
        Dim BAT_Ejecutados As Integer
        Dim Salidas_Audio As Integer
        Dim TopMost_Ejecutados As Integer
        Dim Iconos_Modificados As Integer
    End Structure

    Structure BrowserST : Dim Nombre As String : Dim Ruta As String : Dim Version As String : End Structure
    Structure SalidaAudioST : Dim ID As String : Dim Sonido As String : Dim AccionID As String : End Structure
    Structure AppsTopMostST : Dim Name As String : Dim Handle As IntPtr : Dim TopMost As Boolean : End Structure
    Structure STQMList : Dim Name As String : Dim Value As String : End Structure
    Structure UDPST : Dim Comando As String : Dim RemoteEndPoint As Net.IPEndPoint : End Structure

#Region " QuickMenu "

    Structure SubMenuST
        Dim Name As String
        Dim ID As String
        Dim ParentID As String
        Dim SubMenu As NSContextMenu
    End Structure

    Structure ItemMenuST
        Dim Name As String
        Dim Value As String
        Dim ID As String
        Dim ParentID As String
        Dim Item As ToolStripMenuItem
    End Structure

    Structure SeparatorST
        Dim ID As String
        Dim ParentID As String
        Dim Separator As ToolStripSeparator
    End Structure

#End Region

#End Region

#Region " Variables "

#Region " K-Desktop "

    Public Version As String = "K-Desktop 4.0"
    Public RegPath As String = "KDesktop4"
    Public KobaPath As String = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\KDesktop 4.0\"
    Public KobaPathTemp As String = IO.Path.GetTempPath + "KDesktop\"
    Public KDesktop_Instalado As DateTime : Dim FirstRun As Boolean
    Dim KDesktop_UDP As Integer = 2501

    Dim General_Timer As New Timer With {.Interval = 25, .Enabled = False}
    Dim Sonido_PlayTimer As New Timer With {.Interval = 100, .Enabled = False}
    Public General_Tooltip As New ToolTip With {.InitialDelay = 1000, .ReshowDelay = 250, .AutoPopDelay = 50000, .ShowAlways = True, .Tag = ""}
    Dim K_Tooltip As New ToolTip With {.InitialDelay = 10, .ReshowDelay = 10, .AutoPopDelay = 50000, .ShowAlways = True}
    Dim Combo_Dropped, Combo_IgnoreOne, Texto_Focused, Buscar_Focused, Saliendo As Boolean : Dim Combo_TempValue, CloseAllowed As String

    Public NoAñadir As String = "conhost,AppVShNotify,FNPLicensingService64,ServiceHub.VSDetouredHost,acrotray,svchost,msvsmon,smss,SgrmBroker,lsass,services,wlanext,nvcontainer,ShellExperienceHost,MSBuild,WmiPrvSE,SettingSyncHost,Corsair.Service.CpuIdRemote64,explorer,TeamViewer_Service,devenv,sihost,ServiceHub.TestWindowStoreHost,csrss,dllhost,wininit,SpeechRuntime,taskhostw,spoolsv,Corsair.Service,dwm,MsMpEng,OfficeClickToRun,NahimicService,CompPkgSrv,NVIDIA Share,Corsair.Service.DisplayAdapter,MysticLight2_Service,RuntimeBroker,SearchUI,nvsphelper64,LEDKeeper,ServiceHub.RoslynCodeAnalysisService32,ServiceHub.SettingsHost,VBCSCompiler,GameBar,fontdrvhost,Microsoft.ServiceHub.Controller,SystemSettings,NVDisplay.Container,armsvc,NVIDIA Web Helper,ctfmon,NisSrv,rundll32,PerfWatson2,Service_KMS,ServiceHub.ThreadedWaitDialog,sqlwriter,ApplicationFrameHost,ServiceHub.Host.CLR.x86,RtkAudUService64,RemindersServer,Registry,CueLLAccessService,SystemSettingsBroker,WinStore.App,muachost,SecurityHealthService,WindowsInternal.ComposableShell.Experiences.TextInput.InputApp,StartMenuExperienceHost,ServiceHub.IdentityHost,audiodg,winlogon,Memory Compression,SearchIndexer,System,Idle,backgroundTaskHost,LockApp,PlacesServer,WMIADAP,Smartscreen,TiWorker,TrustedInstaller,SearchFilterHost,SearchProtocolHost,Vmnat,Vmnetdhcp,Vmware-authd,Vmware-hostd,Vmware-usbarbitrator64,KDesktop,KDesktop4,KDesktopL,WUDFHost,Utorrentie,Ducservice,ICUEDevicePluginHost,AdobeCollabSync,Steamwebhelper,NahimicNotifSys,ServiceHub.Host.CLR.x64,TextInputHost,GameBarFTServer,ServiceHub.RoslynCodeAnalysisService,ScriptedSandbox64,UplayWebCore,EpicWebHelper,PSTrayFactory,SamsungMagicianSVC,Python,MpCopyAccelerator,DasHost,Wmpnetwk,Vncagent,Pstf_x64_stub,GalaxyCommunication,GalaxyClient Helper,DisplayFusionHookApp32,SteamService,DisplayFusionHookApp64,CorsairMsiPluginService,UserOOBEBroker,Vncserverui,Gamingservices,Unsecapp,Gamingservicesnet,ServiceHub.DataWarehouseHost,Tv_w32,Upc,Vncserver,SearchApp,CorsairGamingAudioCfgService64,StandardCollector.Service,Jhi_service,AGSService,Tv_x64,DisplayFusionService,ImDiskTk-svc,GOG Galaxy Notifications Renderer,AGMService,MoUsoCoreWorker,SDXHelper,QtWebEngineProcess,EABackgroundService,PowerToys,PowerLauncher,PowerToys.FancyZones,PowerToys.KeyboardManagerEngine,Pservice,ColorPickerUI,EAConnect_microsoft,XboxAppServices,AFC_Bridge,GalaxyClientService,GalaxyClient,"
    Dim NoEjecutarSalir As String = "Capturar Pantalla, Grabar Pantalla (On/Off), Grabar Audio (On/Off), QuickMenu, Desactivar en (On/Off), Apagar Equipo, Comandos"

#End Region

#Region " Keyboard "

    Dim WithEvents Keyboard As Keyboard
    Public Proceso As New Process_CL
    Public Get_HotKey, Mouse_HotKey, HotkeyM As Boolean
    Dim Last_HotKey As String : Dim Rep_HotKey As Boolean

#End Region

#Region " Lista "

    Dim MostrarOcultos, AppsKey, ListaKeyDownPressed As Boolean

#Region " Drag & Drop "

    Dim MovingStartPos As Integer
    Dim MovingDataList As NSListView.NSListViewItem
    Dim MovingDataListMK As NSListViewSK.NSListViewItemSK
    Dim MovingDataListMKTipo As NSListViewSK.NSListViewItemSK.TipoEN
    Dim StartMovingItemList As Boolean : Dim MovingItemList As Boolean

#End Region

#End Region

#Region " Comandos "

    Public Comandos(0) As ComandosST
    Public Comandos_Accion_AccionesTemporales() As AccionST
    Dim EjecutarAccion_Thread As Threading.Thread
    Dim Comandos_Update, Accion_Update As Boolean
    Dim Accion_AItem, Accion_ACItem As AccionST
    Dim CurrentAccionIndex As Integer
    Dim ComandoActualID As String
    Dim Comandos_ComandoNegativo As Boolean = True
    Dim Comandos_IndiceActual As Integer = -2

#End Region

#Region " Acciones "

#Region " Aplicaciones "

    Dim GPaginaWeb_Browsers As List(Of BrowserST)
    Dim GEjecutarBAT_Proceso As New Process

#End Region

#Region " Audio y Video "

    Dim Captura As ScreenRecorderLib.Recorder : Dim Capturado As Boolean
    Dim CapturandoPantalla, GCapturaPantalla_OSD As Boolean
    Dim GCapturaPantalla_WaitTime As WaitTime_CL
    Dim GCapturaPantalla_OSD_Fuente As Font = OSD_Default_Font
    Dim GCapturaPantalla_OSD_Color As Color = OSD_Default_Color
    Public GCapturaPantalla_Calidad As Integer
    Public FCapturaPantalla_Opening, GCapturaPantalla_Grabando As Boolean

    Dim VideoRecorder As New VideoRecorderCL(KobaPathTemp)
    Dim GrabandoPantalla, GGrabacionPantalla_Cancelar As Boolean
    Dim GGrabacionPantalla_WaitTime As WaitTime_CL
    Public GGrabacionPantalla_Pantalla As Integer
    Public GGrabacionPantalla_DesktopDuplication, GGrabacionPantalla_Sonido, GGrabacionPantalla_Microfono, GGrabacionPantalla_MarcarClicks As Boolean
    Public FGrabacionPantalla_Opening, GGrabacionPantalla_Grabando, GGrabacionPantalla_OSD As Boolean
    Public GGrabacionPantalla_OSD_Fuente As Font = OSD_Default_Font
    Public GGrabacionPantalla_OSD_Color As Color = OSD_Default_Color

    Dim GrabandoAudio As Boolean
    Dim GGrabacionAudio_WaitTime As WaitTime_CL
    Dim GGrabacionAudio_Recorder As New AudioRecorder_CL
    Dim GGrabacionAudio_AudioRecordingFile As String
    Public GGrabacionAudio_WaveInAudio As New NAudio.Wave.WasapiLoopbackCapture
    Public FGrabacionAudio_Opening, GGrabacionAudio_Grabando, GGrabacionAudio_OSD As Boolean
    Public GGrabacionAudio_OSD_Fuente As Font = OSD_Default_Font
    Public GGrabacionAudio_OSD_Color As Color = OSD_Default_Color

    Dim WithEvents Audio As New AudioAPI
    Dim GSalidaAudio_AudioTimer As New Timer With {.Interval = 100, .Enabled = True}
    Dim Audio_Action As String
    Dim Audio_Update_Action As Boolean
    Dim GSalidaAudio_MouseDown_Pos As Point
    Dim GSalidaAudio_OSD_Fuente As Font = OSD_Default_Font
    Dim GSalidaAudio_OSD_Color As Color = OSD_Default_Color

#End Region

#Region " Utilidades "

    Dim GMacros_Teclas_Menu As New NSContextMenu
    Dim GMacro_CopiarLista() As NSListViewSK.NSListViewItemSK
    Dim GMacro_MouseDown_Pos As New Point
    Dim GMacro_PrimerComando, GMacro_BorrarUltimoMouseDown, GMacro_Forzar, GMacro_Editando, GMacro_EditandoCarga, AñadirPausas As Boolean
    Dim GMacro_ESCs As Integer = -1 : Dim GMacro_ESCs_StopWatch As New Stopwatch
    Public GMacro_Grabando, GMacro_GrabandoOculto, GMacro_Pausar, Get_Macro_Key, GMacro_MacroM, MacroEjecutando, Macros_OnRecordButton As Boolean

    Public NotasAjusteLinea As Boolean = True
    Public NotasFont As Font : Public NotasColor As Color : Public NotasBackColor As Color
    Public NotasWidth As Integer : Public NotasHeight As Integer
    Public NotasTop As Integer : Public NotasLeft As Integer
    Public NotasState As FormWindowState

    Public KBoards() As KBoardST
    Public KBoard_MenuTecla As New NSContextMenu
    Dim KBoard_LButton, KBoard_MButton, KBoard_RButton, KBoard_Button4, KBoard_Button5 As New Drawing2D.GraphicsPath
    Public Get_KBoard_Key, KBoard_Cambiar_HotKey, KBoard_Por_HotKey As Boolean
    Dim KBoard_Updating, KBoard_Cambiar_Mouse_HotKey, KBoard_Por_Mouse_HotKey As Boolean
    Dim Focus_KBoard_Name, GKBoard_OSD As Boolean
    Dim GKBoard_OSD_Fuente As Font = OSD_Default_Font
    Dim GKBoard_OSD_Color As Color = OSD_Default_Color
    Dim TVTecla As New Timer : Dim CTecla As NSButton
    Dim Contador As Integer : Dim IniciaContador As Boolean : Dim ComandoScript As String

    Dim Focus_QuickMenu_Name As Boolean
    Dim QuickMenus(), QuickMenus_F() As NSContextMenu
    Dim QuickMenu_Editor As New NSContextMenu With {.AutoClose = False}
    Dim QuickMenuSize As Integer : Dim MovingData As String : Dim StartMovingItem As Boolean : Dim MovingItem As Boolean : Dim MoveStrip As Object : Dim MoveItem As Object : Dim MovePosition As Integer : Dim ItemOnMouse As ToolStripMenuItem : Dim SeparatorOnMouse As ToolStripSeparator : Dim QuickMenu_OnMenu As Boolean
    Dim QuickMenu_Editor_ZOrder, QuickMenuRightClick As Boolean : Dim QuickMenu_Mouse_Position As Integer : Dim IgnoreMouseEnter As Boolean : Dim NuevoItem As Object : Dim NuevoStrip As Object : Dim NuevoPosicion As Integer : Dim CopiedItem As Object : Dim AlreadyCopied As Boolean : Dim CancelClose, CancelClose2 As Boolean : Dim IgnoreOne As Boolean : Dim NoLoadQuickMenu As Boolean : Dim Focus_TextBox As Boolean
    Dim QuickMenu_Proceso As Process_CL.ProcessST
    Dim QuickMenu_Loading, QuickMenu_Tamaño_Ignorar, QuickMenu_IgnoreMouse, ForceClose As Boolean

    Dim GRedAdHoc_LocalNetwork As String
    Dim GRedAdHoc_OSD_Fuente As Font = OSD_Default_Font
    Dim GRedAdHoc_OSD_Color As Color = OSD_Default_Color

#End Region

#Region " Acciones "

    Public Get_Pulsacion_Key, GEnviarPulsacion_PulsacionM As Boolean
    Dim GPulsacion_Teclas_Menu As New NSContextMenu

    Dim AppsTopMost As New List(Of String)
    Dim GTopMost_OSD_Fuente As Font = OSD_Default_Font
    Dim GTopMost_OSD_Color As Color = OSD_Default_Color

    Dim GArchivosOcultos_OSD_Fuente As Font = OSD_Default_Font
    Dim GArchivosOcultos_OSD_Color As Color = OSD_Default_Color

    Dim GDesactivarEn_OSD_Fuente As Font = OSD_Default_Font
    Dim GDesactivarEn_OSD_Color As Color = OSD_Default_Color

    Public GMostrarMensaje_Mostrando As Boolean
    Dim GMostrarMensaje_WaitTime As WaitTime_CL
    Dim GMostrarMensaje_OSD_Fuente As Font = OSD_Default_Font
    Dim GMostrarMensaje_OSD_Color As Color = OSD_Default_Color

    Public GApagarEquipo_Apagando As Boolean
    Dim ApagandoEquipo, GApagarEquipo_OSD As Boolean
    Dim GApagarEquipo_Accion, GApagarEquipo_Sonido As String
    Dim GApagarEquipo_WaitTime As WaitTime_CL
    Dim GApagarEquipo_OSD_Fuente As Font = OSD_Default_Font
    Dim GApagarEquipo_OSD_Color As Color = OSD_Default_Color

    Dim GComandos_Comandos_Menu As New NSContextMenu

    Public GEsperar_Esperando As Boolean
    Dim GEsperar_WaitTime As WaitTime_CL

    Dim GEsperar_OSD_Fuente As Font = OSD_Default_Font
    Dim GEsperar_OSD_Color As Color = OSD_Default_Color

#End Region

#End Region

#Region " Opciones "

    Dim Opciones_Update As Boolean = True

    Dim Opciones_IniciarWindows, Opciones_IconoSistema As Boolean
    Public Desactivar(0), DeshabilitarBackForward(0), Opciones_IniciarWindows_Modo As String
    Public Opciones_DisableXButton As Boolean

#Region " Mensaje Iniciar "

    Dim Opciones_MensajeIniciar_Texto As String
    Dim Opciones_MensajeIniciar_Sonido As String
    Dim Opciones_MensajeIniciar_Fuente As Font = OSD_Default_Font
    Dim Opciones_MensajeIniciar_Color As Color = OSD_Default_Color

#End Region

#Region " Sabias Que "

    Dim SabiasQue_Contador As Integer
    Dim SabiasQue_ShowTime As Integer = 7
    Dim SabiasQue_Indice As Integer = -1
    Dim SabiasQue_Lista As New List(Of String)
    ReadOnly Undo_SabiasQue As New Stack(Of Integer)
    ReadOnly Redo_SabiasQue As New Stack(Of Integer)

#End Region

#Region " Serial "

    Dim Opciones_Version_Serial As String = "invalid"
    Dim Opciones_Version_Registro As String
    Dim Opciones_Version_Validez As Date

#End Region

#Region " OSD "

    Public Opciones_OSD As New OSD_CL
    Public Opciones_OSD_Color As Color = OSD_Default_Color
    Public Opciones_OSD_Font As Font = OSD_Default_Font
    Dim OSD_Default_Font As New Font("Arial", 16, FontStyle.Regular)
    Dim OSD_Default_Color As Color = Color.FromArgb(205, 150, 0)
    Dim Opciones_OSD_AnimationTime = 1000

#End Region

#Region " UDP "

    Dim Opciones_UDP As Boolean
    Dim Default_UDP_Puerto As Integer = 2501
    Dim Opciones_UDP_Puerto As Integer
    Shared UDPCliente As Net.Sockets.UdpClient
    Shared UDPRemoteEndPoint As Net.IPEndPoint
    Shared UDPComando As String : Shared UDPTaskSwitch As Boolean

#End Region

#Region " Logros y Estadisticas "

    'Public Logros() As LogroST
    'Public Estadisticas As EstadisticasST
    'Public Check_Logros, Logro_Serial, NotificacionesLogros As Boolean

#End Region

#End Region

#End Region

#End Region

#Region " Eventos "

#Region " Formulario "

#Region " Load "

    Private Sub Menu_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        If PrevInstance() = True Then End
        CheckForIllegalCrossThreadCalls = False : Text = Version : FTheme.Text = Version : NotifyIcon.Text = Version
        'Firewall, Check Admin y Crear Directorios
        If My.User.IsInRole(ApplicationServices.BuiltInRole.Administrator) = False Then ShowMessageBox("Ejecute este programa con permisos de administrador", Version, MsgBoxStyle.Critical) : NotifyIcon.Visible = False : NotifyIcon.Dispose() : End
        Internet.Firewall_AddRule(RegPath, Application.ExecutablePath, "KDesktop")
        If IO.Directory.Exists(KobaPathTemp) = False Then IO.Directory.CreateDirectory(KobaPathTemp)
        If IO.Directory.Exists(KobaPath) = False Then IO.Directory.CreateDirectory(KobaPath)
        If IO.Directory.Exists(KobaPath + "Iconos\WebIcons") = False Then IO.Directory.CreateDirectory(KobaPath + "Iconos\WebIcons")
        If IO.Directory.Exists(KobaPath + "Iconos\Comandos") = False Then IO.Directory.CreateDirectory(KobaPath + "Iconos\Comandos")
        If IO.Directory.Exists(KobaPath + "Iconos\QuickMenu") = False Then IO.Directory.CreateDirectory(KobaPath + "Iconos\QuickMenu")
        If IO.Directory.Exists(KobaPath + "BATs") = False Then IO.Directory.CreateDirectory(KobaPath + "BATs")
        If IO.Directory.Exists(KobaPath + "MACROs") = False Then IO.Directory.CreateDirectory(KobaPath + "MACROs")
        If IO.File.Exists((Application.StartupPath + "\ScreenRecorderLib.dll").Replace("\\", "\")) = False Then IO.File.WriteAllBytes((Application.StartupPath + "\ScreenRecorderLib.dll").Replace("\\", "\"), My.Resources.ScreenRecorderLib)
        If IO.File.Exists((Application.StartupPath + "\NAudio.Lame.dll").Replace("\\", "\")) = False Then IO.File.WriteAllBytes((Application.StartupPath + "\NAudio.Lame.dll").Replace("\\", "\"), My.Resources.NAudio_Lame)
        If IO.File.Exists((Application.StartupPath + "\libmp3lame.64.dll").Replace("\\", "\")) = False Then IO.File.WriteAllBytes((Application.StartupPath + "\libmp3lame.64.dll").Replace("\\", "\"), My.Resources.libmp3lame_64)

        'Serial
        If CBool(Registro.GetRegKey("Microsoft\KD", "FirstRun", "False")) = False Then
            Registro.SetRegKey("Microsoft\KD", "FirstRun", "True")
            Registro.SetRegKey("Microsoft\KD", "Trialed", "False")
            Registro.SetRegKey("Microsoft\KD", "Installed", Now.ToString("dd/MM/yyyy"))
            Registro.SetRegKey("Microsoft\KD", "Version", Version)
            Registro.SetRegKey("Microsoft\KD", "Ejecutando", Process.GetCurrentProcess.MainModule.FileName.ToLower)
            My.Computer.Registry.CurrentUser.DeleteSubKeyTree("Software\" + RegPath, False)
        Else
            If Registro.GetRegKey("Microsoft\KD", "Version", Version) <> Version Then
                Registro.SetRegKey("Microsoft\KD", "Version", Version)
            End If
        End If
        KDesktop_Instalado = Convert.ToDateTime(Registro.GetRegKey("Microsoft\KD", "Installed", Now.ToString("dd/MM/yyyy")))
        Serial_Validar()

        'Registrar / DesRegistrar
        If CBool(Registro.GetRegKey(RegPath + "\Opciones", "IniciarWindows", "True")) = True Then RegistrarTask(Registro.GetRegKey(RegPath + "\Opciones", "IniciarWindowsModo", "Programado")) Else DesRegistrarTask()

        ''Preparar y Cargar
        'If Internet.IsConnectedToInternet() = True Then GRedAdHoc_LocalNetwork = GetBestInterface(Net.Dns.GetHostEntry("www.google.com").AddressList.First, 80).Name

        'Audio
        'DeviceEnum.RegisterEndpointNotificationCallback(NotifyClient) : Audio.LoadDevices()

        ComboAcciones_Cargar() : Sonidos.Cargar() : ComboTeclas_Cargar() : ComboCarpetasEspeciales_Cargar() : SabiasQue_Cargar() : Comandos_Cargar() : KBoards_Cargar() : Cache_Limpiar()

        'Panel Comandos
        QuickMenu_Editor.AllowDrop = True
        AddHandler Microsoft.Win32.SystemEvents.SessionEnding, AddressOf Handler_SessionEnding
        AddHandler General_Timer.Tick, AddressOf General_Timer_Tick
        AddHandler Sonido_PlayTimer.Tick, AddressOf Sonido_PlayTimer_Tick
        AddHandler GSalidaAudio_AudioTimer.Tick, AddressOf GSalidaAudio_AudioTimer_Tick
        AddHandler GComandos_Comandos_Menu.Opening, AddressOf GComandos_Comandos_Menu_Opening
        AddHandler GComandos_Comandos_Menu.PreviewKeyDown, AddressOf GComandos_Comandos_Menu_KeyDown
        AddHandler GPulsacion_Teclas_Menu.PreviewKeyDown, AddressOf GPulsacion_Teclas_Menu_KeyDown
        AddHandler GMacros_Teclas_Menu.PreviewKeyDown, AddressOf GMacros_Teclas_Menu_KeyDown
        AddHandler KBoard_MenuTecla.PreviewKeyDown, AddressOf KBoard_MenuTecla_KeyDown
        AddHandler KBoard_MenuTecla.Opening, AddressOf KBoard_MenuTecla_Opening
        AddHandler KBoard_MenuTecla.Closing, AddressOf KBoard_MenuTecla_Closing

        Comandos_POculto.Image = My.Resources.Ocultar_Mostrado_Off : Comandos_POculto.Tag = "Mostrar"
        If Lista.Items.Count > 0 Then Comando_Mostrar(Comandos(Lista.Items(0).Tag).ID) : Lista.SelectItem(0) Else Comandos_ComandoNegativo = False : Comando_Mostrar("-1") : ComandoActualID = "Negativo"

        'Panel Opciones
        Opciones_Cargar() : Opciones_Mostrar() : Logros.Cargar(RegPath) : Estadisticas.Cargar(RegPath)
        Estadisticas.Estadisticas.KDesktop_Iniciado += 1 : Estadisticas.Guardar()

        'Mensaje Iniciar
        Sonidos.Play_Block(Opciones_MensajeIniciar_Sonido) : If Opciones_MensajeIniciar_Texto <> "" Then Opciones_OSD_Font = Opciones_MensajeIniciar_Fuente : Opciones_OSD_Color = Opciones_MensajeIniciar_Color : ShowOSD(Replace(Replace(Opciones_MensajeIniciar_Texto, """version""", Version, Compare:=CompareMethod.Text), """ver""", Version, Compare:=CompareMethod.Text))

        'Panel Scripts
        TVTecla.Interval = 1 : TVTecla.Enabled = False : AddHandler TVTecla.Tick, AddressOf TVTecla_Tick

        'Keyloger & UDP
        Keyboard = New Keyboard : Net.ServicePointManager.SecurityProtocol = Net.SecurityProtocolType.Tls12 : UDPEscuchar()

        'Ejecutar al Iniciar
        Application.DoEvents() : If Comandos.Length > 0 Then
            Dim cEjecutarComando As EjecutarComandoST = Nothing ': Dim Contador As Integer
            For Cuenta = 0 To Comandos.Length - 1
                If Comandos(Cuenta).ID <> "" And Comandos(Cuenta).EjecutarIniciar = True And Comandos(Cuenta).Deshabilitar = False Then
                    ' if comandos contiene salida de audio o volumen esperar
                    'Do Until AudioDevices(0) IsNot Nothing Or Contador = 100 : WaitTime(100) : Contador += 1 : Loop
                    cEjecutarComando.Indice_Comando = Cuenta
                    cEjecutarComando.ID_Comando = Comandos(Cuenta).ID
                    cEjecutarComando.Logger = "Iniciar"
                    cEjecutarComando.Notas = "Iniciar"
                    EjecutarComando(cEjecutarComando)
                End If
            Next
        End If

        If FirstRun = True Then ShowF("Show")

        Logros.Desbloquear("Bienvenidos a K-Desktop")
        Logros.Desbloquear("Usuario Registrado")
        Logros.Desbloquear("Accionista 18")

        General_Timer.Enabled = True
    End Sub

    Private Sub FMenu_Activated(sender As Object, e As EventArgs) Handles Me.Activated
        If Focus_TextBox = False Then Exit Sub Else Focus_TextBox = False
        If PanelQuickMenu.Visible = True AndAlso QuickMenu_Editor.Items.Count > 0 AndAlso TypeOf QuickMenu_Editor.Items(0) Is ToolStripTextBox Then
            Dim cItem As ToolStripTextBox = CType(QuickMenu_Editor.Items(0), ToolStripTextBox) : cItem.Select() : cItem.Focus()
        End If
    End Sub

#End Region

#Region " Closing "

    Private Sub FMenu_FormClosing(sender As Object, e As FormClosingEventArgs) Handles MyBase.FormClosing
        QuickMenu_Editor.Close()
        If e.CloseReason = CloseReason.UserClosing Then
            'If GMacro_Grabando = True Then
            '    If ShowMessageBox("¿Cancelar grabación de macro?", Version, MsgBoxStyle.YesNo, "YesNo") = DialogResult.Cancel Then
            '        e.Cancel = True : Exit Sub
            '    Else
            '        GMacro_Grabando = False : GMacro_PGrabar.Image = My.Resources.Macro_GrabarNo_Off : CargarMacro()
            '    End If
            'End If
            'Comandos_Update = True
            'If ComandoActualID = "Negativo" Then
            '    Dim Avisar As Boolean
            '    If Comandos_Sonido_TSonido.Text <> "Sin Sonido" Then Avisar = True
            '    If Comandos_EjecutarIniciar_CEjecutarIniciar.Checked <> False Then Avisar = True
            '    If Comandos_EjecutarSalir_CEjecutarSalir.Checked <> False Then Avisar = True
            '    If Comandos_EjecutarSiempre_CEjecutarSiempre.Checked <> False Then Avisar = True
            '    If Comandos_Deshabilitar_CDeshabilitar.Checked <> False Then Avisar = True
            '    If Comandos_BloquearPulsacion_CBloquearPulsacion.Checked <> False Then Avisar = True
            '    If Comandos_Hotkey_ListaHotkey.Items.Count > 0 Then Avisar = True
            '    If Comandos_Procesos_CProceso.Items.Count > 0 Then Avisar = True
            '    If Comandos_Accion_ListaAccion.Items.Count > 0 Then Avisar = True
            '    If Comandos_Nombre_TNombre.Text.Trim <> "" Then Avisar = False
            '    If Avisar = True Then
            '        If ShowMessageBox("¿Descartar Comando?", Version, MsgBoxStyle.YesNo, "Descartar") = DialogResult.Cancel Then
            '            Comandos_ComandoNegativo = True : Lista.SelectItem(-1) : e.Cancel = True : ExitHotKey() : Exit Sub
            '        Else
            '            For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
            '                If Comandos_Accion_ListaAccion.Items(Cuenta).Text = "Macros" AndAlso IO.File.Exists(KobaPath + "MACROs\" + Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 + ".mcr") = True Then IO.File.Delete(KobaPath + "MACROs\" + Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 + ".mcr")
            '                If Comandos_Accion_ListaAccion.Items(Cuenta).Text = "Ejecutar BAT" AndAlso IO.File.Exists(KobaPath + "BATs\" + Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 + ".bat") = True Then IO.File.Delete(KobaPath + "BATs\" + Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 + ".bat")
            '            Next
            '        End If
            '    End If
            '    'Else
            '    '    Comandos_Sonido_CSonido.SelectedItem = "Sin Sonido"
            '    '    Comandos_EjecutarIniciar_CEjecutarIniciar.Checked = False
            '    '    Comandos_EjecutarSalir_CEjecutarSalir.Checked = False
            '    '    Comandos_EjecutarSiempre_CEjecutarSiempre.Checked = False
            '    '    Comandos_Deshabilitar_CDeshabilitar.Checked = False
            '    '    Comandos_BloquearPulsacion_CBloquearPulsacion.Checked = False
            '    '    Comandos_Hotkey_ListaHotkey.Clear() : Comandos_Accion_ListaAccion.Clear()
            '    '    ExitHotKey() : OcultarPaneles() : PLogo.Visible = True
            'End If
            e.Cancel = True : ShowF("Hide")
            QuickMenu_Editor_ZOrder = False : CancelClose = False
            For Each cItem As Object In QuickMenu_Editor.Items
                If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then cItem.HideDropDown()
            Next : QuickMenu_Editor.Close()
            'PanelComandos.Visible = True
            'PanelKBoard1.Visible = False
            'PanelKBoard2.Visible = False
            'PanelQuickMenu.Visible = False
            'PanelOpciones.Visible = False
            'BPanelComandos.ForeColor1 = Color.FromArgb(205, 150, 0)
            'BPanelKBoard.ForeColor1 = Color.FromArgb(102, 102, 102)
            'BPanelQuickMenu.ForeColor1 = Color.FromArgb(102, 102, 102)
            'BPanelOpciones.ForeColor1 = Color.FromArgb(102, 102, 102)
            'Comandos_Nombre_TNombre.SelectionLength = 0 : HTexto.Focus()
            'Lista.Height = 590
            'Comandos_Update = False
        End If
    End Sub

    Public Sub Handler_SessionEnding(sender As Object, e As Microsoft.Win32.SessionEndingEventArgs)
        If e.Reason = Microsoft.Win32.SessionEndReasons.Logoff Or e.Reason = Microsoft.Win32.SessionEndReasons.SystemShutdown Then
            e.Cancel = True
            ShowF("SalirS")
        End If
    End Sub

    Private Sub FMenu_Deactivate(sender As Object, e As EventArgs) Handles Me.Deactivate
        ExitHotKey()
    End Sub

#End Region

#Region " KeyPress "

    Private Sub FMenu_KeyPress(sender As Object, e As KeyPressEventArgs) Handles MyBase.KeyPress
        If Control.ModifierKeys = Keys.Shift Or Control.ModifierKeys = Keys.Control Or Control.ModifierKeys = Keys.Alt Then Exit Sub
        If Asc(e.KeyChar) = 27 Then
            If Get_KBoard_Key = True Then Exit Sub
            If Combo_Dropped = True Then DroppedDown() : Combo_Dropped = False : HTexto.Focus() : Exit Sub
            If Texto_Focused = True Then Texto_Focused = False : HTexto.Focus() : e.Handled = True : Exit Sub
            If Buscar_Focused = True Then Buscar_Focused = False : HTexto.Focus() : e.Handled = True : TBuscar.Visible = False : Lista_Update() : PBuscar.Image = My.Resources.Search_Off : Exit Sub
            If HotkeyM = True Then HotkeyM = False : Exit Sub
            If GEnviarPulsacion_PulsacionM = True Then GEnviarPulsacion_PulsacionM = False : Exit Sub
            If GMacro_MacroM = True Then GMacro_MacroM = False : Exit Sub
            If GMacro_Grabando = True Then Exit Sub
            If GMacro_ESCs_StopWatch.IsRunning = True Then
                If GMacro_ESCs_StopWatch.ElapsedMilliseconds < 2000 Then Exit Sub Else If GMacro_ESCs_StopWatch.ElapsedMilliseconds > 2000 Then GMacro_ESCs_StopWatch.Stop()
            End If
            If Opacity = 1 Then e.Handled = True : ShowF("Hide")
        End If
    End Sub

    Private Sub FMenu_KeyUp(sender As Object, e As KeyEventArgs) Handles Me.KeyUp
        If Control.ModifierKeys = Keys.Shift Or Control.ModifierKeys = Keys.Control Or Control.ModifierKeys = Keys.Alt Then Exit Sub
        If e.KeyCode = Keys.F5 Then
            'If PanelComandos.Visible = True Then Comandos_Cargar() : AudioDevices_Cargar()
            'If PanelOpciones.Visible = True Then Opciones_Cargar() : Opciones_Mostrar()
        End If
    End Sub

    Private Sub FMenu_Move(sender As Object, e As EventArgs) Handles Me.Move
        If PanelQuickMenu.Visible = True Then
            CancelClose = False
            For Each cItem As Object In QuickMenu_Editor.Items
                If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then cItem.HideDropDown()
            Next : QuickMenu_Editor.Show(Left + 240, Top + 110) : QuickMenu_Editor_ZOrder = False
        End If
    End Sub

#Region " DroppedDown "

    Private Sub DroppedDown()
        'Lista
        Lista_CComandos.DroppedDown = False
        'Comandos
        Comandos_Accion_CAccion.DroppedDown = False
        Comandos_Sonido_CSonido.DroppedDown = False
        Comandos_Procesos_CProceso.DroppedDown = False
        Comandos_Procesos_CCurrentProcess.DroppedDown = False
        'Aplicaciones
        GEjecutarAplicacion_CModo.DroppedDown = False
        GEjecutarAplicacion_CPrioridad.DroppedDown = False
        GAbrirCarpeta_CCarpetas.DroppedDown = False
        GAplicaciones_CAccion.DroppedDown = False
        GAplicaciones_CAplicacion.DroppedDown = False
        'Audio y Video
        GCapturaPantalla_CSonido.DroppedDown = False
        GGrabacionPantalla_CSonido.DroppedDown = False
        GGrabacionAudio_CSonido.DroppedDown = False
        GReproducirSonido_CSonido.DroppedDown = False
        GSalidaAudio_CSonido.DroppedDown = False
        GVolumen_CAccion.DroppedDown = False
        'Utilidades
        GMacro_CAccion.DroppedDown = False
        GMacro_CBoton.DroppedDown = False
        GKBoard_CAccion.DroppedDown = False
        GKBoard_CNombre.DroppedDown = False
        GQuickMenu_CNombre.DroppedDown = False
        GRedAdHoc_CSonido.DroppedDown = False
        'Acciones
        GEnviarPulsacion_CAccion.DroppedDown = False
        GEnviarPulsacion_CPulsacion.DroppedDown = False
        GTopMost_CSonido.DroppedDown = False
        GArchivosOcultos_CSonido.DroppedDown = False
        GDesactivarEn_CSonido.DroppedDown = False
        GMostrarMensaje_CSonido.DroppedDown = False
        GApagarEquipo_CAccion.DroppedDown = False
        GApagarEquipo_CSonido.DroppedDown = False
        GComandos_CAccion.DroppedDown = False
        'Opciones
        Opciones_MensajeIniciar_CSonido.DroppedDown = False
        Opciones_Desactivar_CProcesos.DroppedDown = False
    End Sub

#End Region

#End Region

#Region " Show / Hide "

    Public Sub FocusMe(ByRef Formulario As Form)
        Process_CL.BringWindowToTop(Formulario.Handle) : Process_CL.SetActiveWindow(Formulario.Handle) : Process_CL.BringWindowToTop(Formulario.Handle) : Process_CL.SetForegroundWindow(Formulario.Handle)
        BringToFront() : Formulario.Activate() : Try : AppActivate(Formulario.Text) : Catch : End Try
    End Sub

    Public Sub ShowF(Optional Accion As String = "Show")
        Select Case Accion
            Case "Show"
                FormBorderStyle = FormBorderStyle.None : NotifyIcon.Visible = True : Location = New Point((Screen.PrimaryScreen.Bounds.Width - Width) / 2, (Screen.PrimaryScreen.Bounds.Height - Height) / 2) : Refresh() : Opacity = 1 : FocusMe(Me) : TopMost = True : TopMost = False : FocusMe(Me)': Comando_Mostrar(Comandos(Lista.Items(0).Tag).ID)
            Case "Hide"
                If Opciones_IconoSistema = False Then NotifyIcon.Visible = False
                Opacity = 0 : FormBorderStyle = FormBorderStyle.SizableToolWindow : Location = New Point(-10000, -10000) : BCerrar.State = NSButton.MouseState.None : BCerrar.Invalidate()
            Case "Hide_Macro"
                Opacity = 0 : FormBorderStyle = FormBorderStyle.SizableToolWindow : Location = New Point(-10000, -10000) : BCerrar.State = NSButton.MouseState.None : BCerrar.Invalidate()
            Case "Salir", "SalirS"
                Opciones_OSD.Hide() : If FSerial.Opacity <> 0 Then FSerial.Cancelado = "Ending"
                If GrabandoPantalla = True Then VideoRecorder.Stop() : GrabandoPantalla = False
                If GrabandoAudio = True Then GGrabacionAudio_Recorder.CancelRecording() : GrabandoAudio = False
                CapturandoPantalla = False : ApagandoEquipo = False
                For Cuenta = 0 To Comandos.Length - 1
                    For Cuenta2 = 0 To Comandos(Cuenta).Accion.Length - 1
                        If Comandos(Cuenta).Accion(Cuenta2).Thread_EjecutarAccion IsNot Nothing Then Comandos(Cuenta).Accion(Cuenta2).Thread_EjecutarAccion.Abort()
                    Next : If Comandos(Cuenta).Thread_EjecutarComando IsNot Nothing Then Comandos(Cuenta).Thread_EjecutarComando.Abort()
                Next
                FRenombrar.Close() : FIconDialog.Close() : FCapturarPantalla.Close() : FVideoRecorder.Close() : FAudioRecorder.Close() : FSerialGenerator.Close() : FDebug.Close()
                FSerial.Cancelado = "Ending" : FSerial.Close() : FFirstRun.Cancelado = False : FFirstRun.Close()
                ShowF("Hide")
                CloseAllowed = "" : Saliendo = True
                If Comandos.Length > 0 Then
                    Dim cEjecutarComando As EjecutarComandoST = Nothing
                    For Cuenta = 0 To Comandos.Length - 1
                        If Comandos(Cuenta).ID <> "" And Comandos(Cuenta).EjecutarSalir = True And Comandos(Cuenta).Deshabilitar = False Then
                            CloseAllowed = "Wait"
                            cEjecutarComando.Sonido = Comandos(cEjecutarComando.Indice_Comando).Sonido
                            cEjecutarComando.Indice_Comando = Cuenta
                            cEjecutarComando.ID_Comando = Comandos(Cuenta).ID
                            cEjecutarComando.Logger = "Salir"
                            cEjecutarComando.Notas = "Salir"
                            EjecutarComando(cEjecutarComando)
                        End If
Salta:              Next
                End If
                Do Until CapturandoPantalla = False And GrabandoPantalla = False And GrabandoAudio = False And ApagandoEquipo = False AndAlso (CloseAllowed = "" Or CloseAllowed = "Done") : WaitTime(500) : Loop ': If CloseAllowed = "Done" Then WaitTime(Sonido_Duracion(Sonido))
                Do Until FCapturarPantalla.Visible = False And FVideoRecorder.Visible = False And FAudioRecorder.Visible = False : WaitTime(500) : Loop
                Opciones_OSD.Hide() : Keyboard.Close() : Proceso.Close()
                NotifyIcon.Visible = False : NotifyIcon.Dispose() : FTheme.Refresh() : FTheme.Dispose()
                If (Application.StartupPath.ToLower + "\").Replace("\\", "\") <> KobaPath Then
                    'CreateKPS() : RunProcess.RunAsStandar(KobaPathTemp + "KPS.exe", ("Eliminar|-|" + (Application.StartupPath + "\ScreenRecorderLib.dll").Replace("\\", "\")).Replace("""", "|||"))
                    'RunProcess.RunAsStandar(KobaPathTemp + "KPS.exe", ("Eliminar|-|" + (Application.StartupPath + "\NAudio.Lame.dll").Replace("\\", "\")).Replace("""", "|||"))
                    'RunProcess.RunAsStandar(KobaPathTemp + "KPS.exe", ("Eliminar|-|" + (Application.StartupPath + "\libmp3lame.64.dll").Replace("\\", "\")).Replace("""", "|||"))
                End If

                If Accion = "Salir" Then Sonidos.Stop() : Sonidos.Play_Block("Hardware Fail", True)
                Select Case GApagarEquipo_Accion
                    Case "Apagar Equipo" : RunCMD("Shutdown /p /f")
                    Case "Reiniciar Equipo" : RunCMD("Shutdown /r /f /t 0")
                    Case "Cerrar Sesion" : RunCMD("Shutdown -L")
                End Select
                General_Timer.Enabled = False
                End
                'Case "SalirV"
                '    If FSerial.Opacity <> 0 Then FSerial.Cancelado = "Ending"
                '    For Each p As Process In Process.GetProcessesByName("ffmpeg") : p.Kill() : Next
                '    Try : Opciones_OSD.Hide() : Keyboard.Close() : Proceso.Close() : Catch : End Try
                '    NotifyIcon.Visible = False : NotifyIcon.Dispose() : Opacity = 0 : FTheme.Refresh() : FTheme.Dispose()
                '    Internet.Firewall_AddRule("KDesktopU", KobaPathTemp + "update.exe", "KDesktop Updater")
                '    Process.Start(KobaPathTemp + "update.exe", "update")
                '    Threading.Thread.Sleep(100) : Application.DoEvents() : End
        End Select
    End Sub

#End Region

#Region " Controles "

#Region " Main "

    Private Sub Controles_Click(sender As Object, e As EventArgs) Handles FTheme.Click, Lista.Click, PLogo.Click
        If GPaginaWeb_GNavegadores.Visible = True Then GPaginaWeb_GNavegadores.Visible = False
        If sender.name <> "Lista" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub ExitHotKey(Optional LControl As String = "")
        If LControl = "Macro" Or LControl = "Pulsacion" Then
            Comandos_Hotkey_THotkey.Width += 1 : Comandos_Hotkey_LCHotkey.Width += 1 : Comandos_Hotkey_THotkey.isKeyLog = False : Comandos_Hotkey_THotkey.Invalidate() ': Application.DoEvents()
            GMacro_TTecla.isKeyLog = False : GMacro_TTecla.Invalidate()
            GEnviarPulsacion_TPulsacion.isKeyLog = False : GEnviarPulsacion_TPulsacion.Invalidate() ': GEnviarPulsacion_LCPulsacion.Cursor = Cursors.Hand : Application.DoEvents()
            Mouse_HotKey = False : Get_HotKey = False : HotkeyM = False : Get_Macro_Key = False : GMacro_MacroM = False : Get_Pulsacion_Key = False : GEnviarPulsacion_PulsacionM = False
        ElseIf LControl = "Hotkey" Then
            GMacro_TTecla.Width = 107
            GEnviarPulsacion_TPulsacion.Width = 147
            GMacro_TTecla.isKeyLog = False : Get_Pulsacion_Key = False : GEnviarPulsacion_PulsacionM = False : GMacro_TTecla.Invalidate()
            GEnviarPulsacion_TPulsacion.isKeyLog = False : GEnviarPulsacion_TPulsacion.Invalidate() ': GEnviarPulsacion_LCPulsacion.Cursor = Cursors.Hand ': Application.DoEvents()
        ElseIf Mouse_HotKey = True Then
            Comandos_Hotkey_THotkey.Width = 188 : Comandos_Hotkey_LCHotkey.Width = 178 : Comandos_Hotkey_THotkey.isKeyLog = False : Comandos_Hotkey_THotkey.Invalidate() ': Application.DoEvents()
            GMacro_TTecla.Width = 107
            GEnviarPulsacion_TPulsacion.Width = 147
            GMacro_TTecla.isKeyLog = False : GMacro_TTecla.Invalidate()
            GEnviarPulsacion_TPulsacion.isKeyLog = False : GEnviarPulsacion_TPulsacion.Invalidate() ': GEnviarPulsacion_LCPulsacion.Cursor = Cursors.Hand : Application.DoEvents()
            Mouse_HotKey = False : Get_HotKey = False : HotkeyM = False : Get_Macro_Key = False : GMacro_MacroM = False : Get_Pulsacion_Key = False : GEnviarPulsacion_PulsacionM = False
        End If
        If LControl = "Cambiar" Then
            KBoard_TPor.isKeyLog = False : KBoard_TPor.Invalidate()
            KBoard_Por_HotKey = False : KBoard_Por_Mouse_HotKey = False : HotkeyM = False
        ElseIf LControl = "Por" Then
            KBoard_TCambiar.isKeyLog = False : KBoard_TCambiar.Invalidate()
            KBoard_Cambiar_HotKey = False : KBoard_Cambiar_Mouse_HotKey = False : HotkeyM = False
        Else
            KBoard_TCambiar.isKeyLog = False : KBoard_TCambiar.Invalidate()
            KBoard_Cambiar_HotKey = False : KBoard_Cambiar_Mouse_HotKey = False : HotkeyM = False
            KBoard_TPor.isKeyLog = False : KBoard_TPor.Invalidate()
            KBoard_Por_HotKey = False : KBoard_Por_Mouse_HotKey = False : HotkeyM = False
        End If
    End Sub

    Private Sub HTexto_KeyPress(sender As Object, e As KeyPressEventArgs) Handles HTexto.KeyPress
        e.Handled = True
    End Sub

    Private Sub HTexto_GotFocus(sender As Object, e As EventArgs) Handles HTexto.GotFocus
        If Focus_KBoard_Name = True Then KBoard_Nombre_TNombre.Focus() : Focus_KBoard_Name = False
        If Focus_QuickMenu_Name = True Then QuickMenu_Nombre_TNombre.Focus() : Focus_QuickMenu_Name = False
    End Sub

#End Region

#Region " Paneles "

    Private Sub Controles_Comandos_Click(sender As Object, e As EventArgs) Handles BPanelComandos.Click, PanelComandos.Click, Comandos_Nombre_LNombre.Click, Comandos_Sonido_LSonido.Click, Comandos_Sonido_LCSonido.Click, Comandos_Sonido_CSonido.Click, Comandos_Sonido_BPlay.Click, Comandos_Sonido_BExaminar.Click, Comandos_Accion_BAccionAdd.Click, Comandos_Accion_CAccion.Click, Comandos_Accion_Down.Click, Comandos_Accion_Up.Click, Comandos_Accion_NoSettings.Click, Comandos_Accion_LAccion.Click, Comandos_Hotkey_BHotkeyAdd.Click, Comandos_Hotkey_LHotkey.Click, Comandos_Hotkey_LCHotkey.Click, Comandos_EjecutarIniciar_CEjecutarIniciar.Click, Comandos_EjecutarIniciar_LEjecutarIniciar.Click, Comandos_EjecutarSalir_LEjecutarSalir.Click, Comandos_EjecutarSalir_CEjecutarSalir.Click, Comandos_EjecutarSiempre_LEjecutarSiempre.Click, Comandos_EjecutarSiempre_CEjecutarSiempre.Click, Comandos_Deshabilitar_LDeshabilitar.Click, Comandos_Deshabilitar_CDeshabilitar.Click, Comandos_Procesos_CProceso.Click, Comandos_Procesos_CCurrentProcess.Click, Comandos_Procesos_LCProcesos.Click, Comandos_Procesos_BEliminar.Click, Comandos_Procesos_BAñadir.Click, Comandos_Procesos_BExaminar.Click, Comandos_Procesos_LEjecutarProcesos.Click, Comandos_LEjecutarAl.Click
        If GPaginaWeb_GNavegadores.Visible = True Then GPaginaWeb_GNavegadores.Visible = False
        If sender.Name = "Comandos_Hotkey_LCHotkey" Then ExitHotKey("Hotkey") : Exit Sub
        If sender.Name <> "Comandos_Sonido_CSonido" And sender.Name <> "Comandos_Procesos_CProceso" And sender.Name <> "Comandos_Procesos_CCurrentProcess" Then HTexto.Focus()
        If sender.Name <> "Comandos_Hotkey_BHotkeyAdd" Then ExitHotKey()
    End Sub

    Private Sub Controles_Comandos_GotFocus(sender As Object, e As EventArgs) Handles Comandos_Nombre_TNombre.GotFocus, Comandos_Sonido_TSonido.GotFocus, Comandos_Hotkey_THotkey.GotFocus, Comandos_Hotkey_ListaHotkey.GotFocus, Comandos_Accion_ListaAccion.GotFocus, Comandos_Procesos_TProceso.GotFocus
        If GPaginaWeb_GNavegadores.Visible = True Then GPaginaWeb_GNavegadores.Visible = False
        If sender.Name = "Comandos_Hotkey_THotkey" Then ExitHotKey("Hotkey") : Exit Sub
        ExitHotKey()
    End Sub

    Private Sub Controles_KBoard_Click(sender As Object, e As MouseEventArgs) Handles BPanelKBoard.Click, PanelKBoard1.Click, KBoard_Nombre_LNombre.Click, KBoard_Nombre_LCNombre.Click, KBoard_Nombre_BAdd.Click, KBoard_Nombre_BDelete.Click, KBoard_LProceso.Click, KBoard_LCProceso.Click, KBoard_BProcesoAdd.Click, KBoard_BProcesoEliminar.Click, KBoard_BProcesoExaminar.Click, KBoard_CAutoActivar.Click, KBoard_LAutoActivar.Click, KBoard_LEstado.Click, KBoard_TEstado.Click, KBoard_LPor.Click, KBoard_GRaton.Click, KBoard_GNumerico.Click, KBoard_GKeyboard.Click, KBoard_PRaton.Click, KBoard_CLCtrl.Click, KBoard_CLShift.Click, KBoard_CLAlt.Click, KBoard_CLWin.Click, KBoard_CRCtrl.Click, KBoard_CRShift.Click, KBoard_CRAlt.Click, KBoard_CRWin.Click, KBoard_Separador.Click, KBoard_LRaton.Click, KBoard_LNumerico.Click, KBoard_LTeclado.Click, KBoard_CDeshabilitado.Click, KBoard_LDeshabilitado.Click, KBoard_GVersion.Click, KBoard_LVersion.Click, KBoard_LCambiar.Click, KBoard_TCambiar.Click, KBoard_LCCambiar.Click, KBoard_LPor.Click, KBoard_TPor.Click, KBoard_LCPor.Click, PResetear.Click
        ExitHotKey()
        If sender.Name = "KBoard_PRaton" Then
            Dim Boton As String = "None"
            If KBoard_LButton.IsVisible(e.Location) Then Boton = "LClick"
            If KBoard_MButton.IsVisible(e.Location) Then Boton = "MClick"
            If KBoard_RButton.IsVisible(e.Location) Then Boton = "RClick"
            If KBoard_Button4.IsVisible(e.Location) Then Boton = "Button4"
            If KBoard_Button5.IsVisible(e.Location) Then Boton = "Button5"
            If Boton <> "None" Then Exit Sub
        End If
        If sender.Name = "KBoard_TCambiar" Or sender.Name = "KBoard_LCCambiar" Then ExitHotKey(sender.Name) : Exit Sub
        If sender.Name = "KBoard_TPor" Or sender.Name = "KBoard_LCPor" Then ExitHotKey(sender.Name) : Exit Sub
        Dim KTecla As NSButton
        For Each cntrl As Control In KBoard_GKeyboard.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton)
                If KTecla.ClientRectangle.Contains(KTecla.PointToClient(MousePosition)) = False Then
                    KTecla.State = NSButton.MouseState.None
                    If cntrl.Name = "BEnter" Then
                        BEnter2.State = NSButton.MouseState.None : BEnter2.Invalidate()
                        If BEnter.Marked = False Then
                            BEnter2.Marked = False
                            BEnter4.BackColor = Color.FromArgb(65, 65, 65) : BEnter4.Invalidate()
                            BEnter5.BackColor = Color.FromArgb(65, 65, 65) : BEnter5.Invalidate()
                        End If
                    End If
                End If : KTecla.Marked_Set = False : KTecla.Invalidate()
            End If
        Next
        For Each cntrl As Control In KBoard_GNumerico.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton)
                If KTecla.ClientRectangle.Contains(KTecla.PointToClient(MousePosition)) = False Then KTecla.State = NSButton.MouseState.None
                KTecla.Marked_Set = False : KTecla.Invalidate()
            End If
        Next
        For Each cntrl As Control In KBoard_GRaton.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton)
                If KTecla.ClientRectangle.Contains(KTecla.PointToClient(MousePosition)) = False Then KTecla.State = NSButton.MouseState.None
                KTecla.Marked_Set = False : KTecla.Invalidate()
            End If
        Next : ComandoScript = "" : TVTecla.Enabled = False : IniciaContador = False : Contador = 0
    End Sub

    Private Sub Controles_KBoard_GotFocus(sender As Object, e As EventArgs) Handles KBoard_TCambiar.GotFocus
        ExitHotKey()
    End Sub

    Private Sub Controles_Opciones_Click(sender As Object, e As EventArgs) Handles BPanelOpciones.Click, PanelOpciones.Click, Opciones_GMensajeIniciar.Click, Opciones_GLMensajeIniciar.Click, Opciones_MensajeIniciar_LMensaje.Click, Opciones_MensajeIniciar_BOSD.Click, Opciones_MensajeIniciar_LSonido.Click, Opciones_MensajeIniciar_LCSonido.Click, Opciones_MensajeIniciar_BPlay.Click, Opciones_MensajeIniciar_BExaminar.Click, Opciones_GVersion.Click, Opciones_GLVersion.Click, Opciones_Version_LRegistrado.Click, Opciones_Version_LCorreo.Click, Opciones_Version_LValido.Click, Opciones_Version_LFecha.Click, Opciones_Version_LVersion.Click, Opciones_Version_LCVersion.Click, Opciones_Version_PSerial.Click, Opciones_Version_BRegistrar.Click, Opciones_GSistema.Click, Opciones_GLSistema.Click, Opciones_GIniciarWindows.Click, Opciones_IniciarWindows_CIniciarWindows.Click, Opciones_IniciarWindows_LIniciarWindows.Click, Opciones_GIconoSistema.Click, Opciones_IconoSistema_CIconoSistema.Click, Opciones_IconoSistema_LIconoSistema.Click, Opciones_IconoSistema_PIconoSistema.Click, Opciones_GDisableXButton.Click, Opciones_DisableXButton_CDisableXButton.Click, Opciones_DisableXButton_LDisableXButton.Click, Opciones_GUDP.Click, Opciones_GLServidorUDP.Click, Opciones_UDP_LPuerto.Click, Opciones_UDP_LEstado.Click, Opciones_GSabiasQue.Click, Opciones_GLSabiasQue.Click, Opciones_SabiasQue_LShortcut.Click, Opciones_SabiasQue_LAccion.Click, Opciones_GDesactivar.Click, Opciones_GLDesactivarEn.Click, Opciones_Desactivar_LCProceso.Click, Opciones_Desactivar_BExaminar.Click, Opciones_PLogo.Click, LCTRLClick.Click, Opciones_Separador1.Click, Opciones_Separador2.Click, Opciones_Separador3.Click, Opciones_GBotones.Click, Opciones_Desactivar_BEliminar.Click, Opciones_Desactivar_BAñadir.Click, Opciones_Deshabilitar_LCProceso.Click, Opciones_Deshabilitar_TProceso.Click, Opciones_Deshabilitar_BExaminar.Click, Opciones_Deshabilitar_BEliminar.Click, Opciones_Deshabilitar_BAñadir.Click, Opciones_IniciarWindows_LModo.Click, Opciones_IniciarWindows_TModo.Click, PAyuda.Click, PLogros.Click, PImportar.Click, PExportar.Click
        HTexto.Focus()
    End Sub

    Private Sub Controles_Opciones_GotFocus(sender As Object, e As EventArgs) Handles Opciones_MensajeIniciar_TMensaje.GotFocus, Opciones_UDP_TPuerto.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Acciones "

#Region " Aplicaciones "

#Region " Ejecutar Aplicacion "

    Private Sub Controles_GEjecutarAplicacion_Click(sender As Object, e As EventArgs) Handles GEjecutarAplicacion.Click, GEjecutarAplicacion_LRuta.Click, GEjecutarAplicacion_LParametros.Click, GEjecutarAplicacion_LIniciarEn.Click, GEjecutarAplicacion_LAdmin.Click, GEjecutarAplicacion_LModo.Click, GEjecutarAplicacion_LPrioridad.Click, GEjecutarAplicacion_LTopMost.Click, GEjecutarAplicacion_LCModo.Click, GEjecutarAplicacion_LCPrioridad.Click, GEjecutarAplicacion_CAdmin.Click, GEjecutarAplicacion_CModo.Click, GEjecutarAplicacion_CPrioridad.Click, GEjecutarAplicacion_CTopMost.Click, GEjecutarAplicacion_BExaminar_IniciarEn.Click, GEjecutarAplicacion_BExaminar_Ruta.Click, GEjecutarAplicacion_GInformacion.Click, GEjecutarAplicacion_Info_LCompany.Click, GEjecutarAplicacion_Info_LNombre.Click, GEjecutarAplicacion_Info_LTipo.Click, GEjecutarAplicacion_Info_LoadingCircle.Click, GEjecutarAplicacion_Info_PIcono.Click, GEjecutarAplicacion_Info_SinInformacion.Click
        If sender.Name <> "GEjecutarAplicacion_CModo" And sender.Name <> "GEjecutarAplicacion_CPrioridad" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GEjecutarAplicacion_GotFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TRuta.GotFocus, GEjecutarAplicacion_TParametros.GotFocus, GEjecutarAplicacion_TIniciarEn.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Abrir Carpeta "

    Private Sub Controles_GAbrirCarpeta_Click(sender As Object, e As EventArgs) Handles GAbrirCarpeta.Click, GAbrirCarpeta_LRuta.Click, GAbrirCarpeta_LHelp.Click, GAbrirCarpeta_Icono.Click
        HTexto.Focus() : ExitHotKey()
    End Sub

    Private Sub Controles_GAbrirCarpeta_GotFocus(sender As Object, e As EventArgs) Handles GAbrirCarpeta_TRuta.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Pagina Web "

    Private Sub Controles_GPaginaWeb_Click(sender As Object, e As EventArgs) Handles GPaginaWeb.Click, GPaginaWeb_CNuevaVentana.Click, GPaginaWeb_LNuevaVentana.Click, GPaginaWeb_CVentanaIncognito.Click, GPaginaWeb_LVentanaIncognito.Click, GPaginaWeb_CAdmin.Click, GPaginaWeb_LAdmin.Click, GPaginaWeb_GInfo.Click, GPaginaWeb_Info_DNS.Click, GPaginaWeb_Info_LNombre.Click, GPaginaWeb_Info_LoadingCircle.Click, GPaginaWeb_Info_LTipo.Click, GPaginaWeb_Info_PIcono.Click, GPaginaWeb_Info_SinInformacion.Click, GPaginaWeb_LHelp.Click, GPaginaWeb_LURL.Click
        If GPaginaWeb_GNavegadores.Visible = True Then GPaginaWeb_GNavegadores.Visible = False
        HTexto.Focus() : ExitHotKey()
    End Sub

    Private Sub Controles_GPaginaWeb_GotFocus(sender As Object, e As EventArgs) Handles GPaginaWeb_TURL.GotFocus
        If GPaginaWeb_GNavegadores.Visible = True Then GPaginaWeb_GNavegadores.Visible = False
        ExitHotKey()
    End Sub

#End Region

#Region " Aplicaciones "

    Private Sub Controles_GAplicaciones_Click(sender As Object, e As EventArgs) Handles GAplicaciones.Click, GAplicaciones_LAccion.Click, GAplicaciones_LCAccion.Click, GAplicaciones_CAccion.Click, GAplicaciones_LAplicacion.Click, GAplicaciones_LCAplicacion.Click, GAplicaciones_CAplicacion.Click, GAplicaciones_CEsperar.Click, GAplicaciones_LEsperar.Click, GAplicaciones_LHelp.Click, GAplicaciones_LEsperarA.Click, GAplicaciones_Esperar_CActivar.Click, GAplicaciones_Esperar_LActivar.Click, GAplicaciones_Esperar_CAbrir.Click, GAplicaciones_Esperar_LAbrir.Click, GAplicaciones_Esperar_CCerrar.Click, GAplicaciones_Esperar_LCerrar.Click
        If sender.Name <> "GAplicaciones_CAccion" And sender.Name <> "GAplicaciones_CAplicacion" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GActivarAplicacion_GotFocus(sender As Object, e As EventArgs) Handles GAplicaciones_TAccion.GotFocus, GAplicaciones_TAplicacion.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Ejecutar BAT "

    Private Sub Controles_GEjecutarBAT_Click(sender As Object, e As EventArgs) Handles GEjecutarBAT.Click, GEjecutarBAT_LNombre.Click, GEjecutarBAT_LModo.Click, GEjecutarBAT_LCModo.Click, GEjecutarBAT_CModo.Click, GEjecutarBAT_CAdministrador.Click, GEjecutarBAT_LAdministrador.Click, GEjecutarBAT_PNuevo.Click, GEjecutarBAT_PAbrir.Click, GEjecutarBAT_PGuardar.Click, GEjecutarBAT_LHelp.Click
        If sender.Name <> "GEjecutarBAT_CModo" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GEjecutarBAT_GotFocus(sender As Object, e As EventArgs) Handles GEjecutarBAT_TNombre.GotFocus, GEjecutarBAT_TModo.GotFocus, GEjecutarBAT_TTexto.GotFocus
        ExitHotKey()
    End Sub

#End Region

#End Region

#Region " Audio y Videos "

#Region " Captura de Pantalla "

    Private Sub Controles_GCapturaPantalla_Click(sender As Object, e As EventArgs) Handles GCapturaPantalla.Click, GCapturaPantalla_LSonido.Click, GCapturaPantalla_LCSonido.Click, GCapturaPantalla_CSonido.Click, GCapturaPantalla_BExaminar.Click, GCapturaPantalla_CCuentaAtras.Click, GCapturaPantalla_LCuentaAtras.Click, GCapturaPantalla_LFormato.Click, GCapturaPantalla_COSD.Click, GCapturaPantalla_LOSD.Click, GCapturaPantalla_BOSD.Click, GCapturaPantalla_LHelp.Click
        If sender.Name <> "GCapturaPantalla_CSonido" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GCapturaPantalla_GotFocus(sender As Object, e As EventArgs) Handles GCapturaPantalla_TSonido.GotFocus, GCapturaPantalla_TDuracion.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Grabacion de Pantalla "

    Private Sub Controles_GGrabacionPantalla_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla.Click, GGrabacionPantalla_LSonido.Click, GGrabacionPantalla_LCSonido.Click, GGrabacionPantalla_CSonido.Click, GGrabacionPantalla_BExaminar.Click, GGrabacionPantalla_CCuentaAtras.Click, GGrabacionPantalla_LCuentaAtras.Click, GGrabacionPantalla_CMarcarClicks.Click, GGrabacionPantalla_LMarcarClicks.Click, GGrabacionPantalla_LFormato.Click, GGrabacionPantalla_COSD.Click, GGrabacionPantalla_LOSD.Click, GGrabacionPantalla_BOSD.Click, GGrabacionPantalla_LHelp.Click, GGrabacionPantalla_GPantallas.Click, GGrabacionPantalla_CPantalla1.Click, GGrabacionPantalla_LPantalla1.Click, GGrabacionPantalla_CPantalla2.Click, GGrabacionPantalla_LPantalla2.Click, GGrabacionPantalla_CPantalla3.Click, GGrabacionPantalla_LPantalla3.Click, GGrabacionPantalla_CPantalla4.Click, GGrabacionPantalla_LPantalla4.Click, GGrabacionPantalla_CPreguntar.Click, GGrabacionPantalla_LPreguntar.Click, GGrabacionPantalla_LGSonido.Click, GGrabacionPantalla_LGMicrofono.Click, GGrabacionPantalla_CGSonido.Click, GGrabacionPantalla_CGMicrofono.Click, GGrabacionPantalla_LDesktopDuplication.Click, GGrabacionPantalla_CDesktopDuplication.Click
        If sender.Name <> "GGrabacionPantalla_CSonido" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GGrabacionPantalla_GotFocus(sender As Object, e As EventArgs) Handles GGrabacionPantalla_TSonido.GotFocus, GGrabacionPantalla_TDuracion.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Grabacion de Audio "

    Private Sub Controles_GGrabacionAudio_Click(sender As Object, e As EventArgs) Handles GGrabacionAudio.Click, GGrabacionAudio_LSonido.Click, GGrabacionAudio_LCSonido.Click, GGrabacionAudio_CSonido.Click, GGrabacionAudio_BExaminar.Click, GGrabacionAudio_CCuentaAtras.Click, GGrabacionAudio_LCuentaAtras.Click, GGrabacionAudio_LFormato.Click, GGrabacionAudio_COSD.Click, GGrabacionAudio_LOSD.Click, GGrabacionAudio_BOSD.Click, GGrabacionAudio_LHelp.Click
        If sender.Name <> "GGrabacionAudio_CSonido" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GGrabacionAudio_GotFocus(sender As Object, e As EventArgs) Handles GGrabacionAudio_TSonido.GotFocus, GGrabacionAudio_TDuracion.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Reproducir Sonido "

    Private Sub Controles_GReproducirSonido_Click(sender As Object, e As EventArgs) Handles GReproducirSonido.Click, GReproducirSonido_LSonido.Click, GReproducirSonido_LCSonido.Click, GReproducirSonido_CSonido.Click, GReproducirSonido_CEsperar.Click, GReproducirSonido_LEsperar.Click, GReproducirSonido_LHelp.Click
        If sender.Name <> "GReproducirSonido_CSonido" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GReproducirSonido_GotFocus(sender As Object, e As EventArgs) Handles GReproducirSonido_TSonido.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Salida de Audio "

    Private Sub Controles_GSalidaAudio_Click(sender As Object, e As EventArgs) Handles GSalidaAudio.Click, GSalidaAudio_LSonido.Click, GSalidaAudio_LCSonido.Click, GSalidaAudio_CSonido.Click, GSalidaAudio_BPlay.Click, GSalidaAudio_BExaminar.Click, GSalidaAudio_COSD.Click, GSalidaAudio_LOSD.Click, GSalidaAudio_LListaDisponibles.Click, GSalidaAudio_LListaSeleccionados.Click, GSalidaAudio_LNombre.Click, GSalidaAudio_LHardware.Click, GSalidaAudio_LEstado.Click, GSalidaAudio_LPredeterminado.Click, GSalidaAudio_LComunicaciones.Click, GSalidaAudio_PIcono.Click, GSalidaAudio_BAdministradorSonido.Click, GSalidaAudio_Up.Click, GSalidaAudio_Down.Click, GSalidaAudio_ListaDisponibles.Click, GSalidaAudio_ListaSeleccionados.Click, GSalidaAudio_LHelp.Click
        If sender.Name <> "GSalidaAudio_CSonido" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GSalidaAudio_GotFocus(sender As Object, e As EventArgs) Handles GSalidaAudio_TSonido.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Volumen "

    Private Sub Controles_GVolumen_Click(sender As Object, e As EventArgs) Handles GVolumen.Click, GVolumen_LAccion.Click, GVolumen_LCAccion.Click, GVolumen_CAccion.Click, GVolumen_LIntervalo.Click, GVolumen_LHelp.Click
        If sender.Name <> "GVolumen_CAccion" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GVolumen_GotFocus(sender As Object, e As EventArgs) Handles GVolumen_TAccion.GotFocus, GVolumen_TIntervalo.GotFocus
        ExitHotKey()
    End Sub

#End Region

#End Region

#Region " Utilidades "

#Region " Macros "

    Private Sub Controles_GMacros_Click(sender As Object, e As EventArgs) Handles GMacro.Click, GMacro_Lista.Click, GMacro_Up.Click, GMacro_Down.Click, GMacro_CPausasEjecucion.Click, GMacro_LPausasEjecucion.Click, GMacro_CEventosTeclado.Click, GMacro_LEventosTeclado.Click, GMacro_CClicsRaton.Click, GMacro_LClicsRaton.Click, GMacro_CRuedaRaton.Click, GMacro_LRuedaRaton.Click, GMacro_CMovimientoRaton.Click, GMacro_LMovimientoRaton.Click, GMacro_CClicks_Position.Click, GMacro_LClicks_Position.Click, GMacro_CRepetir.Click, GMacro_LRepetir.Click, GMacro_LEsperar.Click, GMacro_CEsperar.Click, GMacro_Separador1.Click, GMacro_Separador2.Click, GMacro_LHelp.Click, GMacro_GAñadirMacro.Click, GMacro_LAñadirMacro.Click, GMacro_LCerrar.Click, GMacro_LAccion.Click, GMacro_CAccion.Click, GMacro_LCAccion.Click, GMacro_LBoton.Click, GMacro_CBoton.Click, GMacro_LCBoton.Click, GMacro_LX.Click, GMacro_LY.Click, GMacro_CoorLMouse.Click, GMacro_CoorLX.Click, GMacro_CoorLY.Click, GMacro_CoorLCX.Click, GMacro_CoorLCY.Click, GMacro_LPausa.Click, GMacro_LTecla.Click, GMacro_LAplicarActuales.Click, GMacro_BAñadirEvento.Click, GMacro_LCTecla.Click, GMacro_LHelp.Click, GMacro_LAñadirPausa.Click, GMacros_BAñadirPausa.Click, GMacro_PPausas.Click, GMacro_PAñadir.Click, GMacro_PEditar.Click, GMacro_PCopiar.Click, GMacro_PPegar.Click, GMacro_PResetTime.Click, GMacro_PSetTime.Click, GMacro_PEliminar.Click, GMacro_PClear.Click, GMacro_PGrabar.Click, GMacro_LPausasMS.Click
        If sender.name <> "GMacro_Lista" And sender.Name <> "GMacro_CAccion" And sender.Name <> "GMacro_CBoton" And sender.Name <> "GMacro_CTecla" Then HTexto.Focus()
        If sender.Name = "GMacro_LCTecla" Then ExitHotKey("Macro") : Exit Sub
        ExitHotKey()
    End Sub

    Private Sub Controles_GMacros_GotFocus(sender As Object, e As EventArgs) Handles GMacro_TAccion.GotFocus, GMacro_TBoton.GotFocus, GMacro_TPausa.GotFocus, GMacro_TX.GotFocus, GMacro_TY.GotFocus, GMacro_TTecla.GotFocus, GMacros_BAñadirPausa.GotFocus
        If sender.Name = "GMacro_TTecla" Then ExitHotKey("Macro") : Exit Sub
        ExitHotKey()
    End Sub

#End Region

#Region " K-Board "

    Private Sub Controles_GKBoard_Click(sender As Object, e As EventArgs) Handles GKBoard.Click, GKBoard_LNombre.Click, GKBoard_LCNombre.Click, GKBoard_CNombre.Click, GKBoard_LHelp.Click
        If sender.Name <> "KBoard_CNombre" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GKBoard_GotFocus(sender As Object, e As EventArgs) Handles GKBoard_TNombre.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " QuickMenu "

    Private Sub Controles_GQuickMenu_Click(sender As Object, e As EventArgs) Handles GQuickMenu.Click, GQuickMenu_LNombre.Click, GQuickMenu_LCNombre.Click, GQuickMenu_CNombre.Click, GQuickMenu_LHelp.Click
        If sender.Name <> "GQuickMenu_CNombre" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GQuickMenu_GotFocus(sender As Object, e As EventArgs) Handles GQuickMenu_TNombre.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Red Ad-Hoc "

    Private Sub Controles_GRedAdHoc_Click(sender As Object, e As EventArgs) Handles GRedAdHoc_LNombre.Click, GRedAdHoc_LContraseña.Click, GRedAdHoc_LSonido.Click, GRedAdHoc_LCSonido.Click, GRedAdHoc_COSD.Click, GRedAdHoc_LOSD.Click, GRedAdHoc_LNoSoportado.Click, GRedAdHoc_LHelp.Click
        HTexto.Focus() : ExitHotKey()
    End Sub

    Private Sub Controles_GRedAdHoc_GotFocus(sender As Object, e As EventArgs) Handles GRedAdHoc_TNombre.GotFocus, GRedAdHoc_TContraseña.GotFocus, GRedAdHoc_TSonido.GotFocus
        ExitHotKey()
    End Sub


#End Region

#End Region

#Region " Acciones "

#Region " Enviar Pulsacion "

    Private Sub Controles_GEnviarPulsacion_Click(sender As Object, e As EventArgs) Handles GEnviarPulsacion.Click, GEnviarPulsacion_LAccion.Click, GEnviarPulsacion_LCAccion.Click, GEnviarPulsacion_CAccion.Click, GEnviarPulsacion_LPulsacion.Click, GEnviarPulsacion_LCPulsacion.Click, GEnviarPulsacion_CPulsacion.Click, GEnviarPulsacion_LTexto.Click, GEnviarPulsacion_LHelp.Click, GEnviarPulsacion_LWIN.Click, GEnviarPulsacion_CWin.Click, GEnviarPulsacion_LCTRL.Click, GEnviarPulsacion_CCTRL.Click, GEnviarPulsacion_LSHIFT.Click, GEnviarPulsacion_CSHIFT.Click, GEnviarPulsacion_LALT.Click, GEnviarPulsacion_CALT.Click, GEnviarPulsacion_PAccion.Click, GEnviarPulsacion_PPulsacion.Click
        If sender.Name <> "GEnviarPulsacion_CAccion" And sender.Name <> "GEnviarPulsacion_CPulsacion" Then HTexto.Focus()
        If sender.Name = "GEnviarPulsacion_LCPulsacion" Or sender.Name = "GEnviarPulsacion_PPulsacion" Then ExitHotKey("Pulsacion") : Exit Sub
        ExitHotKey()
    End Sub

    Private Sub Controles_GEnviarPulsacion_GotFocus(sender As Object, e As EventArgs) Handles GEnviarPulsacion_TAccion.GotFocus, GEnviarPulsacion_TPulsacion.GotFocus, GEnviarPulsacion_TTexto.GotFocus
        If sender.Name = "GEnviarPulsacion_TPulsacion" Then ExitHotKey("Pulsacion") : Exit Sub
        ExitHotKey()
    End Sub

#End Region

#Region " TopMost "

    Private Sub Controles_GTopMost_Click(sender As Object, e As EventArgs) Handles GTopMost.Click, GTopMost_LSonido.Click, GTopMost_LCSonido.Click, GTopMost_CSonido.Click, GTopMost_LHelp.Click
        If sender.Name <> "GTopMost_CSonido" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GTopMost_GotFocus(sender As Object, e As EventArgs) Handles GTopMost_TSonido.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Archivos Ocultos "

    Private Sub Controles_GArchivosOcultos_Click(sender As Object, e As EventArgs) Handles GArchivosOcultos.Click, GArchivosOcultos_LSonido.Click, GArchivosOcultos_LCSonido.Click, GArchivosOcultos_CSonido.Click, GArchivosOcultos_LHelp.Click
        If sender.Name <> "GArchivosOcultos_CSonido" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GArchivosOcultos_GotFocus(sender As Object, e As EventArgs) Handles GArchivosOcultos_TSonido.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Desactivar en "

    Private Sub Controles_GDesactivarEn_Click(sender As Object, e As EventArgs) Handles GDesactivarEn.Click, GDesactivarEn_LSonido.Click, GDesactivarEn_LCSonido.Click, GDesactivarEn_CSonido.Click, GDesactivarEn_LHelp.Click
        If sender.Name <> "GDesactivarEn_CSonido" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GDesactivarEn_GotFocus(sender As Object, e As EventArgs) Handles GDesactivarEn_TSonido.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Mostrar Mensaje "

    Private Sub Controles_GMostrarMensaje_Click(sender As Object, e As EventArgs) Handles GMostrarMensaje.Click, GMostrarMensaje_LMensaje.Click, GMostrarMensaje_LDuracion.Click, GMostrarMensaje_LFormato.Click, GMostrarMensaje_LCuentaAtras.Click, GMostrarMensaje_CCuentaAtras.Click, GMostrarMensaje_LEsperar.Click, GMostrarMensaje_CEsperar.Click, GMostrarMensaje_BOSD.Click, GMostrarMensaje_LHelp.Click, GMostrarMensaje_CSonido.Click, GMostrarMensaje_Separador.Click
        If sender.Name <> "GMostrarMensaje_CSonido" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GMostrarMensaje_GotFocus(sender As Object, e As EventArgs) Handles GMostrarMensaje_TMensaje.GotFocus, GMostrarMensaje_TDuracion.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Apagar Equipo "

    Private Sub Controles_GApagarEquipo_Click(sender As Object, e As EventArgs) Handles GApagarEquipo.Click, GApagarEquipo_LAccion.Click, GApagarEquipo_LCAccion.Click, GApagarEquipo_CAccion.Click, GApagarEquipo_PAccion.Click, GApagarEquipo_LDuracion.Click, GApagarEquipo_Separador.Click, GApagarEquipo_CCuentaAtras.Click, GApagarEquipo_LCuentaAtras.Click, GApagarEquipo_LFormato.Click, GApagarEquipo_COSD.Click, GApagarEquipo_LOSD.Click, GApagarEquipo_BOSD.Click, GApagarEquipo_LHelp.Click
        If sender.Name <> "GApagarEquipo_CAccion" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GApagarEquipo_GotFocus(sender As Object, e As EventArgs) Handles GApagarEquipo_TDuracion.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Comandos "

    Private Sub Controles_GComandos_Click(sender As Object, e As EventArgs) Handles GComandos.Click, GComandos_LAccion.Click, GComandos_LCAccion.Click, GComandos_CAccion.Click, GComandos_LComandos.Click, GComandos_LCComandos.Click, GComandos_PAccion.Click, GComandos_PComandos.Click, GComandos_LHelp.Click
        If sender.Name <> "GComandos_CAccion" And sender.Name <> "GComandos_CComandos" Then HTexto.Focus()
        ExitHotKey()
    End Sub

    Private Sub Controles_GComandos_GotFocus(sender As Object, e As EventArgs) Handles GComandos_TAccion.GotFocus, GComandos_TComandos.GotFocus
        ExitHotKey()
    End Sub

#End Region

#Region " Esperar "

    Private Sub Controles_GEsperar_Click(sender As Object, e As EventArgs) Handles GEsperar.Click, GEsperar_LEsperar.Click, GEsperar_Separador.Click, GEsperar_COSD.Click, GEsperar_LOSD.Click, GEsperar_BOSD.Click, GEsperar_LHelp.Click
        HTexto.Focus() : ExitHotKey()
    End Sub

    Private Sub Controles_GEsperar_GotFocus(sender As Object, e As EventArgs) Handles GEsperar_TEsperar.GotFocus, GEsperar_OSD_TTexto.GotFocus
        ExitHotKey()
    End Sub

#End Region

#End Region

#End Region

#End Region

#End Region

#Region " Funciones "

#Region " PrevInstance "

    Private Function PrevInstance() As Boolean
        Dim Proceso As Process = Process.GetCurrentProcess()
        For Each P As Process In Process.GetProcessesByName(Proceso.ProcessName)
            If P.Id <> Proceso.Id AndAlso Reflection.[Assembly].GetExecutingAssembly().Location.ToLower = Proceso.MainModule.FileName.ToLower Then Return True
        Next
        Dim Ejecutando As String = Registro.GetRegKey("Microsoft\KD", "Ejecutando", Process.GetCurrentProcess.MainModule.FileName.ToLower).ToLower
        If Ejecutando <> Process.GetCurrentProcess.MainModule.FileName.ToLower AndAlso Process.GetProcessesByName(IO.Path.GetFileNameWithoutExtension(Ejecutando)).Length > 0 AndAlso Process.GetProcessesByName(IO.Path.GetFileNameWithoutExtension(Ejecutando))(0).Id <> Process.GetCurrentProcess.Id Then Return True
        Registro.SetRegKey("Microsoft\KD", "Ejecutando", Process.GetCurrentProcess.MainModule.FileName.ToLower) : Return False
    End Function

#End Region

#Region " Cargar "

#Region " Comandos "

    Public Sub Comandos_Cargar()
        Dim SacaComandos() As String = Registro.GetRegKeyNames(RegPath + "\Comandos")
        ReDim Comandos(SacaComandos.Length - 1)
        For Cuenta = 0 To SacaComandos.Length - 1
            Comandos(Cuenta).ID = Split(SacaComandos(Cuenta), "|-|", , CompareMethod.Text)(1)
            Comandos(Cuenta).Nombre = Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta), "Nombre")
            If Comandos(Cuenta).Nombre.Trim = "" Then Registro.DelReg(RegPath + "\Comandos\" + SacaComandos(Cuenta)) : GoTo Repite
            Comandos(Cuenta).Sonido = Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta), "Sonido")
            Comandos(Cuenta).EjecutarIniciar = CBool(Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta), "EjecutarIniciar", False))
            Comandos(Cuenta).EjecutarSalir = CBool(Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta), "EjecutarSalir", False))
            Comandos(Cuenta).EjecutarSiempre = CBool(Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta), "EjecutarSiempre", False))
            Comandos(Cuenta).Deshabilitar = CBool(Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta), "Deshabilitar", False))
            Comandos(Cuenta).BloquearPulsacion = CBool(Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta), "BloquearPulsacion", False))
            Comandos(Cuenta).Oculto = CBool(Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta), "Oculto", False))
            Comandos(Cuenta).CustomIcono = Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta), "Icono")
            Comandos(Cuenta).Hotkey = Split(Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta), "Hotkey"), "|-|", , CompareMethod.Text)
            Comandos(Cuenta).Procesos = Split(Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta), "Procesos"), "|-|", , CompareMethod.Text)
            Dim SacaAcciones() As String = Registro.GetRegKeyNames(RegPath + "\Comandos\" + SacaComandos(Cuenta) + "\Acciones")
            ReDim Comandos(Cuenta).Accion(SacaAcciones.Length - 1)
            For Cuenta2 = 0 To SacaAcciones.Length - 1
                Comandos(Cuenta).Accion(Cuenta2).ID = Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta) + "\Acciones\" + SacaAcciones(Cuenta2), "ID", "")
                Comandos(Cuenta).Accion(Cuenta2).Indice = CInt(Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta) + "\Acciones\" + SacaAcciones(Cuenta2), "Indice", "-1"))
                Comandos(Cuenta).Accion(Cuenta2).Tipo = Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta) + "\Acciones\" + SacaAcciones(Cuenta2), "Tipo", "")
                Comandos(Cuenta).Accion(Cuenta2).Settings = Registro.GetRegKey(RegPath + "\Comandos\" + SacaComandos(Cuenta) + "\Acciones\" + SacaAcciones(Cuenta2), "Settings")
                Comandos(Cuenta).Accion(Cuenta2).ParentID = Comandos(Cuenta).ID
            Next
            Dim SortAccion(Comandos(Cuenta).Accion.Length - 1) As AccionST
            For Cuenta3 = 0 To Comandos(Cuenta).Accion.Length - 1
                For Cuenta4 = 0 To Comandos(Cuenta).Accion.Length - 1
                    If Comandos(Cuenta).Accion(Cuenta4).Indice = Cuenta3 Then
                        SortAccion(Cuenta3).ID = Comandos(Cuenta).Accion(Cuenta4).ID
                        SortAccion(Cuenta3).Indice = Comandos(Cuenta).Accion(Cuenta4).Indice
                        SortAccion(Cuenta3).Tipo = Comandos(Cuenta).Accion(Cuenta4).Tipo
                        SortAccion(Cuenta3).Settings = Comandos(Cuenta).Accion(Cuenta4).Settings
                        SortAccion(Cuenta3).ParentID = Comandos(Cuenta).Accion(Cuenta4).ParentID
                        Exit For
                    End If
                Next
            Next : Comandos(Cuenta).Accion = SortAccion
        Next
        If PanelQuickMenu.Visible = False Then QuickMenus_Cargar()
        Lista_Update()
        Exit Sub
Repite: Comandos_Cargar()
    End Sub

#End Region

#Region " Opciones "

    Private Sub Opciones_Cargar()
        Opciones_Update = True
        'Iniciar Windows
        Opciones_IniciarWindows = CBool(Registro.GetRegKey(RegPath + "\Opciones", "IniciarWindows", "True"))
        Opciones_IniciarWindows_Modo = Registro.GetRegKey(RegPath + "\Opciones", "IniciarWindowsModo", "Programado")
        'Icono Sistema
        Opciones_IconoSistema = CBool(Registro.GetRegKey(RegPath + "\Opciones", "IconoSistema", "True")) : NotifyIcon.Visible = Opciones_IconoSistema
        If IO.File.Exists(KobaPath + "KDesktop.ico") = False Then Iconos.Guardar(My.Resources.KDesktop.ToBitmap, KobaPath + "KDesktop.ico")
        NotifyIcon.Icon = Iconos.Cargar(KobaPath + "KDesktop.ico") : Opciones_IconoSistema_PIconoSistema.Image = NotifyIcon.Icon.ToBitmap
        'DisableXButton
        Opciones_DisableXButton = CBool(Registro.GetRegKey(RegPath + "\Opciones", "DisableXButton", "True"))
        'MensajeIniciar
        Opciones_MensajeIniciar_Texto = Registro.GetRegKey(RegPath + "\Opciones", "MensajeIniciar_Texto", "")
        Opciones_MensajeIniciar_Fuente = String_to_Font(Registro.GetRegKey(RegPath + "\Opciones", "MensajeIniciar_Fuente", Font_to_String(OSD_Default_Font)))
        Opciones_MensajeIniciar_Color = String_to_Color(Registro.GetRegKey(RegPath + "\Opciones", "MensajeIniciar_Color", Color_to_String(OSD_Default_Color)))
        Opciones_MensajeIniciar_Sonido = Registro.GetRegKey(RegPath + "\Opciones", "MensajeIniciar_Sonido", "Ring 2")
        'UDP
        Opciones_UDP = CBool(Registro.GetRegKey(RegPath + "\Opciones", "UDP", "True"))
        Opciones_UDP_Puerto = Registro.GetRegKey(RegPath + "\Opciones", "UDPPort", Default_UDP_Puerto.ToString) : If Opciones_UDP_Puerto < 1000 Then Opciones_UDP_Puerto = Default_UDP_Puerto
        'Desactivar
        Desactivar = Registro.GetRegValueNames(RegPath + "\Opciones\Desactivar")
        'DeshabilitarBackFoward
        If My.Computer.Registry.CurrentUser.OpenSubKey("Software\KDesktop4\Opciones\DeshabilitarBackFoward") Is Nothing Then
            ReDim DeshabilitarBackForward(5)
            DeshabilitarBackForward(0) = "Explorer"
            DeshabilitarBackForward(1) = "iExplorer"
            DeshabilitarBackForward(2) = "Chrome"
            DeshabilitarBackForward(3) = "Firefox"
            DeshabilitarBackForward(4) = "Telegram"
            DeshabilitarBackForward(5) = "SystemSettings"
            For Cuenta = 0 To DeshabilitarBackForward.Length - 1 : Registro.SetRegKey(RegPath + "\Opciones\DeshabilitarBackFoward", DeshabilitarBackForward(Cuenta), "") : Next
        End If : DeshabilitarBackForward = Registro.GetRegValueNames(RegPath + "\Opciones\DeshabilitarBackFoward")
        Opciones_Update = False
    End Sub

#End Region

#Region " K-Board "

#Region " Cargar "

    Private Sub KBoards_Cargar()
        KBoard_LButton.AddPolygon(New Point() {New Point(40, 118), New Point(105, 50), New Point(158, 66), New Point(83, 123), New Point(63, 123)})
        KBoard_MButton.AddPolygon(New Point() {New Point(49, 91), New Point(52, 82), New Point(56, 75), New Point(63, 68), New Point(72, 64), New Point(77, 63), New Point(84, 67), New Point(58, 94)})
        KBoard_RButton.AddPolygon(New Point() {New Point(25, 109), New Point(16, 92), New Point(40, 64), New Point(60, 47), New Point(78, 35), New Point(90, 44), New Point(68, 63), New Point(62, 67), New Point(57, 72), New Point(51, 82)})
        KBoard_Button4.AddPolygon(New Point() {New Point(167, 74), New Point(185, 65), New Point(185, 70), New Point(182, 74), New Point(168, 81)})
        KBoard_Button5.AddPolygon(New Point() {New Point(138, 92), New Point(161, 78), New Point(163, 84), New Point(142, 98)})
        Dim SacaKBoards() As String = Registro.GetRegKeyNames(RegPath + "\KBoard")
        ReDim KBoards(SacaKBoards.Length - 1)
        KBoard_Nombre_CNombre.Items.Clear()
        For Cuenta = 0 To SacaKBoards.Length - 1
            KBoards(Cuenta).Nombre = Registro.GetRegKey(RegPath + "\KBoard\" + SacaKBoards(Cuenta), "Nombre")
            KBoard_Nombre_CNombre.Items.Add(KBoards(Cuenta).Nombre)

            KBoards(Cuenta).Deshabilitado = Registro.GetRegKey(RegPath + "\KBoard\" + SacaKBoards(Cuenta), "Deshabilitado", "False")
            KBoards(Cuenta).AutoActivar = Registro.GetRegKey(RegPath + "\KBoard\" + SacaKBoards(Cuenta), "AutoActivar", "False")

            Dim Procesos As String = Registro.GetRegKey(RegPath + "\KBoard\" + SacaKBoards(Cuenta), "Procesos", "")
            KBoards(Cuenta).Procesos = Split(Procesos, "|-|", , CompareMethod.Text)

            Dim SacaKBoardsKeys() As String = Registro.GetRegValueNames(RegPath + "\KBoard\" + SacaKBoards(Cuenta) + "\Teclas")
            If SacaKBoardsKeys.Length > 0 Then
                ReDim KBoards(Cuenta).Keys(SacaKBoardsKeys.Length - 1)
                For Cuenta2 = 0 To KBoards(Cuenta).Keys.Length - 1
                    KBoards(Cuenta).Keys(Cuenta2) = SacaKBoardsKeys(Cuenta2) + "|-|" + Registro.GetRegKey(RegPath + "\KBoard\" + SacaKBoards(Cuenta) + "\Teclas", SacaKBoardsKeys(Cuenta2), "")
                Next
            End If
        Next
        If KBoard_Nombre_CNombre.Items.Count > 0 Then
            KBoard_Nombre_LCNombre.Cursor = Cursors.Hand
            KBoard_Nombre_TNombre.Cursor = Cursors.Hand
            KBoard_Nombre_BDelete.Enabled = True
            KBoard_LProceso.Enabled = True
            KBoard_TProceso.Cursor = Cursors.Hand
            KBoard_LCProceso.Cursor = Cursors.Hand
            KBoard_TProceso.Enabled = True
            KBoard_LCProceso.Enabled = True
            KBoard_BProcesoAdd.Enabled = True
            KBoard_BProcesoEliminar.Enabled = True
            KBoard_BProcesoExaminar.Enabled = True
            KBoard_TProceso.Cursor = Cursors.Hand
            KBoard_LCambiar.Enabled = True
            KBoard_LCCambiar.Cursor = Cursors.Hand
            KBoard_TCambiar.Cursor = Cursors.Hand
            KBoard_LPor.Enabled = True
            KBoard_LCPor.Cursor = Cursors.Hand
            KBoard_TPor.Cursor = Cursors.Hand
            KBoard_LDeshabilitado.Enabled = True
            KBoard_CDeshabilitado.Enabled = True
            KBoard_CDeshabilitado.Checked = False
            KBoard_LAutoActivar.Enabled = True
            KBoard_CAutoActivar.Enabled = True
            KBoard_CAutoActivar.Checked = False
            PResetear.Enabled = True
            KBoard_LEstado.Visible = True
            KBoard_TEstado.Visible = True
            KBoard_LNumerico.Enabled = True
            KBoard_LRaton.Enabled = True
            KBoard_LTeclado.Enabled = True
            KBoard_Enable()
            KBoard_Nombre_CNombre.SelectedIndex = 0
            For Cuenta = 0 To KBoards.Length - 1
                If KBoards(Cuenta).Nombre.ToLower = KBoard_Nombre_TNombre.Tag.ToString.ToLower Then
                    If KBoards(Cuenta).Activo = True Then KBoard_TEstado.Text = "activado" : KBoard_TEstado.ForeColor = Color.DarkGreen Else KBoard_TEstado.Text = "desactivado" : KBoard_TEstado.ForeColor = Color.DarkRed
                End If
            Next
        Else
            KBoard_Nombre_LCNombre.Cursor = Cursors.Default
            KBoard_Nombre_TNombre.Cursor = Cursors.Default
            KBoard_Nombre_BDelete.Enabled = False
            KBoard_LProceso.Enabled = False
            KBoard_LCProceso.Enabled = False
            KBoard_LCProceso.Text = "Seleccione una aplicación"
            KBoard_BProcesoAdd.Enabled = False
            KBoard_BProcesoEliminar.Enabled = False
            KBoard_BProcesoExaminar.Enabled = False
            KBoard_TProceso.Cursor = Cursors.Default
            KBoard_LCambiar.Enabled = False
            KBoard_LCCambiar.Cursor = Cursors.Default
            KBoard_TCambiar.Cursor = Cursors.Default
            KBoard_LPor.Enabled = False
            KBoard_LCPor.Cursor = Cursors.Default
            KBoard_TPor.Cursor = Cursors.Default
            KBoard_LDeshabilitado.Enabled = False
            KBoard_CDeshabilitado.Enabled = False
            KBoard_CDeshabilitado.Checked = False
            KBoard_LAutoActivar.Enabled = False
            KBoard_CAutoActivar.Enabled = False
            KBoard_CAutoActivar.Checked = False
            PResetear.Enabled = False
            KBoard_LEstado.Visible = False
            KBoard_TEstado.Visible = False
            KBoard_LNumerico.Enabled = False
            KBoard_LRaton.Enabled = False
            KBoard_LTeclado.Enabled = False
            KBoard_Disable()
        End If
        KBoard_LCProceso_TextChanged(Nothing, Nothing)
    End Sub

#End Region

#Region " Guardar "

    Private Sub KBoard_Guardar()
        If KBoard_Updating = True Then Exit Sub
        If KBoards Is Nothing Then Exit Sub

        Registro.DelReg(RegPath + "\KBoard")

        For Cuenta = 0 To KBoards.Length - 1

            If KBoards(Cuenta).Nombre.Trim = "" Then Continue For
            Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Cuenta).Nombre.Replace("\", "|/|"), "Nombre", KBoards(Cuenta).Nombre)
            Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Cuenta).Nombre.Replace("\", "|/|"), "Deshabilitado", KBoards(Cuenta).Deshabilitado.ToString)
            Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Cuenta).Nombre.Replace("\", "|/|"), "AutoActivar", KBoards(Cuenta).AutoActivar.ToString)

            If KBoards(Cuenta).Procesos IsNot Nothing Then
                Dim Procesos As String = ""
                For Cuenta2 = 0 To KBoards(Cuenta).Procesos.Length - 1
                    Procesos += KBoards(Cuenta).Procesos(Cuenta2) + "|-|"
                Next : Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Cuenta).Nombre.Replace("\", "|/|"), "Procesos", Procesos)
            End If

            If KBoards(Cuenta).Keys IsNot Nothing Then
                Dim Tecla1, Tecla2 As String
                For Cuenta2 = 0 To KBoards(Cuenta).Keys.Length - 1
                    If KBoards(Cuenta).Keys(Cuenta2) IsNot Nothing Then
                        Tecla1 = Split(KBoards(Cuenta).Keys(Cuenta2), "|-|", , CompareMethod.Text)(0)
                        Tecla2 = Split(KBoards(Cuenta).Keys(Cuenta2), "|-|", , CompareMethod.Text)(1)
                        If Tecla1 <> "" And Tecla2 <> "" And Tecla2.ToLower <> Tecla1.ToLower Then Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Cuenta).Nombre.Replace("\", "|/|") + "\Teclas", Tecla1, Tecla2)
                    End If
                Next
            End If
        Next
    End Sub

    Private Sub KBoard_Guardar(Nombre As String)
        If KBoard_Updating = True Or KBoards Is Nothing Then Exit Sub

        Dim Indice As Integer = -1
        For Cuenta = 0 To KBoards.Length - 1
            If KBoards(Cuenta).Nombre.ToLower = Nombre Then Indice = Cuenta : Exit For
        Next : If Indice = -1 Then Exit Sub

        Registro.DelReg(RegPath + "\KBoard\" + KBoards(Indice).Nombre.Replace("\", "|/|"))

        KBoards(Indice).Deshabilitado = KBoard_CDeshabilitado.Checked
        KBoards(Indice).AutoActivar = KBoard_CAutoActivar.Checked
        ReDim KBoards(Indice).Procesos(KBoard_CProceso.Items.Count - 1)
        For Cuenta = 0 To KBoard_CProceso.Items.Count - 1
            KBoards(Indice).Procesos(Cuenta) = KBoard_CProceso.Items(Cuenta)
        Next

        Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Indice).Nombre.Replace("\", "|/|"), "Nombre", KBoards(Indice).Nombre)
        Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Indice).Nombre.Replace("\", "|/|"), "Deshabilitado", KBoards(Indice).Deshabilitado.ToString)
        Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Indice).Nombre.Replace("\", "|/|"), "AutoActivar", KBoards(Indice).AutoActivar.ToString)

        If KBoards(Indice).Procesos IsNot Nothing Then
            Dim Procesos As String = ""
            For Cuenta2 = 0 To KBoards(Indice).Procesos.Length - 1
                Procesos += KBoards(Indice).Procesos(Cuenta2) + "|-|"
            Next : Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Indice).Nombre.Replace("\", "|/|"), "Procesos", Procesos)
        End If

        If KBoards(Indice).Keys IsNot Nothing Then
            Dim Tecla1, Tecla2 As String
            For Cuenta2 = 0 To KBoards(Indice).Keys.Length - 1
                If KBoards(Indice).Keys(Cuenta2) IsNot Nothing Then
                    Tecla1 = Split(KBoards(Indice).Keys(Cuenta2), "|-|", , CompareMethod.Text)(0)
                    Tecla2 = Split(KBoards(Indice).Keys(Cuenta2), "|-|", , CompareMethod.Text)(1)
                    Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Indice).Nombre.Replace("\", "|/|") + "\Teclas", Tecla1, Tecla2)
                End If
            Next
        End If
    End Sub

    Private Sub KBoard_Guardar(Indice As Integer)
        If KBoard_Updating = True Or KBoards Is Nothing Then Exit Sub
        If Indice = -1 Then Exit Sub

        Registro.DelReg(RegPath + "\KBoard\" + KBoards(Indice).Nombre.Replace("\", "|/|"))

        Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Indice).Nombre.Replace("\", "|/|"), "Nombre", KBoards(Indice).Nombre)
        Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Indice).Nombre.Replace("\", "|/|"), "Deshabilitado", KBoards(Indice).Deshabilitado.ToString)
        Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Indice).Nombre.Replace("\", "|/|"), "AutoActivar", KBoards(Indice).AutoActivar.ToString)

        If KBoards(Indice).Procesos IsNot Nothing Then
            Dim Procesos As String = ""
            For Cuenta2 = 0 To KBoards(Indice).Procesos.Length - 1
                Procesos += KBoards(Indice).Procesos(Cuenta2) + "|-|"
            Next : Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Indice).Nombre.Replace("\", "|/|"), "Procesos", Procesos)
        End If

        If KBoards(Indice).Keys IsNot Nothing Then
            Dim Tecla1, Tecla2 As String
            For Cuenta2 = 0 To KBoards(Indice).Keys.Length - 1
                If KBoards(Indice).Keys(Cuenta2) IsNot Nothing Then
                    Tecla1 = Split(KBoards(Indice).Keys(Cuenta2), "|-|", , CompareMethod.Text)(0)
                    Tecla2 = Split(KBoards(Indice).Keys(Cuenta2), "|-|", , CompareMethod.Text)(1)
                    Registro.SetRegKey(RegPath + "\KBoard\" + KBoards(Indice).Nombre.Replace("\", "|/|") + "\Teclas", Tecla1, Tecla2)
                End If
            Next
        End If
    End Sub

#End Region

#End Region

#Region " QuickMenu "

#Region " QuickMenu "

    Private Sub QuickMenus_Cargar(Optional Update As Boolean = False)
        QuickMenu_Nombre_CNombre.Sorted = True
        Dim SacaQuickMenus() As String = Registro.GetRegKeyNames(RegPath + "\QuickMenus")
        ReDim QuickMenus(SacaQuickMenus.Length - 1)
        QuickMenu_Nombre_CNombre.Items.Clear()
        For Cuenta = 0 To SacaQuickMenus.Length - 1
            QuickMenus(Cuenta) = New NSContextMenu
            QuickMenus(Cuenta).Nombre = Registro.GetRegKey(RegPath + "\QuickMenus\" + SacaQuickMenus(Cuenta), "Nombre")

            Dim Tamaño As Integer = Registro.GetRegKey(RegPath + "\QuickMenus\" + SacaQuickMenus(Cuenta), "Tamaño", "0")
            Select Case Tamaño
                Case 0 : QuickMenus(Cuenta).Font = New Font("Calibri", 8, FontStyle.Regular) : QuickMenus(Cuenta).ImageScalingSize = New Size(18, 18)
                Case 1 : QuickMenus(Cuenta).Font = New Font("Calibri", 9, FontStyle.Regular) : QuickMenus(Cuenta).ImageScalingSize = New Size(18, 18)
                Case 2 : QuickMenus(Cuenta).Font = New Font("Calibri", 10, FontStyle.Regular) : QuickMenus(Cuenta).ImageScalingSize = New Size(20, 20)
                Case 3 : QuickMenus(Cuenta).Font = New Font("Calibri", 11, FontStyle.Regular) : QuickMenus(Cuenta).ImageScalingSize = New Size(22, 22)
                Case 4 : QuickMenus(Cuenta).Font = New Font("Calibri", 12, FontStyle.Regular) : QuickMenus(Cuenta).ImageScalingSize = New Size(24, 24)
                Case 5 : QuickMenus(Cuenta).Font = New Font("Calibri", 13, FontStyle.Regular) : QuickMenus(Cuenta).ImageScalingSize = New Size(26, 26)
            End Select
            'QuickMenus(Cuenta).Font = New Font("Calibri", Convert.ToSingle(8 + (Tamaño / 10)), FontStyle.Regular) : QuickMenu_Editor.ImageScalingSize = New Size(16 + Tamaño, 16 + Tamaño)

            QuickMenu_Nombre_CNombre.Items.Add(QuickMenus(Cuenta).Nombre)
            QuickMenus_Cargar(Cuenta, RegPath + "\QuickMenus\" + QuickMenus(Cuenta).Nombre, QuickMenus(Cuenta))
            QuickMenus(Cuenta).AutoClose = False
            QuickMenus(Cuenta).AllowDrop = True
            AddHandler QuickMenus(Cuenta).DragDrop, AddressOf QuickMenu_SubMenu_DragDrop
            AddHandler QuickMenus(Cuenta).DragEnter, AddressOf QuickMenu_SubMenu_DragEnter
            AddHandler QuickMenus(Cuenta).DragLeave, AddressOf QuickMenu_SubMenu_DragLeave
            AddHandler QuickMenus(Cuenta).Opening, AddressOf QuickMenu_Editor_Opening
            AddHandler QuickMenus(Cuenta).Opened, AddressOf QuickMenu_Editor_Opened
            AddHandler QuickMenus(Cuenta).Closed, AddressOf QuickMenu_SubMenu_Closed
            AddHandler QuickMenus(Cuenta).Closing, AddressOf QuickMenu_SubMenu_Closing
            AddHandler QuickMenus(Cuenta).PreviewKeyDown, AddressOf QuickMenu_SubMenu_KeyDown
            AddHandler QuickMenus(Cuenta).KeyUp, AddressOf QuickMenu_SubMenu_KeyUp
        Next : QuickMenus_F_Cargar()
        If QuickMenu_Nombre_CNombre.Items.Count = 0 Then
            QuickMenu_Nombre_CNombre.Enabled = False
            QuickMenu_Nombre_LCNombre.Text = ""
            QuickMenu_Nombre_TNombre.Text = ""
            QuickMenu_Nombre_TNombre.Tag = ""
        Else
            If Update = False Then QuickMenu_Nombre_CNombre.SelectedIndex = 0
        End If
    End Sub

    Private Sub QuickMenus_Cargar(Indice As Integer, Ruta As String, Strip As Object)
        Dim HandlerAdded As Boolean
        Dim GetMenus() As String = Registro.GetRegKeyNames(Ruta)
        For Cuenta = 0 To GetMenus.Length - 1
            For Cuenta2 = 0 To GetMenus.Length - 1
                If CInt(Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Indice")) = Cuenta Then
                    If Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Comando") = "[SEPARADOR]" Then
                        Dim NewSeparator As New ToolStripSeparator With {.Name = "-" + Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "ID"), .Text = "-", .Tag = Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "ID") + "|-|[SEPARADOR]|-||-|"}
                        AddHandler NewSeparator.Paint, AddressOf QuickMenu_Titulo_Paint
                        AddHandler NewSeparator.MouseDown, AddressOf QuickMenu_Item_MouseDown
                        AddHandler NewSeparator.MouseUp, AddressOf QuickMenu_Item_MouseUp
                        AddHandler NewSeparator.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
                        AddHandler NewSeparator.MouseMove, AddressOf QuickMenu_Item_MouseMove
                        If Indice = -1 Then Strip.DropDownItems.Add(NewSeparator) Else Strip.Items.Add(NewSeparator)
                    Else
                        Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "ID"), .Text = Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Nombre"), .ForeColor = QuickMenu_Editor.ForeColor, .Tag = Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "ID") + "|-|" + Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Comando") + "|-|" + Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Nombre") + "|-|" + Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Icono")}
                        If Split(NewItem.Tag, "|-|",, CompareMethod.Text)(1) <> "[TITULO]" AndAlso NewItem.Text = "[COMANDO]" Then
                            For Cuenta3 = 0 To Comandos.Length - 1
                                If Comandos(Cuenta3).ID = Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Comando") Then NewItem.Text = Comandos(Cuenta3).Nombre : Exit For
                            Next
                            If NewItem.Text = "[COMANDO]" Then NewItem.Text = "[ELIMINADO]"
                        End If
                        NewItem.Image = Iconos.DefaultIcon(NewItem.Tag)
                        AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
                        AddHandler NewItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
                        AddHandler NewItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
                        AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
                        AddHandler NewItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
                        If Indice = -1 Then
                            Strip.DropDownItems.Add(NewItem)
                            If HandlerAdded = False Then
                                Dim NewStrip As ToolStripDropDownMenu = Strip.DropDownItems(0).Owner : NewStrip.AllowDrop = True
                                AddHandler NewStrip.DragDrop, AddressOf QuickMenu_SubMenu_DragDrop
                                AddHandler NewStrip.DragEnter, AddressOf QuickMenu_SubMenu_DragEnter
                                AddHandler NewStrip.DragLeave, AddressOf QuickMenu_SubMenu_DragLeave
                                AddHandler NewStrip.Opening, AddressOf QuickMenu_SubMenu_Opening
                                AddHandler NewStrip.Closing, AddressOf QuickMenu_SubMenu_Closing
                                AddHandler NewStrip.Closed, AddressOf QuickMenu_SubMenu_Closed
                                AddHandler NewStrip.PreviewKeyDown, AddressOf QuickMenu_SubMenu_KeyDown
                                AddHandler NewStrip.KeyUp, AddressOf QuickMenu_SubMenu_KeyUp
                            End If
                        Else
                            Strip.Items.Add(NewItem)
                        End If
                        If Registro.GetRegKeyNames(Ruta + "\" + GetMenus(Cuenta2)).Length > 0 Then
                            QuickMenus_Cargar(-1, Ruta + "\" + GetMenus(Cuenta2), NewItem)
                        End If
                    End If
                    Exit For
                End If
            Next
        Next
    End Sub

#End Region

#Region " QuickMenu_F "

    Private Sub QuickMenus_F_Cargar()
        Dim SacaQuickMenus() As String = Registro.GetRegKeyNames(RegPath + "\QuickMenus")
        ReDim QuickMenus_F(SacaQuickMenus.Length - 1)
        For Cuenta = 0 To SacaQuickMenus.Length - 1
            QuickMenus_F(Cuenta) = New NSContextMenu
            QuickMenus_F(Cuenta).Nombre = Registro.GetRegKey(RegPath + "\QuickMenus\" + SacaQuickMenus(Cuenta), "Nombre")

            Dim Tamaño As Integer = Registro.GetRegKey(RegPath + "\QuickMenus\" + SacaQuickMenus(Cuenta), "Tamaño", "0")
            Select Case Tamaño
                Case 0 : QuickMenus_F(Cuenta).Font = New Font("Calibri", 8, FontStyle.Regular) : QuickMenus_F(Cuenta).ImageScalingSize = New Size(18, 18)
                Case 1 : QuickMenus_F(Cuenta).Font = New Font("Calibri", 9, FontStyle.Regular) : QuickMenus_F(Cuenta).ImageScalingSize = New Size(18, 18)
                Case 2 : QuickMenus_F(Cuenta).Font = New Font("Calibri", 10, FontStyle.Regular) : QuickMenus_F(Cuenta).ImageScalingSize = New Size(20, 20)
                Case 3 : QuickMenus_F(Cuenta).Font = New Font("Calibri", 11, FontStyle.Regular) : QuickMenus_F(Cuenta).ImageScalingSize = New Size(22, 22)
                Case 4 : QuickMenus_F(Cuenta).Font = New Font("Calibri", 12, FontStyle.Regular) : QuickMenus_F(Cuenta).ImageScalingSize = New Size(24, 24)
                Case 5 : QuickMenus_F(Cuenta).Font = New Font("Calibri", 13, FontStyle.Regular) : QuickMenus_F(Cuenta).ImageScalingSize = New Size(26, 26)
            End Select
            'QuickMenus_F(Cuenta).Font = New Font("Calibri", Convert.ToSingle(8 + (Tamaño / 10)), FontStyle.Regular) : QuickMenus_F(Cuenta).ImageScalingSize = New Size(16 + Tamaño, 16 + Tamaño)

            QuickMenus_F_Cargar(Cuenta, RegPath + "\QuickMenus\" + QuickMenus(Cuenta).Nombre, QuickMenus_F(Cuenta))
            AddHandler QuickMenus_F(Cuenta).Closing, AddressOf QuickMenu_F_SubMenu_Closing
            AddHandler QuickMenus_F(Cuenta).Opening, AddressOf QuickMenu_F_Opening
            AddHandler QuickMenus_F(Cuenta).PreviewKeyDown, AddressOf QuickMenu_F_SubMenu_KeyDown
        Next
    End Sub

    Private Sub QuickMenus_F_Cargar(Indice As Integer, Ruta As String, Strip As Object)
        Dim HandlerAdded As Boolean
        Dim GetMenus() As String = Registro.GetRegKeyNames(Ruta)
        For Cuenta = 0 To GetMenus.Length - 1
            For Cuenta2 = 0 To GetMenus.Length - 1
                If CInt(Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Indice")) = Cuenta Then
                    If Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Comando") = "[SEPARADOR]" Then
                        Dim NewSeparator As New ToolStripSeparator With {.Name = "-" + Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "ID"), .Text = "-", .Tag = Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "ID") + "|-|[SEPARADOR]|-||-|"}
                        AddHandler NewSeparator.Paint, AddressOf QuickMenu_Titulo_Paint
                        AddHandler NewSeparator.MouseDown, AddressOf QuickMenu_F_Item_MouseDown
                        AddHandler NewSeparator.MouseUp, AddressOf QuickMenu_F_Item_MouseUp
                        AddHandler NewSeparator.MouseEnter, AddressOf QuickMenu_F_Item_MouseEnter
                        AddHandler NewSeparator.MouseLeave, AddressOf QuickMenu_F_Item_MouseLeave
                        AddHandler NewSeparator.MouseMove, AddressOf QuickMenu_F_Item_MouseMove
                        If Indice = -1 Then Strip.DropDownItems.Add(NewSeparator) Else Strip.Items.Add(NewSeparator)
                    Else
                        Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "ID"), .Text = Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Nombre"), .ForeColor = QuickMenu_Editor.ForeColor, .Tag = Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "ID") + "|-|" + Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Comando") + "|-|" + Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Nombre") + "|-|" + Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Icono")}
                        If Split(NewItem.Tag, "|-|",, CompareMethod.Text)(1) <> "[TITULO]" AndAlso NewItem.Text = "[COMANDO]" Then
                            For Cuenta3 = 0 To Comandos.Length - 1
                                If Comandos(Cuenta3).ID = Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta2), "Comando") Then NewItem.Text = Comandos(Cuenta3).Nombre : Exit For
                            Next
                            If NewItem.Text = "[COMANDO]" Then NewItem.Text = "[ELIMINADO]"
                        End If
                        NewItem.Image = Iconos.DefaultIcon(NewItem.Tag)
                        AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
                        AddHandler NewItem.MouseDown, AddressOf QuickMenu_F_Item_MouseDown
                        AddHandler NewItem.MouseUp, AddressOf QuickMenu_F_Item_MouseUp
                        AddHandler NewItem.MouseEnter, AddressOf QuickMenu_F_Item_MouseEnter
                        AddHandler NewItem.MouseLeave, AddressOf QuickMenu_F_Item_MouseLeave
                        AddHandler NewItem.MouseMove, AddressOf QuickMenu_F_Item_MouseMove
                        If Indice = -1 Then
                            Strip.DropDownItems.Add(NewItem)
                            If HandlerAdded = False Then
                                Dim NewStrip As ToolStripDropDownMenu = Strip.DropDownItems(0).Owner : NewStrip.AllowDrop = True
                                AddHandler NewStrip.Closing, AddressOf QuickMenu_F_SubMenu_Closing
                                AddHandler NewStrip.PreviewKeyDown, AddressOf QuickMenu_F_SubMenu_KeyDown
                            End If
                        Else
                            Strip.Items.Add(NewItem)
                        End If
                        If Registro.GetRegKeyNames(Ruta + "\" + GetMenus(Cuenta2)).Length > 0 Then
                            QuickMenus_F_Cargar(-1, Ruta + "\" + GetMenus(Cuenta2), NewItem)
                        End If
                    End If
                    Exit For
                End If
            Next
        Next
    End Sub

#End Region

#End Region

#Region " Acciones "

    Private Sub ComboAcciones_Cargar()
        Dim ComboAcciones As New List(Of String)
        ComboAcciones.Add("@|APLICACIONES")
        ComboAcciones.Add("Ejecutar Aplicacion")
        ComboAcciones.Add("Abrir Carpeta")
        ComboAcciones.Add("Pagina Web")
        ComboAcciones.Add("Aplicaciones")
        ComboAcciones.Add("Ejecutar BAT")
        ComboAcciones.Add("@|AUDIO Y VIDEO")
        ComboAcciones.Add("Capturar Pantalla")
        ComboAcciones.Add("Grabar Pantalla (On/Off)")
        ComboAcciones.Add("Grabar Audio (On/Off)")
        ComboAcciones.Add("Reproducir Sonido")
        ComboAcciones.Add("Salida de Audio")
        ComboAcciones.Add("Volumen")
        ComboAcciones.Add("@|UTILIDADES")
        ComboAcciones.Add("Macros")
        ComboAcciones.Add("K-Board")
        ComboAcciones.Add("QuickMenu")
        ComboAcciones.Add("Red Ad-Hoc")
        ComboAcciones.Add("@|ACCIONES")
        ComboAcciones.Add("Enviar Pulsación")
        ComboAcciones.Add("TopMost (On/Off)")
        ComboAcciones.Add("Archivos Ocultos (On/Off)")
        ComboAcciones.Add("Desactivar en (On/Off)")
        ComboAcciones.Add("Mostrar Mensaje")
        ComboAcciones.Add("Apagar Equipo")
        ComboAcciones.Add("Comandos")
        ComboAcciones.Add("Esperar")

        Comandos_Accion_CAccion.Items.Clear() : Comandos_Accion_CAccion.Items.AddRange(ComboAcciones.ToArray)
    End Sub

#Region " GAcciones "

    Private Sub Load_GAcciones()
        GEjecutarAplicacion.Visible = True : GEjecutarAplicacion.Visible = False
        GEjecutarBAT.Visible = True : GEjecutarBAT.Visible = False
        GPaginaWeb.Visible = True : GPaginaWeb.Visible = False
        GAbrirCarpeta.Visible = True : GAbrirCarpeta.Visible = False
        GCapturaPantalla.Visible = True : GCapturaPantalla.Visible = False
        GGrabacionPantalla.Visible = True : GGrabacionPantalla.Visible = False
        GGrabacionAudio.Visible = True : GGrabacionAudio.Visible = False
        GSalidaAudio.Visible = True : GSalidaAudio.Visible = False
        GRedAdHoc.Visible = True : GRedAdHoc.Visible = False
        GVolumen.Visible = True : GVolumen.Visible = False
        GEsperar.Visible = True : GEsperar.Visible = False
        GMostrarMensaje.Visible = True : GMostrarMensaje.Visible = False
        GReproducirSonido.Visible = True : GReproducirSonido.Visible = False
        GAplicaciones.Visible = True : GAplicaciones.Visible = False
        GApagarEquipo.Visible = True : GApagarEquipo.Visible = False
        GTopMost.Visible = True : GTopMost.Visible = False
        'GKNote.Visible = True : GKNote.Visible = False
        GArchivosOcultos.Visible = True : GArchivosOcultos.Visible = False
        GDesactivarEn.Visible = True : GDesactivarEn.Visible = False
        GMacro.Visible = True : GMacro.Visible = False
        GEnviarPulsacion.Visible = True : GEnviarPulsacion.Visible = False
        GComandos.Visible = True : GComandos.Visible = False
        GKBoard.Visible = True : GKBoard.Visible = False
        GQuickMenu.Visible = True : GQuickMenu.Visible = False
    End Sub

#End Region

#End Region

#Region " Teclas "

    Private Sub ComboTeclas_Cargar()
        GPulsacion_Teclas_Menu.Items.Clear() : GPulsacion_Teclas_Menu.ShowCheckMargin = False
        GPulsacion_Teclas_Menu.Items.Add(Teclas_Pulsacion_Create_Menu("Teclas", My.Resources.Teclas_Letra, {"A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "Ñ", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"}, 30, 517))
        GPulsacion_Teclas_Menu.Items.Add(Teclas_Pulsacion_Create_Menu("Números", My.Resources.Teclas_Numero, {"0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}, 30, 194))
        GPulsacion_Teclas_Menu.Items.Add(Teclas_Pulsacion_Create_Menu("Funcion", My.Resources.Teclas_Funcion, {"F1", "F2", "F3", "F4", "F5", "F6", "F7", "F8", "F9", "F10", "F11", "F12", "F13", "F14", "F15", "F16", "F17", "F18", "F19", "F20", "F21", "F22", "F23", "F24"}, 40, 460))
        GPulsacion_Teclas_Menu.Items.Add(Teclas_Pulsacion_Create_Menu("Numérico", My.Resources.Teclas_Numeric, {"NumPad 0", "NumPad 1", "NumPad 2", "NumPad 3", "NumPad 4", "NumPad 5", "NumPad 6", "NumPad 7", "NumPad 8", "NumPad 9", "NumLock", "NumPad /", "NumPad *", "NumPad -", "NumPad +", "NumPad ."}, 90, 308, {"NumPad0", "NumPad1", "NumPad2", "NumPad3", "NumPad4", "NumPad5", "NumPad6", "NumPad7", "NumPad8", "NumPad9", "NumLock", "NumPadDiv", "NumMult", "NumPadSub", "NumPadAdd", "NumPadDot"}))
        GPulsacion_Teclas_Menu.Items.Add(Teclas_Pulsacion_Create_Menu("Desplazamiento", My.Resources.Teclas_Scroll, {"PrintScreen", "Scroll", "Pause", "Insert", "Delete", "Home", "End", "PageUp", "PageDown", "Up", "Down", "Left", "Right", "Tab", "Capital", "Backspace", "Space", "Enter"}, 80, 346))
        GPulsacion_Teclas_Menu.Items.Add(Teclas_Pulsacion_Create_Menu("Multimedia", My.Resources.Teclas_Multimedia, {"Volume Mute", "Volume Up", "Volume Down", "Media Next Track", "Media Previous Track", "Media Stop", "Media Play", "Select Media", "Launch Mail", "Launch Application 1", "Launch Application 2", "Browser Back", "Browser Forward", "Browser Refresh", "Browser Stop", "Browser Search", "Browser Favorites", "Browser Home"}, 133, 346, {"VolumeMute", "VolumeUp", "VolumeDown", "MediaNextTrack", "MediaPreviousTrack", "MediaStop", "MediaPlayPause", "SelectMedia", "LaunchMail", "LaunchApplication1", "LaunchApplication2", "BrowserBack", "BrowserForward", "BrowserRefresh", "BrowserStop", "BrowserSearch", "BrowserFavorites", "BrowserHome"}))
        GPulsacion_Teclas_Menu.Items.Add(Teclas_Pulsacion_Create_Menu("Otros", My.Resources.Teclas_Otros, {"º", "'", "¡", "`", "+", "´", "ç", ",", ".", "-", "<"}, 30, 213, {"º", "'", "¡", "`", "+", "´", "Ç", ",", ".", "-", "<"}))
        GPulsacion_Teclas_Menu.Items.Add(Teclas_Pulsacion_Create_Menu("Ratón", My.Resources.Teclas_Raton, {"Mouse 1", "Mouse 2", "Mouse 3", "Mouse 4", "Mouse 5", "Wheel Up", "Wheel Down"}, 90, 137))

        GMacros_Teclas_Menu.Items.Clear() : GMacros_Teclas_Menu.ShowCheckMargin = False
        GMacros_Teclas_Menu.Items.Add(Teclas_Macros_Create_Menu("Teclas", My.Resources.Teclas_Letra, {"A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "Ñ", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"}, 30, 517))
        GMacros_Teclas_Menu.Items.Add(Teclas_Macros_Create_Menu("Números", My.Resources.Teclas_Numero, {"0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}, 30, 194))
        GMacros_Teclas_Menu.Items.Add(Teclas_Macros_Create_Menu("Funcion", My.Resources.Teclas_Funcion, {"F1", "F2", "F3", "F4", "F5", "F6", "F7", "F8", "F9", "F10", "F11", "F12", "F13", "F14", "F15", "F16", "F17", "F18", "F19", "F20", "F21", "F22", "F23", "F24"}, 40, 460))
        GMacros_Teclas_Menu.Items.Add(Teclas_Macros_Create_Menu("Numérico", My.Resources.Teclas_Numeric, {"NumPad 0", "NumPad 1", "NumPad 2", "NumPad 3", "NumPad 4", "NumPad 5", "NumPad 6", "NumPad 7", "NumPad 8", "NumPad 9", "NumLock", "NumPad /", "NumPad *", "NumPad -", "NumPad +", "NumPad ."}, 90, 308, {"NumPad0", "NumPad1", "NumPad2", "NumPad3", "NumPad4", "NumPad5", "NumPad6", "NumPad7", "NumPad8", "NumPad9", "NumLock", "NumPadDiv", "NumMult", "NumPadSub", "NumPadAdd", "NumPadDot"}))
        GMacros_Teclas_Menu.Items.Add(Teclas_Macros_Create_Menu("Desplazamiento", My.Resources.Teclas_Scroll, {"PrintScreen", "Scroll", "Pause", "Insert", "Delete", "Home", "End", "PageUp", "PageDown", "Up", "Down", "Left", "Right", "Tab", "Capital", "Backspace", "Space", "Enter"}, 80, 346))
        GMacros_Teclas_Menu.Items.Add(Teclas_Macros_Create_Menu("Multimedia", My.Resources.Teclas_Multimedia, {"Volume Mute", "Volume Up", "Volume Down", "Media Next Track", "Media Previous Track", "Media Stop", "Media Play", "Select Media", "Launch Mail", "Launch Application 1", "Launch Application 2", "Browser Back", "Browser Forward", "Browser Refresh", "Browser Stop", "Browser Search", "Browser Favorites", "Browser Home"}, 133, 346, {"VolumeMute", "VolumeUp", "VolumeDown", "MediaNextTrack", "MediaPreviousTrack", "MediaStop", "MediaPlayPause", "SelectMedia", "LaunchMail", "LaunchApplication1", "LaunchApplication2", "BrowserBack", "BrowserForward", "BrowserRefresh", "BrowserStop", "BrowserSearch", "BrowserFavorites", "BrowserHome"}))
        GMacros_Teclas_Menu.Items.Add(Teclas_Macros_Create_Menu("Otros", My.Resources.Teclas_Otros, {"º", "'", "¡", "`", "+", "´", "ç", ",", ".", "-", "<"}, 30, 213, {"º", "'", "¡", "`", "+", "´", "Ç", ",", ".", "-", "<"}))
        GMacros_Teclas_Menu.Items.Add(Teclas_Macros_Create_Menu("Modificadores", My.Resources.Teclas_Modificador, {"LCtrl", "RCtrl", "LShift", "RShift", "LAlt", "RALT", "LWin", "RWin", "Apps Key", "FN Key"}, 70, 194, {"LCtrl", "RCtrl", "LShift", "RShift", "LAlt", "RALT", "LWin", "RWin", "AppsKey", "FNKey"}))

        KBoard_MenuTecla.Items.Clear() : KBoard_MenuTecla.ShowCheckMargin = False
        KBoard_MenuTecla.Items.Add(Teclas_KBoard_Create_Menu("Teclas", My.Resources.Teclas_Letra, {"A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "Ñ", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"}, 30, 517))
        KBoard_MenuTecla.Items.Add(Teclas_KBoard_Create_Menu("Números", My.Resources.Teclas_Numero, {"0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}, 30, 194))
        KBoard_MenuTecla.Items.Add(Teclas_KBoard_Create_Menu("Funcion", My.Resources.Teclas_Funcion, {"F1", "F2", "F3", "F4", "F5", "F6", "F7", "F8", "F9", "F10", "F11", "F12", "F13", "F14", "F15", "F16", "F17", "F18", "F19", "F20", "F21", "F22", "F23", "F24"}, 40, 460))
        KBoard_MenuTecla.Items.Add(Teclas_KBoard_Create_Menu("Numérico", My.Resources.Teclas_Numeric, {"NumPad 0", "NumPad 1", "NumPad 2", "NumPad 3", "NumPad 4", "NumPad 5", "NumPad 6", "NumPad 7", "NumPad 8", "NumPad 9", "NumLock", "NumPad /", "NumPad *", "NumPad -", "NumPad +", "NumPad ."}, 90, 308, {"NumPad0", "NumPad1", "NumPad2", "NumPad3", "NumPad4", "NumPad5", "NumPad6", "NumPad7", "NumPad8", "NumPad9", "NumLock", "NumPadDiv", "NumMult", "NumPadSub", "NumPadAdd", "NumPadDot"}))
        KBoard_MenuTecla.Items.Add(Teclas_KBoard_Create_Menu("Desplazamiento", My.Resources.Teclas_Scroll, {"PrintScreen", "Scroll", "Pause", "Insert", "Delete", "Home", "End", "PageUp", "PageDown", "Up", "Down", "Left", "Right", "Tab", "Capital", "Backspace", "Space", "Enter"}, 80, 346))
        KBoard_MenuTecla.Items.Add(Teclas_KBoard_Create_Menu("Multimedia", My.Resources.Teclas_Multimedia, {"Volume Mute", "Volume Up", "Volume Down", "Media Next Track", "Media Previous Track", "Media Stop", "Media Play", "Select Media", "Launch Mail", "Launch Application 1", "Launch Application 2", "Browser Back", "Browser Forward", "Browser Refresh", "Browser Stop", "Browser Search", "Browser Favorites", "Browser Home"}, 133, 346, {"VolumeMute", "VolumeUp", "VolumeDown", "MediaNextTrack", "MediaPreviousTrack", "MediaStop", "MediaPlayPause", "SelectMedia", "LaunchMail", "LaunchApplication1", "LaunchApplication2", "BrowserBack", "BrowserForward", "BrowserRefresh", "BrowserStop", "BrowserSearch", "BrowserFavorites", "BrowserHome"}))
        KBoard_MenuTecla.Items.Add(Teclas_KBoard_Create_Menu("Otros", My.Resources.Teclas_Otros, {"º", "'", "¡", "`", "+", "´", "ç", ",", ".", "-", "<"}, 30, 213, {"º", "'", "¡", "`", "+", "´", "Ç", ",", ".", "-", "<"}))
        KBoard_MenuTecla.Items.Add(Teclas_KBoard_Create_Menu("Ratón", My.Resources.Teclas_Raton, {"Left Doble Click", "Left Click", "Right Click", "Middle Click", "Button 4", "Button 5", "Wheel Up", "Wheel Down"}, 105, 157, {"Doble Mouse 1", "Mouse 1", "Mouse 2", "Mouse 3", "Mouse 4", "Mouse 5", "Wheel Up", "Wheel Down"}))
        KBoard_MenuTecla.Items.Add(Teclas_KBoard_Create_Menu("Modificadores", My.Resources.Teclas_Modificador, {"LCtrl", "RCtrl", "LShift", "RShift", "LAlt", "RALT", "LWin", "RWin", "Apps Key", "FN Key"}, 70, 194, {"LCtrl", "RCtrl", "LShift", "RShift", "LAlt", "RALT", "LWin", "RWin", "AppsKey", "FNKey"}))
        Teclas_KBoard_Create_Modificadores({"Control - (CTRL)", "Mayúsculas - (SHIFT)", "Alternativa - (ALT)", "Windows - (WIN)"}, {"MCtrl", "MShift", "MAlt", "MWin"})
    End Sub

    Private Sub Teclas_KBoard_Create_Modificadores(Teclas() As String, Optional Teclas_Tag() As String = Nothing)
        Dim NewSeparator As New ToolStripSeparator With {.Name = "Separador", .Text = "-", .ForeColor = QuickMenu_Editor.ForeColor}
        KBoard_MenuTecla.Items.Add(NewSeparator)
        For Cuenta = 0 To Teclas.Length - 1
            Dim NewMainItem As New ToolStripMenuItem With {.Name = "MTecla" + Cuenta.ToString, .Text = Teclas(Cuenta), .Image = My.Resources.Teclas_UnChecked, .ForeColor = QuickMenu_Editor.ForeColor}
            CType(NewMainItem.DropDown, ToolStripDropDownMenu).ShowImageMargin = False
            CType(NewMainItem.DropDown, ToolStripDropDownMenu).ShowCheckMargin = False
            CType(NewMainItem.DropDown, ToolStripDropDownMenu).AutoSize = False
            AddHandler NewMainItem.MouseEnter, AddressOf KBoard_MenuTecla_MouseEnter
            AddHandler NewMainItem.MouseLeave, AddressOf KBoard_MenuTecla_MouseLeave
            AddHandler NewMainItem.MouseDown, AddressOf KBoard_MenuTecla_MouseDown
            If Teclas_Tag IsNot Nothing Then NewMainItem.Tag = Teclas_Tag(Cuenta) Else NewMainItem.Tag = Teclas(Cuenta)
            KBoard_MenuTecla.Items.Add(NewMainItem)
        Next
    End Sub

    Private Function Teclas_Pulsacion_Create_Menu(Nombre As String, Imagen As Bitmap, Teclas() As String, W As Integer, H As Integer, Optional Teclas_Tag() As String = Nothing) As ToolStripMenuItem
        Dim NewMainItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = Nombre, .Image = Imagen, .ForeColor = QuickMenu_Editor.ForeColor}
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).ShowImageMargin = False
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).ShowCheckMargin = False
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).AutoSize = False
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).Width = W
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).Height = H
        AddHandler NewMainItem.MouseEnter, AddressOf GPulsacion_Teclas_Menu_MouseEnter
        AddHandler NewMainItem.MouseLeave, AddressOf GPulsacion_Teclas_Menu_MouseLeave
        For Cuenta = 0 To Teclas.Length - 1
            Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = Teclas(Cuenta), .ForeColor = QuickMenu_Editor.ForeColor, .TextAlign = ContentAlignment.MiddleCenter, .AutoSize = False, .Width = W - 1}
            If Teclas_Tag IsNot Nothing Then NewItem.Tag = Teclas_Tag(Cuenta) Else NewItem.Tag = Teclas(Cuenta)
            AddHandler NewItem.MouseDown, AddressOf GPulsacion_Teclas_Menu_MouseDown
            AddHandler NewItem.MouseEnter, AddressOf GPulsacion_Teclas_Menu_MouseEnter
            AddHandler NewItem.MouseLeave, AddressOf GPulsacion_Teclas_Menu_MouseLeave
            NewMainItem.DropDownItems.Add(NewItem)
        Next : Return NewMainItem
    End Function

    Private Function Teclas_Macros_Create_Menu(Nombre As String, Imagen As Bitmap, Teclas() As String, W As Integer, H As Integer, Optional Teclas_Tag() As String = Nothing) As ToolStripMenuItem
        Dim NewMainItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = Nombre, .Image = Imagen, .ForeColor = QuickMenu_Editor.ForeColor}
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).ShowImageMargin = False
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).ShowCheckMargin = False
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).AutoSize = False
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).Width = W
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).Height = H
        AddHandler NewMainItem.MouseEnter, AddressOf GMacros_Teclas_Menu_MouseEnter
        AddHandler NewMainItem.MouseLeave, AddressOf GMacros_Teclas_Menu_MouseLeave
        For Cuenta = 0 To Teclas.Length - 1
            Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = Teclas(Cuenta), .ForeColor = QuickMenu_Editor.ForeColor, .TextAlign = ContentAlignment.MiddleCenter, .AutoSize = False, .Width = W - 1}
            If Teclas_Tag IsNot Nothing Then NewItem.Tag = Teclas_Tag(Cuenta) Else NewItem.Tag = Teclas(Cuenta)
            AddHandler NewItem.MouseDown, AddressOf GMacros_Teclas_Menu_MouseDown
            AddHandler NewItem.MouseEnter, AddressOf GMacros_Teclas_Menu_MouseEnter
            AddHandler NewItem.MouseLeave, AddressOf GMacros_Teclas_Menu_MouseLeave
            NewMainItem.DropDownItems.Add(NewItem)
        Next : Return NewMainItem
    End Function

    Private Function Teclas_KBoard_Create_Menu(Nombre As String, Imagen As Bitmap, Teclas() As String, W As Integer, H As Integer, Optional Teclas_Tag() As String = Nothing) As ToolStripMenuItem
        Dim NewMainItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = Nombre, .Image = Imagen, .ForeColor = QuickMenu_Editor.ForeColor}
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).ShowImageMargin = False
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).ShowCheckMargin = False
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).AutoSize = False
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).Width = W
        CType(NewMainItem.DropDown, ToolStripDropDownMenu).Height = H
        AddHandler NewMainItem.MouseEnter, AddressOf KBoard_MenuTecla_MouseEnter
        AddHandler NewMainItem.MouseLeave, AddressOf KBoard_MenuTecla_MouseLeave
        For Cuenta = 0 To Teclas.Length - 1
            Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = Teclas(Cuenta), .ForeColor = QuickMenu_Editor.ForeColor, .TextAlign = ContentAlignment.MiddleCenter, .AutoSize = False, .Width = W - 1}
            If Teclas_Tag IsNot Nothing Then NewItem.Tag = Teclas_Tag(Cuenta) Else NewItem.Tag = Teclas(Cuenta)
            AddHandler NewItem.MouseDown, AddressOf KBoard_MenuTecla_MouseDown
            AddHandler NewItem.MouseEnter, AddressOf KBoard_MenuTecla_MouseEnter
            AddHandler NewItem.MouseLeave, AddressOf KBoard_MenuTecla_MouseLeave
            NewMainItem.DropDownItems.Add(NewItem)
        Next : Return NewMainItem
    End Function

#End Region

#Region " Carpetas "

    Private Sub ComboCarpetasEspeciales_Cargar()
        Dim Carpetas As New List(Of String)
        Carpetas.Add("Equipo")
        Carpetas.Add("Panel de Control")
        Carpetas.Add("Control de Volumen")
        Carpetas.Add("Ajustes de Audio")
        Carpetas.Add("Papelera de Reciclaje")
        Carpetas.Add("Papelera (Vaciar)")
        Carpetas.Add("Modo 'God'")
        Carpetas.Add("Documentos")
        Carpetas.Add("Imagenes")
        Carpetas.Add("Musicas")
        Carpetas.Add("Escritorio")
        Carpetas.Add("Videos")
        Carpetas.Add("Descargas")
        Carpetas.Add("K-Temp")
        Carpetas.Add("K-Desktop")
        Carpetas.Add("Usuario")
        Carpetas.Add("Fuentes")
        Carpetas.Add("Menu Inicio (Usuario)")
        Carpetas.Add("Menu Inicio")
        Carpetas.Add("Directivas de Grupo")
        Carpetas.Add("Programador de Tareas")
        Carpetas.Add("Registro de Windows")
        Carpetas.Add("Conexiones de Red")
        Carpetas.Add("Teclado en Pantalla")
        Carpetas.Add("Task Switcher")
        Carpetas.Add("K-Link")
        Carpetas.Add("PowerShell")
        Carpetas.Add("Windows Apps")
        Dim CarpetasArray() As String = Carpetas.ToArray : Array.Sort(CarpetasArray)
        GAbrirCarpeta_CCarpetas.Items.Clear() : For Each Carpeta As String In CarpetasArray : GAbrirCarpeta_CCarpetas.Items.Add(Carpeta) : Next
    End Sub

#End Region

#Region " Sabias Que "

    Private Sub SabiasQue_Cargar()
        SabiasQue_Lista.Clear()
        'Navegador
        SabiasQue_Lista.Add("Navegador|F5|Actualizar")
        SabiasQue_Lista.Add("Navegador|Ctrl + F5|Actualizar y resetear la cache de la página actual")
        SabiasQue_Lista.Add("Navegador|Alt + ←|Ir a la página anterior")
        SabiasQue_Lista.Add("Navegador|Alt + →|Ir a la página siguiente")
        SabiasQue_Lista.Add("Navegador|Alt + Inicio|Ir a la página de inicio")
        SabiasQue_Lista.Add("Navegador|Escape|Detener la carga de la página actual")
        SabiasQue_Lista.Add("Navegador|F6 – Alt + D – Ctrl + L|Seleccionar la barra de búsqueda")
        SabiasQue_Lista.Add("Navegador|F11|Modo pantalla completa")
        SabiasQue_Lista.Add("Navegador|Inicio|Subir al inicio de la página")
        SabiasQue_Lista.Add("Navegador|Fin|Bajar al final de la página")
        SabiasQue_Lista.Add("Navegador|Espacio – AvPag|Scroll abajo")
        SabiasQue_Lista.Add("Navegador|Shift + Espacio – RePag|Scroll arriba")
        SabiasQue_Lista.Add("Navegador|Ctrl + C|Copiar el texto seleccionado")
        SabiasQue_Lista.Add("Navegador|Ctrl + D|Añadir a favoritos la página actual")
        SabiasQue_Lista.Add("Navegador|F3 – Ctrl + F|Buscar en la página actual o seleccionar el resultado siguiente de una búsqueda")
        SabiasQue_Lista.Add("Navegador|Shift + F3|Seleccionar el resultado anterior de una búsqueda")
        SabiasQue_Lista.Add("Navegador|Ctrl + H|Abrir el historial de navegación")
        SabiasQue_Lista.Add("Navegador|Ctrl + J|Abrir el historial de descargas")
        SabiasQue_Lista.Add("Navegador|Ctrl + O|Abrir un archivo local")
        SabiasQue_Lista.Add("Navegador|Ctrl + S|Guardar la página actual")
        SabiasQue_Lista.Add("Navegador|Ctrl + P|Imprimir la página actual")
        SabiasQue_Lista.Add("Navegador|Ctrl + Shift + Suprimir|Abrir una ventana para borrar datos de navegación")
        SabiasQue_Lista.Add("Navegador|F12|Abrir las herramientas de desarrollador")
        SabiasQue_Lista.Add("Navegador|Ctrl + U|Mostrar el código fuente de la página actual")
        SabiasQue_Lista.Add("Navegador|Ctrl + N|Abrir una nueva ventana")
        SabiasQue_Lista.Add("Navegador|Ctrl + Tab – Ctrl + AvPag|Pasar a la pestaña siguiente")
        SabiasQue_Lista.Add("Navegador|Ctrl + Shift + Tab – Ctrl + RePag|Pasar a la pestaña anterior")
        SabiasQue_Lista.Add("Navegador|Ctrl + F4|Cerrar la pestaña actual")
        SabiasQue_Lista.Add("Navegador|Ctrl + T|Abrir una nueva pestaña")
        SabiasQue_Lista.Add("Navegador|Ctrl + Shift + T|Volver a abrir la pestaña cerrada más reciente")
        SabiasQue_Lista.Add("Navegador|Ctrl + (1 - 8)|Mostrar la pestaña correspondiente a su número")
        SabiasQue_Lista.Add("Navegador|Ctrl + 9|Mostrar la última pestaña")
        SabiasQue_Lista.Add("Navegador|Ctrl + Rueda del Ratón ↕|Hacer zoom en la página actual")
        SabiasQue_Lista.Add("Navegador|Ctrl + 0|Restaurar zoom en la página actual")
        SabiasQue_Lista.Add("Navegador|Rueda del Ratón|Cerrar la pestaña abierta" + vbCrLf + "Abrir enlaces en una pestaña nueva" + vbCrLf + "Activar el modo 'Scroll’")
        SabiasQue_Lista.Add("Navegador|Ctrl + Click|Abrir un enlace en una pestaña nueva en segundo plano")
        SabiasQue_Lista.Add("Navegador|Shift + Click|Abrir un enlace en una nueva ventana")
        SabiasQue_Lista.Add("Navegador|Shift + Ctrl + Click|Abrir un enlace en una nueva pestaña")
        SabiasQue_Lista.Add("Navegador|Alt + Seleccionar texto|Permite seleccionar el texto de los enlaces")
        'Explorer
        SabiasQue_Lista.Add("Explorer|Alt + D|Seleccionar la barra de direcciones")
        SabiasQue_Lista.Add("Explorer|Ctrl + E|Seleccionar todos los elementos de la carpeta actual")
        SabiasQue_Lista.Add("Explorer|Ctrl + F|Seleccionar el cuadro de búsqueda")
        SabiasQue_Lista.Add("Explorer|Ctrl + N|Abrir una ventana nueva")
        SabiasQue_Lista.Add("Explorer|Ctrl + W|Cerrar la ventana activa")
        SabiasQue_Lista.Add("Explorer|Ctrl + Rueda del Ratón ↕|Cambiar el tamaño y la apariencia de los iconos y carpetas")
        SabiasQue_Lista.Add("Explorer|Ctrl + Shift + N|Crear una carpeta nueva")
        SabiasQue_Lista.Add("Explorer|Alt + P|Mostrar el panel de vista previa")
        SabiasQue_Lista.Add("Explorer|Alt + Entrar|Abrir el cuadro de diálogo Propiedades del elemento seleccionado")
        SabiasQue_Lista.Add("Explorer|Alt + →|Ver la carpeta siguiente")
        SabiasQue_Lista.Add("Explorer|Alt + ↑|Ver la carpeta que contenía la carpeta")
        SabiasQue_Lista.Add("Explorer|Alt + ← – Retroceso|Ver la carpeta anterior")
        SabiasQue_Lista.Add("Explorer|F11|Maximizar o restaurar la ventana activa")
        SabiasQue_Lista.Add("Explorer|Shift + Click (Barra de Tareas)|Abrir una aplicación o abrir otra instancia de una aplicación")
        SabiasQue_Lista.Add("Explorer|Ctrl + Shift + Click (Barra de Tareas)|Abrir una aplicación como un administrador")
        SabiasQue_Lista.Add("Explorer|Shift + Click Derecho (Barra de Tareas)|Mostrar el menú de la aplicación o del grupo")
        SabiasQue_Lista.Add("Explorer|Ctrl + Click (Barra de Tareas)|Desplazarse a través de las ventanas de un grupo")
        SabiasQue_Lista.Add("Explorer|Ctrl + X|Cortar el elemento seleccionado")
        SabiasQue_Lista.Add("Explorer|Ctrl + C – Ctrl + Insertar|Copiar el elemento seleccionado")
        SabiasQue_Lista.Add("Explorer|Ctrl + V – Shift + Insertar|Pegar el elemento seleccionado")
        SabiasQue_Lista.Add("Explorer|Ctrl + Z|Deshacer una acción")
        SabiasQue_Lista.Add("Explorer|Alt + Tab|Cambiar entre aplicaciones abiertas")
        SabiasQue_Lista.Add("Explorer|Alt + F4|Cerrar el elemento activo o salir de la aplicación activa")
        SabiasQue_Lista.Add("Explorer|F2|Cambiar el nombre del elemento seleccionado")
        SabiasQue_Lista.Add("Explorer|F3|Buscar un archivo o una carpeta")
        SabiasQue_Lista.Add("Explorer|F4|Mostrar la lista de la barra de direcciones")
        SabiasQue_Lista.Add("Explorer|F5|Actualizar la ventana activa")
        SabiasQue_Lista.Add("Explorer|F6|Desplazarse por los elementos en una ventana o en el escritorio")
        SabiasQue_Lista.Add("Explorer|F10|Activar la barra de menús")
        SabiasQue_Lista.Add("Explorer|Alt + Escape|Desplazarse por los elementos en el orden en que se abrieron")
        SabiasQue_Lista.Add("Explorer|Ctrl + D – Suprimir|Eliminar el elemento seleccionado y moverlo a la papelera de reciclaje")
        SabiasQue_Lista.Add("Explorer|Ctrl + Y|Rehacer una acción")
        SabiasQue_Lista.Add("Explorer|Ctrl + →|Mover el cursor al principio de la palabra siguiente")
        SabiasQue_Lista.Add("Explorer|Ctrl + ←|Mover el cursor al principio de la palabra anterior")
        SabiasQue_Lista.Add("Explorer|Ctrl + ↓|Mover el cursor al principio del párrafo siguiente")
        SabiasQue_Lista.Add("Explorer|Ctrl + ↑|Mover el cursor al principio del párrafo anterior")
        SabiasQue_Lista.Add("Explorer|Ctrl + Alt + Tab|Usar las teclas de dirección para cambiar entre aplicaciones abiertas")
        SabiasQue_Lista.Add("Explorer|Ctrl + ← ↑ → ↓|Moverse entre los elementos individuales en una ventana o en el escritorio" + vbCrLf + "Al pulsar 'Espacio’ se selecciona el elemento actual")
        SabiasQue_Lista.Add("Explorer|Ctrl + Escape|Abrir el menú Inicio")
        SabiasQue_Lista.Add("Explorer|Ctrl + Shift + Escape|Abrir el Administrador de Tareas")
        SabiasQue_Lista.Add("Explorer|Ctrl + Shift|Cambiar la distribución del teclado cuando hay varias distribuciones del teclado disponibles")
        SabiasQue_Lista.Add("Explorer|Shift + F10|Mostrar el menú contextual del elemento seleccionado")
        SabiasQue_Lista.Add("Explorer|Shift + ← ↑ → ↓|Seleccionar varios elementos en una ventana o en el escritorio" + vbCrLf + "seleccionar texto en un documento")
        SabiasQue_Lista.Add("Explorer|Shift + Suprimir|Eliminar el elemento seleccionado sin moverlo a la papelera de reciclaje")
        'Windows
        SabiasQue_Lista.Add("Windows|Win + A|Abrir el Centro de Actividades")
        SabiasQue_Lista.Add("Windows|Win + B|Llevar el foco al área de notificación")
        SabiasQue_Lista.Add("Windows|Win + D|Mostrar y ocultar el escritorio")
        SabiasQue_Lista.Add("Windows|Win + E|Abrir el Explorador de Archivos")
        SabiasQue_Lista.Add("Windows|Win + G|Abrir la barra de juegos")
        SabiasQue_Lista.Add("Windows|Win + H|Iniciar dictado")
        SabiasQue_Lista.Add("Windows|Win + I|Abrir Configuración de Windows")
        SabiasQue_Lista.Add("Windows|Win + K|Abrir la acción rápida Conectar")
        SabiasQue_Lista.Add("Windows|Win + L|Bloquear el equipo o cambiar de cuenta")
        SabiasQue_Lista.Add("Windows|Win + M|Minimizar todas las ventanas")
        SabiasQue_Lista.Add("Windows|Win + O|Bloquear la orientación del dispositivo")
        SabiasQue_Lista.Add("Windows|Win + P|Elegir un modo de presentación")
        SabiasQue_Lista.Add("Windows|Win + Ctrl + Q|Abrir Asistencia Rápida")
        SabiasQue_Lista.Add("Windows|Win + Ctrl + Shift + B|Restablecer controlador gráfico")
        SabiasQue_Lista.Add("Windows|Win + R|Abrir el cuadro de diálogo Ejecutar")
        SabiasQue_Lista.Add("Windows|Win + S|Abrir la búsqueda")
        SabiasQue_Lista.Add("Windows|Win + Shift + S|Realizar una captura de pantalla de parte de la pantalla")
        SabiasQue_Lista.Add("Windows|Win + T|Desplazarse por las aplicaciones de la barra de tareas")
        SabiasQue_Lista.Add("Windows|Win + U|Abrir el Centro de Accesibilidad")
        SabiasQue_Lista.Add("Windows|Win + V|Abrir el Portapapeles")
        SabiasQue_Lista.Add("Windows|Win + X|Abrir el menú Vínculo Rápido")
        SabiasQue_Lista.Add("Windows|Win + Punto (.)|Abrir el panel de Emojis")
        SabiasQue_Lista.Add("Windows|Win + Coma (,)|Ojear temporalmente el escritorio")
        SabiasQue_Lista.Add("Windows|Win + Pausa|Mostrar el cuadro de diálogo Propiedades del Sistema")
        SabiasQue_Lista.Add("Windows|Win + Shift + M|Restaurar las ventanas minimizadas en el escritorio")
        SabiasQue_Lista.Add("Windows|Win + (0 - 9)|Iniciar o cambia a la aplicación anclada a la barra de tareas en la posición indicada por el número")
        SabiasQue_Lista.Add("Windows|Win + Shift + (0 - 9)|Iniciar una nueva instancia de la aplicación anclada a la barra de tareas en la posición indicada por el número")
        SabiasQue_Lista.Add("Windows|Win + Ctrl + (0 - 9)|Cambiar a la última ventana activa de la aplicación anclada a la barra de tareas en la posición indicada por el número")
        SabiasQue_Lista.Add("Windows|Win + Ctrl + Shift + (0 - 9)|Iniciar una nueva instancia como administrador de la aplicación anclada a la barra de tareas en la posición indicada por el número")
        SabiasQue_Lista.Add("Windows|Win + Tab|Abrir la Vista de Tareas")
        SabiasQue_Lista.Add("Windows|Win + ↑|Maximizar la ventana")
        SabiasQue_Lista.Add("Windows|Win + ↓|Minimizar la ventana")
        SabiasQue_Lista.Add("Windows|Win + ←|Maximizar la ventana en el lado izquierdo de la pantalla")
        SabiasQue_Lista.Add("Windows|Win + →|Maximizar la ventana en el lado derecho de la pantalla")
        SabiasQue_Lista.Add("Windows|Win + Inicio|Minimizar todo excepto la ventana activa" + vbCrLf + "(repetir la acción para restaurar todas las ventanas)")
        SabiasQue_Lista.Add("Windows|Win + Shift + ↑|Expandir la ventana a la parte superior e inferior de la pantalla")
        SabiasQue_Lista.Add("Windows|Win + Shift + ←  →|Mover una aplicación o ventana de un monitor a otro")
        SabiasQue_Lista.Add("Windows|Win + Espacio|Cambiar entre el idioma de entrada y la distribución del teclado")
        SabiasQue_Lista.Add("Windows|Win + Ctrl + Entrar|Activar Narrador")
        SabiasQue_Lista.Add("Windows|Win + Más (+)|Abrir la Lupa")
        SabiasQue_Lista.Add("Windows|Win + Ctrl + D|Agregar un escritorio virtual")
        SabiasQue_Lista.Add("Windows|Win + Ctrl + ←  →|Alternar entre los escritorios virtuales")
        SabiasQue_Lista.Add("Windows|Win + Ctrl + F4|Cerrar el escritorio virtual que estás usando")
    End Sub

    Private Sub SabiasQue_Random()
        If SabiasQue_Lista.Count = 0 Then SabiasQue_Indice = -1 : Exit Sub
        Dim RandomGen As New Random : Dim RandomIndice As Integer = RandomGen.Next(0, SabiasQue_Lista.Count - 1)
        If Opciones_SabiasQue_LAccion.Text = SabiasQue_Lista(RandomIndice).Split("|")(2) Then
            SabiasQue_Random()
        Else
            If SabiasQue_Indice <> -1 Then Undo_SabiasQue.Push(SabiasQue_Indice) : Redo_SabiasQue.Clear()
            SabiasQue_Indice = RandomIndice : SabiasQue_Show()
        End If
    End Sub

    Private Sub SabiasQue_Show(Optional Indice As Integer = -1)
        If Indice = -1 Then Indice = SabiasQue_Indice
        If SabiasQue_Lista.Count = 0 Or Indice = -1 Then Exit Sub
        Select Case SabiasQue_Lista(Indice).Split("|")(0)
            Case "Navegador" : Opciones_SabiasQue_PTipo.Image = My.Resources.SabiasQue_Navegadores.ToBitmap
            Case "Windows" : Opciones_SabiasQue_PTipo.Image = My.Resources.SabiasQue_Windows.ToBitmap
            Case "Explorer" : Opciones_SabiasQue_PTipo.Image = My.Resources.SabiasQue_Explorer.ToBitmap
        End Select
        Opciones_SabiasQue_LShortcut.Text = SabiasQue_Lista(Indice).Split("|")(1).Replace("–", "|") : Rutas.SetFontSize(Opciones_SabiasQue_LShortcut, 10) : Opciones_SabiasQue_LShortcut.Invalidate()
        Opciones_SabiasQue_LAccion.Text = SabiasQue_Lista(Indice).Split("|")(2)
    End Sub

#End Region

#End Region

#Region " Comando ID "

#Region " Generate ID "

    Private Function Generate_ID() As String
        Randomize() : Dim r As New Random(Int((99999 * Rnd()) + 1))
        Return Now.ToString("ddMMyyyyHHmmss") + r.Next(99999, 999999999).ToString
    End Function

#End Region

#Region " By ID "

    Private Sub Lista_SelectByID(ComandoID As String)
        If ComandoID = "-1" Or ComandoID = "-2" Or ComandoID = "Nuevo" Or Comandos.Length = 0 Or Lista.Items.Count = 0 Then Lista.SelectItem(-1) : Lista.EnsureVisibleAt(-1) : Exit Sub
        For Cuenta = 0 To Lista.Items.Count - 1
            If Comandos(Lista.Items(Cuenta).Tag).ID = ComandoID Then Lista.SelectItem(Cuenta) : Lista.EnsureVisibleAt(Cuenta) : Exit Sub
        Next
    End Sub

    Public Function Comandos_GetByID(ComandoID As String) As Integer
        If ComandoID = "-1" Or ComandoID = "-2" Or ComandoID = "Nuevo" Or Comandos.Length = 0 Then Return -1
        For Cuenta = 0 To Comandos.Length - 1
            If Comandos(Cuenta).ID = ComandoID Then Return Cuenta
        Next : Return -1
    End Function

#End Region

#End Region

#Region " Serial (con Try) "

#Region " Validar "

    Private Sub Serial_Validar()
        Try
            Opciones_Version_Serial = Registro.GetRegKey(RegPath + "\Opciones", "Serial", "invalid")
Repite:     If Opciones_Version_Serial = "invalid" Then
                If CBool(Registro.GetRegKey("Microsoft\KD", "Trialed", "False")) = False Then
                    FFirstRun.ShowDialog()
                    FirstRun = True
                    If FFirstRun.Cancelado = False Then
                        Registro.SetRegKey("Microsoft\KD", "Trialed", "True")
                        Opciones_Version_Serial = FFirstRun.Serial
                        Dim DSerialT As String = Serial_Decrypt(Opciones_Version_Serial) : If DSerialT.Contains("|") Then
                            If DSerialT.Split("|").Length = 3 Then Opciones_Version_Registro = DSerialT.Split("|")(0) : Opciones_Version_Validez = CDate(DSerialT.Split("|")(2)) : Registro.SetRegKey(RegPath + "\Opciones", "Serial", Opciones_Version_Serial) : Exit Sub
                        End If
                    Else
                        End
                    End If
                End If
                Sonidos.Play_Block("Error") : FSerial.ShowDialog()
                If FSerial.Cancelado = "No" Then
                    Opciones_Version_Serial = FSerial.Serial : Registro.SetRegKey(RegPath + "\Opciones", "Serial", Opciones_Version_Serial)
                Else
                    End
                End If
            End If
            Dim DSerial As String = Serial_Decrypt(Opciones_Version_Serial) : If DSerial.Contains("|") Then
                If DSerial.Split("|").Length = 3 Then
                    Dim Fecha As String = DSerial.Split("|")(2) : If Not IsDate(Fecha) Then Opciones_Version_Serial = "invalid" : GoTo Repite
                    If CDate(Now.ToShortDateString) > Fecha Then Sonidos.Play_Block("Chord") : ShowMessageBox("El número de serie ha caducado", Version, MsgBoxStyle.OkOnly, "Aceptar") : Opciones_Version_Serial = "invalid" : GoTo Repite
                    Opciones_Version_Registro = DSerial.Split("|")(0) : Opciones_Version_Validez = CDate(Fecha) : Registro.SetRegKey("Microsoft\KD", "Trialed", "True")
                End If
            Else
                Sonidos.Play_Block("Chord") : ShowMessageBox("El número de serie no es válido", Version, MsgBoxStyle.OkOnly, "Aceptar") : Opciones_Version_Serial = "invalid" : GoTo Repite
            End If
        Catch : Sonidos.Play_Block("Chord") : ShowMessageBox("El número de serie no es válido", Version, MsgBoxStyle.OkOnly, "Aceptar") : Opciones_Version_Serial = "invalid" : GoTo Repite : End Try
    End Sub

#End Region

#Region " Desencriptar "

    Public Function Serial_Decrypt(cSerial As String) As String
        Try
            Dim cypherTextBytes As Byte() = Convert.FromBase64String(cSerial.Replace("*", "+"))
            Dim memoryStream As New IO.MemoryStream(cypherTextBytes)
            Dim symmetricKey As New Security.Cryptography.RijndaelManaged() : symmetricKey.Mode = Security.Cryptography.CipherMode.CBC
            Dim decryptor As Security.Cryptography.ICryptoTransform = symmetricKey.CreateDecryptor({42, 1, 52, 67, 231, 13, 94, 101, 123, 6, 0, 12, 32, 91, 4, 111, 31, 70, 21, 141, 123, 142, 234, 82, 95, 129, 187, 162, 12, 55, 98, 23}, {234, 12, 52, 44, 214, 222, 200, 109, 2, 98, 45, 76, 88, 53, 23, 78})
            Dim cryptoStream As New Security.Cryptography.CryptoStream(memoryStream, decryptor, Security.Cryptography.CryptoStreamMode.Read)
            Dim plainTextBytes(cypherTextBytes.Length) As Byte
            Dim decryptedByteCount As Integer = cryptoStream.Read(plainTextBytes, 0, plainTextBytes.Length) : memoryStream.Close() : cryptoStream.Close()
            Dim enc As New Text.UTF8Encoding : Dim SerialDecrypted As String = enc.GetString(plainTextBytes, 0, decryptedByteCount) : Return (SerialDecrypted)
        Catch : Return "" : End Try
    End Function

#End Region

#Region " Simple Encrypt / Decrypt "

    Private arLetterChars() As Char = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890"
    Private arEncryptedChars() As Char = "¿s¢çc‹i˜Ö´åÄÚKÍìæ¯~4Ûÿ5ÑûÏÉí³èô§ŠÀÙ9ÒÓ?þ.äƒ%*š¾†±HI2@Ã¦Œ,Ôuû^]·"

    Private Function Simple_Encrypt(Texto As String) As String
        If Texto.Trim = "" Then Return ""
        For Each myTextBoxChar As Char In Texto
            For i As Integer = 0 To arLetterChars.Length - 1
                If myTextBoxChar = arLetterChars(i) Then Texto = Texto.Replace(myTextBoxChar, arEncryptedChars(i))
            Next
        Next : Return Texto
    End Function

    Private Function Simple_Decrypt(Texto As String) As String
        If Texto.Trim = "" Then Return ""
        For Each myTextBoxChar As Char In Texto
            For i As Integer = 0 To arEncryptedChars.Length - 1
                If myTextBoxChar = arEncryptedChars(i) Then Texto = Texto.Replace(myTextBoxChar, arLetterChars(i))
            Next
        Next : Return Texto
    End Function

#End Region

#End Region

#Region " Mensajes "

#Region " OSD "

    Public Sub ShowOSD(Texto As String, Optional DisplayTime As Integer = 3000, Optional Countdown As Boolean = False, Optional EndAnimation As OSD_CL.AnimateMode = OSD_CL.AnimateMode.Blend, Optional Wait As Boolean = False)
        If Opciones_OSD_Font Is Nothing Then Opciones_OSD_Font = OSD_Default_Font
        Opciones_OSD.Show(Texto, DisplayTime, Countdown, cColor:=Opciones_OSD_Color, cFont:=Opciones_OSD_Font, cAnimationTime:=Opciones_OSD_AnimationTime, cEndAnimation:=EndAnimation)
        If Wait = True Then WaitTime(DisplayTime)
    End Sub

    Public Sub HideOSD()
        Opciones_OSD.Close()
    End Sub

#End Region

#Region " Sonido "

    ' Reproduce el sonido cuando se selecciona en uno de los ComboBox de Sonido
    Private Sub Sonido_PlayTimer_Tick()
        'Comandos
        If Comandos_Sonido_CSonido.DroppedDown = True Then If Comandos_Sonido_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(Comandos_Sonido_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
        'Audio y Video
        If GCapturaPantalla_CSonido.DroppedDown = True Then If GCapturaPantalla_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(GCapturaPantalla_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
        If GGrabacionPantalla_CSonido.DroppedDown = True Then If GGrabacionPantalla_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(GGrabacionPantalla_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
        If GGrabacionAudio_CSonido.DroppedDown = True Then If GGrabacionAudio_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(GGrabacionAudio_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
        If GReproducirSonido_CSonido.DroppedDown = True Then If GReproducirSonido_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(GReproducirSonido_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
        If GSalidaAudio_CSonido.DroppedDown = True Then If GSalidaAudio_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(GSalidaAudio_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
        'Utilidades
        If GRedAdHoc_CSonido.DroppedDown = True Then If GRedAdHoc_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(GRedAdHoc_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
        'Acciones
        If GTopMost_CSonido.DroppedDown = True Then If GTopMost_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(GTopMost_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
        If GArchivosOcultos_CSonido.DroppedDown = True Then If GArchivosOcultos_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(GArchivosOcultos_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
        If GDesactivarEn_CSonido.DroppedDown = True Then If GDesactivarEn_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(GDesactivarEn_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
        If GMostrarMensaje_CSonido.DroppedDown = True Then If GMostrarMensaje_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(GMostrarMensaje_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
        If GApagarEquipo_CSonido.DroppedDown = True Then If GApagarEquipo_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(GApagarEquipo_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
        'Opciones
        If Opciones_MensajeIniciar_CSonido.DroppedDown = True Then If Opciones_MensajeIniciar_CSonido.SelectedItem.Trim = "Sin Sonido" Then My.Computer.Audio.Stop() : Sonido_PlayTimer.Stop() Else Sonidos.Play_Block(Opciones_MensajeIniciar_CSonido.SelectedItem.Trim) : Sonido_PlayTimer.Stop()
    End Sub

#End Region

#Region " Show Message "

    Public Function ShowMessageBox(Texto As String, Titulo As String, Optional Modo As MsgBoxStyle = MsgBoxStyle.OkOnly, Optional OKTexto As String = "Aceptar", Optional Texto2 As String = "") As DialogResult
        Select Case OKTexto
            Case "YesNo" : FMsgBox.BAceptar.Text = "Sí" : FMsgBox.BCancelar.Text = "No"
            Case "KBoard_Proceso" : FMsgBox.BAceptar.Text = "Establecer" : FMsgBox.BNo.Text = "No" : FMsgBox.BCancelar.Text = "Cancelar"
            Case Else : FMsgBox.BAceptar.Text = OKTexto : FMsgBox.BCancelar.Text = "Cancelar"
        End Select

        'If OKTexto = "YesNo" Then FMsgBox.BAceptar.Text = "Sí" : FMsgBox.BCancelar.Text = "No" Else FMsgBox.BAceptar.Text = OKTexto : FMsgBox.BCancelar.Text = "Cancelar"
        FMsgBox.LTexto.Text = Texto : FMsgBox.LTexto2.Text = Texto2 : FMsgBox.FTheme.Text = Titulo : FMsgBox.Modo = Modo : If FMsgBox.Visible = False Then FMsgBox.ShowDialog()
        Return FMsgBox.Respuesta
    End Function

#End Region

#Region " Wait Time "

    Public Sub WaitTime(WaitTime As Integer, Optional ExtraTime As Integer = 0)
        Dim cWaitTime As New WaitTime_CL() : cWaitTime.Start(WaitTime, ExtraTime)
    End Sub

#End Region

#Region " Iconos (Update) "

    Private Sub Iconos_Update()
        For Cuenta = 0 To Lista.Items.Count - 1 : Lista.Items(Cuenta).Image = Iconos.DefaultIcon(Comandos(Lista.Items(Cuenta).Tag).ID, 0) : Next
        For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
            If ComandoActualID = "Negativo" Then
                Comandos_Accion_ListaAccion.Items(Cuenta).Image = Iconos.DefaultIcon("Negativo", Cuenta, True)
            Else
                Dim Indice_ID As Integer = Comandos_GetByID(ComandoActualID)
                If Indice_ID <> -1 Then Comandos_Accion_ListaAccion.Items(Cuenta).Image = Iconos.DefaultIcon(Comandos(Indice_ID).ID, Cuenta, True)
            End If
        Next : Lista.Invalidate() : Comandos_Accion_ListaAccion.Invalidate() : Lista.Update()
    End Sub

#End Region

#Region " Tooltip "

    Public Sub ShowToolTip(sender As Object, Texto As String)
        General_Tooltip.Dispose()
        General_Tooltip = New ToolTip
        General_Tooltip.InitialDelay = 1000 : General_Tooltip.ReshowDelay = 1000 : General_Tooltip.AutoPopDelay = 50000 : General_Tooltip.ShowAlways = True
        General_Tooltip.SetToolTip(sender, Texto)
    End Sub

#End Region

#Region " Tooltips "

#Region " General_Tooltip "

    Public Sub Show_Tooltip(sender As Object, Texto As String)
        If sender Is Nothing Or Texto = "" Then General_Tooltip.Dispose() : General_Tooltip = New ToolTip : Exit Sub
        General_Tooltip.Dispose() : General_Tooltip = New ToolTip With {.InitialDelay = 1500, .ReshowDelay = 10, .AutoPopDelay = 10000, .ShowAlways = True, .Tag = sender.name, .OwnerDraw = True, .ForeColor = Color.FromArgb(205, 150, 0)}
        AddHandler General_Tooltip.Draw, AddressOf Tooltip_Draw
        General_Tooltip.SetToolTip(sender, Texto)
    End Sub

#End Region

#Region " K_Tooltip "

    Private Sub K_Show_Tooltip(sender As Object, Posicion As Point, Texto As String)
        K_Tooltip.Dispose() : K_Tooltip = New ToolTip With {.InitialDelay = 1000, .ReshowDelay = 10, .AutoPopDelay = 10000, .ShowAlways = True, .Tag = sender.name, .OwnerDraw = True, .ForeColor = Color.FromArgb(205, 150, 0)}
        AddHandler K_Tooltip.Draw, AddressOf Tooltip_Draw
        K_Tooltip.Show(Texto, sender, Posicion)
    End Sub

    Private Sub K_Hide_Tooltip()
        K_Tooltip.Tag = "" : K_Tooltip.Active = False
    End Sub

#End Region

    Private Sub Tooltip_Draw(sender As Object, e As DrawToolTipEventArgs)
        e.Graphics.FillRectangle(New SolidBrush(Color.FromArgb(50, 50, 50)), e.Bounds)
        e.DrawBorder()
        Dim TextFormat As TextFormatFlags = TextFormatFlags.VerticalCenter Or TextFormatFlags.HorizontalCenter Or TextFormatFlags.NoFullWidthCharacterBreak
        e.DrawText(TextFormat)
    End Sub

#End Region

#End Region

#Region " Limpiar Cache "

    Private Sub Cache_Limpiar()
        Dim _Dir As New IO.DirectoryInfo(KobaPathTemp)
        Dim _Files As IO.FileInfo() = _Dir.GetFiles("*.*")
        For Each _File As IO.FileInfo In _Files
            Try : IO.File.Delete(_File.FullName) : Catch : End Try
        Next
        If IO.Directory.Exists(KobaPathTemp + "Importar") = True Then Try : IO.Directory.Delete(KobaPathTemp + "Importar", True) : Catch : End Try
        If IO.Directory.Exists(KobaPathTemp + "Exportar") = True Then Try : IO.Directory.Delete(KobaPathTemp + "Exportar", True) : Catch : End Try

        _Dir = New IO.DirectoryInfo(KobaPath + "Iconos\Comandos") : _Files = _Dir.GetFiles("*.*")
        For Each _File As IO.FileInfo In _Files
            For Cuenta = 0 To Comandos.Length - 1
                If _File.FullName = KobaPath + "Iconos\Comandos\" + Comandos(Cuenta).ID + ".ico" Then GoTo Sigue1
            Next
            Try : IO.File.Delete(_File.FullName) : Catch : End Try
Sigue1: Next

        _Dir = New IO.DirectoryInfo(KobaPath + "Iconos\QuickMenu") : _Files = _Dir.GetFiles("*.*")
        For Each _File As IO.FileInfo In _Files
            Dim SacaQuickMenus() As String = Registro.GetRegKeyNames(RegPath + "\QuickMenus")
            For Cuenta = 0 To SacaQuickMenus.Length - 1
                If Check_QuickMenu_Icons(RegPath + "\QuickMenus\" + QuickMenus(Cuenta).Nombre, _File.FullName) = True Then GoTo Sigue2
            Next
            Try : IO.File.Delete(_File.FullName) : Catch : End Try
Sigue2: Next

        _Dir = New IO.DirectoryInfo(KobaPath + "Iconos\WebIcons") : _Files = _Dir.GetFiles("*.*")
        For Each _File As IO.FileInfo In _Files
            For Cuenta = 0 To Comandos.Length - 1
                If Comandos(Cuenta).Accion IsNot Nothing AndAlso Comandos(Cuenta).Accion.Length > 0 Then
                    For Cuenta2 = 0 To Comandos(Cuenta).Accion.Length - 1
                        If KobaPath + "Iconos\WebIcons\" + Split(Comandos(Cuenta).Accion(Cuenta2).Settings, "|-|",, CompareMethod.Text)(0).Replace("\", "_").Replace("/", "_").Replace("?", "_").Replace(".", "_").Replace(":", "").Replace(";", "") + ".ico" = _File.FullName Then GoTo Sigue3
                    Next
                End If
            Next
            Try : IO.File.Delete(_File.FullName) : Catch : End Try
Sigue3: Next
        If IO.File.Exists(KobaPath + "BATs\TempID.bat") = True Then IO.File.Delete(KobaPath + "BATs\TempID.bat")
        If IO.File.Exists(KobaPath + "MACROs\TempID.mcr") = True Then IO.File.Delete(KobaPath + "MACROs\TempID.mcr")
    End Sub

    Private Function Check_QuickMenu_Icons(Ruta As String, _File As String) As Boolean
        Dim GetMenus() As String = Registro.GetRegKeyNames(Ruta)
        For Cuenta = 0 To GetMenus.Length - 1
            If KobaPath + "Iconos\QuickMenu\" + Registro.GetRegKey(Ruta + "\" + GetMenus(Cuenta), "ID") + ".ico" = _File Then Return True
            If Registro.GetRegKeyNames(Ruta + "\" + GetMenus(Cuenta)).Length > 0 Then
                If Check_QuickMenu_Icons(Ruta + "\" + GetMenus(Cuenta), _File) = True Then Return True
            End If
        Next : Return False
    End Function

#End Region

#Region " General Timer "

    Private Sub General_Timer_Tick()
        If Logros.Check_Logros = True Then Logros.Check_Logros = False : Logros.Comprobar()
        'Panel Opciones
        If Opacity <> 0 And PanelOpciones.Visible = True Then
            General_Timer.Interval = 1000
            'Sabias que
            If SabiasQue_Contador = SabiasQue_ShowTime Then SabiasQue_Random() : SabiasQue_Contador = 0 Else SabiasQue_Contador += 1
            'Servidor UDP (Estado)
            If Opciones_UDP = True Then
                If Internet.IsConnectedToInternet() = True AndAlso UDPCliente IsNot Nothing Then
                    If Opciones_UDP_LEstado.Text <> "Online" Then Opciones_UDP_LEstado.Text = "Online" : Opciones_UDP_LEstado.ForeColor1 = Color.DarkGreen : Opciones_UDP_LEstado.Invalidate()
                Else
                    If Opciones_UDP_LEstado.Text <> "Offline" Then Opciones_UDP_LEstado.Text = "Offline" : Opciones_UDP_LEstado.ForeColor1 = Color.DarkRed : Opciones_UDP_LEstado.Invalidate()
                End If
            Else
                If Opciones_UDP_LEstado.Text <> "Offline" Then Opciones_UDP_LEstado.Text = "Offline" : Opciones_UDP_LEstado.ForeColor1 = Color.DarkRed : Opciones_UDP_LEstado.Invalidate()
            End If
            'Panel quickMenu
        ElseIf Opacity <> 0 And PanelQuickMenu.Visible = True And QuickMenu_Editor_ZOrder = False And QuickMenu_Loading = False Then
            General_Timer.Interval = 100
            SetWindowPos(QuickMenu_Editor.Handle, Handle, 0, 0, 0, 0, &H1 Or &H2)
            If GetWindow(Handle, 3) = QuickMenu_Editor.Handle Then QuickMenu_Editor_ZOrder = True
        ElseIf Opacity <> 0 And PanelQuickMenu.Visible = True And MoveStrip IsNot Nothing And MovingItem = True Then
            General_Timer.Interval = 25
            Dim Strip As Object = MoveStrip
            Dim Position As Integer = Strip.Items.IndexOf(Strip.GetItemAt(MousePosition.X - Strip.Left, MousePosition.Y - Strip.Top))
            If QuickMenu_Mouse_Position <> Position Then
                QuickMenu_Mouse_Position = Position
            Else
                If Position > -1 AndAlso TypeOf Strip.Items(Position) Is ToolStripMenuItem AndAlso Strip.Items(Position).DropDownItems.Count > 0 AndAlso Strip.Items(Position).DropDownItems(0).Visible = True Then Exit Sub
            End If
            If Position > -1 AndAlso Position < Strip.Items.Count AndAlso (TypeOf Strip.Items(Position) Is ToolStripTextBox Or TypeOf Strip.Items(Position) Is ToolStripSeparator) Then Exit Sub
            If Position > -1 AndAlso Position < Strip.Items.Count Then
                If TypeOf Strip.Items(Position) Is ToolStripMenuItem Then
                    If Strip.Items(Position).DropDownItems.Count > 0 Then
                        For Cuenta = 0 To Strip.Items.Count - 1
                            If TypeOf Strip.Items(Cuenta) Is ToolStripMenuItem Then SetForegroundWindow(New Runtime.InteropServices.HandleRef(QuickMenu_Editor, QuickMenu_Editor.Handle)) : Strip.Items(Cuenta).HideDropDown()
                        Next
                        If Position > -1 AndAlso Position < Strip.Items.Count AndAlso Strip.Items(Position).DropDownItems.Count > 0 Then Strip.Items(Position).ShowDropDown()
                    End If
                End If
            End If
        ElseIf Opacity <> 0 And PanelQuickMenu.Visible = True AndAlso CancelClose2 = False AndAlso QuickMenu_SubMenu_Check_TextBoxes() = False AndAlso FComandoRapido.Visible = False AndAlso FNombreIcono.Visible = False AndAlso FMsgBox.Visible = False AndAlso (GetActiveWindow <> Handle And GetActiveWindow <> QuickMenu_Editor.Handle) Then
            CancelClose = False
            For Each cItem As Object In QuickMenu_Editor.Items
                If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then
                    cItem.HideDropDown()
                End If
            Next
        ElseIf Opacity <> 0 And PanelQuickMenu.Visible = True AndAlso Focus_TextBox = False AndAlso FComandoRapido.Visible = False AndAlso QuickMenu_Editor.Items.Count > 0 AndAlso TypeOf QuickMenu_Editor.Items(0) Is ToolStripTextBox AndAlso (GetActiveWindow <> Handle And GetActiveWindow <> QuickMenu_Editor.Handle) Then
            Focus_TextBox = True
        Else
            General_Timer.Interval = 25
        End If
        'Coordenadas ratón
        If GMacro_GAñadirMacro.Visible = True And GMacro_CoorLCX.Visible = True Then
            GMacro_CoorLCX.Text = Cursor.Position.X.ToString : GMacro_CoorLCX.Invalidate() : GMacro_CoorLCY.Text = Cursor.Position.Y.ToString : GMacro_CoorLCY.Invalidate()
        End If
        If GEnviarPulsacion.Visible = True And GEnviarPulsacion_CoorLCX.Visible = True Then
            GEnviarPulsacion_CoorLCX.Text = Cursor.Position.X.ToString : GEnviarPulsacion_CoorLCX.Invalidate() : GEnviarPulsacion_CoorLCY.Text = Cursor.Position.Y.ToString : GEnviarPulsacion_CoorLCY.Invalidate()
        End If
    End Sub

#End Region

#Region " Font Converter "

    Private Function Font_to_String(Fuente As Font) As String
        Dim FontConverter = New FontConverter()
        Return FontConverter.ConvertToString(Fuente)
    End Function

    Private Function String_to_Font(Fuente As String) As Font
        Dim FontConverter = New FontConverter()
        Return TryCast(FontConverter.ConvertFromString(Fuente), Font)
    End Function

#End Region

#Region " Color Converter "

    Private Function Color_to_String(cColor As Color) As String
        Return cColor.R.ToString + ", " + cColor.G.ToString + ", " + cColor.B.ToString
    End Function

    Private Function String_to_Color(cColor As String) As Color
        Return Color.FromArgb(cColor.Split(", ")(0), cColor.Split(", ")(1), cColor.Split(", ")(2))
    End Function

#End Region

#Region " Capturar "

    Public Sub Capturar()
        Dim Contador As Integer
        For Cuenta = 0 To Screen.AllScreens.Count - 1
            Dim Options As New ScreenRecorderLib.RecorderOptions With {
        .DisplayOptions = New ScreenRecorderLib.DisplayOptions With {.MonitorDeviceName = Screen.AllScreens(Cuenta).DeviceName},
        .RecorderMode = ScreenRecorderLib.RecorderMode.Snapshot,
        .RecorderApi = ScreenRecorderLib.RecorderApi.DesktopDuplication,
        .VideoOptions = New ScreenRecorderLib.VideoOptions With {.SnapshotFormat = ScreenRecorderLib.ImageFormat.PNG},
        .MouseOptions = New ScreenRecorderLib.MouseOptions With {
        .IsMousePointerEnabled = False}}

            If IO.File.Exists(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png") Then
                Do Until IO.File.Exists(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png") = False Or Contador > 10 : Application.DoEvents() : Contador += 1 : Threading.Thread.Sleep(50)
                    Try : IO.File.Delete(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png") : Catch : End Try
                Loop
            End If
            If IO.File.Exists(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png") = True Then
                'Dim bounds As Rectangle = Screen.AllScreens(Cuenta).Bounds : Dim screenshot As New Bitmap(bounds.Width, bounds.Height, Imaging.PixelFormat.Format32bppArgb) : Dim graph As Graphics = Graphics.FromImage(screenshot)
                'graph.CopyFromScreen(bounds.X, bounds.Y, 0, 0, bounds.Size, CopyPixelOperation.SourceCopy)
                'screenshot.Save(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png", Imaging.ImageFormat.Png)
                ''My.Resources.NoImage.Save(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png", Imaging.ImageFormat.Png)
            Else
                If VideoRecorder.Recording = False Then
                    Captura = ScreenRecorderLib.Recorder.CreateRecorder(Options)
                    AddHandler Captura.OnRecordingComplete, AddressOf Captura_OnRecordingComplete
                    AddHandler Captura.OnRecordingFailed, AddressOf Captura_OnRecordingFailed
                    AddHandler Captura.OnStatusChanged, AddressOf Captura_OnStatusChanged
                    Capturado = False : Captura.Record(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png")
                    Contador = 0 : Do Until Capturado = True Or Contador > 10 : Application.DoEvents() : Contador += 1 : Threading.Thread.Sleep(50) : Loop
                    If IO.File.Exists(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png") = True Then
                        Dim FullSizeImg As Image = Imagen.LoadImageClone(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png")
                        Select Case Displays.GetRotation(Cuenta)
                            Case Displays.Orientations.DEGREES_CW_90
                                FullSizeImg.RotateFlip(RotateFlipType.Rotate270FlipNone)
                                IO.File.Delete(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png")
                                FullSizeImg.Save(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png", Imaging.ImageFormat.Png)
                            Case Displays.Orientations.DEGREES_CW_270
                                FullSizeImg.RotateFlip(RotateFlipType.Rotate90FlipNone)
                                IO.File.Delete(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png")
                                FullSizeImg.Save(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png", Imaging.ImageFormat.Png)
                        End Select
                    Else
                        Dim bounds As Rectangle = Screen.AllScreens(Cuenta).Bounds : Dim screenshot As New Bitmap(bounds.Width, bounds.Height, Imaging.PixelFormat.Format32bppArgb) : Dim graph As Graphics = Graphics.FromImage(screenshot)
                        graph.CopyFromScreen(bounds.X, bounds.Y, 0, 0, bounds.Size, CopyPixelOperation.SourceCopy)
                        screenshot.Save(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png", Imaging.ImageFormat.Png)
                        'My.Resources.NoImage.Save(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png", Imaging.ImageFormat.Png)
                    End If
                Else
                    Dim bounds As Rectangle = Screen.AllScreens(Cuenta).Bounds : Dim screenshot As New Bitmap(bounds.Width, bounds.Height, Imaging.PixelFormat.Format32bppArgb) : Dim graph As Graphics = Graphics.FromImage(screenshot)
                    graph.CopyFromScreen(bounds.X, bounds.Y, 0, 0, bounds.Size, CopyPixelOperation.SourceCopy)
                    screenshot.Save(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png", Imaging.ImageFormat.Png)
                    'My.Resources.NoImage.Save(KobaPathTemp + "Captura_" + Cuenta.ToString + ".png", Imaging.ImageFormat.Png)
                End If
            End If
        Next
    End Sub

    Private Sub Captura_OnRecordingComplete(sender As Object, e As ScreenRecorderLib.RecordingCompleteEventArgs)
        Capturado = True
    End Sub

    Private Sub Captura_OnRecordingFailed(sender As Object, e As ScreenRecorderLib.RecordingFailedEventArgs)
        Capturado = True
    End Sub

    Private Sub Captura_OnStatusChanged(sender As Object, e As ScreenRecorderLib.RecordingStatusEventArgs)
        'Dim Status As ScreenRecorderLib.RecorderStatus = e.Status
    End Sub

#End Region

#Region " Create KPS "

    Public Sub CreateKPS()
        IO.Directory.CreateDirectory(KobaPathTemp) : If IO.File.Exists(KobaPathTemp + "KPS.exe") = False Then IO.File.WriteAllBytes(KobaPathTemp + "KPS.exe", My.Resources.KPS)
    End Sub

#End Region

#End Region

#End Region

#Region " Paneles "

#Region " Lista "

#Region " Lista "

#Region " Seleccionar "

    Private Sub Lista_SelectedIndexChanged(sender As Object, Indice As Integer) Handles Lista.SelectedIndexChanged
        If GMacro_Grabando = True Then
            If Indice <> -1 Then
                If ComandoActualID = "Negativo" Then
                    Lista.SelectedIndex(0) = -1
                Else
                    If Comandos(Lista.Items(Indice).Tag).ID <> ComandoActualID Then Lista_SelectByID(ComandoActualID)
                End If
            Else
                If ComandoActualID = "Negativo" Then
                    Lista.SelectedIndex(0) = -1
                Else
                    Lista_SelectByID(ComandoActualID)
                End If
            End If
            Exit Sub
        End If
        If Indice <> -1 Then
            Comando_Mostrar(Comandos(Lista.Items(Indice).Tag).ID)
        Else
            Comando_Mostrar("-1")
            If ComandoActualID.StartsWith("Cancel") = True Then ComandoActualID = ComandoActualID.Replace("Cancel", "") Else ComandoActualID = "Negativo"
        End If
        If NoFocusLista = False Then
            HTexto.Focus()
            Lista.Focus()
        End If
    End Sub

#End Region

#Region " Click "

    Private Sub Lista_Click(sender As Object, e As MouseEventArgs) Handles Lista.Click
        If e.Button <> MouseButtons.Left Or TBuscar.Visible = True Or GMacro_Grabando = True Then Exit Sub
        If Lista.PointToClient(MousePosition).Y < 22 Then Lista_CComandos.DroppedDown = True : Lista_CComandos.Focus()
    End Sub

    Private Sub Lista_DobleClick(sender As Object, e As EventArgs, Indice As Integer) Handles Lista.DobleClick

        If Indice <> -1 Then
            QuickMenu_Editor_ZOrder = False : CancelClose = False
            For Each cItem As Object In QuickMenu_Editor.Items
                If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then cItem.HideDropDown()
            Next : QuickMenu_Editor.Close()
            Comando_Mostrar(Comandos(Lista.Items(Indice).Tag).ID)
            PanelComandos.Visible = True : PanelKBoard1.Visible = False : PanelKBoard2.Visible = False : PanelQuickMenu.Visible = False : KBoard_LTeclado.Visible = False : PanelOpciones.Visible = False : Lista.Height = 590
            BPanelComandos.ForeColor1 = Color.FromArgb(205, 150, 0) : BPanelKBoard.ForeColor1 = Color.FromArgb(102, 102, 102) : BPanelQuickMenu.ForeColor1 = Color.FromArgb(102, 102, 102) : BPanelOpciones.ForeColor1 = Color.FromArgb(102, 102, 102)
            If Comandos_Accion_ListaAccion.Items.Length > 0 Then
                Comandos_Accion_ListaAccion.SelectItem(0)
                Comandos_Accion_ListaAccion.EnsureVisibleAt(0)
                Comandos_Accion_ListaAccion.Focus()
            End If
        End If
    End Sub

    Private Sub Lista_Move(sender As Object, e As MouseEventArgs) Handles Lista.MouseMove
        If General_Tooltip.Active = True AndAlso Lista.PointToClient(MousePosition).Y > 21 Then General_Tooltip.Hide(sender)
        If General_Tooltip.Tag <> sender.Name AndAlso Lista.PointToClient(MousePosition).Y < 22 Then Show_Tooltip(sender, "Click Izquierdo: Muestra un menu para filtrar los comandos")
    End Sub

#End Region

#Region " KeyPress "

    Private Sub Lista_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Lista.KeyPress
        ListaKeyDownPressed = False
        If Asc(e.KeyChar) = 13 AndAlso Lista.SelectedIndex(0) <> -1 AndAlso Comandos_Accion_ListaAccion.Items.Length > 0 Then
            e.Handled = True
            If Comandos(Lista.SelectedItems(0).Tag).ID = Comandos(Comandos_GetByID(ComandoActualID)).ID Then
                Comandos_Accion_ListaAccion.SelectItem(0)
                Comandos_Accion_ListaAccion.EnsureVisibleAt(0)
                Comandos_Accion_ListaAccion.Focus()
            Else
                Comandos_Accion_ListaAccion.SelectItem(0)
                Comandos_Accion_ListaAccion.EnsureVisibleAt(0)
            End If
            'MenuLista.Show(Lista, Lista.Columns(0).Width, Lista.SelectedItems(0).Area.Y - 1)
        End If
    End Sub

    Private Sub Lista_KeyDown(sender As Object, e As KeyEventArgs) Handles Lista.KeyDown
        ListaKeyDownPressed = True
        If e.KeyCode = Keys.Apps Then AppsKey = True
        If e.KeyCode = Keys.Delete Then MenuLista_Eliminar_Click(sender, Nothing)
    End Sub

    Private Sub Lista_KeyUp(sender As Object, e As KeyEventArgs) Handles Lista.KeyUp
        ListaKeyDownPressed = False
        If ComandoActualID <> "Negativo" AndAlso Lista.SelectedItems.Count > 0 AndAlso Lista.SelectedItems(0).Tag <> -1 AndAlso Lista.SelectedItems(0).Tag < Comandos.Length Then Comando_Mostrar(Comandos(Lista.SelectedItems(0).Tag).ID, 0, True)
    End Sub

#End Region

#End Region

#Region " Ocultos "

    Private Sub Lista_POculto_Click(sender As Object, e As MouseEventArgs) Handles Lista_POculto.Click, Lista_POculto.DoubleClick
        If e.Button <> MouseButtons.Left Or GMacro_Grabando = True Then Exit Sub
        MostrarOcultos = Not MostrarOcultos
        If MostrarOcultos = True Then Lista_POculto.Image = My.Resources.Ocultar_Oculto_On Else Lista_POculto.Image = My.Resources.Ocultar_Mostrado_On
        Lista_Update() : Lista.Focus()
        If Lista.Items.Count > 0 Then
            If ComandoActualID <> "-1" And ComandoActualID <> "-2" And ComandoActualID <> "Nuevo" And ComandoActualID <> "Negativo" Then
                For Cuenta = 0 To Lista.Items.Count - 1
                    If Comandos(Lista.Items(Cuenta).Tag).ID = ComandoActualID Then Lista.SelectItem(Cuenta) : Lista.EnsureVisibleAt(Cuenta) : Exit Sub
                Next
            End If : Lista.SelectItem(0) : Lista.EnsureVisibleAt(0) : Comando_Mostrar(Comandos(Lista.Items(0).Tag).ID)
        End If
    End Sub

    Private Sub Lista_POculto_MouseEnter(sender As Object, e As EventArgs) Handles Lista_POculto.MouseEnter
        If MostrarOcultos = True Then Lista_POculto.Image = My.Resources.Ocultar_Oculto_On Else Lista_POculto.Image = My.Resources.Ocultar_Mostrado_On
    End Sub

    Private Sub Lista_POculto_MouseLeave(sender As Object, e As EventArgs) Handles Lista_POculto.MouseLeave
        If MostrarOcultos = True Then Lista_POculto.Image = My.Resources.Ocultar_Oculto_Off Else Lista_POculto.Image = My.Resources.Ocultar_Mostrado_Off
    End Sub

#End Region

#Region " Buscar "

    Dim NoFocusLista As Boolean
    Private Sub TBuscar_KeyPress(sender As Object, e As KeyPressEventArgs) Handles TBuscar.KeyPress
        If Asc(e.KeyChar) = 13 Then
            e.Handled = True
            NoFocusLista = True
            Lista_Update()
            If Lista.Items.Count > 0 Then Lista.SelectItem(0) : Lista.EnsureVisibleAt(0) : Comando_Mostrar(ComandoActualID) Else Comando_Mostrar("-1") : ComandoActualID = "Negativo"
            NoFocusLista = False
            TBuscar.Width = (Lista_POculto.Left - TBuscar.Left) - 3
        End If
    End Sub

    Private Sub TBuscar_TextChanged(sender As Object, e As EventArgs) Handles TBuscar.TextChanged
        If TBuscar.Tag <> "Started" Then Exit Sub
        NoFocusLista = True
        Lista_Update()
        If Lista.Items.Count > 0 Then Lista.SelectItem(0) : Lista.EnsureVisibleAt(0) : Comando_Mostrar(ComandoActualID) Else Comando_Mostrar("-1") : ComandoActualID = "Negativo"
        NoFocusLista = False
        TBuscar.Width = (Lista_POculto.Left - TBuscar.Left) - 3
    End Sub

    Private Sub TBuscar_GotFocus(sender As Object, e As EventArgs) Handles TBuscar.GotFocus
        Buscar_Focused = True
    End Sub

    Private Sub TBuscar_LostFocus(sender As Object, e As EventArgs) Handles TBuscar.LostFocus
        Buscar_Focused = False
    End Sub

    Private Sub PBuscar_Click(sender As Object, e As MouseEventArgs) Handles PBuscar.Click, PBuscar.DoubleClick
        If e.Button <> MouseButtons.Left Or GMacro_Grabando = True Then Exit Sub
        If TBuscar.Visible = False Then
            HTexto.Focus()
            TBuscar.Tag = "Started"
            NoFocusLista = True
            Lista_Update(True)
            If Lista.Items.Count > 0 Then Lista.SelectItem(0) : Lista.EnsureVisibleAt(0) : Comando_Mostrar(ComandoActualID) Else Comando_Mostrar("-1") : ComandoActualID = "Negativo"
            NoFocusLista = False
            TBuscar.Width = (Lista_POculto.Left - TBuscar.Left) - 3
            TBuscar.Visible = True
            TBuscar.Focus()
        Else
            TBuscar.Visible = False
            Lista_Update()
            If Lista.Items.Count > 0 Then Lista.SelectItem(0) : Lista.EnsureVisibleAt(0) : Comando_Mostrar(ComandoActualID) Else Comando_Mostrar("-1") : ComandoActualID = "Negativo"
        End If
    End Sub

    Private Sub PBuscar_MouseEnter(sender As Object, e As EventArgs) Handles PBuscar.MouseEnter
        PBuscar.Image = My.Resources.Search_On
    End Sub

    Private Sub PBuscar_MouseLeave(sender As Object, e As EventArgs) Handles PBuscar.MouseLeave
        If TBuscar.Visible = False Then PBuscar.Image = My.Resources.Search_Off
    End Sub

#End Region

#Region " Combo "

#Region " Seleccionar "

    Private Sub Lista_CComandos_SelectedIndexChanged(sender As Object, e As EventArgs) Handles Lista_CComandos.SelectedIndexChanged
        If Combo_TempValue = "" Then
            If Lista_CComandos.SelectedItem.ToString.ToUpper = "@|QUICKMENUS" Then Exit Sub
            HTexto.Focus()
            Lista.Columns(0).Text = Lista_CComandos.SelectedItem.ToString : Lista.Invalidate()
            Comandos_ComandoNegativo = False : Comando_Mostrar("-1")
            Lista_Update()
            If Lista.Items.Count > 0 Then Lista.SelectItem(0) : Lista.EnsureVisibleAt(0) : Comando_Mostrar(Comandos(Lista.Items(0).Tag).ID) Else Comando_Mostrar("-1") : ComandoActualID = "Negativo"
        End If
    End Sub

#End Region

#Region " KeyPress "

    Private Sub Lista_CComandos_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Lista_CComandos.KeyPress
        If Asc(e.KeyChar) = 13 Then
            If Lista_CComandos.SelectedItem.ToString.ToUpper = "@|QUICKMENUS" Then e.Handled = True : Exit Sub
            Lista.Columns(0).Text = Lista_CComandos.SelectedItem.ToString
            HTexto.Focus()
            Lista.Columns(0).Text = Lista_CComandos.SelectedItem.ToString : Lista.Invalidate()
            Comandos_ComandoNegativo = False : Comando_Mostrar("-1")
            Lista_Update()
            If Lista.Items.Count > 0 Then Lista.SelectItem(0) : Lista.EnsureVisibleAt(0) : Comando_Mostrar(Comandos(Lista.Items(0).Tag).ID) Else Comando_Mostrar("-1") : ComandoActualID = "Negativo"
            e.Handled = True
        End If
    End Sub

#End Region

#Region " DropDown "

    Private Sub Lista_CComandos_DropDown(sender As Object, e As EventArgs) Handles Lista_CComandos.DropDown
        Lista_CComandos.Items.Clear()
        Lista_CComandos.Items.Add("COMANDOS")
        Lista_CComandos.Items.Add("COMANDOS (TODOS)")
        Lista_CComandos.Items.Add("SOLO OCULTOS")
        If QuickMenus.Length > 0 Then Lista_CComandos.Items.Add("@|QUICKMENUS")
        For Cuenta = 0 To QuickMenus.Length - 1 : Lista_CComandos.Items.Add(QuickMenus(Cuenta).Nombre) : Next
        Lista_CComandos.MaxDropDownItems = 10
        If Lista.VS.Visible = True Then Lista_CComandos.DropDownWidth = 187 Else Lista_CComandos.DropDownWidth = 205
        Combo_Dropped = True : Combo_TempValue = Lista.Columns(0).Text
        If Lista_CComandos.Items.Contains(Lista.Columns(0).Text) = True Then Lista_CComandos.SelectedItem = Lista.Columns(0).Text Else Lista_CComandos.SelectedIndex = 0
    End Sub

    Private Sub Lista_CComandos_DropDownClosed(sender As Object, e As EventArgs) Handles Lista_CComandos.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub Lista_CComandos_LostFocus(sender As Object, e As EventArgs) Handles Lista_CComandos.LostFocus
        Combo_Dropped = False
    End Sub

#End Region

#End Region

#Region " Menu "

#Region " Ejecutar "

    Private Sub MenuLista_Ejecutar_Click(sender As Object, e As EventArgs) Handles MenuLista_Ejecutar.Click
        If Opacity <> 1 Or Lista.Items.Count = 0 Then Exit Sub
        If Lista.SelectedIndex(0) = -1 Then Exit Sub
        Dim cEjecutarComando As EjecutarComandoST
        cEjecutarComando.Indice_Comando = Lista.SelectedItems(0).Tag
        cEjecutarComando.ID_Comando = Comandos(cEjecutarComando.Indice_Comando).ID
        cEjecutarComando.Sonido = Comandos(cEjecutarComando.Indice_Comando).Sonido
        Proceso.Get_Process_Name()
        cEjecutarComando.Proceso = Proceso.CurrentProcess
        cEjecutarComando.Logger = "Keyboard"
        cEjecutarComando.Notas = "Menu_Lista"
        Comandos(cEjecutarComando.Indice_Comando).EnEjecucion = True
        EjecutarComando(cEjecutarComando)
    End Sub

#End Region

#Region " Nuevo "

    Private Sub MenuLista_Nuevo_Click(sender As Object, e As EventArgs) Handles MenuLista_Nuevo.Click
        QuickMenu_Editor_ZOrder = False : CancelClose = False
        For Each cItem As Object In QuickMenu_Editor.Items
            If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then cItem.HideDropDown()
        Next : QuickMenu_Editor.Close()
        Comando_Nuevo()
    End Sub

#End Region

#Region " Editar "

    Private Sub MenuLista_Editar_Click(sender As Object, e As EventArgs) Handles MenuLista_Editar.Click
        QuickMenu_Editor_ZOrder = False : CancelClose = False
        For Each cItem As Object In QuickMenu_Editor.Items
            If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then cItem.HideDropDown()
        Next : QuickMenu_Editor.Close()
        PanelComandos.Visible = True
        PanelKBoard1.Visible = False
        PanelKBoard2.Visible = False
        PanelQuickMenu.Visible = False
        PanelOpciones.Visible = False
        BPanelComandos.ForeColor1 = Color.FromArgb(205, 150, 0)
        BPanelKBoard.ForeColor1 = Color.FromArgb(102, 102, 102)
        BPanelQuickMenu.ForeColor1 = Color.FromArgb(102, 102, 102)
        BPanelOpciones.ForeColor1 = Color.FromArgb(102, 102, 102)
        Comandos_Nombre_TNombre.SelectionLength = 0 : HTexto.Focus()
        Lista.Height = 590
        If Comandos_Accion_ListaAccion.Items.Count > 0 AndAlso Comandos_Accion_ListaAccion.SelectedItems.Length > 0 AndAlso Comandos_Accion_ListaAccion.SelectedIndex(0) <> -1 AndAlso Comandos(Comandos_GetByID(ComandoActualID)).Accion(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Tipo = "K-Board" Then Accion_Mostrar(Comandos_Accion_ListaAccion.SelectedIndex(0))
        If Comandos_Accion_ListaAccion.Items.Count > 0 AndAlso Comandos_Accion_ListaAccion.SelectedItems.Length > 0 AndAlso Comandos_Accion_ListaAccion.SelectedIndex(0) <> -1 AndAlso Comandos(Comandos_GetByID(ComandoActualID)).Accion(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Tipo = "QuickMenu" Then Accion_Mostrar(Comandos_Accion_ListaAccion.SelectedIndex(0))
    End Sub

#End Region

#Region " Eliminar "

    Private Sub MenuLista_Eliminar_Click(sender As Object, e As EventArgs) Handles MenuLista_Eliminar.Click
        If Opacity <> 1 Or Lista.Items.Count = 0 Then Exit Sub
        If Lista.Items.Count = 0 OrElse Lista.SelectedIndex(0) = -1 Then Exit Sub
        If ShowMessageBox("¿Eliminar '" + Comandos(Lista.SelectedItems(0).Tag).Nombre + "'?", Version, MsgBoxStyle.YesNo, "Eliminar") = DialogResult.Cancel Then Exit Sub
        Registro.DelReg(RegPath + "\Comandos\" + Comandos(Lista.SelectedItems(0).Tag).Nombre.Replace("\", "|/|") + "|-|" + Comandos(Lista.SelectedItems(0).Tag).ID)
        If Comandos(Lista.SelectedItems(0).Tag).Accion IsNot Nothing AndAlso Comandos(Lista.SelectedItems(0).Tag).Accion.Length > 0 Then
            For Cuenta = 0 To Comandos(Lista.SelectedItems(0).Tag).Accion.Length - 1
                If Comandos(Lista.SelectedItems(0).Tag).Accion(Cuenta).Tipo = "Macros" AndAlso IO.File.Exists(KobaPath + "MACROs\" + Comandos(Lista.SelectedItems(0).Tag).Accion(Cuenta).ID + ".mcr") = True Then IO.File.Delete(KobaPath + "MACROs\" + Comandos(Lista.SelectedItems(0).Tag).Accion(Cuenta).ID + ".mcr")
                If Comandos(Lista.SelectedItems(0).Tag).Accion(Cuenta).Tipo = "Ejecutar BAT" AndAlso IO.File.Exists(KobaPath + "BATs\" + Comandos(Lista.SelectedItems(0).Tag).Accion(Cuenta).ID + ".bat") = True Then IO.File.Delete(KobaPath + "BATs\" + Comandos(Lista.SelectedItems(0).Tag).Accion(Cuenta).ID + ".bat")
            Next
        End If
        Lista.RemoveItemAt(Lista.SelectedIndex(0))
        Estadisticas.Estadisticas.Comandos_Eliminados += 1 : Estadisticas.Guardar()
        Dim cItem As Integer = Lista.SelectedIndex(0) : Comando_Eliminar(ComandoActualID) : Lista_Update()
        If Lista.Items.Count > 0 Then
            If cItem < Lista.Items.Count Then
                Lista.SelectItem(cItem)
                Lista.EnsureVisibleAt(cItem)
            Else
                Lista.SelectItem(Lista.Items.Count - 1)
                Lista.EnsureVisibleAt(Lista.Items.Count - 1)
            End If
        Else
            Lista.SelectItem(-1) : Comando_Mostrar("-1") : ComandoActualID = "Negativo"
        End If
        Update_QuickMenu()
    End Sub

    Private Sub Comando_Eliminar(ComandoID As String)
        Dim Indice As Integer = Comandos_GetByID(ComandoID) : If Indice = -1 Then Exit Sub
        Array.Copy(Comandos, Indice + 1, Comandos, Indice, UBound(Comandos) - Indice)
        ReDim Preserve Comandos(UBound(Comandos) - 1)
    End Sub

#End Region

#Region " Icono "

    Private Sub ListaMenu_Icono_Seleccionar_Click(sender As Object, e As EventArgs) Handles ListaMenu_Icono_Seleccionar.Click
        FIconDialog.Cancelado = True : FIconDialog.ShowDialog()
        If FIconDialog.Cancelado = False Then
            Estadisticas.Estadisticas.Iconos_Modificados += 1 : Estadisticas.Guardar()
            Iconos.Guardar(FIconDialog.Icono.ToBitmap, KobaPath + "Iconos\Comandos\" + Comandos(Lista.SelectedItems(0).Tag).ID + ".ico")
            Comandos(Lista.SelectedItems(0).Tag).CustomIcono = "[CUSTOM]"
            Lista.SelectedItems(0).Image = FIconDialog.Icono.ToBitmap : Lista.Invalidate()
            Comando_GuardarValor("Icono")
        End If
    End Sub

    Private Sub ListaMenu_Icono_Examinar_Click(sender As Object, e As EventArgs) Handles ListaMenu_Icono_Examinar.Click
        'Try
        Dim ImageListSmall, ImageListLarge As ImageList : Dim Icono As Bitmap = Nothing
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar icono..." : Abrir.Filter = "Archivos de Iconos|*.ico;*.exe;*.dll;*.lnk|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then
            If Abrir.FileName.ToLower.EndsWith(".lnk") Then ImageListLarge = FIconDialog.GetImageList(Rutas.GetTargetPath(Abrir.FileName)) Else ImageListLarge = FIconDialog.GetImageList(Abrir.FileName)
            ImageListSmall = ImageListLarge : If ImageListSmall IsNot Nothing Then
                For Cuenta = 0 To ImageListSmall.Images.Count - 1
                    If ImageListSmall.Images(Cuenta) IsNot Nothing Then Icono = ImageListSmall.Images(Cuenta) : Exit For
                Next
            Else
                If Abrir.FileName.ToLower.EndsWith(".lnk") Then Abrir.FileName = Rutas.GetTargetPath(Abrir.FileName)
                Icono = Icon.ExtractAssociatedIcon(Abrir.FileName).ToBitmap
            End If
            If Icono Is Nothing Then Exit Sub
            Iconos.Guardar(Icono, KobaPath + "Iconos\Comandos\" + Comandos(Lista.SelectedItems(0).Tag).ID + ".ico")
            Comandos(Lista.SelectedItems(0).Tag).CustomIcono = "[CUSTOM]"
            Lista.SelectedItems(0).Image = Icono : Lista.Invalidate()
            Comando_GuardarValor("Icono")
            Estadisticas.Estadisticas.Iconos_Modificados += 1 : Estadisticas.Guardar()
        End If
        'Catch : End Try
    End Sub

    Private Sub ListaMenu_Icono_PorDefecto_Salir_Click(sender As Object, e As EventArgs) Handles ListaMenu_Icono_PorDefecto.Click
        If IO.File.Exists(KobaPath + "Iconos\Comandos\" + Comandos(Lista.SelectedItems(0).Tag).ID + ".ico") = True Then IO.File.Delete(KobaPath + "Iconos\Comandos\" + Comandos(Lista.SelectedItems(0).Tag).ID + ".ico")
        Comandos(Lista.SelectedItems(0).Tag).CustomIcono = ""
        Lista.SelectedItems(0).Image = Iconos.DefaultIcon(Comandos(Lista.SelectedItems(0).Tag).ID, 0) : Lista.Invalidate()
        Comando_GuardarValor("Icono")
    End Sub

    Private Sub ListaMenu_Icono_Eliminar_Click(sender As Object, e As EventArgs) Handles ListaMenu_Icono_Eliminar.Click
        If IO.File.Exists(KobaPath + "Iconos\Comandos\" + Comandos(Lista.SelectedItems(0).Tag).ID + ".ico") = True Then IO.File.Delete(KobaPath + "Iconos\Comandos\" + Comandos(Lista.SelectedItems(0).Tag).ID + ".ico")
        Estadisticas.Estadisticas.Iconos_Modificados += 1 : Estadisticas.Guardar()
        Comandos(Lista.SelectedItems(0).Tag).CustomIcono = "[ELIMINADO]"
        Lista.SelectedItems(0).Image = Nothing : Lista.Invalidate()
        Comando_GuardarValor("Icono")
    End Sub

#End Region

#Region " Salir "

    Private Sub MenuLista_Salir_Click(sender As Object, e As EventArgs) Handles MenuLista_Salir.Click
        ShowF("Salir")
    End Sub

#End Region

#Region " Eventos "

    Private Sub MenuLista_Opening(sender As Object, e As ComponentModel.CancelEventArgs) Handles MenuLista.Opening
        If Lista.PointToClient(MousePosition).Y < 22 Or GMacro_Grabando = True Then e.Cancel = True : Exit Sub
        'If GMacro_Grabando = True And Lista.SelectedIndex(0) = CurrentComandoIndex Then e.Cancel = True : Exit Sub
        If AppsKey = True Then AppsKey = False : If Lista.SelectedIndex(0) <> -1 Then MenuLista.Show(Lista, Lista.Columns(0).Width, Lista.SelectedItems(0).Area.Y - 1) : Exit Sub Else e.Cancel = True
        If Opacity <> 1 Then e.Cancel = True : Exit Sub
        If Lista.SelectedIndex(0) = -1 Then
            MenuLista_Ejecutar.Visible = False
            MenuLista_Separador0.Visible = False
            MenuLista_Separador1.Visible = True
            MenuLista_Eliminar.Visible = False
            MenuLista_Separador2.Visible = False
            MenuLista_Icono.Visible = False
            MenuLista_Separador3.Visible = False
            MenuLista_Editar.Visible = False
            MenuLista_Separador4.Visible = False
        Else
            MenuLista_Separador1.Visible = True
            MenuLista_Eliminar.Visible = True
            MenuLista_Separador2.Visible = True
            MenuLista_Icono.Visible = True
            MenuLista_Separador3.Visible = True
            If PanelComandos.Visible = False Then
                MenuLista_Editar.Visible = True
                MenuLista_Separador4.Visible = True
            Else
                MenuLista_Editar.Visible = False
                MenuLista_Separador4.Visible = False
            End If
            If Comandos_Accion_ListaAccion.Items.Count = 0 Then MenuLista_Ejecutar.Visible = True : GoTo Sigue
            For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
                If Comandos_Accion_ListaAccion.Items(Cuenta).Text <> "TopMost (On/Off)" AndAlso Comandos_Accion_ListaAccion.Items(Cuenta).Text <> "Desactivar en (On/Off)" Then MenuLista_Ejecutar.Visible = True : MenuLista_Separador0.Visible = True : GoTo Sigue
            Next : MenuLista_Ejecutar.Visible = False : MenuLista_Separador0.Visible = False
Sigue:      CType(MenuLista_Icono.DropDown, ToolStripDropDownMenu).ShowImageMargin = False
        End If
        End Sub

    Private Sub MenuLista_MItem_MouseEnter(sender As Object, e As EventArgs) Handles MenuLista_Ejecutar.MouseEnter, MenuLista_Nuevo.MouseEnter, MenuLista_Eliminar.MouseEnter, MenuLista_Salir.MouseEnter, MenuLista_Icono.MouseEnter, ListaMenu_Icono_Seleccionar.MouseEnter, ListaMenu_Icono_Examinar.MouseEnter, ListaMenu_Icono_PorDefecto.MouseEnter, ListaMenu_Icono_Eliminar.MouseEnter
        Dim QMItem As ToolStripMenuItem = CType(sender, ToolStripMenuItem) : QMItem.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub MenuLista_MItem_MouseLeave(sender As Object, e As EventArgs) Handles MenuLista_Ejecutar.MouseLeave, MenuLista_Nuevo.MouseLeave, MenuLista_Eliminar.MouseLeave, MenuLista_Salir.MouseLeave, MenuLista_Icono.MouseLeave, ListaMenu_Icono_Seleccionar.MouseLeave, ListaMenu_Icono_Examinar.MouseLeave, ListaMenu_Icono_PorDefecto.MouseLeave, ListaMenu_Icono_Eliminar.MouseLeave
        Dim QMItem As ToolStripMenuItem = CType(sender, ToolStripMenuItem) : QMItem.ForeColor = Color.FromArgb(130, 130, 130)
    End Sub

#End Region

#End Region

#Region " Lista Update "

    Private Sub Lista_Update(Optional Buscado As Boolean = False)
        If Comandos Is Nothing Then Exit Sub
        Dim CurrentComandoID As String = ComandoActualID
        SLista.Clear() : SLista.Sorting = SortOrder.None : SLista.BeginUpdate() : SLista.Columns.Add("A")
        For Cuenta = 0 To Comandos.Length - 1
            If Comandos IsNot Nothing AndAlso Comandos(Cuenta).Nombre IsNot Nothing AndAlso Comandos(Cuenta).Nombre.Trim <> "" Then SLista.Items.Add(Comandos(Cuenta).Nombre).Tag = Cuenta
        Next : SLista.EndUpdate() : SLista.Sorting = SortOrder.Ascending : SLista.Sort() : Lista.Clear()
        If TBuscar.Visible = True Or Buscado = True Then
            For Cuenta = 0 To SLista.Items.Count - 1
                If MostrarOcultos = False AndAlso Comandos(SLista.Items(Cuenta).Tag).Oculto = False AndAlso Comandos(SLista.Items(Cuenta).Tag).Nombre.ToLower.Contains(TBuscar.Text.ToLower) Then Lista.AddItem(Comandos(SLista.Items(Cuenta).Tag).Nombre, SLista.Items(Cuenta).Tag)
                If MostrarOcultos = True AndAlso Comandos(SLista.Items(Cuenta).Tag).Nombre.ToLower.Contains(TBuscar.Text.ToLower) Then Lista.AddItem(Comandos(SLista.Items(Cuenta).Tag).Nombre, SLista.Items(Cuenta).Tag)
            Next
        Else
            Select Case Lista.Columns(0).Text
                Case "COMANDOS"
                    For Cuenta = 0 To SLista.Items.Count - 1
                        If MostrarOcultos = False AndAlso Comandos(SLista.Items(Cuenta).Tag).Oculto = True Then GoTo Salta1
                        For Cuenta2 = 0 To QuickMenus.Length - 1
                            If QuickMenu_ExisteComando(QuickMenus(Cuenta2), Comandos(SLista.Items(Cuenta).Tag).ID) = True Then GoTo Salta1
                        Next
                        Lista.AddItem(Comandos(SLista.Items(Cuenta).Tag).Nombre, SLista.Items(Cuenta).Tag)
Salta1:             Next
                Case "COMANDOS (TODOS)"
                    For Cuenta = 0 To SLista.Items.Count - 1
                        If MostrarOcultos = False AndAlso Comandos(SLista.Items(Cuenta).Tag).Oculto = False Then Lista.AddItem(Comandos(SLista.Items(Cuenta).Tag).Nombre, SLista.Items(Cuenta).Tag)
                        If MostrarOcultos = True Then Lista.AddItem(Comandos(SLista.Items(Cuenta).Tag).Nombre, SLista.Items(Cuenta).Tag)
                    Next
                Case "SOLO OCULTOS"
                    For Cuenta = 0 To SLista.Items.Count - 1
                        If Comandos(SLista.Items(Cuenta).Tag).Oculto = True Then Lista.AddItem(Comandos(SLista.Items(Cuenta).Tag).Nombre, SLista.Items(Cuenta).Tag)
                    Next
                Case Else
                    Dim Existe As Boolean
                    For Cuenta = 0 To SLista.Items.Count - 1
                        Existe = False
                        For Cuenta2 = 0 To QuickMenus.Length - 1
                            If QuickMenus(Cuenta2).Nombre.ToLower = Lista.Columns(0).Text.ToLower Then Existe = QuickMenu_ExisteComando(QuickMenus(Cuenta2), Comandos(SLista.Items(Cuenta).Tag).ID)
                            If Existe = True Then Exit For
                        Next
                        If Existe = True Then
                            If MostrarOcultos = False AndAlso Comandos(SLista.Items(Cuenta).Tag).Oculto = False Then Lista.AddItem(Comandos(SLista.Items(Cuenta).Tag).Nombre, SLista.Items(Cuenta).Tag)
                            If MostrarOcultos = True Then Lista.AddItem(Comandos(SLista.Items(Cuenta).Tag).Nombre, SLista.Items(Cuenta).Tag)
                        End If
                    Next
            End Select
        End If
        Iconos_Update()
        If Lista.Items.Count > 0 Then
            For Cuenta = 0 To Lista.Items.Count - 1
                If Lista.Items(Cuenta).Tag < Comandos.Length AndAlso Comandos(Lista.Items(Cuenta).Tag).ID = CurrentComandoID Then Lista.SelectItem(Cuenta) : Lista.EnsureVisibleAt(Cuenta) : Comando_Mostrar(CurrentComandoID) : Exit Sub
            Next
        End If
        If Lista.Items.Count = 0 Then Comando_Mostrar("-1") : ComandoActualID = "Negativo"
    End Sub

#End Region

#End Region

#Region " Panel Botones "

    Private Sub Paneles_Click(sender As Object, e As MouseEventArgs) Handles BPanelComandos.Click, BPanelKBoard.Click, BPanelQuickMenu.Click, BPanelOpciones.Click
        If (TypeOf e Is MouseEventArgs AndAlso e.Button <> MouseButtons.Left) Or GMacro_Grabando = True Then Exit Sub
        Dim Panel As NSButton = CType(sender, NSButton)
        Select Case Panel.Text
            Case "COMANDOS" : ExitHotKey() : If PanelComandos.Visible = True Then Exit Sub
                QuickMenu_Editor_ZOrder = False : CancelClose = False
                For Each cItem As Object In QuickMenu_Editor.Items
                    If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then cItem.HideDropDown()
                Next : QuickMenu_Editor.Close()
                PanelComandos.Visible = True
                PanelKBoard1.Visible = False
                PanelKBoard2.Visible = False
                KBoard_LTeclado.Visible = False
                PanelQuickMenu.Visible = False
                PanelOpciones.Visible = False
                BPanelComandos.ForeColor1 = Color.FromArgb(205, 150, 0)
                BPanelKBoard.ForeColor1 = Color.FromArgb(102, 102, 102)
                BPanelQuickMenu.ForeColor1 = Color.FromArgb(102, 102, 102)
                BPanelOpciones.ForeColor1 = Color.FromArgb(102, 102, 102)
                Comandos_Nombre_TNombre.SelectionLength = 0 : HTexto.Focus()
                Lista.Height = 590
                If Comandos_Accion_ListaAccion.Items.Count > 0 AndAlso Comandos_Accion_ListaAccion.SelectedItems.Length > 0 AndAlso Comandos_Accion_ListaAccion.SelectedIndex(0) <> -1 AndAlso Comandos(Comandos_GetByID(ComandoActualID)).Accion(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Tipo = "K-Board" Then Accion_Mostrar(Comandos_Accion_ListaAccion.SelectedIndex(0))
                If Comandos_Accion_ListaAccion.Items.Count > 0 AndAlso Comandos_Accion_ListaAccion.SelectedItems.Length > 0 AndAlso Comandos_Accion_ListaAccion.SelectedIndex(0) <> -1 AndAlso Comandos(Comandos_GetByID(ComandoActualID)).Accion(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Tipo = "QuickMenu" Then Accion_Mostrar(Comandos_Accion_ListaAccion.SelectedIndex(0))
            Case "K-BOARD" : ExitHotKey() : If PanelKBoard1.Visible = True Then Exit Sub
                QuickMenu_Editor_ZOrder = False : CancelClose = False
                For Each cItem As Object In QuickMenu_Editor.Items
                    If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then cItem.HideDropDown()
                Next : QuickMenu_Editor.Close()
                PanelKBoard1.Visible = True
                PanelKBoard2.Visible = True
                KBoard_LTeclado.Visible = True
                KBoard_LTeclado.BringToFront()
                PanelComandos.Visible = False
                PanelQuickMenu.Visible = False
                PanelOpciones.Visible = False
                BPanelKBoard.ForeColor1 = Color.FromArgb(205, 150, 0)
                BPanelComandos.ForeColor1 = Color.FromArgb(102, 102, 102)
                BPanelQuickMenu.ForeColor1 = Color.FromArgb(102, 102, 102)
                BPanelOpciones.ForeColor1 = Color.FromArgb(102, 102, 102)
                Lista.Height = 340
            Case "QUICK MENU" : ExitHotKey() : If PanelQuickMenu.Visible = True Then Exit Sub
                If PanelQuickMenu.Visible = True Then Exit Sub
                QuickMenu_Editor_ZOrder = False
                BPanelQuickMenu.ForeColor1 = Color.FromArgb(205, 150, 0)
                BPanelComandos.ForeColor1 = Color.FromArgb(102, 102, 102)
                BPanelKBoard.ForeColor1 = Color.FromArgb(102, 102, 102)
                BPanelOpciones.ForeColor1 = Color.FromArgb(102, 102, 102)
                Lista.Height = 590

                For Cuenta = 0 To QuickMenus.Length - 1
                    If QuickMenus(Cuenta).Nombre.ToLower = QuickMenu_Nombre_TNombre.Tag.ToLower Then
                        If QuickMenu_Tamaño_Ignorar = False Then
                            QuickMenu_TQuickMenuSize.Value = Registro.GetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Nombre_TNombre.Tag.Replace("\", "|/|"), "Tamaño", "0")
                            QuickMenu_TQuickMenuSize_Scroll(QuickMenu_TQuickMenuSize)
                        End If
                    End If
                Next
                PanelQuickMenu.Visible = True
                PanelComandos.Visible = False
                PanelKBoard1.Visible = False
                PanelKBoard2.Visible = False
                KBoard_LTeclado.Visible = False
                PanelOpciones.Visible = False
                QuickMenu_Editor_Load(QuickMenu_Nombre_TNombre.Tag)
            Case "OPCIONES" : ExitHotKey() : If PanelOpciones.Visible = True Then Exit Sub
                SabiasQue_Random() : SabiasQue_Contador = 0
                QuickMenu_Editor_ZOrder = False : CancelClose = False
                For Each cItem As Object In QuickMenu_Editor.Items
                    If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then cItem.HideDropDown()
                Next : QuickMenu_Editor.Close()
                If Internet.IsConnectedToInternet() = True Then Opciones_UDP_LEstado.Text = "Online" : Opciones_UDP_LEstado.ForeColor1 = Color.DarkGreen Else Opciones_UDP_LEstado.Text = "Offline" : Opciones_UDP_LEstado.ForeColor1 = Color.DarkRed
                Opciones_UDP_LEstado.Invalidate()
                PanelOpciones.Visible = True
                PanelComandos.Visible = False
                PanelKBoard1.Visible = False
                PanelKBoard2.Visible = False
                KBoard_LTeclado.Visible = False
                PanelQuickMenu.Visible = False
                BPanelOpciones.ForeColor1 = Color.FromArgb(205, 150, 0)
                BPanelComandos.ForeColor1 = Color.FromArgb(102, 102, 102)
                BPanelKBoard.ForeColor1 = Color.FromArgb(102, 102, 102)
                BPanelQuickMenu.ForeColor1 = Color.FromArgb(102, 102, 102)
                Lista.Height = 590
        End Select
    End Sub

#Region " Help "

    Private Sub Comandos_LHelp_Click(sender As Object, e As MouseEventArgs) Handles LHelp.Click, LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If PanelComandos.Visible = True Then FAyuda.Current_Help = "Comandos" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
        If PanelKBoard1.Visible = True Then FAyuda.Current_Help = "K-Board" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
        If PanelQuickMenu.Visible = True Then FAyuda.Current_Help = "QuickMenu" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
        If PanelOpciones.Visible = True Then FAyuda.Current_Help = "Opciones" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub Comandos_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles LHelp.MouseEnter
        LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub Comandos_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles LHelp.MouseLeave
        LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#End Region

#Region " Panel Comandos "

    'Comandos

#Region " Mostrar Comando "

    Private Sub Comando_Mostrar(ComandoID As String, Optional MostrarAccion As Integer = 0, Optional Forzar As Boolean = False)
        If GMacro_Grabando = True And ComandoID <> ComandoActualID Then
            If ShowMessageBox("¿Cancelar grabación de macro?", Version, MsgBoxStyle.YesNo, "YesNo") = DialogResult.Cancel Then
                Lista_SelectByID(ComandoActualID) : ComandoActualID = "Cancel" + ComandoActualID : Exit Sub
            Else
                GMacro_Grabando = False : GMacro_PGrabar.Image = My.Resources.Macro_GrabarNo_Off : CargarMacro()
            End If
        ElseIf GMacro_Grabando = True Then : Exit Sub
        End If
        Comandos_Update = True
        If ComandoID = "-2" Then ComandoID = "-1" : Lista.SelectItem(-1) : Lista.EnsureVisibleAt(-1)
        If ComandoID = "-1" And Comandos_ComandoNegativo = False Then
            ComandoActualID = ComandoID
            Comandos_IndiceActual = -1 : Comandos_ComandoNegativo = True
            Comandos_Nombre_TNombre.Text = "" : Comandos_Nombre_TNombre.Tag = "" : Comandos_Sonido_TSonido.Text = ""
            Comandos_Sonido_TSonido.Text = "Sin Sonido" : Comandos_Sonido_LCSonido.Text = "Sin Sonido"
            Comandos_Hotkey_THotkey.Text = "" : Comandos_Procesos_LCProcesos.Text = "" : Comandos_Hotkey_ListaHotkey.Clear() : Comandos_Procesos_CProceso.Items.Clear() : Comandos_Accion_ListaAccion.Clear()
            Comandos_EjecutarIniciar_CEjecutarIniciar.Checked = False
            Comandos_EjecutarSalir_CEjecutarSalir.Checked = False
            Comandos_EjecutarSiempre_CEjecutarSiempre.Checked = False
            Comandos_EjecutarSiempre_CEjecutarSiempre.Enabled = True
            Comandos_EjecutarSiempre_LEjecutarSiempre.Enabled = True
            Comandos_Deshabilitar_CDeshabilitar.Checked = False
            Comandos_BloquearPulsacion_CBloquearPulsacion.Checked = False
            Comandos_POculto.Image = My.Resources.Ocultar_Mostrado_Off : Comandos_POculto.Tag = "Mostrar"
            Comandos_Procesos_CProceso.Items.Clear() : Comandos_Procesos_TProceso.Text = "" : Comandos_Procesos_LCProcesos.Text = "Seleccione una aplicación"
            Comandos_Accion_ListaAccion.Clear()
            ReDim Comandos_Accion_AccionesTemporales(0)
            If PLogo.Visible = False Then OcultarPaneles() : PLogo.Visible = True
        ElseIf ComandoID = "-1" And Comandos_ComandoNegativo = True Then : ComandoActualID = ComandoID : Comandos_Update = False : Exit Sub
        Else
            If ComandoActualID = "Negativo" Then
                Dim Avisar As Boolean
                If Comandos_Sonido_TSonido.Text <> "Sin Sonido" Then Avisar = True
                If Comandos_EjecutarIniciar_CEjecutarIniciar.Checked <> False Then Avisar = True
                If Comandos_EjecutarSalir_CEjecutarSalir.Checked <> False Then Avisar = True
                If Comandos_EjecutarSiempre_CEjecutarSiempre.Checked <> False Then Avisar = True
                If Comandos_Deshabilitar_CDeshabilitar.Checked <> False Then Avisar = True
                If Comandos_BloquearPulsacion_CBloquearPulsacion.Checked <> False Then Avisar = True
                If Comandos_Hotkey_ListaHotkey.Items.Count > 0 Then Avisar = True
                If Comandos_Procesos_CProceso.Items.Count > 0 Then Avisar = True
                If Comandos_Accion_ListaAccion.Items.Count > 0 Then Avisar = True
                If Avisar = True Then
                    If ShowMessageBox("¿Descartar Comando?", Version, MsgBoxStyle.YesNo, "Descartar") = DialogResult.Cancel Then
                        Comandos_ComandoNegativo = True : Lista.SelectItem(-1) : ComandoID = "-1" : ExitHotKey() : Comandos_Update = False : Exit Sub
                    Else
                        For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
                            If Comandos_Accion_ListaAccion.Items(Cuenta).Text = "Macros" AndAlso IO.File.Exists(KobaPath + "MACROs\" + Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 + ".mcr") = True Then IO.File.Delete(KobaPath + "MACROs\" + Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 + ".mcr")
                            If Comandos_Accion_ListaAccion.Items(Cuenta).Text = "Ejecutar BAT" AndAlso IO.File.Exists(KobaPath + "BATs\" + Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 + ".bat") = True Then IO.File.Delete(KobaPath + "BATs\" + Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 + ".bat")
                        Next : ExitHotKey()
                    End If
                End If
            End If
            If Forzar = False AndAlso ComandoActualID = ComandoID Then Comandos_Update = False : Exit Sub Else If ListaKeyDownPressed = True AndAlso PLogo.Visible = False Then OcultarPaneles() : PLogo.Visible = True
            ReDim Comandos_Accion_AccionesTemporales(0) : ComandoActualID = ComandoID : Comandos_ComandoNegativo = False
            Dim Indice As Integer = Comandos_GetByID(ComandoID)
            If Indice = -1 Then
                Comandos_ComandoNegativo = True
                Comandos_Nombre_TNombre.Text = "" : Comandos_Nombre_TNombre.Tag = "" : Comandos_Sonido_TSonido.Text = ""
                Comandos_Sonido_TSonido.Text = "Sin Sonido" : Comandos_Sonido_LCSonido.Text = "Sin Sonido"
                Comandos_Hotkey_THotkey.Text = "" : Comandos_Procesos_LCProcesos.Text = "" : Comandos_Hotkey_ListaHotkey.Clear() : Comandos_Procesos_CProceso.Items.Clear() : Comandos_Accion_ListaAccion.Clear()
                Comandos_EjecutarIniciar_CEjecutarIniciar.Checked = False
                Comandos_EjecutarSalir_CEjecutarSalir.Checked = False
                Comandos_EjecutarSiempre_CEjecutarSiempre.Checked = False
                Comandos_Deshabilitar_CDeshabilitar.Checked = False
                Comandos_BloquearPulsacion_CBloquearPulsacion.Checked = False
                Comandos_POculto.Image = My.Resources.Ocultar_Mostrado_Off : Comandos_POculto.Tag = "Mostrar"
                Comandos_Procesos_CProceso.Items.Clear() : Comandos_Procesos_TProceso.Text = "" : Comandos_Procesos_LCProcesos.Text = "Seleccione una aplicación"
                ReDim Comandos_Accion_AccionesTemporales(0)
                If PLogo.Visible = False Then OcultarPaneles() : PLogo.Visible = True
                Comandos_Update = False
                Exit Sub
            End If
            Comandos_Nombre_TNombre.Text = "" : Comandos_Nombre_TNombre.Tag = "" : Comandos_Sonido_TSonido.Text = ""
            Comandos_Nombre_TNombre.Text = Comandos(Indice).Nombre : Comandos_Nombre_TNombre.Tag = Comandos(Indice).Nombre
            Comandos_Sonido_TSonido.Text = Comandos(Indice).Sonido : If Comandos_Sonido_TSonido.Text = "" Then Comandos_Sonido_TSonido.Text = "Sin Sonido"
            Comandos_Sonido_LCSonido.Text = Comandos(Indice).Sonido : If Comandos_Sonido_LCSonido.Text = "" Then Comandos_Sonido_LCSonido.Text = "Sin Sonido"
            Comandos_Hotkey_THotkey.Text = "" : Comandos_Procesos_LCProcesos.Text = ""
            Comandos_EjecutarIniciar_CEjecutarIniciar.Checked = Comandos(Indice).EjecutarIniciar
            Comandos_EjecutarSalir_CEjecutarSalir.Checked = Comandos(Indice).EjecutarSalir
            Comandos_EjecutarSiempre_CEjecutarSiempre.Checked = Comandos(Indice).EjecutarSiempre
            Comandos_Deshabilitar_CDeshabilitar.Checked = Comandos(Indice).Deshabilitar
            Comandos_BloquearPulsacion_CBloquearPulsacion.Checked = Comandos(Indice).BloquearPulsacion
            If Comandos(Indice).Oculto = True Then Comandos_POculto.Image = My.Resources.Ocultar_Oculto_Off : Comandos_POculto.Tag = "Oculto" Else Comandos_POculto.Image = My.Resources.Ocultar_Mostrado_Off : Comandos_POculto.Tag = "Mostrar"
            If Comandos(Indice).Deshabilitar = True Then
                Comandos_EjecutarSiempre_LEjecutarSiempre.Enabled = False
                Comandos_EjecutarSiempre_CEjecutarSiempre.Enabled = False
            Else
                Comandos_EjecutarSiempre_LEjecutarSiempre.Enabled = True
                Comandos_EjecutarSiempre_CEjecutarSiempre.Enabled = True
            End If
            Comandos_Hotkey_ListaHotkey.Clear()
            For Cuenta = 0 To Comandos(Indice).Hotkey.Length - 1
                If Comandos(Indice).Hotkey(Cuenta) <> "" Then Comandos_Hotkey_ListaHotkey.AddItem(Comandos(Indice).Hotkey(Cuenta), Cuenta)
            Next
            Comandos_Procesos_CProceso.Items.Clear()
            For Cuenta = 0 To Comandos(Indice).Procesos.Length - 1
                If Comandos(Indice).Procesos(Cuenta) <> "" Then Comandos_Procesos_CProceso.Items.Add(Comandos(Indice).Procesos(Cuenta))
            Next
            If Comandos_Procesos_CProceso.Items.Count > 0 Then
                Comandos_Procesos_CProceso.SelectedItem = 0
                Comandos_Procesos_TProceso.Text = Comandos_Procesos_CProceso.Items(0)
                Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text
            Else
                Comandos_Procesos_TProceso.Text = ""
                Comandos_Procesos_LCProcesos.Text = "Seleccione una aplicación"
            End If
            Comandos_Accion_ListaAccion.Clear() : For Cuenta = 0 To Comandos(Indice).Accion.Length - 1
                For Cuenta2 = 0 To Comandos(Indice).Accion.Length - 1
                    If Comandos(Indice).Accion(Cuenta2).ID <> "" And Comandos(Indice).Accion(Cuenta2).Indice = Cuenta Then
                        Comandos_Accion_ListaAccion.AddItem(Comandos(Indice).Accion(Cuenta2).Tipo, Cuenta2)
                        Comandos_Accion_ListaAccion.Items(Comandos_Accion_ListaAccion.Items.Length - 1).Tag2 = Comandos(Indice).Accion(Cuenta2).ID
                        Exit For
                    End If
                Next
            Next
            For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
                Comandos_Accion_ListaAccion.Items(Cuenta).Image = Iconos.DefaultIcon(Comandos(Comandos_GetByID(ComandoActualID)).ID, Cuenta, True)
            Next
            If MostrarAccion > -1 AndAlso Comandos_Accion_ListaAccion.Items.Length > 0 AndAlso ListaKeyDownPressed = False Then
                Comandos_Accion_ListaAccion.SelectItem(MostrarAccion)
                Comandos_Accion_ListaAccion.EnsureVisibleAt(MostrarAccion)
            End If
            If Comandos_Accion_ListaAccion.Items.Count = 0 Then OcultarPaneles() : PLogo.Visible = True
        End If : Comandos_Update = False
    End Sub

#End Region

#Region " Nuevo Comando "

    Private Sub Comando_Nuevo()
        If ComandoActualID = "Negativo" Then
            Dim Avisar As Boolean
            If Comandos_Sonido_TSonido.Text <> "Sin Sonido" Then Avisar = True
            If Comandos_EjecutarIniciar_CEjecutarIniciar.Checked <> False Then Avisar = True
            If Comandos_EjecutarSalir_CEjecutarSalir.Checked <> False Then Avisar = True
            If Comandos_EjecutarSiempre_CEjecutarSiempre.Checked <> False Then Avisar = True
            If Comandos_Deshabilitar_CDeshabilitar.Checked <> False Then Avisar = True
            If Comandos_BloquearPulsacion_CBloquearPulsacion.Checked <> False Then Avisar = True
            If Comandos_Hotkey_ListaHotkey.Items.Count > 0 Then Avisar = True
            If Comandos_Procesos_CProceso.Items.Count > 0 Then Avisar = True
            If Comandos_Accion_ListaAccion.Items.Count > 0 Then Avisar = True
            If Avisar = True Then
                If ShowMessageBox("¿Descartar Comando?", Version, MsgBoxStyle.YesNo, "Descartar") = DialogResult.Cancel Then
                    Comandos_ComandoNegativo = True : Lista.SelectItem(-1) : ExitHotKey() : Comandos_Update = False : Exit Sub
                Else
                    For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
                        If Comandos_Accion_ListaAccion.Items(Cuenta).Text = "Macros" AndAlso IO.File.Exists(KobaPath + "MACROs\" + Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 + ".mcr") = True Then IO.File.Delete(KobaPath + "MACROs\" + Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 + ".mcr")
                        If Comandos_Accion_ListaAccion.Items(Cuenta).Text = "Ejecutar BAT" AndAlso IO.File.Exists(KobaPath + "BATs\" + Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 + ".bat") = True Then IO.File.Delete(KobaPath + "BATs\" + Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 + ".bat")
                    Next : ExitHotKey()
                End If
            End If
        End If
        If Comandos IsNot Nothing Then ReDim Preserve Comandos(Comandos.Length) Else ReDim Comandos(0)
        Comandos(Comandos.Length - 1).Nombre = "Nuevo Comando"
        Comandos(Comandos.Length - 1).ID = Now.ToString("ddMMyyyyHHmmss")
        Comandos(Comandos.Length - 1).Sonido = "Sin Sonido"
        ReDim Comandos(Comandos.Length - 1).Accion(0)
        ReDim Comandos(Comandos.Length - 1).Hotkey(0) : Comandos(Comandos.Length - 1).Hotkey(0) = ""
        ReDim Comandos(Comandos.Length - 1).Procesos(0) : Comandos(Comandos.Length - 1).Procesos(0) = ""
        ComandoActualID = "NUEVO"

        NuevoComandoIgnorar = 0
        If Lista.Columns(0).Text = "COMANDOS" Or Lista.Columns(0).Text = "COMANDOS (TODOS)" Then Lista.AddItem("Nuevo Comando", Comandos.Length - 1)
        For Cuenta = 0 To Lista.Items.Count - 1
            If CInt(Lista.Items(Cuenta).Tag) = Comandos.Length - 1 Then Lista.SelectItem(Cuenta) : Lista.EnsureVisibleAt(Cuenta) : GoTo Salta
        Next
        Lista.SelectItem(-1)
        Comando_Mostrar(Comandos(Comandos.Length - 1).ID)
Salta:  Comando_GuardarTodo(Comandos.Length - 1, False)
        QuickMenu_Editor_ZOrder = False : QuickMenu_Editor.Close() : PanelComandos.Visible = True : PanelKBoard1.Visible = False : PanelKBoard2.Visible = False : PanelQuickMenu.Visible = False : PanelOpciones.Visible = False : Lista.Height = 590
        BPanelComandos.ForeColor1 = Color.FromArgb(205, 150, 0) : BPanelKBoard.ForeColor1 = Color.FromArgb(102, 102, 102) : BPanelQuickMenu.ForeColor1 = Color.FromArgb(102, 102, 102) : BPanelOpciones.ForeColor1 = Color.FromArgb(102, 102, 102)
        Comandos_Nombre_TNombre.Focus() : Comandos_Nombre_TNombre.SelectionStart = 0 : Comandos_Nombre_TNombre.SelectionLength = Comandos_Nombre_TNombre.Text.Length
        Estadisticas.Estadisticas.Comandos_Creados += 1 : Estadisticas.Guardar()
    End Sub

#End Region

#Region " Guardar Comando "

    Private Sub Comando_GuardarValor(Nombre As String, Optional IndiceID As Integer = -1, Optional Ordenar As Boolean = True)
        If Comandos_Update = True Then Exit Sub
        If IndiceID = -1 Then IndiceID = Comandos_GetByID(ComandoActualID)
        If IndiceID = -1 Then Exit Sub
        If Comandos(IndiceID).Nombre Is Nothing Then Exit Sub
        Select Case Nombre
            Case "Nombre" : Comando_GuardarTodo(IndiceID, Ordenar)
            Case "Sonido" : Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Sonido", Comandos(IndiceID).Sonido)
            Case "Hotkey"
                Dim Hotkeys As String = "" : For Cuenta = 0 To Comandos(IndiceID).Hotkey.Length - 1
                    If Comandos(IndiceID).Hotkey(Cuenta) <> "" Then Hotkeys += "|-|" + Comandos(IndiceID).Hotkey(Cuenta) Else Hotkeys = Comandos(IndiceID).Hotkey(Cuenta)
                Next : If Hotkeys.StartsWith("|-|") = True Then Hotkeys = Hotkeys.Substring(3)
                Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Hotkey", Hotkeys)
            Case "Procesos"
                Dim Procesos As String = "" : For Cuenta = 0 To Comandos(IndiceID).Procesos.Length - 1
                    If Comandos(IndiceID).Procesos(Cuenta) <> "" Then Procesos += "|-|" + Comandos(IndiceID).Procesos(Cuenta) Else Procesos = Comandos(IndiceID).Procesos(Cuenta)
                Next : If Procesos.StartsWith("|-|") = True Then Procesos = Procesos.Substring(3)
                Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Procesos", Procesos)
            Case "Acciones" : Accion_Guardar()
            Case "EjecutarIniciar" : Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "EjecutarIniciar", Comandos(IndiceID).EjecutarIniciar.ToString)
            Case "EjecutarSalir" : Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "EjecutarSalir", Comandos(IndiceID).EjecutarSalir.ToString)
            Case "EjecutarSiempre" : Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "EjecutarSiempre", Comandos(IndiceID).EjecutarSiempre.ToString)
            Case "Deshabilitar" : Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Deshabilitar", Comandos(IndiceID).Deshabilitar.ToString)
            Case "BloquearPulsacion" : Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "BloquearPulsacion", Comandos(IndiceID).BloquearPulsacion.ToString)
            Case "Oculto" : Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Oculto", Comandos(IndiceID).Oculto.ToString)
            Case "Icono" : Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Icono", Comandos(IndiceID).CustomIcono)
        End Select
    End Sub

    Private Sub Comando_GuardarTodo(IndiceID As Integer, Optional Ordenar As Boolean = True)
        If Comandos_Update = True Then Exit Sub
        If IndiceID = -1 Then IndiceID = Comandos_GetByID(ComandoActualID)
        If IndiceID = -1 Then Exit Sub
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Nombre", Comandos(IndiceID).Nombre)
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Sonido", Comandos(IndiceID).Sonido)
        Dim Hotkeys As String = "" : For Cuenta = 0 To Comandos(IndiceID).Hotkey.Length - 1
            If Comandos(IndiceID).Hotkey(Cuenta) <> "" Then Hotkeys += "|-|" + Comandos(IndiceID).Hotkey(Cuenta) Else Hotkeys = Comandos(IndiceID).Hotkey(Cuenta)
        Next : If Hotkeys.StartsWith("|-|") = True Then Hotkeys = Hotkeys.Substring(3)
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Hotkey", Hotkeys)
        Dim Procesos As String = "" : For Cuenta = 0 To Comandos(IndiceID).Procesos.Length - 1
            If Comandos(IndiceID).Procesos(Cuenta) <> "" Then Procesos += "|-|" + Comandos(IndiceID).Procesos(Cuenta) Else Procesos = Comandos(IndiceID).Procesos(Cuenta)
        Next : If Procesos.StartsWith("|-|") = True Then Procesos = Procesos.Substring(3)
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Procesos", Procesos)
        Accion_Guardar(IndiceID)
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "EjecutarIniciar", Comandos(IndiceID).EjecutarIniciar.ToString)
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "EjecutarSalir", Comandos(IndiceID).EjecutarSalir.ToString)
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "EjecutarSiempre", Comandos(IndiceID).EjecutarSiempre.ToString)
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Deshabilitar", Comandos(IndiceID).Deshabilitar.ToString)
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "BloquearPulsacion", Comandos(IndiceID).BloquearPulsacion.ToString)
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Oculto", Comandos(IndiceID).Oculto.ToString)
        If Comandos(IndiceID).CustomIcono Is Nothing Then Comandos(IndiceID).CustomIcono = ""
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID, "Icono", Comandos(IndiceID).CustomIcono)
        If Ordenar = True Then Lista_Update()
    End Sub

#End Region

    'Acciones

#Region " Mostrar Accion "

    Private Sub Accion_Mostrar(Indice As Integer)
        If GPaginaWeb_GNavegadores.Visible = True Then GPaginaWeb_GNavegadores.Visible = False
        If GMacro_Grabando = True And Indice <> CurrentAccionIndex Then
            If ShowMessageBox("¿Cancelar grabación de macro?", Version, MsgBoxStyle.YesNo, "YesNo") = DialogResult.Cancel Then
                Comandos_Accion_ListaAccion.SelectItem(CurrentAccionIndex) : Comandos_Accion_ListaAccion.EnsureVisibleAt(CurrentAccionIndex) : Exit Sub
            Else
                GMacro_Grabando = False : GMacro_PGrabar.Image = My.Resources.Macro_GrabarNo_Off : CargarMacro() : CancelDrop = True
            End If
        ElseIf GMacro_Grabando = True Then
            Exit Sub
        End If
        If Comandos_Accion_ListaAccion.SelectedIndex.Count > 0 Then CurrentAccionIndex = Comandos_Accion_ListaAccion.SelectedIndex(0) Else CurrentAccionIndex = -1
        If Indice = -1 Then OcultarPaneles() : PLogo.Visible = True : Exit Sub
        Accion_Update = True
        Dim IndiceComando = Comandos_GetByID(ComandoActualID) : If IndiceComando = -1 Then ComandoActualID = "Negativo"
        Dim Tipo As String : If ComandoActualID = "Negativo" Then Tipo = Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Tipo Else Tipo = Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Tipo
        Dim Accion_ID As String : If ComandoActualID = "Negativo" Then Accion_ID = Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).ID Else Accion_ID = Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).ID
        Select Case Tipo
            'Aplicaciones
            Case "Ejecutar Aplicacion"
                Thread_EjecutarAplicacion_Info = New Threading.Thread(AddressOf Accion_Info)
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                GEjecutarAplicacion_CAdmin.Checked = CBool(Settings(6))
                GEjecutarAplicacion_CTopMost.Checked = CBool(Settings(5))
                GEjecutarAplicacion_TRuta.Tag = Settings(0) : GEjecutarAplicacion_TRuta.Text = GEjecutarAplicacion_TRuta.Tag : ValidarAccion()
                GEjecutarAplicacion_TParametros.Text = Settings(1)
                GEjecutarAplicacion_TIniciarEn.Tag = Settings(2)
                If GEjecutarAplicacion_TIniciarEn.Tag = "" Then GEjecutarAplicacion_TIniciarEn.Text = "Por Defecto" Else GEjecutarAplicacion_TIniciarEn.Text = (Rutas.Acortar_Ruta(GEjecutarAplicacion_TIniciarEn.Tag, GEjecutarAplicacion_TIniciarEn) + "\").Replace("\\", "\")
                If GEjecutarAplicacion_TIniciarEn.Text.EndsWith("\") And GEjecutarAplicacion_TIniciarEn.Text.Length > 3 Then GEjecutarAplicacion_TIniciarEn.Text = GEjecutarAplicacion_TIniciarEn.Text.Substring(0, GEjecutarAplicacion_TIniciarEn.Text.Length - 1)
                GEjecutarAplicacion_TModo.Text = Settings(3)
                GEjecutarAplicacion_TPrioridad.Text = Settings(4)
                GEjecutarAplicacion_CheckControls()
                If GEjecutarAplicacion.Visible = False Then OcultarPaneles() : GEjecutarAplicacion.Visible = True
            Case "Abrir Carpeta"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                GAbrirCarpeta_TRuta.Tag = Settings(0) : GAbrirCarpeta_TRuta.Text = GAbrirCarpeta_TRuta.Tag : GAbrirCarpeta_TRuta_LostFocus(Nothing, Nothing)
                If GAbrirCarpeta.Visible = False Then OcultarPaneles() : GAbrirCarpeta.Visible = True
            Case "Pagina Web"
                Thread_PaginaWeb_Info = New Threading.Thread(AddressOf PaginaWeb_Info)
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                GPaginaWeb_CNuevaVentana.Checked = CBool(Settings(2))
                GPaginaWeb_CVentanaIncognito.Checked = CBool(Settings(3))
                GPaginaWeb_CAdmin.Checked = CBool(Settings(4))
                GPaginaWeb_TURL.Text = Internet.ValidarWeb(Settings(0))
                PaginaWeb_Info(GPaginaWeb_TURL.Text)
                GPaginaWeb_PNavegador.Tag = Settings(1)
                GetInstalledBrowsers()
                If GPaginaWeb_PNavegador.Tag = "" Then GPaginaWeb_PNavegador.Tag = GetDefaultBrowser()
                Select Case GPaginaWeb_PNavegador.Tag.ToString.ToLower
                    Case "microsoft edge"
                        GPaginaWeb_CNuevaVentana.Checked = False : GPaginaWeb_CNuevaVentana.Enabled = False : GPaginaWeb_LNuevaVentana.Enabled = False
                        GPaginaWeb_CVentanaIncognito.Checked = False : GPaginaWeb_CVentanaIncognito.Enabled = False : GPaginaWeb_LVentanaIncognito.Enabled = False
                    Case Else
                        GPaginaWeb_CNuevaVentana.Enabled = True : GPaginaWeb_LNuevaVentana.Enabled = True
                        GPaginaWeb_CVentanaIncognito.Enabled = True : GPaginaWeb_LVentanaIncognito.Enabled = True
                End Select
                Select Case GPaginaWeb_PNavegador.Tag.ToString.ToLower
                    Case "google chrome" : GPaginaWeb_PNavegador.Image = My.Resources.Navegador_Chrome.ToBitmap
                    Case "mozilla firefox" : GPaginaWeb_PNavegador.Image = My.Resources.Navegador_Firefox.ToBitmap
                    Case "microsoft edge" : GPaginaWeb_PNavegador.Image = My.Resources.Navegador_Edge.ToBitmap
                    Case "opera" : GPaginaWeb_PNavegador.Image = My.Resources.Navegador_Opera.ToBitmap
                    Case "vivaldi" : GPaginaWeb_PNavegador.Image = My.Resources.Navegador_Vivaldi.ToBitmap
                    Case "uc browser" : GPaginaWeb_PNavegador.Image = My.Resources.Navegador_UCBrowser.ToBitmap
                    Case "brave" : GPaginaWeb_PNavegador.Image = My.Resources.Navegador_Brave.ToBitmap
                    Case Else
                        GPaginaWeb_PNavegador.Tag = GetDefaultBrowser() : GPaginaWeb_PNavegador.Image = My.Resources.Navegador_Browser.ToBitmap
                        Select Case GPaginaWeb_PNavegador.Tag.ToString.ToLower
                            Case "microsoft edge"
                                GPaginaWeb_CNuevaVentana.Checked = False : GPaginaWeb_CNuevaVentana.Enabled = False : GPaginaWeb_LNuevaVentana.Enabled = False
                                GPaginaWeb_CVentanaIncognito.Checked = False : GPaginaWeb_CVentanaIncognito.Enabled = False : GPaginaWeb_LVentanaIncognito.Enabled = False
                            Case Else
                                GPaginaWeb_CNuevaVentana.Enabled = True : GPaginaWeb_LNuevaVentana.Enabled = True
                                GPaginaWeb_CVentanaIncognito.Enabled = True : GPaginaWeb_LVentanaIncognito.Enabled = True
                        End Select
                End Select : GPaginaWeb_PNavegador.Refresh()
                If GPaginaWeb.Visible = False Then OcultarPaneles() : GPaginaWeb.Visible = True
            Case "Aplicaciones"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                GAplicaciones_TAccion.Text = Settings(0) : GAplicaciones_LCAccion.Text = Settings(0)
                GAplicaciones_TAplicacion.Text = Settings(1) : If GAplicaciones_TAplicacion.Text.Trim = "" Then GAplicaciones_LCAplicacion.Text = "Seleccione una aplicación" : GAplicaciones_TAplicacion.ForeColor1 = Color.FromArgb(72, 72, 72) Else GAplicaciones_LCAplicacion.Text = GAplicaciones_TAplicacion.Text
                GAplicaciones_CEsperar.Checked = CBool(Settings(2))
                Select Case Settings(3)
                    Case "Activar" : GAplicaciones_Esperar_CActivar.Checked = True
                    Case "Abrir" : GAplicaciones_Esperar_CAbrir.Checked = True
                    Case "Cerrar" : GAplicaciones_Esperar_CCerrar.Checked = True
                    Case Else : GAplicaciones_Esperar_CActivar.Checked = True
                End Select
                If GAplicaciones.Visible = False Then OcultarPaneles() : GAplicaciones.Visible = True
            Case "Ejecutar BAT"
                GEjecutarBAT_TTexto.Text = "" : GEjecutarBAT_TTexto.Tag = ""
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                GEjecutarBAT_CAdministrador.Checked = Settings(3)
                GEjecutarBAT_TModo.Text = Settings(2) : If GEjecutarBAT_TModo.Text = "" Then GEjecutarBAT_TModo.Text = "Normal"
                If Settings(0) = "" Then GEjecutarBAT_TNombre.Text = "Sin Nombre" Else GEjecutarBAT_TNombre.Text = Settings(0)
                GEjecutarBAT_TTexto.Tag = Settings(1)
                If IO.File.Exists(GEjecutarBAT_TTexto.Tag.ToString) = True Then Dim Leer As New IO.StreamReader(GEjecutarBAT_TTexto.Tag.ToString) : GEjecutarBAT_TTexto.Text = Leer.ReadToEnd : Leer.Close()
                Guardar_BAT_KDesktop(GEjecutarBAT_TTexto.Tag.ToString)
                If GEjecutarBAT.Visible = False Then OcultarPaneles() : GEjecutarBAT.Visible = True
            'Audio y Video
            Case "Capturar Pantalla"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                If Settings(1).Trim = "" Then Settings(1) = "0" : If Settings(2).Trim = "" Then Settings(2) = "sec"
                If Settings(0) = "Sin Sonido" Or Settings(0) = "" Then GCapturaPantalla_TSonido.Text = "Sin Sonido" : GCapturaPantalla_LCSonido.Text = "Sin Sonido" Else GCapturaPantalla_TSonido.Text = Settings(0) : GCapturaPantalla_LCSonido.Text = Settings(0)
                GCapturaPantalla_TDuracion.Text = Settings(1) : GCapturaPantalla_LFormato.Value2 = Settings(2)
                GCapturaPantalla_CCuentaAtras.Checked = CBool(Settings(3))
                GCapturaPantalla_COSD.Checked = CBool(Settings(4)) : GCapturaPantalla_BOSD.Enabled = GCapturaPantalla_COSD.Checked
                GCapturaPantalla_OSD_Fuente = String_to_Font(Settings(5)) : GCapturaPantalla_OSD_Color = String_to_Color(Settings(6))
                GCapturaPantalla_BOSD.ForeColor1 = GCapturaPantalla_OSD_Color : GCapturaPantalla_BOSD.ForeColor3 = GCapturaPantalla_OSD_Color
                If GCapturaPantalla_COSD.Checked = True Then GCapturaPantalla_CCuentaAtras.Enabled = True : GCapturaPantalla_LCuentaAtras.Enabled = True Else GCapturaPantalla_CCuentaAtras.Enabled = False : GCapturaPantalla_LCuentaAtras.Enabled = False
                If GCapturaPantalla.Visible = False Then OcultarPaneles() : GCapturaPantalla.Visible = True
            Case "Grabar Pantalla (On/Off)"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                If Settings(6).Trim = "" Then Settings(6) = "0" : If Settings(5).Trim = "" Then Settings(7) = "sec"
                If Settings(5) = "Sin Sonido" Or Settings(5) = "" Then GGrabacionPantalla_TSonido.Text = "Sin Sonido" : GGrabacionPantalla_LCSonido.Text = "Sin Sonido" Else GGrabacionPantalla_TSonido.Text = Settings(5) : GGrabacionPantalla_LCSonido.Text = Settings(5)
                GGrabacionPantalla_TDuracion.Text = Settings(6) : GGrabacionPantalla_LFormato.Value2 = Settings(7)
                GGrabacionPantalla_CDesktopDuplication.Checked = CBool(Settings(1))
                GGrabacionPantalla_CGSonido.Checked = CBool(Settings(2))
                GGrabacionPantalla_CGMicrofono.Checked = CBool(Settings(3))
                GGrabacionPantalla_CMarcarClicks.Checked = CBool(Settings(4))
                GGrabacionPantalla_CCuentaAtras.Checked = CBool(Settings(8))
                GGrabacionPantalla_COSD.Checked = CBool(Settings(9)) : GGrabacionPantalla_BOSD.Enabled = GGrabacionPantalla_COSD.Checked
                GGrabacionPantalla_OSD_Fuente = String_to_Font(Settings(10)) : GGrabacionPantalla_OSD_Color = String_to_Color(Settings(11))
                GGrabacionPantalla_BOSD.ForeColor1 = GGrabacionPantalla_OSD_Color : GGrabacionPantalla_BOSD.ForeColor3 = GGrabacionPantalla_OSD_Color
                If GGrabacionPantalla_COSD.Checked = True Then GGrabacionPantalla_CCuentaAtras.Enabled = True : GGrabacionPantalla_LCuentaAtras.Enabled = True Else GGrabacionPantalla_CCuentaAtras.Enabled = False : GGrabacionPantalla_LCuentaAtras.Enabled = False

                GGrabacionPantalla_CPantalla2.Enabled = False : GGrabacionPantalla_LPantalla2.Enabled = False
                GGrabacionPantalla_CPantalla3.Enabled = False : GGrabacionPantalla_LPantalla3.Enabled = False
                GGrabacionPantalla_CPantalla4.Enabled = False : GGrabacionPantalla_LPantalla4.Enabled = False
                For Cuenta = 1 To Screen.AllScreens.Length
                    If Cuenta = 2 Then GGrabacionPantalla_CPantalla2.Enabled = True : GGrabacionPantalla_LPantalla2.Enabled = True
                    If Cuenta = 3 Then GGrabacionPantalla_CPantalla3.Enabled = True : GGrabacionPantalla_LPantalla3.Enabled = True
                    If Cuenta = 4 Then GGrabacionPantalla_CPantalla4.Enabled = True : GGrabacionPantalla_LPantalla4.Enabled = True
                Next

                If Settings(0) = "0" Then GGrabacionPantalla_CPantalla1.Checked = True
                If Settings(0) = "1" Then GGrabacionPantalla_CPantalla2.Checked = True
                If Settings(0) = "2" Then GGrabacionPantalla_CPantalla3.Checked = True
                If Settings(0) = "3" Then GGrabacionPantalla_CPantalla4.Checked = True
                If Settings(0) = "?" Then GGrabacionPantalla_CPreguntar.Checked = True

                If GGrabacionPantalla.Visible = False Then OcultarPaneles() : GGrabacionPantalla.Visible = True
            Case "Grabar Audio (On/Off)"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                If Settings(1).Trim = "" Then Settings(1) = "0" : If Settings(2).Trim = "" Then Settings(2) = "sec"
                If Settings(0) = "Sin Sonido" Or Settings(0) = "" Then GGrabacionAudio_TSonido.Text = "Sin Sonido" : GGrabacionAudio_LCSonido.Text = "Sin Sonido" Else GGrabacionAudio_TSonido.Text = Settings(0) : GGrabacionAudio_LCSonido.Text = Settings(0)
                GGrabacionAudio_TDuracion.Text = Settings(1) : GGrabacionAudio_LFormato.Value2 = Settings(2)
                GGrabacionAudio_CCuentaAtras.Checked = CBool(Settings(3))
                GGrabacionAudio_COSD.Checked = CBool(Settings(4)) : GGrabacionAudio_BOSD.Enabled = GGrabacionAudio_COSD.Checked
                GGrabacionAudio_OSD_Fuente = String_to_Font(Settings(5)) : GGrabacionAudio_OSD_Color = String_to_Color(Settings(6))
                GGrabacionAudio_BOSD.ForeColor1 = GGrabacionAudio_OSD_Color : GGrabacionAudio_BOSD.ForeColor3 = GGrabacionAudio_OSD_Color
                If GGrabacionAudio_COSD.Checked = True Then GGrabacionAudio_CCuentaAtras.Enabled = True : GGrabacionAudio_LCuentaAtras.Enabled = True Else GGrabacionAudio_CCuentaAtras.Enabled = False : GGrabacionAudio_LCuentaAtras.Enabled = False
                If GGrabacionAudio.Visible = False Then OcultarPaneles() : GGrabacionAudio.Visible = True
            Case "Reproducir Sonido"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                If Settings(0) = "Sin Sonido" Or Settings(0) = "" Then GReproducirSonido_TSonido.Text = "Sin Sonido" : GReproducirSonido_LCSonido.Text = "Sin Sonido" Else GReproducirSonido_TSonido.Text = Settings(0) : GReproducirSonido_LCSonido.Text = Settings(0)
                GReproducirSonido_CEsperar.Checked = CBool(Settings(1))
                If GReproducirSonido.Visible = False Then OcultarPaneles() : GReproducirSonido.Visible = True
            Case "Salida de Audio"
                GSalidaAudio_SinInformacion.Visible = True
                GSalidaAudio_LNombre.Text = "" : GSalidaAudio_LNombre.Invalidate()
                GSalidaAudio_LHardware.Text = "" : GSalidaAudio_LHardware.Invalidate()
                GSalidaAudio_LEstado.Text = "" : GSalidaAudio_LEstado.Invalidate()
                GSalidaAudio_LPredeterminado.Visible = False
                GSalidaAudio_LComunicaciones.Visible = False
                GSalidaAudio_PIcono.Image = Nothing : GSalidaAudio_PIcono.Invalidate()

                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                GSalidaAudio_OSD_Fuente = String_to_Font(Settings(2)) : GSalidaAudio_OSD_Color = String_to_Color(Settings(3))
                GRedAdHoc_OSD_Fuente = GRedAdHoc_OSD_Fuente : GSalidaAudio_BOSD.ForeColor1 = GSalidaAudio_OSD_Color : GSalidaAudio_BOSD.ForeColor3 = GSalidaAudio_OSD_Color
                GSalidaAudio_COSD.Checked = CBool(Settings(1)) : GSalidaAudio_BOSD.Enabled = GSalidaAudio_COSD.Checked

                GSalidaAudio_ListaDisponibles.Clear()
                If Audio.AudioDevices IsNot Nothing Then
                    For Cuenta = 0 To Audio.AudioDevices.Length - 1
                        If Audio.AudioDevices(Cuenta).ID IsNot Nothing OrElse Audio.AudioDevices(Cuenta).ID <> "" Then
                            GSalidaAudio_ListaDisponibles.AddItem(Audio.AudioDevices(Cuenta).Name, Audio.AudioDevices(Cuenta).ID.ToString)
                            If Audio.AudioDevices(Cuenta).Multimedia = True Then GSalidaAudio_ListaDisponibles.Items(GSalidaAudio_ListaDisponibles.Items.Count - 1).Marked = True Else GSalidaAudio_ListaDisponibles.Items(GSalidaAudio_ListaDisponibles.Items.Count - 1).Marked = False
                        End If
                    Next
                End If

                GSalidaAudio_ListaSeleccionados.Clear()
                If Settings.Length > 4 Then
                    For Cuenta = 4 To Settings.Length - 1
                        Dim cAudioDevice As AudioAPI.AudioDeviceST
                        cAudioDevice = Audio.GetAudioDevice(Settings(Cuenta))
                        If cAudioDevice.ID <> "" Then
                            GSalidaAudio_ListaSeleccionados.AddItem(cAudioDevice.Name, cAudioDevice.ID.ToString)
                            If cAudioDevice.Multimedia = True Then GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.Items.Count - 1).Marked = True Else GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.Items.Count - 1).Marked = False
                        End If
                    Next
                End If
                GSalidaAudio_ListaDisponibles.SelectItem(-1) : GSalidaAudio_ListaSeleccionados.SelectItem(-1)
                If Settings(0) = "Sin Sonido" Or Settings(0) = "" Then GSalidaAudio_TSonido.Text = "Sin Sonido" : GSalidaAudio_LCSonido.Text = "Sin Sonido" Else GSalidaAudio_TSonido.Text = Settings(0) : GSalidaAudio_LCSonido.Text = Settings(0)
                GSalidaAudio_ListaDisponibles.SelectItem(0)
                If GSalidaAudio.Visible = False Then OcultarPaneles() : GSalidaAudio.Visible = True
            Case "Volumen"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                GVolumen_CAccion.SelectedItem = Settings(0) : GVolumen_TIntervalo.Text = Settings(1)
                If GVolumen_TIntervalo.Text = "" Then GVolumen_TIntervalo.Text = "0"
                If GVolumen_TIntervalo.Text.Trim <> "" Then If CInt(GVolumen_TIntervalo.Text) > 100 Then GVolumen_TIntervalo.Text = "100"
                If GVolumen.Visible = False Then OcultarPaneles() : GVolumen.Visible = True
            'Utilidades
            Case "Macros"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                GMacro_CPausasEjecucion.Checked = CBool(Settings(0))
                GMacro_CEventosTeclado.Checked = CBool(Settings(1))
                GMacro_CClicsRaton.Checked = CBool(Settings(2))
                GMacro_CRuedaRaton.Checked = CBool(Settings(3))
                GMacro_CMovimientoRaton.Checked = CBool(Settings(4))
                GMacro_CClicks_Position.Checked = CBool(Settings(5))
                GMacro_CRepetir.Checked = CBool(Settings(6))
                GMacro_CEsperar.Checked = CBool(Settings(7))
                CargarMacro()
                If GMacro.Visible = False Then OcultarPaneles() : GMacro.Visible = True : GMacro_GAñadirMacro.Visible = False : GMacro_LAñadirMacro.Visible = False : GMacro_Separador2.Visible = False
            Case "K-Board"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                GKBoard_CAccion.SelectedIndex = 0
                GKBoard_TAccion.Text = Settings(0) : GKBoard_LCAccion.Text = Settings(0)

                GKBoard_CNombre.Items.Clear()
                If KBoards IsNot Nothing Then For Cuenta = 0 To KBoards.Length - 1 : GKBoard_CNombre.Items.Add(KBoards(Cuenta).Nombre) : Next
                If GKBoard_CNombre.Items.Count = 0 Then
                    GKBoard_CNombre.Enabled = False : GKBoard_PPreview.Visible = False : GKBoard_LCNombre.Text = "No hay K-Boards" : GKBoard_LCNombre.Cursor = DefaultCursor : GKBoard_TNombre.Cursor = DefaultCursor
                Else
                    GKBoard_CNombre.Enabled = True : GKBoard_PPreview.Visible = True : GKBoard_LCNombre.Cursor = Cursors.Hand : GKBoard_TNombre.Cursor = Cursors.Hand
                    If GKBoard_CNombre.Items.Contains(Settings(1)) = False Or Settings(1).Trim = "" Then GKBoard_LCNombre.Text = "Seleccione un K-Board" : GKBoard_PPreview.Visible = False Else GKBoard_LCNombre.Text = Settings(1) : GKBoard_PPreview.Visible = True
                End If
                GKBoard_COSD.Checked = CBool(Settings(2)) : GKBoard_BOSD.Enabled = GKBoard_COSD.Checked
                GKBoard_OSD_Fuente = String_to_Font(Settings(3)) : GKBoard_OSD_Color = String_to_Color(Settings(4))
                If GKBoard.Visible = False Then OcultarPaneles() : GKBoard.Visible = True
            Case "QuickMenu"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                GQuickMenu_CNombre.Items.Clear()
                If QuickMenus IsNot Nothing Then For Cuenta = 0 To QuickMenus.Length - 1 : GQuickMenu_CNombre.Items.Add(QuickMenus(Cuenta).Nombre) : Next
                If GQuickMenu_CNombre.Items.Count = 0 Then
                    GQuickMenu_CNombre.Enabled = False : GQuickMenu_PQuickMenu.Visible = False : GQuickMenu_LCNombre.Text = "No hay QuickMenus" : GQuickMenu_LCNombre.Cursor = DefaultCursor : GQuickMenu_TNombre.Cursor = DefaultCursor
                Else
                    GQuickMenu_CNombre.Enabled = True : GQuickMenu_PQuickMenu.Visible = True : GQuickMenu_LCNombre.Cursor = Cursors.Hand : GQuickMenu_TNombre.Cursor = Cursors.Hand
                    If GQuickMenu_CNombre.Items.Contains(Settings(0)) = False Or Settings(0).Trim = "" Then GQuickMenu_LCNombre.Text = "Seleccione un QuickMenu" : GQuickMenu_PQuickMenu.Visible = False Else GQuickMenu_LCNombre.Text = Settings(0) : GQuickMenu_PQuickMenu.Visible = True
                End If
                If GQuickMenu.Visible = False Then OcultarPaneles() : GQuickMenu.Visible = True
            Case "Red Ad-Hoc"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                GRedAdHoc_BCrearRed.Width = 118 : GRedAdHoc_BCerrarRed.Visible = False
                If Red_AdHoc_Soportada() = True Then
                    GRedAdHoc_LCSonido.Cursor = Cursors.Hand : GRedAdHoc_TSonido.Cursor = Cursors.Hand
                    GRedAdHoc_LNombre.Enabled = True : GRedAdHoc_TNombre.Enabled = True : GRedAdHoc_LContraseña.Enabled = True : GRedAdHoc_TContraseña.Enabled = True : GRedAdHoc_LOSD.Enabled = True : GRedAdHoc_COSD.Enabled = True
                    GRedAdHoc_LSonido.Enabled = True : GRedAdHoc_TSonido.Enabled = True : GRedAdHoc_LCSonido.Enabled = True : GRedAdHoc_CSonido.Enabled = True : GRedAdHoc_BPlay.Enabled = True : GRedAdHoc_BExaminar.Enabled = True : GRedAdHoc_BCrearRed.Enabled = True : GRedAdHoc_LNoSoportado.Visible = False
                    GRedAdHoc_BOSD.Enabled = CBool(Settings(3)) : GRedAdHoc_LNoSoportado.Visible = False : GRedAdHoc_TNombre.Text = Settings(0) : GRedAdHoc_TContraseña.Text = Settings(1)
                    If Red_AdHoc_Activa() = True Then GRedAdHoc_BCrearRed.Width = 96 : GRedAdHoc_BCrearRed.Text = "Modificar Red" : GRedAdHoc_BCerrarRed.Visible = True Else GRedAdHoc_BCrearRed.Width = 118 : GRedAdHoc_BCrearRed.Text = "Crear Red" : GRedAdHoc_BCerrarRed.Visible = False
                    If GRedAdHoc_TNombre.Text.Trim = "" Or GRedAdHoc_TContraseña.Text.Length < 8 Or GRedAdHoc_TNombre.Text.Length > 63 Then GRedAdHoc_BCrearRed.Enabled = False Else GRedAdHoc_BCrearRed.Enabled = True
                Else
                    GRedAdHoc_LCSonido.Cursor = Cursors.Default : GRedAdHoc_TSonido.Cursor = Cursors.Default
                    GRedAdHoc_TNombre.Text = Settings(0) : GRedAdHoc_TContraseña.Text = Settings(1)
                    GRedAdHoc_LNombre.Enabled = False : GRedAdHoc_TNombre.Enabled = False : GRedAdHoc_LContraseña.Enabled = False : GRedAdHoc_TContraseña.Enabled = False : GRedAdHoc_LOSD.Enabled = False : GRedAdHoc_COSD.Enabled = False
                    GRedAdHoc_LSonido.Enabled = False : GRedAdHoc_TSonido.Enabled = False : GRedAdHoc_LCSonido.Enabled = False : GRedAdHoc_CSonido.Enabled = False : GRedAdHoc_BPlay.Enabled = False : GRedAdHoc_BExaminar.Enabled = False : GRedAdHoc_BCrearRed.Enabled = False : GRedAdHoc_LNoSoportado.Visible = True
                    GRedAdHoc_BOSD.Enabled = False : GRedAdHoc_LNoSoportado.Visible = True : GRedAdHoc_BCrearRed.Width = 118 : GRedAdHoc_BCrearRed.Text = "Crear Red" : GRedAdHoc_BCerrarRed.Visible = False
                End If
                GRedAdHoc_COSD.Checked = CBool(Settings(3)) : GRedAdHoc_OSD_Fuente = String_to_Font(Settings(4)) : GRedAdHoc_OSD_Color = String_to_Color(Settings(5))
                GRedAdHoc_BOSD.ForeColor1 = GRedAdHoc_OSD_Color : GRedAdHoc_BOSD.ForeColor3 = GRedAdHoc_OSD_Color
                If Settings(2) = "Sin Sonido" Or Settings(2) = "" Then GRedAdHoc_TSonido.Text = "Sin Sonido" : GRedAdHoc_LCSonido.Text = "Sin Sonido" Else GRedAdHoc_TSonido.Text = Settings(2) : GRedAdHoc_LCSonido.Text = Settings(2)
                If GRedAdHoc.Visible = False Then OcultarPaneles() : GRedAdHoc.Visible = True
            'Acciones
            Case "Enviar Pulsación"
                GEnviarPulsacion_TTexto.Text = "" : GEnviarPulsacion_TPulsacion.Text = "" : GEnviarPulsacion_LCPulsacion.Text = "" : GEnviarPulsacion_TX.Text = "0" : GEnviarPulsacion_TX.Text = "0"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                GEnviarPulsacion_TAccion.Text = Settings(0) : GEnviarPulsacion_LCAccion.Text = Settings(0)
                If Settings(0) = "Enviar Pulsación" Then
                    GEnviarPulsacion_LTexto.Visible = False : GEnviarPulsacion_TTexto.Visible = False
                    GEnviarPulsacion_LPulsacion.Visible = True : GEnviarPulsacion_TPulsacion.Visible = True : GEnviarPulsacion_LCPulsacion.Visible = True : GEnviarPulsacion_CPulsacion.Visible = True : GEnviarPulsacion_PPulsacion.Visible = True
                    GEnviarPulsacion_LCTRL.Visible = True : GEnviarPulsacion_CCTRL.Visible = True
                    GEnviarPulsacion_LSHIFT.Visible = True : GEnviarPulsacion_CSHIFT.Visible = True
                    GEnviarPulsacion_LALT.Visible = True : GEnviarPulsacion_CALT.Visible = True
                    GEnviarPulsacion_LWIN.Visible = True : GEnviarPulsacion_CWin.Visible = True
                    GEnviarPulsacion_LX.Visible = False : GEnviarPulsacion_CoorLX.Visible = False : GEnviarPulsacion_CoorLCX.Visible = False : GEnviarPulsacion_TX.Visible = False
                    GEnviarPulsacion_LY.Visible = False : GEnviarPulsacion_CoorLY.Visible = False : GEnviarPulsacion_CoorLCY.Visible = False : GEnviarPulsacion_TY.Visible = False
                    GEnviarPulsacion_CoorLMouse.Visible = False : GEnviarPulsacion_LAplicarActuales.Visible = False
                    GEnviarPulsacion_TPulsacion.Tag = Settings(1)
                    Dim cPulsacion As String = Settings(1)
                    If cPulsacion.ToLower.Contains("ctrl") Then GEnviarPulsacion_CCTRL.Checked = True : cPulsacion = cPulsacion.Replace("CTRL", "") Else GEnviarPulsacion_CCTRL.Checked = False
                    If cPulsacion.ToLower.Contains("shift") Then GEnviarPulsacion_CSHIFT.Checked = True : cPulsacion = cPulsacion.Replace("SHIFT", "") Else GEnviarPulsacion_CSHIFT.Checked = False
                    If cPulsacion.ToLower.Contains("alt") Then GEnviarPulsacion_CALT.Checked = True : cPulsacion = cPulsacion.Replace("ALT", "") Else GEnviarPulsacion_CALT.Checked = False
                    If cPulsacion.ToLower.Contains("win") Then GEnviarPulsacion_CWin.Checked = True : cPulsacion = cPulsacion.Replace("WIN", "") Else GEnviarPulsacion_CWin.Checked = False
                    If cPulsacion.EndsWith("+") Then cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "") + "+" Else cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "")
                    cPulsacion = cPulsacion.Replace("Mouse1", "Mouse 1").Replace("Mouse2", "Mouse 2").Replace("Mouse3", "Mouse 3").Replace("Mouse4", "Mouse 4").Replace("Mouse5", "Mouse 5").Replace("WheelDown", "Wheel Down").Replace("WheelUp", "Wheel Up")
                    GEnviarPulsacion_TPulsacion.Text = cPulsacion
                ElseIf Settings(0) = "Mover Ratón" Then
                    GEnviarPulsacion_LPulsacion.Visible = False : GEnviarPulsacion_TPulsacion.Visible = False : GEnviarPulsacion_LCPulsacion.Visible = False : GEnviarPulsacion_CPulsacion.Visible = False : GEnviarPulsacion_PPulsacion.Visible = False
                    GEnviarPulsacion_LTexto.Visible = True : GEnviarPulsacion_TTexto.Visible = True
                    GEnviarPulsacion_LCTRL.Visible = False : GEnviarPulsacion_CCTRL.Visible = False
                    GEnviarPulsacion_LSHIFT.Visible = False : GEnviarPulsacion_CSHIFT.Visible = False
                    GEnviarPulsacion_LALT.Visible = False : GEnviarPulsacion_CALT.Visible = False
                    GEnviarPulsacion_LWIN.Visible = False : GEnviarPulsacion_CWin.Visible = False
                    GEnviarPulsacion_LTexto.Visible = False : GEnviarPulsacion_TTexto.Visible = False
                    GEnviarPulsacion_LX.Visible = True : GEnviarPulsacion_CoorLX.Visible = True : GEnviarPulsacion_CoorLCX.Visible = True : GEnviarPulsacion_TX.Visible = True
                    GEnviarPulsacion_LY.Visible = True : GEnviarPulsacion_CoorLY.Visible = True : GEnviarPulsacion_CoorLCY.Visible = True : GEnviarPulsacion_TY.Visible = True
                    GEnviarPulsacion_CoorLMouse.Visible = True : GEnviarPulsacion_LAplicarActuales.Visible = True
                    If Settings(1).Split("-").Length > 1 Then GEnviarPulsacion_TX.Text = Settings(1).Split("-")(0) : GEnviarPulsacion_TY.Text = Settings(1).Split("-")(1)
                ElseIf Settings(0) = "Desplazar Ratón" Then
                    GEnviarPulsacion_LPulsacion.Visible = False : GEnviarPulsacion_TPulsacion.Visible = False : GEnviarPulsacion_LCPulsacion.Visible = False : GEnviarPulsacion_CPulsacion.Visible = False : GEnviarPulsacion_PPulsacion.Visible = False
                    GEnviarPulsacion_LTexto.Visible = True : GEnviarPulsacion_TTexto.Visible = True
                    GEnviarPulsacion_LCTRL.Visible = False : GEnviarPulsacion_CCTRL.Visible = False
                    GEnviarPulsacion_LSHIFT.Visible = False : GEnviarPulsacion_CSHIFT.Visible = False
                    GEnviarPulsacion_LALT.Visible = False : GEnviarPulsacion_CALT.Visible = False
                    GEnviarPulsacion_LWIN.Visible = False : GEnviarPulsacion_CWin.Visible = False
                    GEnviarPulsacion_LTexto.Visible = False : GEnviarPulsacion_TTexto.Visible = False
                    GEnviarPulsacion_LX.Visible = True : GEnviarPulsacion_CoorLX.Visible = False : GEnviarPulsacion_CoorLCX.Visible = False : GEnviarPulsacion_TX.Visible = True
                    GEnviarPulsacion_LY.Visible = True : GEnviarPulsacion_CoorLY.Visible = False : GEnviarPulsacion_CoorLCY.Visible = False : GEnviarPulsacion_TY.Visible = True
                    GEnviarPulsacion_CoorLMouse.Visible = False : GEnviarPulsacion_LAplicarActuales.Visible = False
                    If Settings(1).Split("-").Length > 1 Then GEnviarPulsacion_TX.Text = Settings(1).Split("-")(0) : GEnviarPulsacion_TY.Text = Settings(1).Split("-")(1)
                Else
                    GEnviarPulsacion_LPulsacion.Visible = False : GEnviarPulsacion_TPulsacion.Visible = False : GEnviarPulsacion_LCPulsacion.Visible = False : GEnviarPulsacion_CPulsacion.Visible = False : GEnviarPulsacion_PPulsacion.Visible = False
                    GEnviarPulsacion_LTexto.Visible = True : GEnviarPulsacion_TTexto.Visible = True
                    GEnviarPulsacion_LCTRL.Visible = False : GEnviarPulsacion_CCTRL.Visible = False
                    GEnviarPulsacion_LSHIFT.Visible = False : GEnviarPulsacion_CSHIFT.Visible = False
                    GEnviarPulsacion_LALT.Visible = False : GEnviarPulsacion_CALT.Visible = False
                    GEnviarPulsacion_LWIN.Visible = False : GEnviarPulsacion_CWin.Visible = False
                    GEnviarPulsacion_LX.Visible = False : GEnviarPulsacion_CoorLX.Visible = False : GEnviarPulsacion_CoorLCX.Visible = False : GEnviarPulsacion_TX.Visible = False
                    GEnviarPulsacion_LY.Visible = False : GEnviarPulsacion_CoorLY.Visible = False : GEnviarPulsacion_CoorLCY.Visible = False : GEnviarPulsacion_TY.Visible = False
                    GEnviarPulsacion_CoorLMouse.Visible = False : GEnviarPulsacion_LAplicarActuales.Visible = False
                    If Settings(1) = "" Then GEnviarPulsacion_TTexto.Text = "Texto a enviar" : GEnviarPulsacion_TTexto.ForeColor1 = Color.FromArgb(72, 72, 72) Else GEnviarPulsacion_TTexto.Text = Settings(1) : GEnviarPulsacion_TTexto.ForeColor1 = Color.FromArgb(102, 102, 102)
                End If
                GAplicaciones_TAplicacion.Text = Settings(1) : If GAplicaciones_TAplicacion.Text.Trim = "" Then GAplicaciones_LCAplicacion.Text = "Seleccione una aplicación" : GAplicaciones_TAplicacion.ForeColor1 = Color.FromArgb(72, 72, 72) Else GAplicaciones_LCAplicacion.Text = GAplicaciones_TAplicacion.Text
                If GEnviarPulsacion.Visible = False Then OcultarPaneles() : GEnviarPulsacion.Visible = True
            Case "TopMost (On/Off)"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                If Settings(0) = "Sin Sonido" Or Settings(0) = "" Then GTopMost_TSonido.Text = "Sin Sonido" : GTopMost_LCSonido.Text = "Sin Sonido" Else GTopMost_TSonido.Text = Settings(0) : GTopMost_LCSonido.Text = Settings(0)
                GTopMost_COSD.Checked = CBool(Settings(1)) : GTopMost_BOSD.Enabled = GTopMost_COSD.Checked
                GTopMost_OSD_Fuente = String_to_Font(Settings(2)) : GTopMost_OSD_Color = String_to_Color(Settings(3))
                GTopMost_BOSD.ForeColor1 = GTopMost_OSD_Color : GTopMost_BOSD.ForeColor3 = GTopMost_OSD_Color
                If GTopMost.Visible = False Then OcultarPaneles() : GTopMost.Visible = True
            Case "Archivos Ocultos (On/Off)"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                If Settings(0) = "Sin Sonido" Or Settings(0) = "" Then GArchivosOcultos_TSonido.Text = "Sin Sonido" : GArchivosOcultos_LCSonido.Text = "Sin Sonido" Else GArchivosOcultos_TSonido.Text = Settings(0) : GArchivosOcultos_LCSonido.Text = Settings(0)
                GArchivosOcultos_COSD.Checked = CBool(Settings(1)) : GArchivosOcultos_BOSD.Enabled = GArchivosOcultos_COSD.Checked
                GArchivosOcultos_OSD_Fuente = String_to_Font(Settings(2)) : GArchivosOcultos_OSD_Color = String_to_Color(Settings(3))
                GArchivosOcultos_BOSD.ForeColor1 = GArchivosOcultos_OSD_Color : GArchivosOcultos_BOSD.ForeColor3 = GArchivosOcultos_OSD_Color
                If GArchivosOcultos.Visible = False Then OcultarPaneles() : GArchivosOcultos.Visible = True
            Case "Desactivar en (On/Off)"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                If Settings(0) = "Sin Sonido" Or Settings(0) = "" Then GDesactivarEn_TSonido.Text = "Sin Sonido" : GDesactivarEn_LCSonido.Text = "Sin Sonido" Else GDesactivarEn_TSonido.Text = Settings(0) : GDesactivarEn_LCSonido.Text = Settings(0)
                GDesactivarEn_COSD.Checked = CBool(Settings(1)) : GDesactivarEn_BOSD.Enabled = GDesactivarEn_COSD.Checked
                GDesactivarEn_OSD_Fuente = String_to_Font(Settings(2)) : GDesactivarEn_OSD_Color = String_to_Color(Settings(3))
                GDesactivarEn_BOSD.ForeColor1 = GDesactivarEn_OSD_Color : GDesactivarEn_BOSD.ForeColor3 = GDesactivarEn_OSD_Color
                If GDesactivarEn.Visible = False Then OcultarPaneles() : GDesactivarEn.Visible = True
            Case "Mostrar Mensaje"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                If Settings(0) = "" Then GMostrarMensaje_TMensaje.Text = "Mensaje a mostrar" : GMostrarMensaje_TMensaje.ForeColor1 = Color.FromArgb(72, 72, 72) Else GMostrarMensaje_TMensaje.Text = Settings(0) : GMostrarMensaje_TMensaje.ForeColor1 = Color.FromArgb(102, 102, 102)
                If Settings(1).Trim = "" Then Settings(1) = "0" : If Settings(2).Trim = "" Then Settings(2) = "sec"
                GMostrarMensaje_TDuracion.Text = Settings(1) : GMostrarMensaje_LFormato.Value2 = Settings(2)
                GMostrarMensaje_CCuentaAtras.Checked = CBool(Settings(3)) : GMostrarMensaje_CEsperar.Checked = CBool(Settings(4))
                GMostrarMensaje_OSD_Fuente = String_to_Font(Settings(5)) : GMostrarMensaje_OSD_Color = String_to_Color(Settings(6))
                GMostrarMensaje_BOSD.ForeColor1 = GMostrarMensaje_OSD_Color : GMostrarMensaje_BOSD.ForeColor3 = GMostrarMensaje_OSD_Color
                If Settings(7) = "Sin Sonido" Or Settings(7) = "" Then GMostrarMensaje_TSonido.Text = "Sin Sonido" : GMostrarMensaje_LCSonido.Text = "Sin Sonido" Else GMostrarMensaje_TSonido.Text = Settings(7) : GMostrarMensaje_LCSonido.Text = Settings(7)
                If GMostrarMensaje.Visible = False Then OcultarPaneles() : GMostrarMensaje.Visible = True
            Case "Apagar Equipo"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                If Settings(2).Trim = "" Then Settings(2) = "0" : If Settings(3).Trim = "" Then Settings(3) = "sec"
                GApagarEquipo_CAccion.SelectedItem = Settings(0)
                If Settings(1) = "Sin Sonido" Or Settings(1) = "" Then GApagarEquipo_TSonido.Text = "Sin Sonido" : GApagarEquipo_LCSonido.Text = "Sin Sonido" Else GApagarEquipo_TSonido.Text = Settings(1) : GApagarEquipo_LCSonido.Text = Settings(1)
                GApagarEquipo_TDuracion.Text = Settings(2) : GApagarEquipo_LFormato.Value2 = Settings(3)
                GApagarEquipo_CCuentaAtras.Checked = CBool(Settings(4))
                GApagarEquipo_COSD.Checked = CBool(Settings(5)) : GApagarEquipo_BOSD.Enabled = GApagarEquipo_COSD.Checked
                GApagarEquipo_CCuentaAtras.Enabled = GApagarEquipo_COSD.Checked : GApagarEquipo_LCuentaAtras.Enabled = GApagarEquipo_COSD.Checked
                GApagarEquipo_OSD_Fuente = String_to_Font(Settings(6)) : GApagarEquipo_OSD_Color = String_to_Color(Settings(7))
                GApagarEquipo_BOSD.ForeColor1 = GApagarEquipo_OSD_Color : GApagarEquipo_BOSD.ForeColor3 = GApagarEquipo_OSD_Color
                If GApagarEquipo.Visible = False Then OcultarPaneles() : GApagarEquipo.Visible = True
            Case "Comandos"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                If Settings(0).Trim = "" Then Settings(0) = "Ejecutar Comando"
                GComandos_CAccion.SelectedItem = Settings(0)
                If Comandos.Length = 0 Then
                    GComandos_LCComandos.Text = "No hay comandos" : GComandos_LCComandos.Cursor = Cursors.Default : GComandos_TComandos.Cursor = Cursors.Default
                Else
                    If Settings(1) = "" Then
                        GComandos_TComandos.Text = "" : GComandos_TComandos.Tag = "" : GComandos_LCComandos.Text = "Seleccione un comando"
                    Else
                        For Cuenta = 0 To Comandos.Length - 1
                            If Comandos(Cuenta).ID = Settings(1) Then
                                GComandos_TComandos.Text = Comandos(Cuenta).Nombre
                                GComandos_TComandos.Tag = Comandos(Cuenta).ID
                                GComandos_LCComandos.Text = Comandos(Cuenta).Nombre
                                GoTo Sigue
                            End If
                        Next : GComandos_TComandos.Text = "" : GComandos_TComandos.Tag = "" : GComandos_LCComandos.Text = "Seleccione un comando"
Sigue:              End If : GComandos_LCComandos.Cursor = Cursors.Hand : GComandos_TComandos.Cursor = Cursors.Hand
                End If
                If GComandos.Visible = False Then OcultarPaneles() : GComandos.Visible = True
            Case "Esperar"
                Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.Items(Indice).Tag).Settings, "|-|", , CompareMethod.Text)
                If Settings(0).Trim = "" Then Settings(0) = "0" : If Settings(1).Trim = "" Then Settings(1) = "sec"
                GEsperar_TEsperar.Text = Settings(0) : GEsperar_LFormato.Value2 = Settings(1)
                GEsperar_CCuentaAtras.Checked = CBool(Settings(2))
                GEsperar_COSD.Checked = CBool(Settings(3)) : GEsperar_BOSD.Enabled = GEsperar_COSD.Checked : GEsperar_OSD_TTexto.Enabled = GEsperar_COSD.Checked : GEsperar_OSD_Fuente = String_to_Font(Settings(4)) : GEsperar_OSD_Color = String_to_Color(Settings(5))
                GEsperar_CCuentaAtras.Enabled = GEsperar_COSD.Checked : GEsperar_LCuentaAtras.Enabled = GEsperar_COSD.Checked
                GEsperar_BOSD.ForeColor1 = GEsperar_OSD_Color : GEsperar_BOSD.ForeColor3 = GEsperar_OSD_Color
                If Settings(6) = "" Then GEsperar_OSD_TTexto.Tag = "" : GEsperar_OSD_TTexto.Text = "Mensaje a mostrar" : GEsperar_OSD_TTexto.ForeColor1 = Color.FromArgb(72, 72, 72) Else GEsperar_OSD_TTexto.Tag = Settings(6) : GEsperar_OSD_TTexto.Text = Settings(6) : GEsperar_OSD_TTexto.ForeColor1 = Color.FromArgb(102, 102, 102)
                If GEsperar_COSD.Checked = False Then GEsperar_OSD_TTexto.Text = ""
                If GEsperar.Visible = False Then OcultarPaneles() : GEsperar.Visible = True
            Case Else
                OcultarPaneles() : Comandos_Accion_NoSettings.Visible = True : PLogo.Visible = True
        End Select : Accion_Update = False
    End Sub

    Private Sub OcultarPaneles()
        'Aplicaciones
        GEjecutarAplicacion.Visible = False
        GAbrirCarpeta.Visible = False
        GPaginaWeb.Visible = False
        GAplicaciones.Visible = False
        GEjecutarBAT.Visible = False
        'Audio y Video
        GCapturaPantalla.Visible = False
        GGrabacionPantalla.Visible = False
        GGrabacionAudio.Visible = False
        GReproducirSonido.Visible = False
        GSalidaAudio.Visible = False
        GVolumen.Visible = False
        'Utilidades
        GMacro.Visible = False
        GKBoard.Visible = False
        GQuickMenu.Visible = False
        GRedAdHoc.Visible = False
        'Acciones
        GEnviarPulsacion.Visible = False
        GTopMost.Visible = False
        GArchivosOcultos.Visible = False
        GDesactivarEn.Visible = False
        GMostrarMensaje.Visible = False
        GApagarEquipo.Visible = False
        GComandos.Visible = False
        GEsperar.Visible = False
        'Otros
        PLogo.Visible = False
        Comandos_Accion_NoSettings.Visible = False
    End Sub

#End Region

#Region " Guardar Acciones "

    Private Sub Accion_Guardar(Optional IndiceID As Integer = -1)
        If Accion_Update = True Then Exit Sub
        If IndiceID = -1 Then IndiceID = Comandos_GetByID(ComandoActualID)
        If IndiceID = -1 Then Exit Sub
        Registro.DelReg(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID + "\Acciones")
        My.Computer.Registry.CurrentUser.CreateSubKey("Software\KDesktop4\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID + "\Acciones")
        For Cuenta = 0 To Comandos(IndiceID).Accion.Length - 1
            If Comandos(IndiceID).Accion(Cuenta).ID <> "" Then
                Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID + "\Acciones\Accion|-|" + Comandos(IndiceID).Accion(Cuenta).ID, "ID", Comandos(IndiceID).Accion(Cuenta).ID)
                Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID + "\Acciones\Accion|-|" + Comandos(IndiceID).Accion(Cuenta).ID, "Indice", Comandos(IndiceID).Accion(Cuenta).Indice.ToString)
                Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID + "\Acciones\Accion|-|" + Comandos(IndiceID).Accion(Cuenta).ID, "Tipo", Comandos(IndiceID).Accion(Cuenta).Tipo)
                Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID + "\Acciones\Accion|-|" + Comandos(IndiceID).Accion(Cuenta).ID, "Settings", Comandos(IndiceID).Accion(Cuenta).Settings)
            End If
        Next : Iconos_Update()
    End Sub

    Private Sub Accion_Guardar(IndiceID As Integer, Indice As Integer)
        If Accion_Update = True Then Exit Sub
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID + "\Acciones\Accion|-|" + Comandos(IndiceID).Accion(Indice).ID, "ID", Comandos(IndiceID).Accion(Indice).ID)
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID + "\Acciones\Accion|-|" + Comandos(IndiceID).Accion(Indice).ID, "Indice", Comandos(IndiceID).Accion(Indice).Indice.ToString)
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID + "\Acciones\Accion|-|" + Comandos(IndiceID).Accion(Indice).ID, "Tipo", Comandos(IndiceID).Accion(Indice).Tipo)
        Registro.SetRegKey(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID + "\Acciones\Accion|-|" + Comandos(IndiceID).Accion(Indice).ID, "Settings", Comandos(IndiceID).Accion(Indice).Settings)
    End Sub

#End Region

#Region " Guardar Settings "

    Private Sub Settings_Guardar(Indice As Integer)
        If Accion_Update = True Then Exit Sub
        Dim Tipo As String : Dim Settings As String = ""
        Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID)
        If IndiceID = -1 Then Tipo = Comandos_Accion_AccionesTemporales(Indice).Tipo Else Tipo = Comandos(IndiceID).Accion(Indice).Tipo
        Select Case Tipo
            'Aplicaciones
            Case "Ejecutar Aplicacion"
                Settings = GEjecutarAplicacion_TRuta.Tag + "|-|"
                Settings += GEjecutarAplicacion_TParametros.Text + "|-|"
                Settings += GEjecutarAplicacion_TIniciarEn.Tag + "|-|"
                Settings += GEjecutarAplicacion_TModo.Text + "|-|"
                Settings += GEjecutarAplicacion_TPrioridad.Text + "|-|"
                Settings += GEjecutarAplicacion_CTopMost.Checked.ToString + "|-|"
                Settings += GEjecutarAplicacion_CAdmin.Checked.ToString
            Case "Abrir Carpeta"
                Settings = GAbrirCarpeta_TRuta.Tag
            Case "Pagina Web"
                Settings = GPaginaWeb_TURL.Text + "|-|"
                Settings += GPaginaWeb_PNavegador.Tag + "|-|"
                Settings += GPaginaWeb_CNuevaVentana.Checked.ToString + "|-|"
                Settings += GPaginaWeb_CVentanaIncognito.Checked.ToString + "|-|"
                Settings += GPaginaWeb_CAdmin.Checked.ToString
            Case "Aplicaciones"
                Settings = GAplicaciones_TAccion.Text + "|-|"
                Settings += GAplicaciones_TAplicacion.Text + "|-|"
                Settings += GAplicaciones_CEsperar.Checked.ToString + "|-|"
                Dim EsperarModo As String = "Activar"
                If GAplicaciones_Esperar_CActivar.Checked = True Then EsperarModo = "Activar"
                If GAplicaciones_Esperar_CAbrir.Checked = True Then EsperarModo = "Abrir"
                If GAplicaciones_Esperar_CCerrar.Checked = True Then EsperarModo = "Cerrar"
                Settings += EsperarModo
            Case "Ejecutar BAT"
                Settings = GEjecutarBAT_TNombre.Text + "|-|"
                Settings += GEjecutarBAT_TTexto.Tag + "|-|"
                Settings += GEjecutarBAT_TModo.Text + "|-|"
                Settings += GEjecutarBAT_CAdministrador.Checked.ToString
            'Audio y Video
            Case "Capturar Pantalla"
                Settings = GCapturaPantalla_TSonido.Text + "|-|"
                Settings += GCapturaPantalla_TDuracion.Text + "|-|"
                Settings += GCapturaPantalla_LFormato.Value2 + "|-|"
                Settings += GCapturaPantalla_CCuentaAtras.Checked.ToString + "|-|"
                Settings += GCapturaPantalla_COSD.Checked.ToString + "|-|"
                Settings += Font_to_String(GCapturaPantalla_OSD_Fuente) + "|-|"
                Settings += Color_to_String(GCapturaPantalla_OSD_Color)
            Case "Grabar Pantalla (On/Off)"
                Dim Pantalla As String = "?"
                If GGrabacionPantalla_CPantalla1.Checked = True Then Pantalla = "0"
                If GGrabacionPantalla_CPantalla2.Checked = True Then Pantalla = "1"
                If GGrabacionPantalla_CPantalla3.Checked = True Then Pantalla = "2"
                If GGrabacionPantalla_CPantalla4.Checked = True Then Pantalla = "3"
                Settings = Pantalla + "|-|"
                Settings += GGrabacionPantalla_CDesktopDuplication.Checked.ToString + "|-|"
                Settings += GGrabacionPantalla_CGSonido.Checked.ToString + "|-|"
                Settings += GGrabacionPantalla_CGMicrofono.Checked.ToString + "|-|"
                Settings += GGrabacionPantalla_CMarcarClicks.Checked.ToString + "|-|"
                Settings += GGrabacionPantalla_TSonido.Text + "|-|"
                Settings += GGrabacionPantalla_TDuracion.Text + "|-|"
                Settings += GGrabacionPantalla_LFormato.Value2 + "|-|"
                Settings += GGrabacionPantalla_CCuentaAtras.Checked.ToString + "|-|"
                Settings += GGrabacionPantalla_COSD.Checked.ToString + "|-|"
                Settings += Font_to_String(GGrabacionPantalla_OSD_Fuente) + "|-|"
                Settings += Color_to_String(GGrabacionPantalla_OSD_Color)
            Case "Grabar Audio (On/Off)"
                Settings = GGrabacionAudio_TSonido.Text + "|-|"
                Settings += GGrabacionAudio_TDuracion.Text + "|-|"
                Settings += GGrabacionAudio_LFormato.Value2 + "|-|"
                Settings += GGrabacionAudio_CCuentaAtras.Checked.ToString + "|-|"
                Settings += GGrabacionAudio_COSD.Checked.ToString + "|-|"
                Settings += Font_to_String(GGrabacionAudio_OSD_Fuente) + "|-|"
                Settings += Color_to_String(GGrabacionAudio_OSD_Color)
            Case "Reproducir Sonido"
                Settings = GReproducirSonido_TSonido.Text + "|-|"
                Settings += GReproducirSonido_CEsperar.Checked.ToString
            Case "Salida de Audio"
                Settings = GSalidaAudio_TSonido.Text + "|-|"
                Settings += GSalidaAudio_COSD.Checked.ToString + "|-|"
                Settings += Font_to_String(GSalidaAudio_OSD_Fuente) + "|-|"
                Settings += Color_to_String(GSalidaAudio_OSD_Color) + "|-|"
                For Cuenta = 0 To GSalidaAudio_ListaSeleccionados.Items.Count - 1
                    Settings += GSalidaAudio_ListaSeleccionados.Items(Cuenta).Tag + "|-|"
                Next : Settings = Settings.Substring(0, Settings.Length - 3)
            Case "Volumen"
                Settings = GVolumen_TAccion.Text + "|-|"
                Settings += GVolumen_TIntervalo.Text
            'Utilidades
            Case "Macros"
                Settings = GMacro_CPausasEjecucion.Checked.ToString + "|-|"
                Settings += GMacro_CEventosTeclado.Checked.ToString + "|-|"
                Settings += GMacro_CClicsRaton.Checked.ToString + "|-|"
                Settings += GMacro_CRuedaRaton.Checked.ToString + "|-|"
                Settings += GMacro_CMovimientoRaton.Checked.ToString + "|-|"
                Settings += GMacro_CClicks_Position.Checked.ToString + "|-|"
                Settings += GMacro_CRepetir.Checked.ToString + "|-|"
                Settings += GMacro_CEsperar.Checked.ToString
            Case "K-Board"
                Dim TempValue As String : If GKBoard_LCNombre.Text = "Seleccione un K-Board" Or GKBoard_LCNombre.Text = "No hay K-Boards" Then TempValue = "" Else TempValue = GKBoard_LCNombre.Text
                Settings = GKBoard_TAccion.Text + "|-|"
                Settings += TempValue + "|-|"
                Settings += GKBoard_COSD.Checked.ToString + "|-|"
                Settings += Font_to_String(GKBoard_OSD_Fuente) + "|-|"
                Settings += Color_to_String(GKBoard_OSD_Color)
            Case "QuickMenu"
                If GQuickMenu_LCNombre.Text = "Seleccione un QuickMenu" Or GQuickMenu_LCNombre.Text = "No hay QuickMenus" Then Settings = "|-|" Else Settings = GQuickMenu_LCNombre.Text + "|-|"
            Case "Red Ad-Hoc"
                Settings = GRedAdHoc_TNombre.Text + "|-|"
                Settings += GRedAdHoc_TContraseña.Text + "|-|"
                Settings += GRedAdHoc_TSonido.Text + "|-|"
                Settings += GRedAdHoc_COSD.Checked.ToString + "|-|"
                Settings += Font_to_String(GRedAdHoc_OSD_Fuente) + "|-|"
                Settings += Color_to_String(GRedAdHoc_OSD_Color)
            'Acciones
            Case "Enviar Pulsación"
                Dim Texto As String = "" : If GEnviarPulsacion_TTexto.ForeColor1 = Color.FromArgb(102, 102, 102) Then Texto = GEnviarPulsacion_TTexto.Text
                If GEnviarPulsacion_TAccion.Text = "Enviar Pulsación" Then
                    Settings = GEnviarPulsacion_TAccion.Text + "|-|"
                    Settings += GEnviarPulsacion_TPulsacion.Tag + "|-|"
                ElseIf GEnviarPulsacion_TAccion.Text = "Mover Ratón" Or GEnviarPulsacion_TAccion.Text = "Desplazar Ratón" Then
                    Settings = GEnviarPulsacion_TAccion.Text + "|-|"
                    Settings += GEnviarPulsacion_TX.Text + "-"
                    Settings += GEnviarPulsacion_TY.Text + "|-|"
                Else
                    Settings = GEnviarPulsacion_TAccion.Text + "|-|"
                    Settings += Texto + "|-|"
                End If
            Case "TopMost (On/Off)"
                Settings = GTopMost_TSonido.Text + "|-|"
                Settings += GTopMost_COSD.Checked.ToString + "|-|"
                Settings += Font_to_String(GTopMost_OSD_Fuente) + "|-|"
                Settings += Color_to_String(GTopMost_OSD_Color)
            Case "Archivos Ocultos (On/Off)"
                Settings = GArchivosOcultos_TSonido.Text + "|-|"
                Settings += GArchivosOcultos_COSD.Checked.ToString + "|-|"
                Settings += Font_to_String(GArchivosOcultos_OSD_Fuente) + "|-|"
                Settings += Color_to_String(GArchivosOcultos_OSD_Color)
            Case "Desactivar en (On/Off)"
                Settings = GDesactivarEn_TSonido.Text + "|-|"
                Settings += GDesactivarEn_COSD.Checked.ToString + "|-|"
                Settings += Font_to_String(GDesactivarEn_OSD_Fuente) + "|-|"
                Settings += Color_to_String(GDesactivarEn_OSD_Color)
            Case "Mostrar Mensaje"
                Dim Mensaje As String = "" : If GMostrarMensaje_TMensaje.ForeColor1 = Color.FromArgb(102, 102, 102) Then Mensaje = GMostrarMensaje_TMensaje.Text
                Settings = Mensaje + "|-|"
                Settings += GMostrarMensaje_TDuracion.Text + "|-|"
                Settings += GMostrarMensaje_LFormato.Value2 + "|-|"
                Settings += GMostrarMensaje_CCuentaAtras.Checked.ToString + "|-|"
                Settings += GMostrarMensaje_CEsperar.Checked.ToString + "|-|"
                Settings += Font_to_String(GMostrarMensaje_OSD_Fuente) + "|-|"
                Settings += Color_to_String(GMostrarMensaje_OSD_Color) + "|-|"
                Settings += GMostrarMensaje_TSonido.Text
            Case "Apagar Equipo"
                Settings = GApagarEquipo_TAccion.Text + "|-|"
                Settings += GApagarEquipo_TSonido.Text + "|-|"
                Settings += GApagarEquipo_TDuracion.Text + "|-|"
                Settings += GApagarEquipo_LFormato.Value2 + "|-|"
                Settings += GApagarEquipo_CCuentaAtras.Checked.ToString + "|-|"
                Settings += GApagarEquipo_COSD.Checked.ToString + "|-|"
                Settings += Font_to_String(GApagarEquipo_OSD_Fuente) + "|-|"
                Settings += Color_to_String(GApagarEquipo_OSD_Color)
            Case "Comandos"
                Settings = GComandos_TAccion.Text + "|-|"
                Settings += GComandos_TComandos.Tag
            Case "Esperar"
                Dim Mensaje As String = "" : If GEsperar_OSD_TTexto.ForeColor1 = Color.FromArgb(102, 102, 102) Then Mensaje = GEsperar_OSD_TTexto.Tag
                Settings = GEsperar_TEsperar.Text + "|-|"
                Settings += GEsperar_LFormato.Value2 + "|-|"
                Settings += GEsperar_CCuentaAtras.Checked.ToString + "|-|"
                Settings += GEsperar_COSD.Checked.ToString + "|-|"
                Settings += Font_to_String(GEsperar_OSD_Fuente) + "|-|"
                Settings += Color_to_String(GEsperar_OSD_Color) + "|-|" + Mensaje
        End Select : Iconos_Update()
        If IndiceID = -1 Then Comandos_Accion_AccionesTemporales(Indice).Settings = Settings Else Comandos(IndiceID).Accion(Indice).Settings = Settings : Accion_Guardar(IndiceID, Indice)
    End Sub

    Private Function DefaultSettings(Tipo As String, Optional Accion_ID As String = "") As String
        Select Case Tipo
                'Aplicaciones
            Case "Ejecutar Aplicacion" : Return "|-||-||-|Normal|-|Normal|-|False|-|False"
            Case "Abrir Carpeta" : Return ""
            Case "Pagina Web" : Return "|-|" + GetDefaultBrowser() + "|-|False|-|False|-|False"
            Case "Aplicaciones" : Return "Activar Aplicacion|-||-|False|-|Activar"
            Case "Ejecutar BAT" : Return "Sin Nombre|-|" + KobaPath + "BATs\" + Accion_ID + ".bat" + "|-|Normal|-|False"
                'Audio y Video
            Case "Capturar Pantalla" : Return "Camera|-|0|-|sec|-|False|-|False|-|" + Font_to_String(OSD_Default_Font) + "|-|" + Color_to_String(OSD_Default_Color) + "|-|False"
            Case "Grabar Pantalla (On/Off)" : Return "?|-|False|-|True|-|False|-|False|-||-|0|-|sec|-|False|-|False|-|" + Font_to_String(OSD_Default_Font) + "|-|" + Color_to_String(OSD_Default_Color)
            Case "Grabar Audio (On/Off)" : Return "|-|0|-|sec|-|False|-|True|-|" + Font_to_String(OSD_Default_Font) + "|-|" + Color_to_String(OSD_Default_Color)
            Case "Reproducir Sonido" : Return "|-|False"
            Case "Salida de Audio" : Return "Alarma 1|-|True|-|" + Font_to_String(OSD_Default_Font) + "|-|" + Color_to_String(OSD_Default_Color)
            Case "Volumen" : Return "Establecer Volumen|-|30"
                'Utilidades
            Case "Macros" : Return "True|-|True|-|False|-|False|-|False|-|True|-|False|-|False"
            Case "K-Board" : Return "K-Board (On/Off)|-||-|True|-|" + Font_to_String(OSD_Default_Font) + "|-|" + Color_to_String(OSD_Default_Color)
            Case "QuickMenu" : Return "|-|"
            Case "Red Ad-Hoc" : Return "|-||-||-|True|-|" + Font_to_String(OSD_Default_Font) + "|-|" + Color_to_String(OSD_Default_Color)
                'Acciones
            Case "Enviar Pulsación" : Return "Enviar Pulsación|-|"
            Case "TopMost (On/Off)" : Return "Chimes|-|True|-|" + Font_to_String(OSD_Default_Font) + "|-|" + Color_to_String(OSD_Default_Color)
            Case "Archivos Ocultos (On/Off)" : Return "Message|-|True|-|" + Font_to_String(OSD_Default_Font) + "|-|" + Color_to_String(OSD_Default_Color)
            Case "Desactivar en (On/Off)" : Return "Chimes|-|True|-|" + Font_to_String(OSD_Default_Font) + "|-|" + Color_to_String(OSD_Default_Color)
            Case "Mostrar Mensaje" : Return "|-|0|-|sec|-|False|-|False|-|" + Font_to_String(OSD_Default_Font) + "|-|" + Color_to_String(OSD_Default_Color) + "|-|"
            Case "Apagar Equipo" : Return "Apagar Equipo|-|Shutdown|-|5|-|sec|-|True|-|True|-|" + Font_to_String(OSD_Default_Font) + "|-|" + Color_to_String(OSD_Default_Color)
            Case "Comandos" : Return "Ejecutar Comando|-|"
            Case "Esperar" : Return "0|-|sec|-|False|-|True|-|" + Font_to_String(OSD_Default_Font) + "|-|" + Color_to_String(OSD_Default_Color) + "|-|"
        End Select : Return ""
    End Function

#End Region

    'Controles

#Region " Controles "

#Region " Nombre "

    Dim NuevoComandoIgnorar As Integer = -1
    Dim NombreComandoTemp As String

    Private Sub Comandos_Nombre_TNombre_GotFocus(sender As Object, e As EventArgs) Handles Comandos_Nombre_TNombre.GotFocus
        NombreComandoTemp = Comandos_Nombre_TNombre.Text
    End Sub

    Private Sub Comandos_Nombre_TNombre_LostFocus(sender As Object, e As EventArgs) Handles Comandos_Nombre_TNombre.LostFocus
        If Comandos_Nombre_TNombre.Text.Trim = "" Then Comandos_Nombre_TNombre.Text = NombreComandoTemp
        If NuevoComandoIgnorar <> -1 Then If NuevoComandoIgnorar = 1 Then NuevoComandoIgnorar = -1 Else NuevoComandoIgnorar += 1 : Exit Sub
        If ComandoActualID = "Negativo" Then
            If Comandos_Nombre_TNombre.Text.Trim = "" Then Exit Sub
            'Comandos_Nombre_TNombre.Tag = Comandos_Nombre_TNombre.Text.Trim.Substring(0, 1).ToUpper + Comandos_Nombre_TNombre.Text.Trim.Substring(1).Trim()
            Comandos_Nombre_TNombre.Tag = Comandos_Nombre_TNombre.Text.Trim : Comandos_Nombre_TNombre.Text = Comandos_Nombre_TNombre.Tag
            ReDim Preserve Comandos(Comandos.Length)
            Comandos(Comandos.Length - 1).Nombre = Comandos_Nombre_TNombre.Text
            Comandos(Comandos.Length - 1).ID = Now.ToString("ddMMyyyyHHmmss")
            Comandos(Comandos.Length - 1).Sonido = Comandos_Sonido_TSonido.Text
            Comandos(Comandos.Length - 1).EjecutarIniciar = Comandos_EjecutarIniciar_CEjecutarIniciar.Checked
            Comandos(Comandos.Length - 1).EjecutarSalir = Comandos_EjecutarSalir_CEjecutarSalir.Checked
            Comandos(Comandos.Length - 1).EjecutarSiempre = Comandos_EjecutarSiempre_CEjecutarSiempre.Checked
            Comandos(Comandos.Length - 1).Deshabilitar = Comandos_Deshabilitar_CDeshabilitar.Checked
            Comandos(Comandos.Length - 1).BloquearPulsacion = Comandos_BloquearPulsacion_CBloquearPulsacion.Checked
            Dim Oculto As Boolean : If Comandos_POculto.Tag = "Mostrar" Then Oculto = False Else Oculto = True
            Comandos(Comandos.Length - 1).Oculto = Oculto
            ComandoActualID = Comandos(Comandos.Length - 1).ID
            ReDim Comandos(Comandos.Length - 1).Hotkey(Comandos_Hotkey_ListaHotkey.Items.Count - 1)
            For Cuenta = 0 To Comandos_Hotkey_ListaHotkey.Items.Count - 1
                If Comandos_Hotkey_ListaHotkey.Items(Cuenta).Text <> "" Then Comandos(Comandos.Length - 1).Hotkey(Cuenta) = Comandos_Hotkey_ListaHotkey.Items(Cuenta).Text
            Next
            ReDim Comandos(Comandos.Length - 1).Procesos(Comandos_Procesos_CProceso.Items.Count - 1)
            For Cuenta = 0 To Comandos_Procesos_CProceso.Items.Count - 1
                If Comandos_Procesos_CProceso.Items(Cuenta) <> "" Then Comandos(Comandos.Length - 1).Procesos(Cuenta) = Comandos_Procesos_CProceso.Items(Cuenta).Text
            Next
            For Cuenta = 0 To Comandos_Accion_AccionesTemporales.Length - 1 : Comandos_Accion_AccionesTemporales(Cuenta).ParentID = Comandos(Comandos.Length - 1).ID : Next
            Comandos(Comandos.Length - 1).Accion = Comandos_Accion_AccionesTemporales
            Comandos_ComandoNegativo = False
            Comando_GuardarTodo(Comandos.Length - 1)
            PanelComandos.Visible = True : PanelKBoard1.Visible = False : PanelKBoard2.Visible = False : PanelQuickMenu.Visible = False : PanelOpciones.Visible = False : Lista.Height = 590
            BPanelComandos.ForeColor1 = Color.FromArgb(205, 150, 0) : BPanelKBoard.ForeColor1 = Color.FromArgb(102, 102, 102) : BPanelQuickMenu.ForeColor1 = Color.FromArgb(102, 102, 102) : BPanelOpciones.ForeColor1 = Color.FromArgb(102, 102, 102)
            Lista_Update()
            For Cuenta = 0 To Lista.Items.Count - 1
                If Comandos(Lista.Items(Cuenta).Tag).ID = ComandoActualID Then Lista.SelectItem(Cuenta) : Lista.EnsureVisibleAt(Cuenta) : Exit For
            Next
            Estadisticas.Estadisticas.Comandos_Creados += 1 : Estadisticas.Guardar()
            Exit Sub
        End If
        Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID) : If IndiceID = -1 Then Exit Sub
        If (Comandos_Nombre_TNombre.Text.Trim = "" Or Comandos_Nombre_TNombre.Text.Trim = Comandos(IndiceID).Nombre) AndAlso Comandos(IndiceID).Nombre <> "Nuevo Comando" Then Comandos_Nombre_TNombre.Text = Comandos_Nombre_TNombre.Tag : Exit Sub
        Comandos_Nombre_TNombre.Tag = Comandos_Nombre_TNombre.Text.Trim : Comandos_Nombre_TNombre.Text = Comandos_Nombre_TNombre.Tag
        Registro.DelReg(RegPath + "\Comandos\" + Comandos(IndiceID).Nombre.Replace("\", "|/|") + "|-|" + Comandos(IndiceID).ID)
        Comandos(IndiceID).Nombre = Comandos_Nombre_TNombre.Text
        Comando_GuardarValor("Nombre")
        Lista_Update()
        For Cuenta = 0 To Lista.Items.Count - 1
            If Comandos(Lista.Items(Cuenta).Tag).ID = ComandoActualID Then Lista.SelectItem(Cuenta) : Lista.EnsureVisibleAt(Cuenta) : Exit For
        Next
    End Sub

    Private Sub Comandos_Nombre_TNombre_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Comandos_Nombre_TNombre.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub Comandos_Nombre_TNombre_TextChanged(sender As Object, e As EventArgs) Handles Comandos_Nombre_TNombre.TextChanged
        If TextRenderer.MeasureText(Comandos_Nombre_TNombre.Text, Comandos_Nombre_TNombre.Font).Width >= Comandos_Nombre_TNombre.Width Then Comandos_Nombre_TNombre.MaxLength = 25 Else Comandos_Nombre_TNombre.MaxLength = 50
    End Sub

    Private Sub Comandos_POculto_Click(sender As Object, e As MouseEventArgs) Handles Comandos_POculto.Click, Comandos_POculto.DoubleClick
        If e.Button <> MouseButtons.Left Or GMacro_Grabando = True Then Exit Sub
        HTexto.Focus()
        Dim Oculto As Boolean
        If Comandos_POculto.Tag = "Mostrar" Then Comandos_POculto.Image = My.Resources.Ocultar_Oculto_On : Comandos_POculto.Tag = "Oculto" : Oculto = True Else Comandos_POculto.Image = My.Resources.Ocultar_Mostrado_On : Comandos_POculto.Tag = "Mostrar" : Oculto = False
        If Comandos_GetByID(ComandoActualID) <> -1 Then Comandos(Comandos_GetByID(ComandoActualID)).Oculto = Oculto
        Comando_GuardarValor("Oculto")
        'If Lista.SelectedIndex(0) <> -1 Then
        '    Comandos(Lista.SelectedItems(0).Tag).Oculto = Oculto
        '    Comando_GuardarValor("Oculto")
        'End If
        Lista_Update()
        If Lista.Items.Count = 1 Then Lista.SelectItem(0) : Lista.EnsureVisibleAt(0) : Comando_Mostrar(Comandos(Lista.Items(0).Tag).ID) : Exit Sub
        For Cuenta = 0 To Lista.Items.Count - 1
            If Comandos(Lista.Items(Cuenta).Tag).ID = ComandoActualID Then Lista.SelectItem(Cuenta) : Lista.EnsureVisibleAt(Cuenta) : Exit For
        Next
    End Sub

    Private Sub Comandos_POculto_MouseEnter(sender As Object, e As EventArgs) Handles Comandos_POculto.MouseEnter
        If Comandos_POculto.Tag = "Mostrar" Then Comandos_POculto.Image = My.Resources.Ocultar_Mostrado_On Else Comandos_POculto.Image = My.Resources.Ocultar_Oculto_On
    End Sub

    Private Sub Comandos_POculto_MouseLeave(sender As Object, e As EventArgs) Handles Comandos_POculto.MouseLeave
        If Comandos_POculto.Tag = "Mostrar" Then Comandos_POculto.Image = My.Resources.Ocultar_Mostrado_Off Else Comandos_POculto.Image = My.Resources.Ocultar_Oculto_Off
    End Sub

#End Region

#Region " Sonido "

    Private Sub Comandos_Sonido_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles Comandos_Sonido_LCSonido.TextChanged
        Comandos_Sonido_TSonido.Enabled = False
        Comandos_Sonido_LCSonido.Text = Rutas.Acortar_Ruta(Comandos_Sonido_TSonido.Text, Comandos_Sonido_LCSonido)
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(Comandos_Sonido_LCSonido.Text, New Font(Comandos_Sonido_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < Comandos_Sonido_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : Comandos_Sonido_LCSonido.Font = New Font(Comandos_Sonido_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        If Comandos.Length > 0 AndAlso Comandos_GetByID(ComandoActualID) <> -1 Then Comandos(Comandos_GetByID(ComandoActualID)).Sonido = Comandos_Sonido_TSonido.Text
        Comando_GuardarValor("Sonido")
    End Sub

    Private Sub Comandos_Sonido_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles Comandos_Sonido_LCSonido.Click, Comandos_Sonido_TSonido.Click
        If e.Button = MouseButtons.Left Then
            Comandos_Sonido_CSonido.DroppedDown = True : Comandos_Sonido_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            Comandos_Sonido_LCSonido.Visible = False : Combo_IgnoreOne = True : Comandos_Sonido_TSonido.ReadOnly = False : Comandos_Sonido_TSonido.Enabled = True : Comandos_Sonido_TSonido.Cursor = Cursors.IBeam : Comandos_Sonido_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub Comandos_Sonido_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Comandos_Sonido_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub Comandos_Sonido_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles Comandos_Sonido_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : Comandos_Sonido_CSonido.DroppedDown = True : Comandos_Sonido_CSonido.Focus()
    End Sub

    Private Sub Comandos_Sonido_TSonido_GotFocus(sender As Object, e As EventArgs) Handles Comandos_Sonido_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub Comandos_Sonido_TSonido_LostFocus(sender As Object, e As EventArgs) Handles Comandos_Sonido_TSonido.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If Comandos_Sonido_LCSonido.Visible = False Then Comandos_Sonido_LCSonido.Visible = True : Comandos_Sonido_TSonido.ReadOnly = True : Comandos_Sonido_TSonido.Enabled = False : Comandos_Sonido_TSonido.Cursor = Cursors.Hand
        If Comandos_Sonido_TSonido.Text.Trim = "" Then Comandos_Sonido_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To Comandos_Sonido_CSonido.Items.Count - 1
            If Comandos_Sonido_TSonido.Text.ToLower = Comandos_Sonido_CSonido.Items(Cuenta).ToLower Then Comandos_Sonido_TSonido.Text = Comandos_Sonido_CSonido.Items(Cuenta)
        Next : Comandos_Sonido_TSonido.Text = Comandos_Sonido_TSonido.Text.Trim : Comandos_Sonido_TSonido.SelectionLength = 0 : Comandos_Sonido_LCSonido.Text = Comandos_Sonido_TSonido.Text
    End Sub

    Private Sub Comandos_Sonido_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles Comandos_Sonido_TSonido.MouseEnter, Comandos_Sonido_CSonido.MouseEnter
        Comandos_Sonido_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub Comandos_Sonido_CSonido_DropDown(sender As Object, e As EventArgs) Handles Comandos_Sonido_CSonido.DropDown
        Comandos_Sonido_TSonido.Enabled = True
        Comandos_Sonido_CSonido.MaxDropDownItems = Comandos_Sonido_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = Comandos_Sonido_TSonido.Text
        If Comandos_Sonido_CSonido.Items.Contains(Comandos_Sonido_TSonido.Text) = True Then Comandos_Sonido_CSonido.SelectedItem = Comandos_Sonido_TSonido.Text Else Comandos_Sonido_CSonido.SelectedIndex = 0
    End Sub

    Private Sub Comandos_Sonido_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles Comandos_Sonido_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub Comandos_Sonido_CSonido_LostFocus(sender As Object, e As EventArgs) Handles Comandos_Sonido_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub Comandos_Sonido_CSonido_SelectedIndexChanged(sender As Object, e As EventArgs) Handles Comandos_Sonido_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then Comandos_Sonido_TSonido.Text = Comandos_Sonido_CSonido.SelectedItem.Trim : Comandos_Sonido_LCSonido.Text = Comandos_Sonido_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub Comandos_Sonido_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Comandos_Sonido_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then Comandos_Sonido_TSonido.Text = Comandos_Sonido_CSonido.SelectedItem.Trim : Comandos_Sonido_LCSonido.Text = Comandos_Sonido_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub Comandos_Sonido_CSonido_ItemHover(Index As Integer) Handles Comandos_Sonido_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub Comandos_Sonido_BPlay_Click(sender As Object, e As MouseEventArgs) Handles Comandos_Sonido_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If Comandos_Sonido_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(Comandos_Sonido_TSonido.Text)
    End Sub

    Private Sub Comandos_Sonido_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles Comandos_Sonido_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then Comandos_Sonido_TSonido.Text = Abrir.FileName : Comandos_Sonido_LCSonido.Text = Comandos_Sonido_TSonido.Text : Sonidos.Play_Block(Comandos_Sonido_TSonido.Text)
        Comandos_Sonido_TSonido.SelectionStart = Comandos_Sonido_TSonido.Text.Length : Comandos_Sonido_TSonido.SelectionLength = 0
        Comandos_Sonido_BExaminar.State = NSButton.MouseState.None : Comandos_Sonido_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub Comandos_Sonido_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles Comandos_Sonido_BExaminar.MouseEnter
        Comandos_Sonido_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " Hotkey "

    Private Sub Comandos_Hotkey_THotkey_DoubleClick(sender As Object, e As EventArgs) Handles Comandos_Hotkey_THotkey.DoubleClick, Comandos_Hotkey_LCHotkey.DoubleClick
        Comandos_Hotkey_THotkey.Text = ""
    End Sub

    Private Sub Comandos_Hotkey_THotkey_TextChanged(sender As Object, e As EventArgs) Handles Comandos_Hotkey_THotkey.TextChanged
        Comandos_Hotkey_LCHotkey.Text = Comandos_Hotkey_THotkey.Text
        Rutas.SetFontSize(Comandos_Hotkey_LCHotkey, 6.75, 5.25)
    End Sub

    Private Sub Comandos_Hotkey_THotkey_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Comandos_Hotkey_THotkey.KeyPress
        e.Handled = True : If Asc(e.KeyChar) = 13 Then HTexto.Focus()
    End Sub

    Private Sub Comandos_Hotkey_THotkey_GotFocus(sender As Object, e As EventArgs) Handles Comandos_Hotkey_THotkey.GotFocus, Comandos_Hotkey_LCHotkey.Click
        If GMacro_Grabando = True Then HTexto.Focus() : Exit Sub
        Mouse_HotKey = True
        Comandos_Hotkey_THotkey.Width = 187 : Comandos_Hotkey_LCHotkey.Width = 177 : Comandos_Hotkey_THotkey.isKeyLog = True : Comandos_Hotkey_THotkey.Invalidate()
        Get_HotKey = True : HotkeyM = True
    End Sub

    Private Sub Comandos_Hotkey_LCHotkey_Click(sender As Object, e As EventArgs) Handles Comandos_Hotkey_LCHotkey.Click
        If GMacro_Grabando = True Then HTexto.Focus() : Exit Sub
        Mouse_HotKey = True
        Comandos_Hotkey_THotkey.isKeyLog = True : Comandos_Hotkey_THotkey.Invalidate()
        Get_HotKey = True : HotkeyM = True
        HTexto.Focus()
    End Sub

#Region " Botones "

    Private Sub Comandos_Hotkey_BHotkeyAdd_Click(sender As Object, e As MouseEventArgs) Handles Comandos_Hotkey_BHotkeyAdd.Click
        If e IsNot Nothing Then If e.Button <> MouseButtons.Left Then Exit Sub
        If HotkeyM = False Then Comandos_Hotkey_THotkey.Focus() : Exit Sub
        If Comandos_Hotkey_THotkey.Text = "" Then Exit Sub
        For Cuenta = 0 To Comandos_Hotkey_ListaHotkey.Items.Count - 1
            If Comandos_Hotkey_ListaHotkey.Items(Cuenta).Text = Comandos_Hotkey_THotkey.Text Then Comandos_Hotkey_THotkey.Text = "" : Exit Sub
        Next
        Comandos_Hotkey_ListaHotkey.AddItem(Comandos_Hotkey_THotkey.Text)
        Comandos_Hotkey_ListaHotkey.SelectItem(Comandos_Hotkey_ListaHotkey.Items.Count - 1)
        Comandos_Hotkey_ListaHotkey.EnsureVisibleAt(Comandos_Hotkey_ListaHotkey.Items.Count - 1)
        Comandos_Hotkey_THotkey.Text = ""
        Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID)
        If IndiceID <> -1 Then
            ReDim Comandos(IndiceID).Hotkey(Comandos_Hotkey_ListaHotkey.Items.Count - 1)
            For Cuenta = 0 To Comandos_Hotkey_ListaHotkey.Items.Count - 1
                Comandos(IndiceID).Hotkey(Cuenta) = Comandos_Hotkey_ListaHotkey.Items(Cuenta).Text
            Next
            Comando_GuardarValor("Hotkey")
        End If : ExitHotKey()
    End Sub

#End Region

#Region " Lista "

    Private Sub Comandos_Hotkey_ListaHotkey_KeyDown(sender As Object, e As KeyEventArgs) Handles Comandos_Hotkey_ListaHotkey.KeyDown
        If e.KeyCode = Keys.Delete Then e.Handled = True : Comandos_MenuHotkey_Eliminar_Click(sender, Nothing)
    End Sub

#End Region

#Region " Menu "

    Private Sub Comandos_MenuHotkey_Opening(sender As Object, e As System.ComponentModel.CancelEventArgs) Handles Comandos_MenuHotkey.Opening
        If GMacro_Grabando = True Then e.Cancel = True : Exit Sub
        Comandos_MenuHotkey_Eliminar.Visible = True : Comandos_MenuHotkey_Separador0.Visible = True : Comandos_MenuHotkey.Height = 54
        Dim SoloAñadir As Boolean
        If Comandos_Hotkey_ListaHotkey.Items.Count = 0 Then SoloAñadir = True
        If Comandos_Hotkey_ListaHotkey.SelectedIndex(0) = -1 Then SoloAñadir = True
        If SoloAñadir = True Then
            Comandos_MenuHotkey_Eliminar.Visible = False : Comandos_MenuHotkey_Separador0.Visible = False
            Comandos_MenuHotkey.Height = 26
        End If
    End Sub

    Private Sub Comandos_MenuHotkey_Añadir_Click(sender As Object, e As EventArgs) Handles Comandos_MenuHotkey_Añadir.Click
        Comandos_Hotkey_THotkey.Text = "" : Comandos_Hotkey_THotkey.Focus()
    End Sub

    Private Sub Comandos_MenuHotkey_Eliminar_Click(sender As Object, e As EventArgs) Handles Comandos_MenuHotkey_Eliminar.Click
        If Comandos_Hotkey_ListaHotkey.SelectedItems(0).Text <> "" Then
            Dim Indice As Integer = Comandos_Hotkey_ListaHotkey.SelectedIndex(0)
            Comandos_Hotkey_ListaHotkey.RemoveItem(Comandos_Hotkey_ListaHotkey.SelectedItems(0))
            If Comandos_Hotkey_ListaHotkey.Items.Count > 0 Then If Indice > Comandos_Hotkey_ListaHotkey.Items.Count - 1 Then Comandos_Hotkey_ListaHotkey.SelectItem(Comandos_Hotkey_ListaHotkey.Items.Count - 1) Else Comandos_Hotkey_ListaHotkey.SelectItem(Indice)
            Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID)
            If IndiceID <> -1 Then
                ReDim Comandos(IndiceID).Hotkey(Comandos_Hotkey_ListaHotkey.Items.Count - 1)
                For Cuenta = 0 To Comandos_Hotkey_ListaHotkey.Items.Count - 1
                    Comandos(IndiceID).Hotkey(Cuenta) = Comandos_Hotkey_ListaHotkey.Items(Cuenta).Text
                Next : Comando_GuardarValor("Hotkey")
            End If
        End If
    End Sub

    Private Sub MenuHotKey_MItem_MouseEnter(sender As Object, e As EventArgs) Handles Comandos_MenuHotkey_Añadir.MouseEnter, Comandos_MenuHotkey_Eliminar.MouseEnter
        Dim QMItem As ToolStripMenuItem = CType(sender, ToolStripMenuItem) : QMItem.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub MenuHotKey_MItem_MouseLeave(sender As Object, e As EventArgs) Handles Comandos_MenuHotkey_Añadir.MouseLeave, Comandos_MenuHotkey_Eliminar.MouseLeave
        Dim QMItem As ToolStripMenuItem = CType(sender, ToolStripMenuItem) : QMItem.ForeColor = Color.FromArgb(130, 130, 130)
    End Sub

#End Region

#End Region

#Region " Acciones "

    Private Sub Comandos_Accion_ListaAccion_SelectedIndexChanged(sender As Object, Indice As Integer) Handles Comandos_Accion_ListaAccion.SelectedIndexChanged
        If GMacro_Grabando = True Then
            If Indice <> CurrentAccionIndex Then Comandos_Accion_ListaAccion.SelectItem(CurrentAccionIndex)
        Else
            Accion_Mostrar(Indice)
        End If
    End Sub

#Region " KeyPress "

    Private Sub Comandos_Accion_ListaAccion_KeyDown(sender As Object, e As KeyEventArgs) Handles Comandos_Accion_ListaAccion.KeyDown
        If e.KeyCode = Keys.Delete Then e.Handled = True : Accion_Eliminar()
    End Sub

    Private Sub Comandos_Accion_ListaAccion_MouseUp(sender As Object, e As MouseEventArgs) Handles Comandos_Accion_ListaAccion.MouseUp
        If StartMovingItemList = True AndAlso e.Button = MouseButtons.Left Then StartMovingItemList = False : MovingStartPos = -1
    End Sub

    Private Sub Comandos_Accion_ListaAccion_MouseDown(sender As Object, e As MouseEventArgs) Handles Comandos_Accion_ListaAccion.MouseDown
        If e.Button <> MouseButtons.Left Then Exit Sub
        Application.DoEvents()
        If GMacro_Grabando = True Then Comandos_Accion_ListaAccion.AllowDrop = False : Exit Sub
        If Keyboard.Get_KeyState(Keys.LControlKey) Or Keyboard.Get_KeyState(Keys.RControlKey) Then

        Else
            If Comandos_Accion_ListaAccion.Items.Count < 2 OrElse Comandos_Accion_ListaAccion.SelectedIndex(0) = -1 Then Comandos_Accion_ListaAccion.AllowDrop = False : Exit Sub
        End If
        StartMovingItemList = True : Comandos_Accion_ListaAccion.AllowDrop = True : GSalidaAudio_ListaSeleccionados.AllowDrop = False : GSalidaAudio_ListaDisponibles.AllowDrop = False
    End Sub

    Private Sub Comandos_Accion_ListaAccion_MouseMove(sender As Object, e As MouseEventArgs) Handles Comandos_Accion_ListaAccion.MouseMove
        If StartMovingItemList = True Then
            StartMovingItemList = False
            If Keyboard.Get_KeyState(Keys.LControlKey) Or Keyboard.Get_KeyState(Keys.RControlKey) Then
                Comandos_Accion_ListaAccion.DoDragDrop("", DragDropEffects.Copy)
            Else
                Comandos_Accion_ListaAccion.DoDragDrop("", DragDropEffects.Move)
            End If
        End If
    End Sub

#End Region

#Region " Drag & Drop "

    Private Sub Comandos_Accion_ListaAccion_DragEnter(sender As Object, e As DragEventArgs) Handles Comandos_Accion_ListaAccion.DragEnter
        If CancelDrop = True Or GMacro_Grabando = True Then CancelDrop = False : Comandos_Accion_ListaAccion.AllowDrop = True : Exit Sub
        If Comandos_Accion_ListaAccion.Items.Count = 0 OrElse Comandos_Accion_ListaAccion.SelectedIndex(0) = -1 Then Exit Sub
        If MovingItemList = True Then MovingItemList = False : Exit Sub
        MoveStrip = sender
        If Keyboard.Get_KeyState(Keys.LControlKey) Or Keyboard.Get_KeyState(Keys.RControlKey) Then
            e.Effect = DragDropEffects.Copy
            If ComandoActualID = "Negativo" Then
                Accion_AItem = Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
            Else
                Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID) : If IndiceID = -1 Then Exit Sub
                Accion_AItem = Comandos(IndiceID).Accion(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
            End If
        Else
            e.Effect = DragDropEffects.Move
        End If
        MovingStartPos = Comandos_Accion_ListaAccion.SelectedIndex(0)
        MovingDataList = Comandos_Accion_ListaAccion.SelectedItems(0)
        MovingItemList = True
    End Sub

    Private Sub Comandos_Accion_ListaAccion_DragLeave(sender As Object, e As DragEventArgs) Handles Comandos_Accion_ListaAccion.DragLeave
        MovingItemList = False
    End Sub

    Dim CancelDrop As Boolean
    Private Sub Comandos_Accion_ListaAccion_DragDrop(sender As Object, e As DragEventArgs) Handles Comandos_Accion_ListaAccion.DragDrop
        If CancelDrop = True Then CancelDrop = False : Exit Sub
        Try : MovingItemList = False
            Dim Position As Integer = -1 : Dim pt As New Point(PointToClient(MousePosition).X - (PanelComandos.Left + Comandos_Accion_ListaAccion.Left), PointToClient(MousePosition).Y - (PanelComandos.Top + Comandos_Accion_ListaAccion.Top))
            For Cuenta As Integer = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
                If Comandos_Accion_ListaAccion.Items(Cuenta).Area.Contains(pt) Then Position = Cuenta : GoTo Salta1
            Next
Salta1:
            If e.Effect = DragDropEffects.Copy Then
                If ComandoActualID = "Negativo" Then
                    If Comandos_Accion_AccionesTemporales Is Nothing Then
                        ReDim Comandos_Accion_AccionesTemporales(0)
                    Else
                        If Comandos_Accion_AccionesTemporales.Length = 0 OrElse Comandos_Accion_AccionesTemporales(0).Tipo = "" Then ReDim Comandos_Accion_AccionesTemporales(0) Else ReDim Preserve Comandos_Accion_AccionesTemporales(Comandos_Accion_AccionesTemporales.Length)
                    End If
                    Dim Indice As Integer = Comandos_Accion_AccionesTemporales.Length - 1
                    Comandos_Accion_AccionesTemporales(Indice) = Accion_AItem
                    Comandos_Accion_AccionesTemporales(Indice).ID = Now.ToString("ddMMyyyyHHmmss")
                    Comandos_Accion_AccionesTemporales(Indice).ParentID = ""
                    If Position = -1 Then
                        Comandos_Accion_AccionesTemporales(Indice).Indice = Comandos_Accion_ListaAccion.Items.Count
                        Comandos_Accion_ListaAccion.AddItem(Comandos_Accion_AccionesTemporales(Indice).Tipo, Indice)
                        Comandos_Accion_ListaAccion.Items(Comandos_Accion_ListaAccion.Items.Count - 1).Tag2 = Comandos_Accion_AccionesTemporales(Indice).ID
                        Comandos_Accion_ListaAccion.SelectItem(Comandos_Accion_ListaAccion.Items.Count - 1)
                    Else
                        Comandos_Accion_AccionesTemporales(Indice).Indice = Position
                        Dim NewItem As New NSListView.NSListViewItem
                        NewItem.Text = Comandos_Accion_AccionesTemporales(Indice).Tipo
                        NewItem.Tag = Indice
                        NewItem.Tag2 = Comandos_Accion_AccionesTemporales(Indice).ID
                        Comandos_Accion_ListaAccion.InsertItemAt(Position, NewItem)
                        Comandos_Accion_ListaAccion.SelectItem(Position)
                    End If
                    If Comandos_Accion_AccionesTemporales(Indice).Tipo = "Ejecutar BAT" AndAlso IO.File.Exists(KobaPath + "BATs\" + Accion_AItem.ID + ".bat") = True Then IO.File.Copy(KobaPath + "BATs\" + Accion_AItem.ID + ".bat", KobaPath + "BATs\" + Comandos_Accion_AccionesTemporales(Indice).ID + ".bat", True)
                    If Comandos_Accion_AccionesTemporales(Indice).Tipo = "Macros" AndAlso IO.File.Exists(KobaPath + "MACROs\" + Accion_AItem.ID + ".mcr") = True Then IO.File.Copy(KobaPath + "MACROs\" + Accion_AItem.ID + ".mcr", KobaPath + "MACROs\" + Comandos_Accion_AccionesTemporales(Indice).ID + ".mcr", True)
                Else
                    Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID) : If IndiceID = -1 Then Exit Sub
                    If IndiceID = -1 Then HTexto.Focus() : Exit Sub
                    If Comandos(IndiceID).Accion IsNot Nothing AndAlso Comandos(IndiceID).Accion.Length > 0 Then
                        If Comandos(IndiceID).Accion(Comandos(IndiceID).Accion.Length - 1).ID <> "" Then ReDim Preserve Comandos(IndiceID).Accion(Comandos(IndiceID).Accion.Length)
                    Else
                        ReDim Comandos(IndiceID).Accion(0)
                    End If
                    Dim Indice As Integer = Comandos(IndiceID).Accion.Length - 1
                    Comandos(IndiceID).Accion(Indice) = Accion_AItem
                    Comandos(IndiceID).Accion(Indice).ID = Now.ToString("ddMMyyyyHHmmss")
                    Comandos(IndiceID).Accion(Indice).ParentID = ComandoActualID
                    If Position = -1 Then
                        Comandos(IndiceID).Accion(Indice).Indice = Comandos_Accion_ListaAccion.Items.Count
                        Comandos_Accion_ListaAccion.AddItem(Comandos(IndiceID).Accion(Indice).Tipo, Indice)
                        Comandos_Accion_ListaAccion.Items(Comandos_Accion_ListaAccion.Items.Count - 1).Tag2 = Comandos(IndiceID).Accion(Indice).ID
                        Comandos_Accion_ListaAccion.SelectItem(Comandos_Accion_ListaAccion.Items.Count - 1)
                    Else
                        Comandos(IndiceID).Accion(Indice).Indice = Position
                        Dim NewItem As New NSListView.NSListViewItem
                        NewItem.Text = Comandos(IndiceID).Accion(Indice).Tipo
                        NewItem.Tag = Indice
                        NewItem.Tag2 = Comandos(IndiceID).Accion(Indice).ID
                        Comandos_Accion_ListaAccion.InsertItemAt(Position, NewItem)
                        Comandos_Accion_ListaAccion.SelectItem(Position)
                    End If
                    If Comandos(IndiceID).Accion(Indice).Tipo = "Ejecutar BAT" AndAlso IO.File.Exists(KobaPath + "BATs\" + Accion_AItem.ID + ".bat") = True Then IO.File.Copy(KobaPath + "BATs\" + Accion_AItem.ID + ".bat", KobaPath + "BATs\" + Comandos(IndiceID).Accion(Indice).ID + ".bat", True)
                    If Comandos(IndiceID).Accion(Indice).Tipo = "Macros" AndAlso IO.File.Exists(KobaPath + "MACROs\" + Accion_AItem.ID + ".mcr") = True Then IO.File.Copy(KobaPath + "MACROs\" + Accion_AItem.ID + ".mcr", KobaPath + "MACROs\" + Comandos(IndiceID).Accion(Indice).ID + ".mcr", True)
                End If
            ElseIf e.Effect = DragDropEffects.Move Then
                Comandos_Accion_ListaAccion.RemoveItemAt(MovingStartPos)
                If Position = -1 Then
                    Comandos_Accion_ListaAccion.AddItem(MovingDataList.Text, MovingDataList.Tag)
                    Comandos_Accion_ListaAccion.Items(Comandos_Accion_ListaAccion.Items.Length - 1).Tag2 = MovingDataList.Tag2
                    Comandos_Accion_ListaAccion.SelectItem(Comandos_Accion_ListaAccion.Items.Count - 1)
                Else
                    Comandos_Accion_ListaAccion.InsertItemAt(Position, MovingDataList)
                    Comandos_Accion_ListaAccion.SelectItem(Position)
                End If
            End If
            If ComandoActualID = "-1" Or ComandoActualID = "-2" Or ComandoActualID = "Negativo" Then
                For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1 : Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Cuenta).Tag).Indice = Cuenta : Next
                Comandos_Accion_AccionesTemporales = Accion_Sort(Comandos_Accion_AccionesTemporales)
                For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
                    For Cuenta2 = 0 To Comandos_Accion_AccionesTemporales.Length - 1
                        If Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 = Comandos_Accion_AccionesTemporales(Cuenta2).ID Then Comandos_Accion_ListaAccion.Items(Cuenta).Tag = Cuenta2 : GoTo Sigue1
                    Next
Sigue1:         Next
            Else
                Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID)
                For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1 : Comandos(IndiceID).Accion(Comandos_Accion_ListaAccion.Items(Cuenta).Tag).Indice = Cuenta : Next
                Comandos(IndiceID).Accion = Accion_Sort(Comandos(IndiceID).Accion)
                For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
                    For Cuenta2 = 0 To Comandos(IndiceID).Accion.Length - 1
                        If Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 = Comandos(IndiceID).Accion(Cuenta2).ID Then Comandos_Accion_ListaAccion.Items(Cuenta).Tag = Cuenta2 : GoTo Sigue2
                    Next
Sigue2:         Next : Accion_Guardar() : Accion_Mostrar(Comandos_Accion_ListaAccion.SelectedIndex(0))
            End If
        Catch : End Try
    End Sub

#End Region

#Region " Combo "

    Private Sub Comandos_Accion_CAccion_DropDown(sender As Object, e As EventArgs) Handles Comandos_Accion_CAccion.DropDown
        Comandos_Accion_CAccion.MaxDropDownItems = Comandos_Accion_CAccion.Items.Count : Combo_Dropped = True : Combo_TempValue = " " : Comandos_Accion_CAccion.Focus()
    End Sub

    Private Sub Comandos_Accion_CAccion_DropDownClosed(sender As Object, e As EventArgs) Handles Comandos_Accion_CAccion.DropDownClosed, Comandos_Accion_CAccion.LostFocus
        Combo_TempValue = ""
    End Sub

    Private Sub Comandos_Accion_CAccion_LostFocus(sender As Object, e As EventArgs) Handles Comandos_Accion_CAccion.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub Comandos_Accion_CAccion_SelectedIndexChanged(sender As Object, e As EventArgs) Handles Comandos_Accion_CAccion.SelectedIndexChanged
        If Combo_TempValue = "" Then
            Comandos_Accion_ListaAccion.Focus()
            If sender.Text.StartsWith("@") Then Exit Sub
            Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID)
            If ComandoActualID = "Negativo" Then
                Dim Indice As Integer = Math.Max(CurrentAccionIndex, 0)
                If CambiarAccion = False Then
                    If Comandos_Accion_AccionesTemporales Is Nothing Then
                        ReDim Comandos_Accion_AccionesTemporales(0)
                    Else
                        If Comandos_Accion_AccionesTemporales.Length = 0 OrElse Comandos_Accion_AccionesTemporales(0).Tipo = "" Then ReDim Comandos_Accion_AccionesTemporales(0) Else ReDim Preserve Comandos_Accion_AccionesTemporales(Comandos_Accion_AccionesTemporales.Length)
                    End If
                    Indice = Comandos_Accion_AccionesTemporales.Length - 1
                    Comandos_Accion_AccionesTemporales(Indice).ID = Now.ToString("ddMMyyyyHHmmss")
                    Comandos_Accion_AccionesTemporales(Indice).Indice = Comandos_Accion_ListaAccion.Items.Count
                    Comandos_Accion_AccionesTemporales(Indice).Tipo = Comandos_Accion_CAccion.SelectedItem.Trim
                    Comandos_Accion_AccionesTemporales(Indice).Settings = DefaultSettings(Comandos_Accion_CAccion.SelectedItem.Trim)
                    Comandos_Accion_AccionesTemporales(Indice).ParentID = ""
                    Comandos_Accion_ListaAccion.AddItem(Comandos_Accion_CAccion.SelectedItem.Trim, Indice)
                    Comandos_Accion_ListaAccion.Items(Comandos_Accion_ListaAccion.Items.Count - 1).Tag2 = Comandos_Accion_AccionesTemporales(Indice).ID
                    Comandos_Accion_ListaAccion.SelectItem(Comandos_Accion_ListaAccion.Items.Count - 1)
                    Comandos_Accion_ListaAccion.EnsureVisibleAt(Comandos_Accion_ListaAccion.Items.Count - 1)
                Else
                    Comandos_Accion_AccionesTemporales(Indice).ID = Now.ToString("ddMMyyyyHHmmss")
                    Comandos_Accion_AccionesTemporales(Indice).Indice = Indice
                    Comandos_Accion_AccionesTemporales(Indice).Tipo = Comandos_Accion_CAccion.SelectedItem.Trim
                    Comandos_Accion_AccionesTemporales(Indice).Settings = DefaultSettings(Comandos_Accion_CAccion.SelectedItem.Trim)
                    Comandos_Accion_AccionesTemporales(Indice).ParentID = ""
                    Comandos_Accion_ListaAccion.Items(Indice).Text = Comandos_Accion_CAccion.SelectedItem.Trim
                    Comandos_Accion_ListaAccion.Items(Indice).Tag = Indice
                    Comandos_Accion_ListaAccion.Items(Indice).Tag2 = Comandos_Accion_AccionesTemporales(Indice).ID
                    Comandos_Accion_ListaAccion.SelectItem(Indice)
                End If
                Iconos_Update()
            Else
                If IndiceID = -1 Then HTexto.Focus() : Exit Sub
                Dim Indice As Integer = Math.Max(CurrentAccionIndex, 0)
                If CambiarAccion = False Then
                    If Comandos(IndiceID).Accion IsNot Nothing AndAlso Comandos(IndiceID).Accion.Length > 0 Then
                        If Comandos(IndiceID).Accion(Comandos(IndiceID).Accion.Length - 1).ID <> "" Then ReDim Preserve Comandos(IndiceID).Accion(Comandos(IndiceID).Accion.Length)
                    Else
                        ReDim Comandos(IndiceID).Accion(0)
                    End If
                    Indice = Comandos(IndiceID).Accion.Length - 1
                    Comandos(IndiceID).Accion(Indice).ID = Now.ToString("ddMMyyyyHHmmss")
                    Comandos(IndiceID).Accion(Indice).Indice = Comandos_Accion_ListaAccion.Items.Count
                    Comandos(IndiceID).Accion(Indice).Tipo = Comandos_Accion_CAccion.SelectedItem.Trim
                    Comandos(IndiceID).Accion(Indice).Settings = DefaultSettings(Comandos_Accion_CAccion.SelectedItem.Trim, Comandos(IndiceID).Accion(Indice).ID)
                    Comandos(IndiceID).Accion(Indice).ParentID = Comandos(IndiceID).ID
                    Comandos_Accion_ListaAccion.AddItem(Comandos_Accion_CAccion.SelectedItem.Trim, Indice)
                    Comandos_Accion_ListaAccion.Items(Comandos_Accion_ListaAccion.Items.Count - 1).Tag2 = Comandos(IndiceID).Accion(Indice).ID
                    Comandos_Accion_ListaAccion.SelectItem(Comandos_Accion_ListaAccion.Items.Count - 1)
                    Comandos_Accion_ListaAccion.EnsureVisibleAt(Comandos_Accion_ListaAccion.Items.Count - 1)
                Else
                    Comandos(IndiceID).Accion(Indice).ID = Now.ToString("ddMMyyyyHHmmss")
                    Comandos(IndiceID).Accion(Indice).Indice = Indice
                    Comandos(IndiceID).Accion(Indice).Tipo = Comandos_Accion_CAccion.SelectedItem.Trim
                    Comandos(IndiceID).Accion(Indice).Settings = DefaultSettings(Comandos_Accion_CAccion.SelectedItem.Trim, Comandos(IndiceID).Accion(Indice).ID)
                    Comandos(IndiceID).Accion(Indice).ParentID = Comandos(IndiceID).ID
                    Comandos_Accion_ListaAccion.Items(Indice).Text = Comandos_Accion_CAccion.SelectedItem.Trim
                    Comandos_Accion_ListaAccion.Items(Indice).Tag = Indice
                    Comandos_Accion_ListaAccion.Items(Indice).Tag2 = Comandos(IndiceID).Accion(Indice).ID
                    Comandos_Accion_ListaAccion.SelectItem(Indice)
                End If
                Accion_Guardar()
            End If
            CambiarAccion = False
            Lista.Invalidate()
            Estadisticas.Estadisticas.Acciones_Creadas += 1 : Estadisticas.Guardar()
        End If
    End Sub

    Private Sub Comandos_Accion_CAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Comandos_Accion_CAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then Comandos_Accion_CAccion_SelectedIndexChanged(sender, Nothing) : e.Handled = True
    End Sub

#End Region

#Region " Up / Down "

    Private Function Accion_Sort(cAccion() As AccionST) As Object
        Dim TempAccion(cAccion.Length - 1) As AccionST
        For Cuenta = 0 To cAccion.Length - 1
            For Cuenta2 = 0 To cAccion.Length - 1
                If cAccion(Cuenta2).Indice = Cuenta Then TempAccion(Cuenta) = cAccion(Cuenta2)
            Next
        Next : Return TempAccion
    End Function

    Private Sub Comandos_Accion_Up_Click(sender As Object, e As MouseEventArgs) Handles Comandos_Accion_Up.Click, Comandos_Accion_Up.DoubleClick
        If e.Button <> MouseButtons.Left Or GMacro_Grabando = True Then Exit Sub
        If Comandos_Accion_ListaAccion.Items.Count = 0 Then Exit Sub
        If Comandos_Accion_ListaAccion.SelectedIndex(0) = -1 Or Comandos_Accion_ListaAccion.SelectedIndex(0) = 0 Then Exit Sub
        Dim Item As NSListView.NSListViewItem = Comandos_Accion_ListaAccion.Items(Comandos_Accion_ListaAccion.SelectedIndex(0))
        Dim NewIndex As Integer = Comandos_Accion_ListaAccion.SelectedIndex(0) - 1 : Comandos_Accion_ListaAccion.RemoveItemAt(Comandos_Accion_ListaAccion.SelectedIndex(0)) : Comandos_Accion_ListaAccion.InsertItemAt(NewIndex, Item) : Comandos_Accion_ListaAccion.SelectItem(NewIndex) : Comandos_Accion_ListaAccion.EnsureVisibleAt(NewIndex)
        If ComandoActualID = "-1" Or ComandoActualID = "-2" Or ComandoActualID = "Negativo" Then
            For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1 : Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Cuenta).Tag).Indice = Cuenta : Next
            Comandos_Accion_AccionesTemporales = Accion_Sort(Comandos_Accion_AccionesTemporales)
            For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
                For Cuenta2 = 0 To Comandos_Accion_AccionesTemporales.Length - 1
                    If Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 = Comandos_Accion_AccionesTemporales(Cuenta2).ID Then Comandos_Accion_ListaAccion.Items(Cuenta).Tag = Cuenta2 : GoTo Sigue1
                Next
Sigue1:     Next
        Else
            Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID)
            For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1 : Comandos(IndiceID).Accion(Comandos_Accion_ListaAccion.Items(Cuenta).Tag).Indice = Cuenta : Next
            Comandos(IndiceID).Accion = Accion_Sort(Comandos(IndiceID).Accion)
            For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
                For Cuenta2 = 0 To Comandos(IndiceID).Accion.Length - 1
                    If Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 = Comandos(IndiceID).Accion(Cuenta2).ID Then Comandos_Accion_ListaAccion.Items(Cuenta).Tag = Cuenta2 : GoTo Sigue2
                Next
Sigue2:     Next : Accion_Guardar()
        End If
    End Sub

    Private Sub Comandos_Accion_Down_Click(sender As Object, e As MouseEventArgs) Handles Comandos_Accion_Down.Click, Comandos_Accion_Down.DoubleClick
        If e.Button <> MouseButtons.Left Or GMacro_Grabando = True Then Exit Sub
        If Comandos_Accion_ListaAccion.Items.Count = 0 Then Exit Sub
        If Comandos_Accion_ListaAccion.SelectedIndex(0) = -1 Or Comandos_Accion_ListaAccion.SelectedIndex(0) = Comandos_Accion_ListaAccion.Items.Count - 1 Then Exit Sub
        Dim Item As NSListView.NSListViewItem = Comandos_Accion_ListaAccion.Items(Comandos_Accion_ListaAccion.SelectedIndex(0))
        Dim NewIndex As Integer = Comandos_Accion_ListaAccion.SelectedIndex(0) + 1 : Comandos_Accion_ListaAccion.RemoveItemAt(Comandos_Accion_ListaAccion.SelectedIndex(0)) : Comandos_Accion_ListaAccion.InsertItemAt(NewIndex, Item) : Comandos_Accion_ListaAccion.SelectItem(NewIndex) : Comandos_Accion_ListaAccion.EnsureVisibleAt(NewIndex)
        If ComandoActualID = "-1" Or ComandoActualID = "-2" Or ComandoActualID = "Negativo" Then
            For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1 : Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Cuenta).Tag).Indice = Cuenta : Next
            Comandos_Accion_AccionesTemporales = Accion_Sort(Comandos_Accion_AccionesTemporales)
            For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
                For Cuenta2 = 0 To Comandos_Accion_AccionesTemporales.Length - 1
                    If Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 = Comandos_Accion_AccionesTemporales(Cuenta2).ID Then Comandos_Accion_ListaAccion.Items(Cuenta).Tag = Cuenta2 : GoTo Sigue1
                Next
Sigue1:     Next
        Else
            Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID)
            For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1 : Comandos(IndiceID).Accion(Comandos_Accion_ListaAccion.Items(Cuenta).Tag).Indice = Cuenta : Next
            Comandos(IndiceID).Accion = Accion_Sort(Comandos(IndiceID).Accion)
            For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
                For Cuenta2 = 0 To Comandos(IndiceID).Accion.Length - 1
                    If Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 = Comandos(IndiceID).Accion(Cuenta2).ID Then Comandos_Accion_ListaAccion.Items(Cuenta).Tag = Cuenta2 : GoTo Sigue2
                Next
Sigue2:     Next : Accion_Guardar()
        End If
    End Sub

#End Region

#Region " Menu "

#Region " Eventos "

    Private Sub Comandos_MenuAccion_Opening(sender As Object, e As System.ComponentModel.CancelEventArgs) Handles Comandos_MenuAccion.Opening
        If GMacro_Grabando = True Then e.Cancel = True : Exit Sub
        Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID)
        Comandos_MenuAccion_Eliminar.Visible = True : Comandos_MenuAccion_Separador0.Visible = True : Comandos_MenuAccion_Cambiar.Visible = True : Comandos_MenuAccion_Separador4.Visible = True : Comandos_MenuAccion_Ejecutar.Visible = True : Comandos_MenuAccion_Separador1.Visible = True : Comandos_MenuAccion.Height = 110
        Dim SoloAñadir, NoEjecutar As Boolean
        If Comandos_Accion_ListaAccion.Items.Count = 0 Then SoloAñadir = True
        If Comandos_Accion_ListaAccion.SelectedIndex(0) = -1 Then SoloAñadir = True
        If ComandoActualID = "-1" Or ComandoActualID = "Negativo" AndAlso Comandos_Accion_ListaAccion.SelectedItems.Length > 0 Then
            If Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Tipo = "Desactivar en (On/Off)" Then NoEjecutar = True
            If Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Tipo = "QuickMenu" Then NoEjecutar = True
            If Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Tipo = "TopMost (On/Off)" Then NoEjecutar = True
            If Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Tipo = "Macros" Then NoEjecutar = True
        ElseIf Comandos_Accion_ListaAccion.SelectedItems.Length > 0 Then
            If Comandos(IndiceID).Accion(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Tipo = "Desactivar en (On/Off)" Then NoEjecutar = True
            If Comandos(IndiceID).Accion(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Tipo = "QuickMenu" Then NoEjecutar = True
            If Comandos(IndiceID).Accion(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Tipo = "TopMost (On/Off)" Then NoEjecutar = True
        End If
        Comandos_MenuAccion_Eliminar.Visible = False : Comandos_MenuAccion_Separador0.Visible = False
        Comandos_MenuAccion_Cambiar.Visible = False : Comandos_MenuAccion_Separador4.Visible = False
        Comandos_MenuAccion_Ejecutar.Visible = False : Comandos_MenuAccion_Separador1.Visible = False
        Comandos_MenuAccion_Cortar.Visible = False : Comandos_MenuAccion_Separador2.Visible = False
        Comandos_MenuAccion_Copiar.Visible = False : Comandos_MenuAccion_Separador3.Visible = False
        Comandos_MenuAccion_Pegar.Visible = False
        Comandos_MenuAccion.Height = 26
        If SoloAñadir = False Then
            Comandos_MenuAccion_Eliminar.Visible = True : Comandos_MenuAccion_Separador0.Visible = True
            Comandos_MenuAccion_Cambiar.Visible = True : Comandos_MenuAccion_Separador4.Visible = True
            Comandos_MenuAccion_Separador2.Visible = True
            Comandos_MenuAccion_Cortar.Visible = True
            Comandos_MenuAccion_Copiar.Visible = True
            Comandos_MenuAccion.Height += 106
        End If
        If SoloAñadir = False And NoEjecutar = False Then
            Comandos_MenuAccion_Ejecutar.Visible = True : Comandos_MenuAccion_Separador1.Visible = True
            Comandos_MenuAccion.Height += 28
        End If
        If Accion_ACItem.ID <> "" Then
            Comandos_MenuAccion_Separador3.Visible = True
            Comandos_MenuAccion_Pegar.Visible = True
            Comandos_MenuAccion.Height += 28
        End If
    End Sub

    Private Sub MenuAccion_MItem_MouseEnter(sender As Object, e As EventArgs) Handles Comandos_MenuAccion_Añadir.MouseEnter, Comandos_MenuAccion_Eliminar.MouseEnter, Comandos_MenuAccion_Cambiar.MouseEnter, Comandos_MenuAccion_Ejecutar.MouseEnter, Comandos_MenuAccion_Cortar.MouseEnter, Comandos_MenuAccion_Copiar.MouseEnter, Comandos_MenuAccion_Pegar.MouseEnter
        Dim QMItem As ToolStripMenuItem = CType(sender, ToolStripMenuItem) : QMItem.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub MenuAccion_MItem_MouseLeave(sender As Object, e As EventArgs) Handles Comandos_MenuAccion_Añadir.MouseLeave, Comandos_MenuAccion_Eliminar.MouseLeave, Comandos_MenuAccion_Cambiar.MouseLeave, Comandos_MenuAccion_Ejecutar.MouseLeave, Comandos_MenuAccion_Cortar.MouseLeave, Comandos_MenuAccion_Copiar.MouseLeave, Comandos_MenuAccion_Pegar.MouseLeave
        Dim QMItem As ToolStripMenuItem = CType(sender, ToolStripMenuItem) : QMItem.ForeColor = Color.FromArgb(130, 130, 130)
    End Sub

#End Region

#Region " Añadir "

    Private Sub Comandos_MenuAccion_Añadir_Click(sender As Object, e As EventArgs) Handles Comandos_MenuAccion_Añadir.Click
        Comandos_Accion_CAccion.DroppedDown = True : CambiarAccion = False
    End Sub

    Private Sub Comandos_Accion_BAccionAdd_Click(sender As Object, e As MouseEventArgs) Handles Comandos_Accion_BAccionAdd.Click
        If e.Button <> MouseButtons.Left Or GMacro_Grabando = True Then Exit Sub
        Comandos_Accion_CAccion.DroppedDown = True : CambiarAccion = False
    End Sub

#End Region

#Region " Eliminar "

    Private Sub Comandos_MenuAccion_Eliminar_Click(sender As Object, e As EventArgs) Handles Comandos_MenuAccion_Eliminar.Click
        Accion_Eliminar()
    End Sub

#Region " Accion Elminar "

    Private Sub Accion_Eliminar()
        If Comandos_Accion_ListaAccion.Items.Count = 0 Then Accion_Mostrar(-1) : Exit Sub
        Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID)
        Dim Indice As Integer = Comandos_Accion_ListaAccion.SelectedIndex(0)
        Accion_Eliminar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        If IO.File.Exists(KobaPath + "BATs\" + Comandos_Accion_ListaAccion.SelectedItems(0).Tag2 + ".bat") = True Then IO.File.Delete(KobaPath + "BATs\" + Comandos_Accion_ListaAccion.SelectedItems(0).Tag2 + ".bat")
        If IO.File.Exists(KobaPath + "MACROs\" + Comandos_Accion_ListaAccion.SelectedItems(0).Tag2 + ".mcr") = True Then IO.File.Delete(KobaPath + "MACROs\" + Comandos_Accion_ListaAccion.SelectedItems(0).Tag2 + ".mcr")
        Comandos_Accion_ListaAccion.RemoveItem(Comandos_Accion_ListaAccion.SelectedItems(0))
        Estadisticas.Estadisticas.Acciones_Eliminadas += 1 : Estadisticas.Guardar()
        If Comandos_Accion_ListaAccion.Items.Count = 0 Then Comandos_Accion_ListaAccion.Refresh() : OcultarPaneles()
        For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
            If ComandoActualID = "-1" Or ComandoActualID = "Negativo" Then
                For Cuenta2 = 0 To Comandos_Accion_AccionesTemporales.Length - 1
                    If Comandos_Accion_AccionesTemporales(Cuenta2).ID <> Nothing Then
                        If Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 = Comandos_Accion_AccionesTemporales(Cuenta2).ID Then
                            Comandos_Accion_ListaAccion.Items(Cuenta).Tag = Cuenta2
                            Exit For
                        End If
                    End If
                Next
            Else
                For Cuenta2 = 0 To Comandos(IndiceID).Accion.Length - 1
                    If Comandos(IndiceID).Accion(Cuenta2).ID <> Nothing Then
                        If Comandos_Accion_ListaAccion.Items(Cuenta).Tag2 = Comandos(IndiceID).Accion(Cuenta2).ID Then
                            Comandos_Accion_ListaAccion.Items(Cuenta).Tag = Cuenta2
                            Exit For
                        End If
                    End If
                Next
            End If
        Next
        For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
            If ComandoActualID = "-1" Or ComandoActualID = "Negativo" Then
                Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Cuenta).Tag).Indice = Cuenta
            Else
                Comandos(IndiceID).Accion(Comandos_Accion_ListaAccion.Items(Cuenta).Tag).Indice = Cuenta
            End If
        Next : If ComandoActualID <> "-1" And ComandoActualID <> "-2" And ComandoActualID <> "Negativo" Then Accion_Guardar()
        If Indice > Comandos_Accion_ListaAccion.Items.Count - 1 Then
            Comandos_Accion_ListaAccion.SelectItem(Comandos_Accion_ListaAccion.Items.Count - 1)
            Comandos_Accion_ListaAccion.EnsureVisibleAt(Comandos_Accion_ListaAccion.Items.Count - 1)
            Accion_Mostrar(Comandos_Accion_ListaAccion.Items.Count - 1)
        Else
            Comandos_Accion_ListaAccion.SelectItem(Indice)
            Comandos_Accion_ListaAccion.EnsureVisibleAt(Indice)
            Accion_Mostrar(Indice)
        End If
        Lista.Invalidate()
    End Sub

    Private Sub Accion_Eliminar(Indice As Integer)
        Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID)
        If ComandoActualID = "-1" Or ComandoActualID = "Negativo" Then
            Array.Copy(Comandos_Accion_AccionesTemporales, Indice + 1, Comandos_Accion_AccionesTemporales, Indice, UBound(Comandos_Accion_AccionesTemporales) - Indice)
            ReDim Preserve Comandos_Accion_AccionesTemporales(UBound(Comandos_Accion_AccionesTemporales) - 1)
        Else
            Array.Copy(Comandos(IndiceID).Accion, Indice + 1, Comandos(IndiceID).Accion, Indice, UBound(Comandos(IndiceID).Accion) - Indice)
            ReDim Preserve Comandos(IndiceID).Accion(UBound(Comandos(IndiceID).Accion) - 1)
        End If
    End Sub

#End Region

#End Region

#Region " Cambiar "

    Dim CambiarAccion As Boolean
    Private Sub Comandos_MenuAccion_Cambiar_Click(sender As Object, e As EventArgs) Handles Comandos_MenuAccion_Cambiar.Click
        Comandos_Accion_CAccion.DroppedDown = True : CambiarAccion = True
    End Sub

#End Region

#Region " Ejecutar "

    Private Sub Comandos_MenuAccion_Ejecutar_Click(sender As Object, e As EventArgs) Handles Comandos_MenuAccion_Ejecutar.Click
        If ComandoActualID = "-1" Or ComandoActualID = "Negativo" Then
            EjecutarAccion(-1, Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        Else
            Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID) : If IndiceID = -1 Then Exit Sub
            EjecutarAccion(IndiceID, Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If
    End Sub

#End Region

#Region " Cortar "

    Private Sub Comandos_MenuAccion_Cortar_Click(sender As Object, e As EventArgs) Handles Comandos_MenuAccion_Cortar.Click
        If ComandoActualID = "Negativo" Then
            Accion_ACItem = Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        Else
            Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID) : If IndiceID = -1 Then Exit Sub
            Accion_ACItem = Comandos(IndiceID).Accion(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If
        If IO.File.Exists(KobaPath + "BATs\" + Accion_ACItem.ID + ".bat") = True Then IO.File.Copy(KobaPath + "BATs\" + Accion_ACItem.ID + ".bat", KobaPath + "BATs\TempID.bat", True)
        If IO.File.Exists(KobaPath + "MACROs\" + Accion_ACItem.ID + ".mcr") = True Then IO.File.Copy(KobaPath + "MACROs\" + Accion_ACItem.ID + ".mcr", KobaPath + "MACROs\TempID.mcr", True)
        Accion_ACItem.ID = "TempID" : Accion_Eliminar()
    End Sub

#End Region

#Region " Copiar "

    Private Sub Comandos_MenuAccion_Copiar_Click(sender As Object, e As EventArgs) Handles Comandos_MenuAccion_Copiar.Click
        If ComandoActualID = "Negativo" Then
            Accion_ACItem = Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        Else
            Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID) : If IndiceID = -1 Then Exit Sub
            Accion_ACItem = Comandos(IndiceID).Accion(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If
        If IO.File.Exists(KobaPath + "BATs\" + Accion_ACItem.ID + ".bat") = True Then IO.File.Copy(KobaPath + "BATs\" + Accion_ACItem.ID + ".bat", KobaPath + "BATs\TempID.bat", True)
        If IO.File.Exists(KobaPath + "MACROs\" + Accion_ACItem.ID + ".mcr") = True Then IO.File.Copy(KobaPath + "MACROs\" + Accion_ACItem.ID + ".mcr", KobaPath + "MACROs\TempID.mcr", True)
        Accion_ACItem.ID = "TempID"
    End Sub

#End Region

#Region " Pegar "

    Private Sub Comandos_MenuAccion_Pegar_Click(sender As Object, e As EventArgs) Handles Comandos_MenuAccion_Pegar.Click
        If ComandoActualID = "Negativo" Then
            Dim Indice As Integer = Comandos_Accion_AccionesTemporales.Length - 1
            Comandos_Accion_AccionesTemporales(Indice) = Accion_ACItem
            Comandos_Accion_AccionesTemporales(Indice).ID = Now.ToString("ddMMyyyyHHmmss")
            Comandos_Accion_AccionesTemporales(Indice).ParentID = ""
            Comandos_Accion_AccionesTemporales(Indice).Indice = Comandos_Accion_ListaAccion.Items.Count
            Comandos_Accion_ListaAccion.AddItem(Comandos_Accion_AccionesTemporales(Indice).Tipo, Indice)
            Comandos_Accion_ListaAccion.Items(Comandos_Accion_ListaAccion.Items.Count - 1).Tag2 = Comandos_Accion_AccionesTemporales(Indice).ID
            Comandos_Accion_ListaAccion.SelectItem(Comandos_Accion_ListaAccion.Items.Count - 1)
            If Comandos_Accion_AccionesTemporales(Indice).Tipo = "Ejecutar BAT" AndAlso IO.File.Exists(KobaPath + "BATs\" + Accion_ACItem.ID + ".bat") = True Then IO.File.Copy(KobaPath + "BATs\" + Accion_ACItem.ID + ".bat", KobaPath + "BATs\" + Comandos_Accion_AccionesTemporales(Indice).ID + ".bat", True)
            If Comandos_Accion_AccionesTemporales(Indice).Tipo = "Macros" AndAlso IO.File.Exists(KobaPath + "MACROs\" + Accion_ACItem.ID + ".mcr") = True Then IO.File.Copy(KobaPath + "MACROs\" + Accion_ACItem.ID + ".mcr", KobaPath + "MACROs\" + Comandos_Accion_AccionesTemporales(Indice).ID + ".mcr", True)
        Else
            Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID) : If IndiceID = -1 Then Exit Sub
            If Comandos(IndiceID).Accion IsNot Nothing AndAlso Comandos(IndiceID).Accion.Length > 0 Then
                If Comandos(IndiceID).Accion(Comandos(IndiceID).Accion.Length - 1).ID <> "" Then ReDim Preserve Comandos(IndiceID).Accion(Comandos(IndiceID).Accion.Length)
            Else
                ReDim Comandos(IndiceID).Accion(0)
            End If
            Dim Indice As Integer = Comandos(IndiceID).Accion.Length - 1
            Comandos(IndiceID).Accion(Indice) = Accion_ACItem
            Comandos(IndiceID).Accion(Indice).ID = Now.ToString("ddMMyyyyHHmmss")
            Comandos(IndiceID).Accion(Indice).ParentID = ComandoActualID
            Comandos_Accion_ListaAccion.AddItem(Comandos(IndiceID).Accion(Indice).Tipo, Indice)
            Comandos_Accion_ListaAccion.Items(Comandos_Accion_ListaAccion.Items.Count - 1).Tag2 = Comandos(IndiceID).Accion(Indice).ID
            Comandos_Accion_ListaAccion.SelectItem(Comandos_Accion_ListaAccion.Items.Count - 1)
            If Comandos(IndiceID).Accion(Indice).Tipo = "Ejecutar BAT" AndAlso IO.File.Exists(KobaPath + "BATs\" + Accion_ACItem.ID + ".bat") = True Then IO.File.Copy(KobaPath + "BATs\" + Accion_ACItem.ID + ".bat", KobaPath + "BATs\" + Comandos(IndiceID).Accion(Indice).ID + ".bat", True)
            If Comandos(IndiceID).Accion(Indice).Tipo = "Macros" AndAlso IO.File.Exists(KobaPath + "MACROs\" + Accion_ACItem.ID + ".mcr") = True Then IO.File.Copy(KobaPath + "MACROs\" + Accion_ACItem.ID + ".mcr", KobaPath + "MACROs\" + Comandos(IndiceID).Accion(Indice).ID + ".mcr", True)
        End If
        If IO.File.Exists(KobaPath + "BATs\TempID.bat") = True Then IO.File.Delete(KobaPath + "BATs\TempID.bat")
        If IO.File.Exists(KobaPath + "MACROs\TempID.mcr") = True Then IO.File.Delete(KobaPath + "MACROs\TempID.mcr")
        Accion_Guardar() : Accion_Mostrar(Comandos_Accion_ListaAccion.SelectedIndex(0))
    End Sub

#End Region

#End Region

#End Region

#Region " Procesos "

#Region " LCProceso "

    Private Sub Comandos_Procesos_LCProcesos_TextChanged(sender As Object, e As EventArgs) Handles Comandos_Procesos_LCProcesos.TextChanged
        Rutas.SetFontSize(Comandos_Procesos_LCProcesos, 8)
        Comandos_Procesos_TProceso.Enabled = False
        If Comandos_Procesos_TProceso.Text.Trim = "" AndAlso Comandos_Procesos_CProceso.Items.Count = 0 Then Comandos_Procesos_LCProcesos.Text = "Seleccione una aplicación" : Comandos_Procesos_TProceso.ForeColor1 = Color.FromArgb(72, 72, 72)
    End Sub

    Private Sub Comandos_Procesos_LCProcesos_Click(sender As Object, e As MouseEventArgs) Handles Comandos_Procesos_LCProcesos.Click, Comandos_Procesos_LCProcesos.DoubleClick, Comandos_Procesos_TProceso.Click, Comandos_Procesos_TProceso.DoubleClick
        If e.Button = MouseButtons.Left Then
            If Comandos_Procesos_CProceso.Items.Count > 0 Then Comandos_Procesos_ShowCombo() Else Comandos_Procesos_BAñadir_Click(Nothing, e)
        ElseIf e.Button = MouseButtons.Right Then
            Comandos_Procesos_TProceso.Text = "" : Comandos_Procesos_LCProcesos.Visible = False : Combo_IgnoreOne = True : Comandos_Procesos_TProceso.ReadOnly = False : Comandos_Procesos_TProceso.Enabled = True : Comandos_Procesos_TProceso.Cursor = Cursors.IBeam : Comandos_Procesos_TProceso.Focus()
        Else : HTexto.Focus() : End If
    End Sub

#End Region

#Region " TProceso "

    Private Sub Comandos_Procesos_TProceso_GotFocus(sender As Object, e As EventArgs) Handles Comandos_Procesos_TProceso.GotFocus
        If Comandos_Procesos_LCProcesos.Visible = True Then HTexto.Focus()
        If Comandos_Procesos_TProceso.ForeColor1 = Color.FromArgb(72, 72, 72) Then Comandos_Procesos_TProceso.Text = "" : Comandos_Procesos_TProceso.ForeColor1 = Color.FromArgb(102, 102, 102)
        Texto_Focused = True
    End Sub

    Private Sub Comandos_Procesos_TProceso_LostFocus(sender As Object, e As EventArgs) Handles Comandos_Procesos_TProceso.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If Comandos_Procesos_LCProcesos.Visible = False Then Comandos_Procesos_LCProcesos.Visible = True : Comandos_Procesos_TProceso.ReadOnly = True : Comandos_Procesos_TProceso.Enabled = False : Comandos_Procesos_TProceso.Cursor = Cursors.Hand
        If Comandos_Procesos_TProceso.Text.Length > 1 Then Comandos_Procesos_TProceso.Text = Comandos_Procesos_TProceso.Text.Trim.Substring(0, 1).ToUpper + Comandos_Procesos_TProceso.Text.Trim.Substring(1) : Comandos_Procesos_TProceso.SelectionLength = 0
        If Comandos_Procesos_CProceso.Items.Count > 0 Then
            For Cuenta = 0 To Comandos_Procesos_CProceso.Items.Count - 1
                If Comandos_Procesos_CProceso.Items(Cuenta).ToLower = Comandos_Procesos_TProceso.Text.ToLower Then GoTo Sigue
            Next
            Comandos_Procesos_CProceso.SelectedItem = 0
            Comandos_Procesos_TProceso.Text = Comandos_Procesos_CProceso.Items(0)
Sigue:      Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text
        Else
            Comandos_Procesos_TProceso.Text = ""
            Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text
        End If
    End Sub

    Private Sub Comandos_Procesos_TProceso_KeyDown(sender As Object, e As KeyEventArgs) Handles Comandos_Procesos_TProceso.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : Comandos_Procesos_ShowCombo()
    End Sub

    Private Sub Comandos_Procesos_TProceso_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Comandos_Procesos_TProceso.KeyPress
        If Asc(e.KeyChar) = 13 Then
            Try : Dim Cuenta As Integer : e.Handled = True : Comandos_Procesos_TProceso.Text = Comandos_Procesos_TProceso.Text.Trim
                If Comandos_Procesos_TProceso.Text <> "" Then
                    If Comandos_Procesos_CProceso.Items.Count > 0 Then
                        For Cuenta = 0 To Comandos_Procesos_CProceso.Items.Count - 1
                            If Comandos_Procesos_CProceso.Items(Cuenta).ToLower = Comandos_Procesos_TProceso.Text.ToLower Then Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text : HTexto.Focus() : Exit Sub
                        Next
                    End If
                    Comandos_Procesos_CProceso.Items.Add(Comandos_Procesos_TProceso.Text.Substring(0, 1).ToUpper + Comandos_Procesos_TProceso.Text.Substring(1))
                    Comandos_Procesos_CProceso.Enabled = True
                    Comandos_Procesos_Guardar()
                Else
                    If Comandos_Procesos_CProceso.Items.Count > 0 Then
                        Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text
                    Else
                        Comandos_Procesos_TProceso.Text = ""
                        Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text
                    End If
                End If
            Catch : End Try : HTexto.Focus()
        End If
    End Sub

#End Region

#Region " CProcesos "

    Private Sub Comandos_Procesos_ShowCombo()
        If Comandos_Procesos_CProceso.Items.Count = 0 Then HTexto.Focus() : Exit Sub
        Comandos_Procesos_CProceso.Sorted = True : Comandos_Procesos_CProceso.Sorted = False
        Comandos_Procesos_CProceso.MaxDropDownItems = 10
        If Comandos_Procesos_CProceso.Items.Contains(Comandos_Procesos_TProceso.Text) = True Then Comandos_Procesos_CProceso.SelectedItem = Comandos_Procesos_TProceso.Text Else Comandos_Procesos_CProceso.SelectedIndex = 0
        Comandos_Procesos_CProceso.DroppedDown = True : Combo_Dropped = True : Comandos_Procesos_CProceso.Focus()
    End Sub

    Private Sub Comandos_Procesos_CProceso_SelectionChangeCommitted(sender As Object, e As EventArgs) Handles Comandos_Procesos_CProceso.SelectionChangeCommitted
        Comandos_Procesos_TProceso.Text = Comandos_Procesos_CProceso.SelectedItem.Trim
        Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text
        HTexto.Focus()
    End Sub

    Private Sub Comandos_Procesos_CProceso_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Comandos_Procesos_CProceso.KeyPress
        If Asc(e.KeyChar) = 13 Then Comandos_Procesos_TProceso.Text = Comandos_Procesos_CProceso.SelectedItem.Trim : Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub Comandos_Procesos_CProceso_LostFocus(sender As Object, e As EventArgs) Handles Comandos_Procesos_CProceso.LostFocus
        Combo_Dropped = False
    End Sub

#End Region

#Region " Añadir "

    Private Sub Comandos_Procesos_BAñadir_Click(sender As Object, e As MouseEventArgs) Handles Comandos_Procesos_BAñadir.Click
        If e IsNot Nothing AndAlso e.Button <> MouseButtons.Left Then Exit Sub
        Comandos_Procesos_CCurrentProcess.Items.Clear()
        For Each P As Process In Process.GetProcesses
            If NoAñadir.ToLower.Contains(P.ProcessName.ToLower + ",") = True Then GoTo Salta
            If P.ProcessName <> "" Then
                For Cuenta = 0 To Comandos_Procesos_CProceso.Items.Count - 1
                    If Comandos_Procesos_CProceso.Items(Cuenta).ToLower = P.ProcessName.ToLower Then GoTo Salta
                Next
                For Cuenta = 0 To Comandos_Procesos_CCurrentProcess.Items.Count - 1
                    If P.ProcessName.ToLower = Comandos_Procesos_CCurrentProcess.Items(Cuenta).ToString.ToLower Then GoTo Salta
                Next : Comandos_Procesos_CCurrentProcess.Items.Add(P.ProcessName.Substring(0, 1).ToUpper + P.ProcessName.Substring(1))
Salta:      End If
        Next
        If Comandos_Procesos_CCurrentProcess.Items.Count = 0 Then HTexto.Focus() : Exit Sub
        Comandos_Procesos_CCurrentProcess.Sorted = True : Comandos_Procesos_CCurrentProcess.Sorted = False
        Comandos_Procesos_CCurrentProcess.MaxDropDownItems = 10
        If Comandos_Procesos_CCurrentProcess.Items.Contains(Comandos_Procesos_TProceso.Text) = True Then Comandos_Procesos_CCurrentProcess.SelectedItem = Comandos_Procesos_TProceso.Text Else Comandos_Procesos_CCurrentProcess.SelectedIndex = 0
        Comandos_Procesos_CCurrentProcess.DroppedDown = True : Combo_Dropped = True : Comandos_Procesos_CCurrentProcess.Focus()
    End Sub

#Region " Combo "

    Private Sub Comandos_Procesos_CCurrentProcess_SelectionChangeCommitted(sender As Object, e As EventArgs) Handles Comandos_Procesos_CCurrentProcess.SelectionChangeCommitted
        For Cuenta = 0 To Comandos_Procesos_CProceso.Items.Count - 1
            If Comandos_Procesos_CProceso.Items(Cuenta).ToLower = Comandos_Procesos_CCurrentProcess.SelectedItem.ToString.ToLower.Trim Then HTexto.Focus() : Exit Sub
        Next
        Comandos_Procesos_CProceso.Items.Add(Comandos_Procesos_CCurrentProcess.SelectedItem.Trim)
        Comandos_Procesos_TProceso.Text = Comandos_Procesos_CCurrentProcess.SelectedItem.Trim
        Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text
        Comandos_Procesos_CProceso.Enabled = True
        Comandos_Procesos_Guardar()
        HTexto.Focus()
    End Sub

    Private Sub Comandos_Procesos_CCurrentProcess_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Comandos_Procesos_CCurrentProcess.KeyPress
        If Asc(e.KeyChar) = 13 Then Comandos_Procesos_TProceso.Text = Comandos_Procesos_CCurrentProcess.SelectedItem.Trim : Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub Comandos_Procesos_CCurrentProcess_LostFocus(sender As Object, e As EventArgs) Handles Comandos_Procesos_CCurrentProcess.LostFocus
        Combo_Dropped = False
    End Sub

#End Region

#End Region

#Region " Eliminar "

    Private Sub Comandos_Procesos_BEliminar_Click(sender As Object, e As MouseEventArgs) Handles Comandos_Procesos_BEliminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Comandos_Procesos_CProceso.Items.Remove(Comandos_Procesos_TProceso.Text)
        Comandos_Procesos_Guardar()
        If Comandos_Procesos_CProceso.Items.Count > 0 Then
            Comandos_Procesos_CProceso.SelectedItem = 0
            Comandos_Procesos_TProceso.Text = Comandos_Procesos_CProceso.Items(0)
            Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text
        Else
            Comandos_Procesos_CProceso.Enabled = False
            Comandos_Procesos_TProceso.Text = ""
            Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text
        End If
    End Sub

#End Region

#Region " Examinar "

    Private Sub Comandos_Procesos_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles Comandos_Procesos_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar aplicacion..." : Abrir.Filter = "Aplicaciones|*.exe|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then
            Comandos_Procesos_TProceso.Text = IO.Path.GetFileNameWithoutExtension(Abrir.FileName).Substring(0, 1).ToUpper + IO.Path.GetFileNameWithoutExtension(Abrir.FileName).Substring(1)
            Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text
            Dim Cuenta As Integer : Comandos_Procesos_TProceso.Text = Comandos_Procesos_TProceso.Text.Trim : If Comandos_Procesos_TProceso.Text <> "" Then
                For Cuenta = 0 To Comandos_Procesos_CProceso.Items.Count - 1
                    If Comandos_Procesos_CProceso.Items(Cuenta).ToLower = Comandos_Procesos_TProceso.Text.ToLower Then Exit Sub
                Next : Comandos_Procesos_CProceso.Items.Add(Comandos_Procesos_TProceso.Text.Substring(0, 1).ToUpper + Comandos_Procesos_TProceso.Text.Substring(1))
                Comandos_Procesos_Guardar()
                Comandos_Procesos_TProceso.Text = Comandos_Procesos_TProceso.Text.Substring(0, 1).ToUpper + Comandos_Procesos_TProceso.Text.Substring(1)
                Comandos_Procesos_LCProcesos.Text = Comandos_Procesos_TProceso.Text
                Comandos_Procesos_CProceso.Enabled = True
            End If
        End If
        Comandos_Procesos_BExaminar.State = NSButton.MouseState.None : Comandos_Procesos_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub Comandos_Procesos_Guardar()
        Dim IndiceID As Integer = Comandos_GetByID(ComandoActualID)
        If IndiceID <> -1 Then
            ReDim Comandos(IndiceID).Procesos(Comandos_Procesos_CProceso.Items.Count - 1)
            For Cuenta = 0 To Comandos_Procesos_CProceso.Items.Count - 1
                Comandos(IndiceID).Procesos(Cuenta) = Comandos_Procesos_CProceso.Items(Cuenta)
            Next : Comando_GuardarValor("Procesos")
        End If
    End Sub

#End Region

#End Region

#Region " Checks "

    Private Sub Comandos_EjecutarIniciar_Click(sender As Object, e As MouseEventArgs) Handles Comandos_EjecutarIniciar_LEjecutarIniciar.Click, Comandos_EjecutarIniciar_LEjecutarIniciar.DoubleClick, Comandos_EjecutarIniciar_CEjecutarIniciar.Click, Comandos_EjecutarIniciar_CEjecutarIniciar.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If Comandos_EjecutarIniciar_CEjecutarIniciar.Checked = True Then Comandos_EjecutarIniciar_CEjecutarIniciar.Checked = False Else Comandos_EjecutarIniciar_CEjecutarIniciar.Checked = True
        If Comandos_GetByID(ComandoActualID) <> -1 Then Comandos(Comandos_GetByID(ComandoActualID)).EjecutarIniciar = Comandos_EjecutarIniciar_CEjecutarIniciar.Checked
        Comando_GuardarValor("EjecutarIniciar")
    End Sub

    Private Sub Comandos_EjecutarSalir_Click(sender As Object, e As MouseEventArgs) Handles Comandos_EjecutarSalir_LEjecutarSalir.Click, Comandos_EjecutarSalir_LEjecutarSalir.DoubleClick, Comandos_EjecutarSalir_CEjecutarSalir.Click, Comandos_EjecutarSalir_CEjecutarSalir.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If Comandos_EjecutarSalir_CEjecutarSalir.Checked = True Then Comandos_EjecutarSalir_CEjecutarSalir.Checked = False Else Comandos_EjecutarSalir_CEjecutarSalir.Checked = True
        If Comandos_GetByID(ComandoActualID) <> -1 Then Comandos(Comandos_GetByID(ComandoActualID)).EjecutarSalir = Comandos_EjecutarSalir_CEjecutarSalir.Checked
        Comando_GuardarValor("EjecutarSalir")
    End Sub

    Private Sub Comandos_EjecutarSiempre_Click(sender As Object, e As MouseEventArgs) Handles Comandos_EjecutarSiempre_LEjecutarSiempre.Click, Comandos_EjecutarSiempre_LEjecutarSiempre.DoubleClick, Comandos_EjecutarSiempre_CEjecutarSiempre.Click, Comandos_EjecutarSiempre_CEjecutarSiempre.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If Comandos_EjecutarSiempre_CEjecutarSiempre.Checked = True Then Comandos_EjecutarSiempre_CEjecutarSiempre.Checked = False Else Comandos_EjecutarSiempre_CEjecutarSiempre.Checked = True
        If Comandos_GetByID(ComandoActualID) <> -1 Then Comandos(Comandos_GetByID(ComandoActualID)).EjecutarSiempre = Comandos_EjecutarSiempre_CEjecutarSiempre.Checked
        Comando_GuardarValor("EjecutarSiempre")
    End Sub

    Private Sub Comandos_Deshabilitar_Click(sender As Object, e As MouseEventArgs) Handles Comandos_Deshabilitar_LDeshabilitar.Click, Comandos_Deshabilitar_LDeshabilitar.DoubleClick, Comandos_Deshabilitar_CDeshabilitar.Click, Comandos_Deshabilitar_CDeshabilitar.DoubleClick
        If e IsNot Nothing AndAlso e.Button <> MouseButtons.Left Then Exit Sub
        If e IsNot Nothing AndAlso TypeOf sender Is NSLabel Then If Comandos_Deshabilitar_CDeshabilitar.Checked = True Then Comandos_Deshabilitar_CDeshabilitar.Checked = False Else Comandos_Deshabilitar_CDeshabilitar.Checked = True
        If ComandoActualID = "Negativo" Then
            If Comandos_Deshabilitar_CDeshabilitar.Checked = True Then
                Comandos_EjecutarSiempre_LEjecutarSiempre.Enabled = False
                Comandos_EjecutarSiempre_CEjecutarSiempre.Enabled = False
                For Cuenta = 0 To Comandos_Accion_AccionesTemporales.Length - 1
                    If Comandos_Accion_AccionesTemporales(Cuenta).EnEjecucion = True Then Comandos_Accion_AccionesTemporales(Cuenta).EnEjecucion = False : Comandos_Accion_AccionesTemporales(Cuenta).Thread_EjecutarAccion.Abort()
                Next
            Else
                Comandos_EjecutarSiempre_LEjecutarSiempre.Enabled = True
                Comandos_EjecutarSiempre_CEjecutarSiempre.Enabled = True
            End If
        Else
            If Comandos_GetByID(ComandoActualID) <> -1 Then Comandos(Comandos_GetByID(ComandoActualID)).Deshabilitar = Comandos_Deshabilitar_CDeshabilitar.Checked
            Comando_GuardarValor("Deshabilitar")
            If Comandos_Deshabilitar_CDeshabilitar.Checked = True Then
                Comandos_EjecutarSiempre_LEjecutarSiempre.Enabled = False
                Comandos_EjecutarSiempre_CEjecutarSiempre.Enabled = False
                If Comandos_GetByID(ComandoActualID) <> -1 Then
                    For Cuenta = 0 To Comandos(Comandos_GetByID(ComandoActualID)).Accion.Length - 1
                        If Comandos(Comandos_GetByID(ComandoActualID)).Accion(Cuenta).Thread_EjecutarAccion IsNot Nothing AndAlso Comandos(Comandos_GetByID(ComandoActualID)).Accion(Cuenta).Thread_EjecutarAccion.IsAlive Then Comandos(Comandos_GetByID(ComandoActualID)).Accion(Cuenta).EnEjecucion = False : Comandos(Comandos_GetByID(ComandoActualID)).Accion(Cuenta).Thread_EjecutarAccion.Abort()
                    Next
                End If
            Else
                Comandos_EjecutarSiempre_LEjecutarSiempre.Enabled = True
                Comandos_EjecutarSiempre_CEjecutarSiempre.Enabled = True
            End If
        End If
    End Sub

    Private Sub Comandos_BloquearPulsacion_Click(sender As Object, e As MouseEventArgs) Handles Comandos_BloquearPulsacion_LBloquearPulsacion.Click, Comandos_BloquearPulsacion_LBloquearPulsacion.DoubleClick, Comandos_BloquearPulsacion_CBloquearPulsacion.Click, Comandos_BloquearPulsacion_CBloquearPulsacion.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If Comandos_BloquearPulsacion_CBloquearPulsacion.Checked = True Then Comandos_BloquearPulsacion_CBloquearPulsacion.Checked = False Else Comandos_BloquearPulsacion_CBloquearPulsacion.Checked = True
        If Comandos_GetByID(ComandoActualID) <> -1 Then Comandos(Comandos_GetByID(ComandoActualID)).BloquearPulsacion = Comandos_BloquearPulsacion_CBloquearPulsacion.Checked
        Comando_GuardarValor("BloquearPulsacion")
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Comandos_Tooltips(sender As Object, e As EventArgs) Handles Comandos_EjecutarIniciar_CEjecutarIniciar.MouseEnter, Comandos_EjecutarIniciar_LEjecutarIniciar.MouseEnter, Comandos_EjecutarSalir_CEjecutarSalir.MouseEnter, Comandos_EjecutarSalir_LEjecutarSalir.MouseEnter, Comandos_EjecutarSiempre_CEjecutarSiempre.MouseEnter, Comandos_EjecutarSiempre_LEjecutarSiempre.MouseEnter, Comandos_Deshabilitar_CDeshabilitar.MouseEnter, Comandos_Deshabilitar_LDeshabilitar.MouseEnter, Comandos_BloquearPulsacion_CBloquearPulsacion.MouseEnter, Comandos_BloquearPulsacion_LBloquearPulsacion.MouseEnter, Comandos_POculto.MouseEnter, Lista_POculto.MouseEnter, Comandos_Sonido_LSonido.MouseEnter, Comandos_Sonido_BPlay.MouseEnter, Comandos_Sonido_BExaminar.MouseEnter, Comandos_Nombre_LNombre.MouseEnter, Comandos_Accion_LAccion.MouseEnter, Comandos_Accion_BAccionAdd.MouseEnter, Comandos_Hotkey_LHotkey.MouseEnter, Comandos_Hotkey_BHotkeyAdd.MouseEnter, Comandos_Procesos_BAñadir.MouseEnter, Comandos_Procesos_BEliminar.MouseEnter, Comandos_Procesos_BExaminar.MouseEnter, Comandos_Procesos_LCProcesos.MouseEnter, Lista_CComandos.MouseEnter, PBuscar.MouseEnter, Comandos_Sonido_LCSonido.MouseEnter, Comandos_Procesos_LEjecutarProcesos.MouseEnter, Comandos_LEjecutarAl.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "PBuscar" : Show_Tooltip(sender, "Permite buscar comandos por nombre")
            Case "Lista_POculto" : Show_Tooltip(sender, "Muestra u oculta los comandos ocultos")
            Case "Lista_Comandos" : If Lista.PointToClient(MousePosition).Y < 22 Then Show_Tooltip(sender, "Muestra un menu para filtrar los comandos")
            Case "Comandos_POculto" : Show_Tooltip(sender, "Muestra u oculta el comando en la lista de comandos")
            Case "Comandos_Nombre_Nombre" : Show_Tooltip(sender, "Nombre del comando")
            Case "Comandos_Sonido_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse el comando")
            Case "Comandos_Sonido_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse el comando" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "Comandos_Sonido_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "Comandos_Sonido_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
            Case "Comandos_Accion_Accion" : Show_Tooltip(sender, "Acciones que se ejecutarán")
            Case "Comandos_Accion_BAccionAdd" : Show_Tooltip(sender, "Añade una acción a la lista de acciones")
            Case "Comandos_Hotkey_Hotkey" : Show_Tooltip(sender, "Combinaciones de tecla que activan el comando")
            Case "Comandos_Hotkey_BHotkeyAdd" : Show_Tooltip(sender, "Añade a la lista el 'Hotkey' introducido")

            Case "Comandos_Procesos_CProcesos" : If Comandos_Procesos_LCProcesos.Text = "Seleccione una aplicación" Then Show_Tooltip(sender, "Añade un proceso que esté en ejecución a la lista de procesos" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente" + vbCrLf + "CTRL + Click: Selecciona un proceso con el ratón" + vbCrLf + vbCrLf + "Cuando se añade algun proceso a la lista" + vbCrLf + "el comando solo se ejecutará en esos procesos") Else Show_Tooltip(sender, "Procesos en los que se ejecutará el comando" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente" + vbCrLf + "CTRL + Click: Selecciona un proceso con el ratón" + vbCrLf + vbCrLf + "Cuando se añade algun proceso a la lista" + vbCrLf + "el comando solo se ejecutará en esos procesos")
            Case "Comandos_Procesos_BAñadir" : Show_Tooltip(sender, "Añade un proceso que esté en ejecución a la lista de procesos")
            Case "Comandos_Procesos_BEliminar" : Show_Tooltip(sender, "Elimina el proceso seleccionado de la lista de procesos")
            Case "Comandos_Procesos_BExaminar" : Show_Tooltip(sender, "Añade un archivo ejecutable a la lista de procesos")

            Case "Comandos_EjecutarIniciar_EjecutarIniciar" : Show_Tooltip(sender, "Ejecuta el comando al iniciarse K-Desktop")
            Case "Comandos_EjecutarSalir_EjecutarSalir" : Show_Tooltip(sender, "Ejecuta el comando al cerrarse K-Desktop")
            Case "Comandos_Deshabilitar_Deshabilitar" : Show_Tooltip(sender, "No ejecuta el comando cuando se presiona su 'Hotkey")
            Case "Comandos_EjecutarSiempre_EjecutarSiempre" : Show_Tooltip(sender, "Ejecuta el comando incluso cuando se haya" + vbCrLf + "deshabilitado K-Desktop en una aplicación")
            Case "Comandos_BloquearPulsacion_BloquearPulsacion" : Show_Tooltip(sender, "Impide que la aplicación actual reciba la pulsación del 'Hotkey'")
        End Select
    End Sub

#End Region

#End Region

#End Region

#Region " Panel Acciones "

#Region " Aplicaciones "

#Region " Ejecutar Aplicacion "

#Region " Check Controls "

    Private Sub GEjecutarAplicacion_CheckControls()
        If Internet.ValidarURL(GEjecutarAplicacion_TRuta.Text) = True Then
            GEjecutarAplicacion_CTopMost.Enabled = False : GEjecutarAplicacion_LTopMost.Enabled = False : GEjecutarAplicacion_CTopMost.Checked = False
            GEjecutarAplicacion_TParametros.ReadOnly = True : GEjecutarAplicacion_TParametros.Text = ""
            GEjecutarAplicacion_TParametros.ForeColor1 = Color.FromArgb(18, 18, 18) : GEjecutarAplicacion_TParametros.ForeColor2 = Color.FromArgb(18, 18, 18)
            GEjecutarAplicacion_TIniciarEn.ReadOnly = True : GEjecutarAplicacion_BExaminar_IniciarEn.Enabled = False : GEjecutarAplicacion_TIniciarEn.Text = "Por Defecto"
            GEjecutarAplicacion_TIniciarEn.ForeColor1 = Color.FromArgb(18, 18, 18) : GEjecutarAplicacion_TIniciarEn.ForeColor2 = Color.FromArgb(18, 18, 18) : GEjecutarAplicacion_TIniciarEn.Cursor = Cursors.Default
            GEjecutarAplicacion_CModo.Enabled = False : GEjecutarAplicacion_TModo.Enabled = False : GEjecutarAplicacion_LCModo.Enabled = False
            GEjecutarAplicacion_TModo.Cursor = Cursors.Default : GEjecutarAplicacion_LCModo.Cursor = Cursors.Default
            GEjecutarAplicacion_TModo.Text = "Normal" : GEjecutarAplicacion_LCModo.Text = "Normal"
            GEjecutarAplicacion_CPrioridad.Enabled = False : GEjecutarAplicacion_TPrioridad.Enabled = False : GEjecutarAplicacion_LCPrioridad.Enabled = False
            GEjecutarAplicacion_TPrioridad.Cursor = Cursors.Default : GEjecutarAplicacion_LCPrioridad.Cursor = Cursors.Default
            GEjecutarAplicacion_TPrioridad.Text = "Normal" : GEjecutarAplicacion_LCPrioridad.Text = "Normal"
            Exit Sub
        ElseIf IO.Directory.Exists(GEjecutarAplicacion_TRuta.Text) = True Or GEjecutarAplicacion_TRuta.Text.ToLower = "explorer" Then
            GEjecutarAplicacion_CTopMost.Enabled = False : GEjecutarAplicacion_LTopMost.Enabled = False : GEjecutarAplicacion_CTopMost.Checked = False
            GEjecutarAplicacion_TParametros.ReadOnly = False : GEjecutarAplicacion_TParametros.ForeColor1 = GEjecutarAplicacion_TRuta.ForeColor1 : GEjecutarAplicacion_TParametros.ForeColor2 = GEjecutarAplicacion_TRuta.ForeColor2
            GEjecutarAplicacion_TIniciarEn.ReadOnly = True : GEjecutarAplicacion_BExaminar_IniciarEn.Enabled = False : GEjecutarAplicacion_TIniciarEn.Text = "Por Defecto"
            GEjecutarAplicacion_TIniciarEn.ForeColor1 = Color.FromArgb(18, 18, 18) : GEjecutarAplicacion_TIniciarEn.ForeColor2 = Color.FromArgb(18, 18, 18) : GEjecutarAplicacion_TIniciarEn.Cursor = Cursors.Default
            GEjecutarAplicacion_CModo.Enabled = True : GEjecutarAplicacion_TModo.Enabled = True : GEjecutarAplicacion_LCModo.Enabled = True
            GEjecutarAplicacion_TModo.Cursor = Cursors.Hand : GEjecutarAplicacion_LCModo.Cursor = Cursors.Hand
            GEjecutarAplicacion_CPrioridad.Enabled = False : GEjecutarAplicacion_TPrioridad.Enabled = False : GEjecutarAplicacion_LCPrioridad.Enabled = False
            GEjecutarAplicacion_TPrioridad.Cursor = Cursors.Default : GEjecutarAplicacion_LCPrioridad.Cursor = Cursors.Default
            GEjecutarAplicacion_TPrioridad.Text = "Normal" : GEjecutarAplicacion_LCPrioridad.Text = "Normal"
            Exit Sub
        ElseIf GEjecutarAplicacion_TRuta.Text.ToLower = "cmd" Then
            GEjecutarAplicacion_CTopMost.Enabled = True : GEjecutarAplicacion_LTopMost.Enabled = True
            GEjecutarAplicacion_TParametros.ReadOnly = False : GEjecutarAplicacion_TParametros.ForeColor1 = GEjecutarAplicacion_TRuta.ForeColor1 : GEjecutarAplicacion_TParametros.ForeColor2 = GEjecutarAplicacion_TRuta.ForeColor2
            GEjecutarAplicacion_TIniciarEn.ReadOnly = False : GEjecutarAplicacion_BExaminar_IniciarEn.Enabled = True
            GEjecutarAplicacion_TIniciarEn.ForeColor1 = GEjecutarAplicacion_TRuta.ForeColor1 : GEjecutarAplicacion_TIniciarEn.ForeColor2 = GEjecutarAplicacion_TRuta.ForeColor2 : GEjecutarAplicacion_TIniciarEn.Cursor = Cursors.IBeam
            GEjecutarAplicacion_CModo.Enabled = True : GEjecutarAplicacion_TModo.Enabled = True : GEjecutarAplicacion_LCModo.Enabled = True
            GEjecutarAplicacion_TModo.Cursor = Cursors.Hand : GEjecutarAplicacion_LCModo.Cursor = Cursors.Hand
            GEjecutarAplicacion_CPrioridad.Enabled = False : GEjecutarAplicacion_TPrioridad.Enabled = False : GEjecutarAplicacion_LCPrioridad.Enabled = False
            GEjecutarAplicacion_TPrioridad.Cursor = Cursors.Default : GEjecutarAplicacion_LCPrioridad.Cursor = Cursors.Default
            GEjecutarAplicacion_TPrioridad.Text = "Normal" : GEjecutarAplicacion_LCPrioridad.Text = "Normal"
        Else
            GEjecutarAplicacion_CTopMost.Enabled = True : GEjecutarAplicacion_LTopMost.Enabled = True
            GEjecutarAplicacion_TParametros.ReadOnly = False : GEjecutarAplicacion_TParametros.ForeColor1 = GEjecutarAplicacion_TRuta.ForeColor1 : GEjecutarAplicacion_TParametros.ForeColor2 = GEjecutarAplicacion_TRuta.ForeColor2
            GEjecutarAplicacion_TIniciarEn.ReadOnly = False : GEjecutarAplicacion_BExaminar_IniciarEn.Enabled = True
            GEjecutarAplicacion_TIniciarEn.ForeColor1 = GEjecutarAplicacion_TRuta.ForeColor1 : GEjecutarAplicacion_TIniciarEn.ForeColor2 = GEjecutarAplicacion_TRuta.ForeColor2 : GEjecutarAplicacion_TIniciarEn.Cursor = Cursors.IBeam
            GEjecutarAplicacion_CModo.Enabled = True : GEjecutarAplicacion_TModo.Enabled = True : GEjecutarAplicacion_LCModo.Enabled = True
            GEjecutarAplicacion_TModo.Cursor = Cursors.Hand : GEjecutarAplicacion_LCModo.Cursor = Cursors.Hand
            GEjecutarAplicacion_CPrioridad.Enabled = True : GEjecutarAplicacion_TPrioridad.Enabled = True : GEjecutarAplicacion_LCPrioridad.Enabled = True
            GEjecutarAplicacion_TPrioridad.Cursor = Cursors.Hand : GEjecutarAplicacion_LCPrioridad.Cursor = Cursors.Hand
        End If
        If GEjecutarAplicacion_LCModo.Text = "Oculto" Then
            GEjecutarAplicacion_CTopMost.Enabled = False : GEjecutarAplicacion_LTopMost.Enabled = False : GEjecutarAplicacion_CTopMost.Checked = False
        Else
            GEjecutarAplicacion_CTopMost.Enabled = True : GEjecutarAplicacion_LTopMost.Enabled = True
        End If
    End Sub

#End Region

#Region " Validad Accion "

    Private Sub ValidarAccion()
        If GEjecutarAplicacion_TRuta.Tag = "" Then Accion_Info(GEjecutarAplicacion_TRuta.Tag) : GEjecutarAplicacion_TRuta.Tag = "" : Exit Sub
        If IO.Path.GetDirectoryName(GEjecutarAplicacion_TRuta.Tag) <> "" Or IO.File.Exists(GEjecutarAplicacion_TRuta.Tag) = True Or IO.Directory.Exists(GEjecutarAplicacion_TRuta.Tag) = True Then
            GEjecutarAplicacion_TRuta.Text = Rutas.Acortar_Ruta(GEjecutarAplicacion_TRuta.Tag, GEjecutarAplicacion_TRuta) : Accion_Info(GEjecutarAplicacion_TRuta.Tag) : Exit Sub
        Else
            If GEjecutarAplicacion_TRuta.Text.ToLower.StartsWith("www.") = True Then GEjecutarAplicacion_TRuta.Text = "http://" + Replace(GEjecutarAplicacion_TRuta.Text, "www.", "", 1, -1, Constants.vbTextCompare)
            If GEjecutarAplicacion_TRuta.Text.ToLower.StartsWith("https://") = False And GEjecutarAplicacion_TRuta.Text.ToLower.StartsWith("http://") = False Then If Internet.ValidarURL(GEjecutarAplicacion_TRuta.Text) = True Then GEjecutarAplicacion_TRuta.Text = "http://" + GEjecutarAplicacion_TRuta.Text
            If GEjecutarAplicacion_TRuta.Text.ToLower.StartsWith("https://") = True Or GEjecutarAplicacion_TRuta.Text.ToLower.StartsWith("http://") = True Then If Internet.ValidarURL(GEjecutarAplicacion_TRuta.Text) = False Then If GEjecutarAplicacion_TRuta.Text.ToLower.StartsWith("https://") = True Then GEjecutarAplicacion_TRuta.Text = GEjecutarAplicacion_TRuta.Text.Substring(8) Else GEjecutarAplicacion_TRuta.Text = GEjecutarAplicacion_TRuta.Text.Substring(7)
            GEjecutarAplicacion_TRuta.Text = Replace(GEjecutarAplicacion_TRuta.Text, "http://", "http://", 1, -1, Constants.vbTextCompare)
            GEjecutarAplicacion_TRuta.Text = Replace(GEjecutarAplicacion_TRuta.Text, "https://", "https://", 1, -1, Constants.vbTextCompare)
            GEjecutarAplicacion_TRuta.Text = Replace(GEjecutarAplicacion_TRuta.Text, "http://www.", "http://", 1, -1, Constants.vbTextCompare)
            GEjecutarAplicacion_TRuta.Text = Replace(GEjecutarAplicacion_TRuta.Text, "https://www.", "https://", 1, -1, Constants.vbTextCompare)
            GEjecutarAplicacion_TRuta.Text = Replace(GEjecutarAplicacion_TRuta.Text, "ftp://", "ftp://", 1, -1, Constants.vbTextCompare)
            GEjecutarAplicacion_TRuta.Tag = GEjecutarAplicacion_TRuta.Text : Accion_Info(GEjecutarAplicacion_TRuta.Tag)
        End If
    End Sub

    Public Function ReplaceSpecialFolder(Ruta As String) As String
        If Ruta = "" Then Return ""
        Ruta = Replace(Ruta, "%appdata%", Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), 1, -1, Constants.vbTextCompare)
        Ruta = Replace(Ruta, "%temp%", IO.Path.GetTempPath, 1, -1, Constants.vbTextCompare)
        Ruta = Replace(Ruta, "%programdata%", Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData), 1, -1, Constants.vbTextCompare)
        Ruta = Replace(Ruta, "%windir%", Environment.GetFolderPath(Environment.SpecialFolder.Windows), 1, -1, Constants.vbTextCompare)
        Ruta = Replace(Ruta, "%programfiles(x86)%", Environment.GetFolderPath(Environment.SpecialFolder.ProgramFilesX86), 1, -1, Constants.vbTextCompare)
        Ruta = Replace(Ruta, "%programfiles%", Environment.GetFolderPath(Environment.SpecialFolder.ProgramFiles), 1, -1, Constants.vbTextCompare)
        Return Ruta.Replace("\\", "\").Trim
    End Function

    Public Function CheckSpecialFolder(Ruta As String) As String
        If Ruta = "" Then Return ""
        If IO.File.Exists(Ruta) = True Or IO.Directory.Exists(Ruta) = True Then Return Ruta
        If IO.File.Exists((Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\" + Ruta).ToString.Replace("\\", "\")) = True Then Return (Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\" + Ruta).ToString.Replace("\\", "\")
        If IO.File.Exists((IO.Path.GetTempPath + "\" + Ruta).ToString.Replace("\\", "\")) = True Then Return (Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\" + Ruta).ToString.Replace("\\", "\")
        If IO.File.Exists((Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) + "\" + Ruta).ToString.Replace("\\", "\")) = True Then Return (IO.Path.GetTempPath + "\" + Ruta).ToString.Replace("\\", "\")
        If IO.File.Exists((Environment.GetFolderPath(Environment.SpecialFolder.Windows) + "\" + Ruta).ToString.Replace("\\", "\")) = True Then Return (Environment.GetFolderPath(Environment.SpecialFolder.Windows) + "\" + Ruta).ToString.Replace("\\", "\")
        If IO.File.Exists((Environment.GetFolderPath(Environment.SpecialFolder.Windows) + "\System32\" + Ruta).ToString.Replace("\\", "\")) = True Then Return (Environment.GetFolderPath(Environment.SpecialFolder.Windows) + "\System32\" + Ruta).ToString.Replace("\\", "\")
        If IO.File.Exists((Environment.GetFolderPath(Environment.SpecialFolder.ProgramFiles) + "\" + Ruta).ToString.Replace("\\", "\")) = True Then Return (Environment.GetFolderPath(Environment.SpecialFolder.ProgramFiles) + "\" + Ruta).ToString.Replace("\\", "\")
        If IO.File.Exists((Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\" + Ruta).ToString.Replace("\\", "\")) = True Then Return (Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\" + Ruta).ToString.Replace("\\", "\")
        If IO.File.Exists((Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\" + Ruta).ToString.Replace("\\", "\")) = True Then Return (Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\" + Ruta).ToString.Replace("\\", "\")
        Return Ruta
    End Function

#End Region

#Region " Ruta "

    Private Sub GEjecutarAplicacion_TRuta_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEjecutarAplicacion_TRuta.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : GEjecutarAplicacion_GInformacion.Tag = "" : HTexto.Focus()
    End Sub

    Private Sub GEjecutarAplicacion_TRuta_GotFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TRuta.GotFocus
        If GEjecutarAplicacion_TRuta.Tag.ToString.Length = 2 And GEjecutarAplicacion_TRuta.Tag.ToString.EndsWith(":") Then GEjecutarAplicacion_TRuta.Tag = GEjecutarAplicacion_TRuta.Tag.ToString.ToUpper + "\"
        If GEjecutarAplicacion_TRuta.Tag.ToString.EndsWith("\") And GEjecutarAplicacion_TRuta.Tag.ToString.Length > 3 Then GEjecutarAplicacion_TRuta.Tag = GEjecutarAplicacion_TRuta.Tag.ToString.Substring(0, GEjecutarAplicacion_TRuta.Tag.ToString.Length - 1)
        If GEjecutarAplicacion_TRuta.Tag = "" Then GEjecutarAplicacion_TRuta.Text = "" Else GEjecutarAplicacion_TRuta.Text = GEjecutarAplicacion_TRuta.Tag
    End Sub

    Private Sub GEjecutarAplicacion_TRuta_LostFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TRuta.LostFocus
        GEjecutarAplicacion_TRuta.Text = GEjecutarAplicacion_TRuta.Text.Trim
        If GEjecutarAplicacion_TRuta.Text = "" Then
            GEjecutarAplicacion_TRuta.Tag = ""
            GEjecutarAplicacion_TRuta.Text = ""
            GEjecutarAplicacion_Info_LNombre.Value1 = "" : GEjecutarAplicacion_Info_LNombre.Value2 = ""
            GEjecutarAplicacion_Info_LCompany.Text = "" : GEjecutarAplicacion_Info_LCompany.Refresh()
            GEjecutarAplicacion_Info_LTipo.Text = "" : GEjecutarAplicacion_Info_LTipo.Refresh()
            GEjecutarAplicacion_Info_PIcono.Image = Nothing : GEjecutarAplicacion_Info_PIcono.Refresh()
            GEjecutarAplicacion_Info_SinInformacion.Visible = True
            GEjecutarAplicacion_GInformacion.Tag = ""
            If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
            Iconos_Update()
        Else
            GEjecutarAplicacion_TRuta.Text = ReplaceSpecialFolder(GEjecutarAplicacion_TRuta.Text)
            GEjecutarAplicacion_TRuta.Text = CheckSpecialFolder(GEjecutarAplicacion_TRuta.Text)
            If GEjecutarAplicacion_TRuta.Text.Length = 2 And GEjecutarAplicacion_TRuta.Text.EndsWith(":") Then GEjecutarAplicacion_TRuta.Text = GEjecutarAplicacion_TRuta.Text.ToUpper + "\"
            If GEjecutarAplicacion_TRuta.Text.EndsWith("\") And GEjecutarAplicacion_TRuta.Text.Length > 3 Then GEjecutarAplicacion_TRuta.Text = GEjecutarAplicacion_TRuta.Text.Substring(0, GEjecutarAplicacion_TRuta.Text.Length - 1)
            If GEjecutarAplicacion_TRuta.Text.ToLower.StartsWith("http") = False Then GEjecutarAplicacion_TRuta.Text = GEjecutarAplicacion_TRuta.Text.Substring(0, 1).ToUpper + GEjecutarAplicacion_TRuta.Text.Substring(1)
            If GEjecutarAplicacion_TRuta.Text.ToLower = "cmd" Then GEjecutarAplicacion_TRuta.Text = "CMD"
            GEjecutarAplicacion_TRuta.Tag = GEjecutarAplicacion_TRuta.Text : GEjecutarAplicacion_TRuta.SelectionLength = 0 : ValidarAccion()
            If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : GEjecutarAplicacion_CheckControls()
    End Sub

#End Region

#Region " Parametros "

    Private Sub GEjecutarAplicacion_TParametros_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEjecutarAplicacion_TParametros.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GEjecutarAplicacion_TParametros_GotFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TParametros.GotFocus
        If GEjecutarAplicacion_TParametros.ReadOnly = True Then HTexto.Focus() : Exit Sub
    End Sub

    Private Sub GEjecutarAplicacion_TParametros_LostFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TParametros.LostFocus
        GEjecutarAplicacion_TParametros.Text = GEjecutarAplicacion_TParametros.Text.Trim : GEjecutarAplicacion_TParametros.SelectionLength = 0 : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " IniciarEn "

    Private Sub GEjecutarAplicacion_TIniciarEn_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEjecutarAplicacion_TIniciarEn.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GEjecutarAplicacion_TIniciarEn_GotFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TIniciarEn.GotFocus
        If GEjecutarAplicacion_TIniciarEn.ReadOnly = True Then HTexto.Focus() : Exit Sub
        If GEjecutarAplicacion_TIniciarEn.Tag.ToString.Length = 2 And GEjecutarAplicacion_TIniciarEn.Tag.ToString.EndsWith(":") Then GEjecutarAplicacion_TIniciarEn.Tag = GEjecutarAplicacion_TIniciarEn.Tag.ToString + "\"
        If GEjecutarAplicacion_TIniciarEn.Tag.ToString.EndsWith("\") And GEjecutarAplicacion_TIniciarEn.Tag.ToString.Length > 3 Then GEjecutarAplicacion_TIniciarEn.Tag = GEjecutarAplicacion_TIniciarEn.Tag.ToString.Substring(0, GEjecutarAplicacion_TIniciarEn.Tag.ToString.Length - 1)
        If GEjecutarAplicacion_TIniciarEn.Tag = "" Then GEjecutarAplicacion_TIniciarEn.Text = "" Else GEjecutarAplicacion_TIniciarEn.Text = GEjecutarAplicacion_TIniciarEn.Tag
    End Sub

    Private Sub GEjecutarAplicacion_TIniciarEn_LostFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TIniciarEn.LostFocus
        If GEjecutarAplicacion_TIniciarEn.ReadOnly = True Then Exit Sub
        GEjecutarAplicacion_TIniciarEn.Text = GEjecutarAplicacion_TIniciarEn.Text.Trim
        GEjecutarAplicacion_TIniciarEn.Text = ReplaceSpecialFolder(GEjecutarAplicacion_TIniciarEn.Text)
        If GEjecutarAplicacion_TIniciarEn.Text = "" Then GEjecutarAplicacion_TIniciarEn.Text = "Por Defecto" : GEjecutarAplicacion_TIniciarEn.Tag = "" : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GEjecutarAplicacion_TIniciarEn.Text.Length = 2 And GEjecutarAplicacion_TIniciarEn.Text.EndsWith(":") Then GEjecutarAplicacion_TIniciarEn.Text = GEjecutarAplicacion_TIniciarEn.Text + "\"
        If GEjecutarAplicacion_TIniciarEn.Text.EndsWith("\") And GEjecutarAplicacion_TIniciarEn.Text.Length > 3 Then GEjecutarAplicacion_TIniciarEn.Text = GEjecutarAplicacion_TIniciarEn.Text.Substring(0, GEjecutarAplicacion_TIniciarEn.Text.Length - 1)
        GEjecutarAplicacion_TIniciarEn.Tag = GEjecutarAplicacion_TIniciarEn.Text : GEjecutarAplicacion_TIniciarEn.SelectionLength = 0
        GEjecutarAplicacion_TIniciarEn.Text = Rutas.Acortar_Ruta(GEjecutarAplicacion_TIniciarEn.Tag, GEjecutarAplicacion_TIniciarEn)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Modo "

    Private Sub GEjecutarAplicacion_TModo_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEjecutarAplicacion_TModo.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GEjecutarAplicacion_TModo_TextChanged(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TModo.TextChanged
        GEjecutarAplicacion_LCModo.Text = GEjecutarAplicacion_TModo.Text : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GEjecutarAplicacion_TModo_GotFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TModo.GotFocus
        GEjecutarAplicacion_TModo.Text = GEjecutarAplicacion_TModo.Text.Trim : GEjecutarAplicacion_TModo.SelectionLength = 0 : HTexto.Focus()
    End Sub

    Private Sub GEjecutarAplicacion_TModo_LostFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TModo.LostFocus
        GEjecutarAplicacion_TModo.Text = GEjecutarAplicacion_TModo.Text.Trim : GEjecutarAplicacion_TModo.SelectionLength = 0
    End Sub

    Private Sub GEjecutarAplicacion_TModo_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarAplicacion_TModo.Click, GEjecutarAplicacion_LCModo.Click
        HTexto.Focus() : If GEjecutarAplicacion_LCModo.Enabled = False Then Exit Sub
        If e.Button = MouseButtons.Left Then GEjecutarAplicacion_CModo.DroppedDown = True : GEjecutarAplicacion_CModo.Focus()
    End Sub

    Private Sub GEjecutarAplicacion_PModo_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarAplicacion_PModo.Click, GEjecutarAplicacion_PModo.DoubleClick
        HTexto.Focus() : If GEjecutarAplicacion_CModo.Enabled = False Then Exit Sub
        If e.Button = MouseButtons.Left Then GEjecutarAplicacion_CModo.DroppedDown = True : GEjecutarAplicacion_CModo.Focus()
    End Sub

    Private Sub GEjecutarAplicacion_PModo_MouseEnter(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_PModo.MouseEnter
        If GEjecutarAplicacion_CModo.Enabled = False Then Exit Sub
        GEjecutarAplicacion_PModo.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GEjecutarAplicacion_PModo_MouseLeave(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_PModo.MouseLeave
        GEjecutarAplicacion_PModo.Image = My.Resources.CComandos_Off
    End Sub

#Region " Combo "

    Private Sub GEjecutarAplicacion_CModo_DropDown(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_CModo.DropDown
        GEjecutarAplicacion_CModo.MaxDropDownItems = GEjecutarAplicacion_CModo.Items.Count : Combo_Dropped = True : Combo_TempValue = GEjecutarAplicacion_TModo.Text : GEjecutarAplicacion_CModo.SelectedItem = GEjecutarAplicacion_TModo.Text
        If GEjecutarAplicacion_CModo.Items.Contains(GEjecutarAplicacion_TModo.Text) = True Then GEjecutarAplicacion_CModo.SelectedItem = GEjecutarAplicacion_TModo.Text Else GEjecutarAplicacion_CModo.SelectedIndex = 0
    End Sub

    Private Sub GEjecutarAplicacion_CModo_DropDownClosed(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_CModo.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GEjecutarAplicacion_CModo_LostFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_CModo.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GEjecutarAplicacion_CModo_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_CModo.SelectedIndexChanged
        If Combo_TempValue = "" Then GEjecutarAplicacion_TModo.Text = GEjecutarAplicacion_CModo.SelectedItem.Trim : GEjecutarAplicacion_LCModo.Text = GEjecutarAplicacion_TModo.Text : HTexto.Focus()
        GEjecutarAplicacion_CheckControls()
    End Sub

    Private Sub GEjecutarAplicacion_CModo_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEjecutarAplicacion_CModo.KeyPress
        If Asc(e.KeyChar) = 13 Then GEjecutarAplicacion_TModo.Text = GEjecutarAplicacion_CModo.SelectedItem.Trim : GEjecutarAplicacion_LCModo.Text = GEjecutarAplicacion_TModo.Text : e.Handled = True : HTexto.Focus()
    End Sub

#End Region

#End Region

#Region " Prioridad "

    Private Sub GEjecutarAplicacion_TPrioridad_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEjecutarAplicacion_TPrioridad.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GEjecutarAplicacion_TPrioridad_TextChanged(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TPrioridad.TextChanged
        GEjecutarAplicacion_LCPrioridad.Text = GEjecutarAplicacion_TPrioridad.Text : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GEjecutarAplicacion_TPrioridad_GotFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TPrioridad.GotFocus
        GEjecutarAplicacion_TPrioridad.Text = GEjecutarAplicacion_TPrioridad.Text.Trim : GEjecutarAplicacion_TPrioridad.SelectionLength = 0 : HTexto.Focus()
    End Sub

    Private Sub GEjecutarAplicacion_TPrioridad_LostFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TPrioridad.LostFocus
        GEjecutarAplicacion_TPrioridad.Text = GEjecutarAplicacion_TPrioridad.Text.Trim : GEjecutarAplicacion_TPrioridad.SelectionLength = 0
    End Sub

    Private Sub GEjecutarAplicacion_TPrioridad_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarAplicacion_TPrioridad.Click, GEjecutarAplicacion_LCPrioridad.Click
        HTexto.Focus() : If GEjecutarAplicacion_LCPrioridad.Enabled = False Then Exit Sub
        If e.Button = MouseButtons.Left Then GEjecutarAplicacion_CPrioridad.DroppedDown = True : GEjecutarAplicacion_CPrioridad.Focus()
    End Sub

    Private Sub GEjecutarAplicacion_PPrioridad_PModo_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarAplicacion_PPrioridad.Click, GEjecutarAplicacion_PPrioridad.DoubleClick
        HTexto.Focus() : If GEjecutarAplicacion_CPrioridad.Enabled = False Then Exit Sub
        If e.Button = MouseButtons.Left Then GEjecutarAplicacion_CPrioridad.DroppedDown = True : GEjecutarAplicacion_CPrioridad.Focus()
    End Sub

    Private Sub GEjecutarAplicacion_PPrioridad_MouseEnter(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_PPrioridad.MouseEnter
        If GEjecutarAplicacion_CPrioridad.Enabled = False Then Exit Sub
        GEjecutarAplicacion_PPrioridad.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GEjecutarAplicacion_PPrioridad_MouseLeave(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_PPrioridad.MouseLeave
        GEjecutarAplicacion_PPrioridad.Image = My.Resources.CComandos_Off
    End Sub

#Region " Combo "

    Private Sub GEjecutarAplicacion_CPrioridad_DropDown(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_CPrioridad.DropDown
        GEjecutarAplicacion_CPrioridad.MaxDropDownItems = GEjecutarAplicacion_CPrioridad.Items.Count : Combo_Dropped = True : Combo_TempValue = GEjecutarAplicacion_TPrioridad.Text : GEjecutarAplicacion_CPrioridad.SelectedItem = GEjecutarAplicacion_TPrioridad.Text
        If GEjecutarAplicacion_CPrioridad.Items.Contains(GEjecutarAplicacion_TPrioridad.Text) = True Then GEjecutarAplicacion_CPrioridad.SelectedItem = GEjecutarAplicacion_TPrioridad.Text Else GEjecutarAplicacion_CPrioridad.SelectedIndex = 0
    End Sub

    Private Sub GEjecutarAplicacion_CPrioridad_DropDownClosed(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_CPrioridad.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GEjecutarAplicacion_CPrioridad_LostFocus(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_CPrioridad.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GEjecutarAplicacion_CPrioridad_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_CPrioridad.SelectedIndexChanged
        If Combo_TempValue = "" Then GEjecutarAplicacion_TPrioridad.Text = GEjecutarAplicacion_CPrioridad.SelectedItem.Trim : GEjecutarAplicacion_LCPrioridad.Text = GEjecutarAplicacion_TPrioridad.Text : HTexto.Focus()
    End Sub

    Private Sub GEjecutarAplicacion_CPrioridad_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEjecutarAplicacion_CPrioridad.KeyPress
        If Asc(e.KeyChar) = 13 Then GEjecutarAplicacion_TPrioridad.Text = GEjecutarAplicacion_CPrioridad.SelectedItem.Trim : GEjecutarAplicacion_LCPrioridad.Text = GEjecutarAplicacion_TPrioridad.Text : e.Handled = True : HTexto.Focus()
    End Sub

#End Region

#End Region

#Region " TopMost "

    Private Sub GEjecutarAplicacion_TopMost_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarAplicacion_LTopMost.Click, GEjecutarAplicacion_LTopMost.DoubleClick, GEjecutarAplicacion_CTopMost.Click, GEjecutarAplicacion_CTopMost.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GEjecutarAplicacion_CTopMost.Checked = True Then GEjecutarAplicacion_CTopMost.Checked = False Else GEjecutarAplicacion_CTopMost.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Administrador "

    Private Sub GEjecutarAplicacion_Admin_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarAplicacion_LAdmin.Click, GEjecutarAplicacion_LAdmin.DoubleClick, GEjecutarAplicacion_CAdmin.DoubleClick, GEjecutarAplicacion_CAdmin.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GEjecutarAplicacion_CAdmin.Checked = True Then GEjecutarAplicacion_CAdmin.Checked = False Else GEjecutarAplicacion_CAdmin.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Botones "

    Private Sub GEjecutarAplicacion_BExaminar_Ruta_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarAplicacion_BExaminar_Ruta.Click
        HTexto.Focus() : If e.Button = MouseButtons.Left Then
            Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True : Abrir.Title = "Seleccionar programa..." : Abrir.Filter = "Archivos Ejecutables|*.exe;*.bat;*.lnk|Todos los Archivos|*.*"
            If Abrir.ShowDialog <> DialogResult.Cancel Then GEjecutarAplicacion_TRuta.Tag = Abrir.FileName : GEjecutarAplicacion_TRuta.Text = Rutas.Acortar_Ruta(Abrir.FileName, GEjecutarAplicacion_TRuta)
            GEjecutarAplicacion_BExaminar_Ruta.State = NSButton.MouseState.None : GEjecutarAplicacion_BExaminar_Ruta.Invalidate()
        ElseIf e.Button = Windows.Forms.MouseButtons.Right Then
            Dim Abrir As New FolderBrowserDialog : Abrir.ShowNewFolderButton = True : If IO.Directory.Exists(GEjecutarAplicacion_TRuta.Text) Then Abrir.SelectedPath = IO.Path.GetDirectoryName(GEjecutarAplicacion_TRuta.Text)
            Abrir.Description = "Seleccionar carpeta..." : If Abrir.ShowDialog <> DialogResult.Cancel Then GEjecutarAplicacion_TRuta.Tag = Abrir.SelectedPath : GEjecutarAplicacion_TRuta.Text = Rutas.Acortar_Ruta(Abrir.SelectedPath, GEjecutarAplicacion_TRuta)
            GEjecutarAplicacion_BExaminar_Ruta.State = NSButton.MouseState.None : GEjecutarAplicacion_BExaminar_Ruta.Invalidate()
        End If
        GEjecutarAplicacion_TRuta.SelectionStart = GEjecutarAplicacion_TRuta.Text.Length : GEjecutarAplicacion_TRuta.SelectionLength = 0
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Accion_Info(GEjecutarAplicacion_TRuta.Tag)
        GEjecutarAplicacion_CheckControls()
    End Sub

    Private Sub GEjecutarAplicacion_BExaminar_IniciarEn_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarAplicacion_BExaminar_IniciarEn.Click
        HTexto.Focus() : If e.Button = MouseButtons.Left Then
            Dim Abrir As New FolderBrowserDialog : If IO.Directory.Exists(GEjecutarAplicacion_TIniciarEn.Text) Then Abrir.SelectedPath = IO.Path.GetDirectoryName(GEjecutarAplicacion_TIniciarEn.Text)
            Abrir.Description = "Seleccionar carpeta..." : If Abrir.ShowDialog <> DialogResult.Cancel Then
                GEjecutarAplicacion_TIniciarEn.Tag = Abrir.SelectedPath : GEjecutarAplicacion_TIniciarEn.Text = (Rutas.Acortar_Ruta(Abrir.SelectedPath, GEjecutarAplicacion_TIniciarEn) + "\").Replace("\\", "\")
            End If
            GEjecutarAplicacion_BExaminar_IniciarEn.State = NSButton.MouseState.None : GEjecutarAplicacion_BExaminar_IniciarEn.Invalidate() : HTexto.Focus()
        ElseIf e.Button = MouseButtons.Middle Or e.Button = MouseButtons.Right Then
            GEjecutarAplicacion_TIniciarEn.Tag = "" : GEjecutarAplicacion_TIniciarEn.Text = "Por Defecto"
        End If
        GEjecutarAplicacion_TIniciarEn.SelectionStart = GEjecutarAplicacion_TIniciarEn.Text.Length : GEjecutarAplicacion_TIniciarEn.SelectionLength = 0
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Info "

    Private Sub GEjecutarAplicacion_Info_PIcono_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarAplicacion_Info_PIcono.Click
        If e.Button <> MouseButtons.Right Then Exit Sub
        EjecutarAccion(Comandos_GetByID(ComandoActualID), Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Dim Thread_EjecutarAplicacion_Info As New Threading.Thread(AddressOf Accion_Info)
    Private Sub Accion_Info(Ruta As String)
        If Ruta = "" Then
            GEjecutarAplicacion_Info_LNombre.Value1 = "" : GEjecutarAplicacion_Info_LNombre.Value2 = ""
            GEjecutarAplicacion_Info_LCompany.Text = "" : GEjecutarAplicacion_Info_LCompany.Refresh()
            GEjecutarAplicacion_Info_LTipo.Text = "" : GEjecutarAplicacion_Info_LTipo.Refresh()
            GEjecutarAplicacion_Info_PIcono.Image = Nothing : GEjecutarAplicacion_Info_PIcono.Refresh()
            GEjecutarAplicacion_Info_SinInformacion.Visible = True
            GEjecutarAplicacion_GInformacion.Tag = ""
            Exit Sub
        End If
        GEjecutarAplicacion_Info_SinInformacion.Visible = False
        If GEjecutarAplicacion_GInformacion.Tag = Ruta.ToLower Then Exit Sub Else GEjecutarAplicacion_GInformacion.Tag = Ruta.ToLower
        If Internet.ValidarURL(Ruta) = True Then
            GEjecutarAplicacion_Info_LNombre.Value1 = "" : GEjecutarAplicacion_Info_LNombre.Value2 = ""
            GEjecutarAplicacion_Info_LCompany.Text = "" : GEjecutarAplicacion_Info_LCompany.Refresh()
            GEjecutarAplicacion_Info_LTipo.Text = "" : GEjecutarAplicacion_Info_LTipo.Refresh()
            GEjecutarAplicacion_Info_PIcono.Image = Nothing : GEjecutarAplicacion_Info_PIcono.Refresh()
            GEjecutarAplicacion_Info_LoadingCircle.Active = True : GEjecutarAplicacion_Info_LoadingCircle.Visible = True
        End If
Repite: If Thread_EjecutarAplicacion_Info.ThreadState = Threading.ThreadState.Unstarted Or Thread_EjecutarAplicacion_Info.ThreadState = Threading.ThreadState.Aborted Or Thread_EjecutarAplicacion_Info.ThreadState = Threading.ThreadState.Stopped Then
            Thread_EjecutarAplicacion_Info = New Threading.Thread(AddressOf ThreadSub_EjecutarAplicacion_Info)
            Thread_EjecutarAplicacion_Info.IsBackground = True
            Thread_EjecutarAplicacion_Info.Start(Ruta) : Application.DoEvents()
        ElseIf Thread_EjecutarAplicacion_Info.ThreadState = Threading.ThreadState.Running Then
            Thread_EjecutarAplicacion_Info.Abort() : Application.DoEvents() : GoTo Repite
        Else
            GoTo Repite
        End If
    End Sub

    Private Sub ThreadSub_EjecutarAplicacion_Info(Ruta As String)
        Dim Titulo As String
Repite: Titulo = "" : Ruta = ReplaceSpecialFolder(Ruta)
        If IO.File.Exists(Ruta) = False And IO.Directory.Exists(Ruta) = False Then
            Ruta = Replace(Ruta, "http", "http", 1, -1, Constants.vbTextCompare) : If Internet.ValidarURL(Ruta) = True Then
                If New Uri(Ruta).HostNameType = UriHostNameType.Dns Then
                    Dim URLTitulo As String = "" : Dim cURLTitulo() As String = New Uri(Ruta).Host.Split(".") : For Cuenta = 0 To cURLTitulo.Length - 2 : URLTitulo += cURLTitulo(Cuenta) + "." : Next
                    URLTitulo = URLTitulo.Substring(0, URLTitulo.Length - 1)

                    Dim Company As String = "" : Try : Company = Net.Dns.GetHostAddresses(New Uri(Ruta).Host)(0).ToString() : Catch : End Try : GEjecutarAplicacion_Info_LCompany.Refresh()
                    Dim Icono As Image = Nothing : If IO.File.Exists(KobaPathTemp + "icono.ico") = True Then IO.File.Delete(KobaPathTemp + "icono.ico")
                    Try : My.Computer.Network.DownloadFile("https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://www." + New Uri(Ruta).Host.ToString + "&size=32", KobaPathTemp + "icono.ico", "", "", False, 500, True) : Catch : Company = "" : GoTo Salta1 : End Try
                    Dim Contador As Integer : Do Until IO.File.Exists(KobaPathTemp + "icono.ico") = True Or Contador = 100 : Contador += 1 : Threading.Thread.Sleep(10) : Loop
Salta1:             If IO.File.Exists(KobaPathTemp + "icono.ico") = True Then Icono = Imagen.LoadImageClone(KobaPathTemp + "icono.ico") : IO.File.Delete(KobaPathTemp + "icono.ico") Else Icono = Nothing

                    GEjecutarAplicacion_Info_LNombre.Text = URLTitulo : Rutas.SetFontSize(GEjecutarAplicacion_Info_LNombre, 8) : GEjecutarAplicacion_Info_LNombre.Text = ""
                    If URLTitulo.Length > 1 Then GEjecutarAplicacion_Info_LNombre.Value1 = URLTitulo.Substring(0, 1).ToUpper : GEjecutarAplicacion_Info_LNombre.Value2 = URLTitulo.Substring(1) Else GEjecutarAplicacion_Info_LNombre.Value1 = URLTitulo.ToUpper : GEjecutarAplicacion_Info_LNombre.Value2 = ""
                    If Company = "" Then Company = "Offline"
                    GEjecutarAplicacion_Info_LCompany.Text = Company : GEjecutarAplicacion_Info_LCompany.Refresh()
                    GEjecutarAplicacion_Info_LTipo.Text = "Website" : GEjecutarAplicacion_Info_LTipo.Refresh()

                    If Icono Is Nothing AndAlso IO.File.Exists(KobaPath + "Iconos\WebIcons\" + Ruta.Replace("\", "_").Replace("/", "_").Replace("?", "_").Replace(".", "_").Replace(":", "").Replace(";", "") + ".ico") = True Then
                        Icono = Iconos.Cargar(KobaPath + "Iconos\WebIcons\" + Ruta.Replace("\", "_").Replace("/", "_").Replace("?", "_").Replace(".", "_").Replace(":", "").Replace(";", "") + ".ico").ToBitmap
                    ElseIf Icono Is Nothing Then
                        Icono = My.Resources.WebPage.ToBitmap
                    Else
                        Iconos.Guardar(Icono, KobaPath + "Iconos\WebIcons\" + Ruta.Replace("\", "_").Replace("/", "_").Replace("?", "_").Replace(".", "_").Replace(":", "").Replace(";", "") + ".ico")
                    End If
                    GEjecutarAplicacion_Info_PIcono.Image = Icono : GEjecutarAplicacion_Info_PIcono.Refresh()
                    GEjecutarAplicacion_Info_LoadingCircle.Visible = False : GEjecutarAplicacion_Info_LoadingCircle.Active = False
                    Invoke(Sub() Iconos_Update())
                    Exit Sub
                End If
            Else
                Dim cRuta = Rutas.GetTargetPath(Ruta) : If IO.File.Exists(cRuta) = True Then
                    Ruta = cRuta : GoTo Salta2
                Else
                    Dim cTitulo As String = Ruta : GEjecutarAplicacion_Info_LNombre.Text = cTitulo : Rutas.SetFontSize(GEjecutarAplicacion_Info_LNombre, 8, 4) : GEjecutarAplicacion_Info_LNombre.Text = ""
                    If IO.Path.GetDirectoryName(Ruta) <> "" Then cTitulo = Rutas.Acortar_Ruta(Ruta, GEjecutarAplicacion_Info_LNombre)
                    If cTitulo.Length > 1 Then GEjecutarAplicacion_Info_LNombre.Value1 = cTitulo.Substring(0, 1).ToUpper : GEjecutarAplicacion_Info_LNombre.Value2 = cTitulo.Substring(1) Else GEjecutarAplicacion_Info_LNombre.Value1 = cTitulo.ToUpper : GEjecutarAplicacion_Info_LNombre.Value2 = ""
                    GEjecutarAplicacion_Info_LCompany.Text = "" : GEjecutarAplicacion_Info_LCompany.Refresh()
                    If Ruta.Length = 3 AndAlso Ruta.EndsWith(":\") Then GEjecutarAplicacion_Info_LTipo.Text = "Unidad Desconocida" Else GEjecutarAplicacion_Info_LTipo.Text = "Aplicacion Desconocida"
                    Rutas.SetFontSize(GEjecutarAplicacion_Info_LTipo, 7, 4) : GEjecutarAplicacion_Info_LTipo.Refresh()
                    GEjecutarAplicacion_Info_PIcono.Image = My.Resources.Accion_Aplicacion.ToBitmap : GEjecutarAplicacion_Info_PIcono.Refresh()
                    GEjecutarAplicacion_Info_LoadingCircle.Visible = False : GEjecutarAplicacion_Info_LoadingCircle.Active = False
                    Invoke(Sub() Iconos_Update())
                    Exit Sub
                End If
            End If
        End If
Salta2: If IO.File.Exists(Ruta) = True Then Titulo = FileVersionInfo.GetVersionInfo(Ruta).FileDescription
        If Titulo Is Nothing Then Titulo = ""
        If Titulo = "" Then
            If IO.Directory.Exists(Ruta) = True Then
                Titulo = Rutas.Acortar_Ruta(Ruta, GEjecutarAplicacion_Info_LNombre)
            Else
                If IO.Path.GetDirectoryName(Ruta) <> "" Then Titulo = Rutas.Acortar_Ruta(Ruta, GEjecutarAplicacion_Info_LNombre) Else Titulo = IO.Path.GetFileNameWithoutExtension(Ruta)
            End If
        End If
        If Titulo.ToLower = "procesador de comandos de windows" Then Titulo = "Comando de MS-DOS"
        GEjecutarAplicacion_Info_LNombre.Text = Titulo : Rutas.SetFontSize(GEjecutarAplicacion_Info_LNombre, 8) : GEjecutarAplicacion_Info_LNombre.Text = ""
        If Titulo.Length > 1 Then GEjecutarAplicacion_Info_LNombre.Value1 = Titulo.Substring(0, 1).ToUpper : GEjecutarAplicacion_Info_LNombre.Value2 = Titulo.Substring(1) Else GEjecutarAplicacion_Info_LNombre.Value1 = Titulo.ToUpper : GEjecutarAplicacion_Info_LNombre.Value2 = ""
        Dim Compañia As String = "" : If IO.File.Exists(Ruta) = True Then Compañia = FileVersionInfo.GetVersionInfo(Ruta).CompanyName
        If Compañia Is Nothing Then Compañia = ""
        GEjecutarAplicacion_Info_LCompany.Text = Compañia : GEjecutarAplicacion_Info_LCompany.Refresh()
        GEjecutarAplicacion_Info_LTipo.Text = FileType(Ruta) : Rutas.SetFontSize(GEjecutarAplicacion_Info_LTipo, 7, 4) : GEjecutarAplicacion_Info_LTipo.Refresh()

        If GEjecutarAplicacion_Info_LTipo.Text = "Archivo" Then If IO.Directory.Exists(Ruta) = True Then GEjecutarAplicacion_Info_LTipo.Text = "Carpeta" : GEjecutarAplicacion_Info_LTipo.Refresh() : GEjecutarAplicacion_Info_LCompany.Text = "Microsoft Corporation" : GEjecutarAplicacion_Info_LCompany.Refresh()
        Select Case GEjecutarAplicacion_Info_LTipo.Text
            Case "Carpeta"
                GEjecutarAplicacion_Info_PIcono.Image = My.Resources.Accion_AbrirCarpeta.ToBitmap
            Case "Disco local"
                GEjecutarAplicacion_Info_LCompany.Text = "Microsoft Corporation" : GEjecutarAplicacion_Info_LCompany.Refresh()
                GEjecutarAplicacion_Info_PIcono.Image = My.Resources.DiscoLocal.ToBitmap
            Case "Acceso directo"
                Ruta = Rutas.GetTargetPath(Ruta) : GoTo Repite
            Case "Archivo por lotes de Windows"
                GEjecutarAplicacion_Info_LCompany.Text = "Microsoft Corporation" : GEjecutarAplicacion_Info_LCompany.Refresh()
                GEjecutarAplicacion_Info_PIcono.Image = My.Resources.Accion_BAT.ToBitmap
            Case Else
                GEjecutarAplicacion_Info_PIcono.Image = Iconos.ExtraerIcono(Ruta, My.Resources.Accion_Aplicacion.ToBitmap)
        End Select
        GEjecutarAplicacion_Info_LNombre.Visible = True : GEjecutarAplicacion_Info_LCompany.Visible = True : GEjecutarAplicacion_Info_LTipo.Visible = True : GEjecutarAplicacion_Info_PIcono.Visible = True
        GEjecutarAplicacion_Info_LoadingCircle.Visible = False : GEjecutarAplicacion_Info_LoadingCircle.Active = False
        Invoke(Sub() Iconos_Update())
    End Sub

#End Region

#Region " Help "

    Private Sub GEjecutarAplicacion_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarAplicacion_LHelp.Click, GEjecutarAplicacion_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Ejecutar Aplicación" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GEjecutarAplicacion_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_LHelp.MouseEnter
        GEjecutarAplicacion_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GEjecutarAplicacion_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_LHelp.MouseLeave
        GEjecutarAplicacion_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_EjecutarAplicacion_Tooltips(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_LRuta.MouseEnter, GEjecutarAplicacion_BExaminar_Ruta.MouseEnter, GEjecutarAplicacion_LParametros.MouseEnter, GEjecutarAplicacion_LIniciarEn.MouseEnter, GEjecutarAplicacion_LModo.MouseEnter, GEjecutarAplicacion_LPrioridad.MouseEnter, GEjecutarAplicacion_CAdmin.MouseEnter, GEjecutarAplicacion_LAdmin.MouseEnter, GEjecutarAplicacion_CTopMost.MouseEnter, GEjecutarAplicacion_LTopMost.MouseEnter, GEjecutarAplicacion_Info_LNombre.MouseEnter, GEjecutarAplicacion_LCModo.MouseEnter, GEjecutarAplicacion_LCPrioridad.MouseEnter, GEjecutarAplicacion_BExaminar_IniciarEn.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GEjecutarAplicacion_Ruta" : Show_Tooltip(sender, "Archivo, carpeta o página web que se abrirá")
            Case "GEjecutarAplicacion_BExaminar_Ruta" : Show_Tooltip(sender, "Click Izquierdo: Seleccionar un archivo" + vbCrLf + "Click Derecho: Seleccionar una carpeta")
            Case "GEjecutarAplicacion_Parametros" : Show_Tooltip(sender, "Parámetros con el que se ejecutará la aplicación")
            Case "GEjecutarAplicacion_IniciarEn" : Show_Tooltip(sender, "Carpeta de inicio de la aplicación")
            Case "GEjecutarAplicacion_BExaminar_IniciarEn" : Show_Tooltip(sender, "Seleccionar la carpeta de inicio de la aplicación")
            Case "GEjecutarAplicacion_Admin" : Show_Tooltip(sender, "Ejecuta la aplicación con privilegios de administrador")
            Case "GEjecutarAplicacion_Modo", "GEjecutarAplicacion_CModo" : Show_Tooltip(sender, "Modo en el que se ejecutará la aplicación" + vbCrLf + vbCrLf + "No todas las aplicaciones lo soportan")
            Case "GEjecutarAplicacion_Prioridad", "GEjecutarAplicacion_CPrioridad" : Show_Tooltip(sender, "Prioridad de CPU que se le asignará a la aplicación")
            Case "GEjecutarAplicacion_TopMost" : Show_Tooltip(sender, "Mantiene la aplicación por encima de las otras ventanas" + vbCrLf + "No todas las aplicaciones lo soportan")
            Case "GEjecutarAplicacion_Info_Nombre" : If (GEjecutarAplicacion_TRuta.Tag <> "" AndAlso IO.Path.GetDirectoryName(GEjecutarAplicacion_TRuta.Tag) <> "") And GEjecutarAplicacion_TRuta.Text <> GEjecutarAplicacion_TRuta.Tag AndAlso GEjecutarAplicacion_TRuta.Tag <> GEjecutarAplicacion_Info_LNombre.Value1 + GEjecutarAplicacion_Info_LNombre.Value2 Then Show_Tooltip(sender, GEjecutarAplicacion_TRuta.Tag.ToString)
        End Select
    End Sub

#End Region

#End Region

#Region " Abrir Carpeta "

#Region " Ruta "

    Private Sub GAbrirCarpeta_LCRuta_TextChanged(sender As Object, e As EventArgs) Handles GAbrirCarpeta_LCRuta.TextChanged
        GAbrirCarpeta_TRuta.Enabled = False : If GAbrirCarpeta_LCRuta.Text = "Escriba o selecciona un destino" Then Exit Sub
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GAbrirCarpeta_TRuta_Click(sender As Object, e As MouseEventArgs) Handles GAbrirCarpeta_LCRuta.Click, GAbrirCarpeta_TRuta.Click
        If e.Button = MouseButtons.Left Then
            GAbrirCarpeta_CCarpetas.DroppedDown = True : GAbrirCarpeta_CCarpetas.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            GAbrirCarpeta_LCRuta.Visible = False : Combo_IgnoreOne = True : GAbrirCarpeta_TRuta.ReadOnly = False : GAbrirCarpeta_TRuta.Enabled = True : GAbrirCarpeta_TRuta.Cursor = Cursors.IBeam : GAbrirCarpeta_TRuta.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub GAbrirCarpeta_TRuta_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GAbrirCarpeta_TRuta.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GAbrirCarpeta_TRuta_GotFocus(sender As Object, e As EventArgs) Handles GAbrirCarpeta_TRuta.GotFocus
        If GAbrirCarpeta_TRuta.Tag = "" Then GAbrirCarpeta_TRuta.Text = "" Else GAbrirCarpeta_TRuta.Text = GAbrirCarpeta_TRuta.Tag
    End Sub

    Private Sub GAbrirCarpeta_TRuta_LostFocus(sender As Object, e As EventArgs) Handles GAbrirCarpeta_TRuta.LostFocus
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GAbrirCarpeta_LCRuta.Visible = False Then GAbrirCarpeta_LCRuta.Visible = True : GAbrirCarpeta_TRuta.ReadOnly = True : GAbrirCarpeta_TRuta.Enabled = False : GAbrirCarpeta_TRuta.Cursor = Cursors.Hand
        If GAbrirCarpeta_TRuta.Text.Length > 2 Then GAbrirCarpeta_TRuta.Text = GAbrirCarpeta_TRuta.Text.Substring(0, 1).ToUpper + GAbrirCarpeta_TRuta.Text.Substring(1)
        GAbrirCarpeta_TRuta.Text = ReplaceSpecialFolder(GAbrirCarpeta_TRuta.Text)
        GAbrirCarpeta_TRuta.Tag = GAbrirCarpeta_TRuta.Text : GAbrirCarpeta_TRuta.SelectionLength = 0
        GAbrirCarpeta_TRuta.Text = Rutas.Acortar_Ruta(GAbrirCarpeta_TRuta.Tag, GAbrirCarpeta_TRuta)
        For Cuenta = 0 To GAbrirCarpeta_CCarpetas.Items.Count - 1
            If GAbrirCarpeta_CCarpetas.Items(Cuenta).ToString.ToLower = GAbrirCarpeta_TRuta.Text.ToLower Then GAbrirCarpeta_TRuta.Text = GAbrirCarpeta_CCarpetas.Items(Cuenta) : Exit For
        Next
        GAbrirCarpeta_LCRuta.Text = GAbrirCarpeta_TRuta.Text
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        Select Case GAbrirCarpeta_TRuta.Tag.ToString.ToLower.Trim
            Case "equipo" : GAbrirCarpeta_Icono.Image = My.Resources.CE_Equipo.ToBitmap
            Case "panel de control" : GAbrirCarpeta_Icono.Image = My.Resources.CE_PanelControl.ToBitmap
            Case "control de volumen" : GAbrirCarpeta_Icono.Image = My.Resources.CE_ControlVolumen.ToBitmap
            Case "ajustes de audio" : GAbrirCarpeta_Icono.Image = My.Resources.CE_AjustesAudio.ToBitmap
            Case "papelera de reciclaje" : GAbrirCarpeta_Icono.Image = My.Resources.CE_Papelera.ToBitmap
            Case "papelera (vaciar)" : GAbrirCarpeta_Icono.Image = My.Resources.CE_VaciarPapelera.ToBitmap
            Case "modo 'god'" : GAbrirCarpeta_Icono.Image = My.Resources.CE_GodMode.ToBitmap
            Case "documentos" : GAbrirCarpeta_Icono.Image = My.Resources.CE_Documentos.ToBitmap
            Case "imagenes" : GAbrirCarpeta_Icono.Image = My.Resources.CE_Imagenes.ToBitmap
            Case "musicas" : GAbrirCarpeta_Icono.Image = My.Resources.CE_Musicas.ToBitmap
            Case "escritorio" : GAbrirCarpeta_Icono.Image = My.Resources.CE_Escritorio.ToBitmap
            Case "videos" : GAbrirCarpeta_Icono.Image = My.Resources.CE_Videos.ToBitmap
            Case "descargas" : GAbrirCarpeta_Icono.Image = My.Resources.CE_Descargas.ToBitmap
            Case "k-temp" : GAbrirCarpeta_Icono.Image = My.Resources.CE_KTemp.ToBitmap
            Case "k-desktop" : GAbrirCarpeta_Icono.Image = My.Resources.KDesktop.ToBitmap
            Case "usuario" : GAbrirCarpeta_Icono.Image = My.Resources.CE_Usuario.ToBitmap
            Case "fuentes" : GAbrirCarpeta_Icono.Image = My.Resources.CE_Fuentes.ToBitmap
            Case "menu inicio (usuario)" : GAbrirCarpeta_Icono.Image = My.Resources.CE_MenuInicio.ToBitmap
            Case "menu inicio" : GAbrirCarpeta_Icono.Image = My.Resources.CE_MenuInicio.ToBitmap
            Case "directivas de grupo" : GAbrirCarpeta_Icono.Image = My.Resources.CE_GroupPolicy.ToBitmap
            Case "programador de tareas" : GAbrirCarpeta_Icono.Image = My.Resources.CE_ProgramadorTareas.ToBitmap
            Case "registro de windows" : GAbrirCarpeta_Icono.Image = My.Resources.CE_Regedit.ToBitmap
            Case "teclado en pantalla" : GAbrirCarpeta_Icono.Image = My.Resources.CE_TecladoPantalla.ToBitmap
            Case "conexiones de red" : GAbrirCarpeta_Icono.Image = My.Resources.CE_ConexionesRed.ToBitmap
            Case "task switcher" : GAbrirCarpeta_Icono.Image = My.Resources.CE_TaskSwitcher.ToBitmap
            Case "k-link" : GAbrirCarpeta_Icono.Image = My.Resources.CE_K_Link.ToBitmap
            Case "powershell" : GAbrirCarpeta_Icono.Image = My.Resources.CE_PowerShell.ToBitmap
            Case "windows apps" : GAbrirCarpeta_Icono.Image = My.Resources.CE_WindowsApps.ToBitmap
            Case Else : GAbrirCarpeta_Icono.Image = My.Resources.Accion_AbrirCarpeta.ToBitmap
        End Select
        If GAbrirCarpeta_TRuta.Tag.ToString.ToLower.Trim = "" Then GAbrirCarpeta_LCRuta.Text = "Escriba o selecciona un destino"
    End Sub

    Private Sub GAbrirCarpeta_TRuta_KeyDown(sender As Object, e As KeyEventArgs) Handles GAbrirCarpeta_TRuta.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GAbrirCarpeta_CCarpetas.DroppedDown = True : GAbrirCarpeta_CCarpetas.Focus()
    End Sub

    Private Sub GAbrirCarpeta_TRuta_MouseEnter(sender As Object, e As EventArgs) Handles GAbrirCarpeta_TRuta.MouseEnter
        GAbrirCarpeta_CCarpetas.State = NSComboBox.MouseState.None
    End Sub

#End Region

#Region " Combo "

    Private Sub GAbrirCarpeta_CCarpetas_DropDown(sender As Object, e As EventArgs) Handles GAbrirCarpeta_CCarpetas.DropDown
        GAbrirCarpeta_TRuta.Enabled = True
        GAbrirCarpeta_CCarpetas.MaxDropDownItems = GAbrirCarpeta_CCarpetas.Items.Count : Combo_Dropped = True : Combo_TempValue = GAbrirCarpeta_TRuta.Text : GAbrirCarpeta_CCarpetas.SelectedItem = GAbrirCarpeta_TRuta.Text : If Combo_TempValue = "" Then Combo_TempValue = " "
        If GAbrirCarpeta_CCarpetas.Items.Contains(GAbrirCarpeta_TRuta.Text) = True Then GAbrirCarpeta_CCarpetas.SelectedItem = GAbrirCarpeta_TRuta.Text Else GAbrirCarpeta_CCarpetas.SelectedIndex = 0
    End Sub

    Private Sub GAbrirCarpeta_CCarpetas_DropDownClosed(sender As Object, e As EventArgs) Handles GAbrirCarpeta_CCarpetas.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GAbrirCarpeta_CCarpetas_LostFocus(sender As Object, e As EventArgs) Handles GAbrirCarpeta_CCarpetas.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GAbrirCarpeta_CCarpetas_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GAbrirCarpeta_CCarpetas.SelectedIndexChanged
        If Combo_TempValue = "" Then GAbrirCarpeta_TRuta.Text = GAbrirCarpeta_CCarpetas.SelectedItem.Trim : GAbrirCarpeta_TRuta.Focus() : HTexto.Focus()
    End Sub

    Private Sub GAbrirCarpeta_CCarpetas_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GAbrirCarpeta_CCarpetas.KeyPress
        If Asc(e.KeyChar) = 13 Then GAbrirCarpeta_TRuta.Text = GAbrirCarpeta_CCarpetas.SelectedItem.Trim : e.Handled = True : GAbrirCarpeta_TRuta.Focus() : HTexto.Focus()
    End Sub

#End Region

#Region " Botones "

    Private Sub GAbrirCarpeta_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles GAbrirCarpeta_BExaminar.Click
        HTexto.Focus() : If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New FolderBrowserDialog : Abrir.ShowNewFolderButton = True : If IO.Directory.Exists(GAbrirCarpeta_TRuta.Text) Then Abrir.SelectedPath = IO.Path.GetDirectoryName(GAbrirCarpeta_TRuta.Text)
        Abrir.Description = "Seleccionar carpeta..." : If Abrir.ShowDialog <> DialogResult.Cancel Then GAbrirCarpeta_TRuta.Tag = Abrir.SelectedPath : GAbrirCarpeta_TRuta.Text = Rutas.Acortar_Ruta(Abrir.SelectedPath, GAbrirCarpeta_TRuta)
        GAbrirCarpeta_BExaminar.State = NSButton.MouseState.None : GAbrirCarpeta_BExaminar.Invalidate()
        GAbrirCarpeta_TRuta.SelectionStart = GAbrirCarpeta_TRuta.Text.Length : GAbrirCarpeta_TRuta.SelectionLength = 0
        GAbrirCarpeta_TRuta.Focus() : HTexto.Focus()
    End Sub

    Private Sub GAbrirCarpeta_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles GAbrirCarpeta_BExaminar.MouseEnter
        GAbrirCarpeta_CCarpetas.State = NSComboBox.MouseState.None
    End Sub

    Private Sub GAbrirCarpeta_Icono_Click(sender As Object, e As MouseEventArgs) Handles GAbrirCarpeta_Icono.Click, GAbrirCarpeta_Icono.DoubleClick
        If e.Button = MouseButtons.Right Then EjecutarAccion(Comandos_GetByID(ComandoActualID), Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        'If e.Button = MouseButtons.Left Then EjecutarAccion(Lista.SelectedItems(0).Tag, Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    <Runtime.InteropServices.DllImport("shell32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function SHGetKnownFolderPath(ByRef id As Guid, flags As Integer, token As IntPtr, <Runtime.InteropServices.Out> ByRef path As IntPtr) As Integer : End Function
    Private Shared FolderDownloads As New Guid("374DE290-123F-4565-9164-39C4925E467B")
    Public Function GetDownloadsPath() As String
        If Environment.OSVersion.Version.Major < 6 Then Return Registro.GetRegKey("Microsoft\Windows\CurrentVersion\Explorer\Shell Folders", "{374DE290-123F-4565-9164-39C4925E467B}")
        Dim pathPtr As IntPtr = IntPtr.Zero
        Try : SHGetKnownFolderPath(FolderDownloads, 0, IntPtr.Zero, pathPtr)
            Return Runtime.InteropServices.Marshal.PtrToStringUni(pathPtr)
        Finally : Runtime.InteropServices.Marshal.FreeCoTaskMem(pathPtr) : End Try
    End Function

#End Region

#Region " Help "

    Private Sub GAbrirCarpeta_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GAbrirCarpeta_LHelp.Click, GAbrirCarpeta_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Abrir Carpeta" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GAbrirCarpeta_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GAbrirCarpeta_LHelp.MouseEnter
        GAbrirCarpeta_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GAbrirCarpeta_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GAbrirCarpeta_LHelp.MouseLeave
        GAbrirCarpeta_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_AbrirCarpeta_Tooltips(sender As Object, e As EventArgs) Handles GAbrirCarpeta_LRuta.MouseEnter, GAbrirCarpeta_BExaminar.MouseEnter, GAbrirCarpeta_LCRuta.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GAbrirCarpeta_Ruta", "GAbrirCarpeta_CRuta" : Show_Tooltip(sender, "Carpeta especial o ruta de la carpeta" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "GAbrirCarpeta_BExaminar" : Show_Tooltip(sender, "Seleccionar una carpeta")
        End Select
    End Sub

#End Region

#End Region

#Region " Pagina Web "

#Region " URL "

    Private Sub GPaginaWeb_TURL_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GPaginaWeb_TURL.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : GPaginaWeb_GInfo.Tag = "" : HTexto.Focus()
    End Sub

    Private Sub GPaginaWeb_TURL_LostFocus(sender As Object, e As EventArgs) Handles GPaginaWeb_TURL.LostFocus
        If GPaginaWeb_TURL.Text.Trim = "" Then
            GPaginaWeb_TURL.Text = ""
            GPaginaWeb_Info_LNombre.Value1 = "" : GPaginaWeb_Info_LNombre.Value2 = ""
            GPaginaWeb_Info_DNS.Text = "" : GPaginaWeb_Info_DNS.Refresh()
            GPaginaWeb_Info_LTipo.Text = "" : GPaginaWeb_Info_LTipo.Refresh()
            GPaginaWeb_Info_PIcono.Image = Nothing : GPaginaWeb_Info_PIcono.Refresh()
            GPaginaWeb_Info_SinInformacion.Visible = True
            GPaginaWeb_GInfo.Tag = ""
            If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
            Iconos_Update()
        Else
            GPaginaWeb_TURL.Text = GPaginaWeb_TURL.Text.Trim
            If GPaginaWeb_TURL.Text.ToLower.StartsWith("http") = False AndAlso GPaginaWeb_TURL.Text.Length > 0 Then GPaginaWeb_TURL.Text = GPaginaWeb_TURL.Text.Substring(0, 1).ToUpper + GPaginaWeb_TURL.Text.Substring(1)
            GPaginaWeb_TURL.SelectionLength = 0 : GPaginaWeb_TURL.Text = Internet.ValidarWeb(GPaginaWeb_TURL.Text) : PaginaWeb_Info(GPaginaWeb_TURL.Text)
            If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If
    End Sub

#End Region

#Region " Navegador "

#Region " Get Default Browser "

    Public Function GetDefaultBrowser() As String
        Dim DefaultBrowser As String = Registro.GetRegKey("Microsoft\Windows\Shell\Associations\UrlAssociations\https\UserChoice", "ProgId").ToLower.Replace("https", "").Replace("html", "").Replace(".", "")
        If DefaultBrowser.ToLower.Contains("chrome") Then Return "Google Chrome"
        If DefaultBrowser.ToLower.Contains("firefox") Then Return "Mozilla Firefox"
        If DefaultBrowser.ToLower.Contains("opera") Then Return "Opera"
        If DefaultBrowser.ToLower.Contains("vivaldi") Then Return "Vivaldi"
        If DefaultBrowser.ToLower.Contains("brave") Then Return "Brave"
        If DefaultBrowser.ToLower = "uc" Then Return "UC Browser"
        If DefaultBrowser.ToLower.StartsWith("app") Then Return "Microsoft Edge"
        Return DefaultBrowser
    End Function

#End Region

#Region " Get Installed Browsers "

    Private Function GetInstalledBrowsers() As List(Of BrowserST)
        Dim Browsers As New List(Of BrowserST)
        Try : Dim BrowserKeys = My.Computer.Registry.LocalMachine.OpenSubKey("SOFTWARE\WOW6432Node\Clients\StartMenuInternet")
            If BrowserKeys IsNot Nothing Then
                Dim BrowserNames As String() = BrowserKeys.GetSubKeyNames()
                For Cuenta As Integer = 0 To BrowserNames.Length - 1
                    Dim Browser As New BrowserST : Dim BrowserKey = BrowserKeys.OpenSubKey(BrowserNames(Cuenta))
                    Browser.Nombre = CStr(BrowserKey.GetValue(Nothing)).Replace(" Stable", "") : Dim BrowserKeyPath = BrowserKey.OpenSubKey("shell\open\command") : Browser.Ruta = BrowserKeyPath.GetValue(Nothing).ToString().Replace("""", "")
                    If IO.File.Exists(Browser.Ruta) = True Then Browser.Version = FileVersionInfo.GetVersionInfo(Browser.Ruta).FileVersion Else Browser.Version = "Desconocido"
                    If Browser.Nombre <> "" Then Browsers.Add(Browser)
                Next
            End If
            BrowserKeys = My.Computer.Registry.CurrentUser.OpenSubKey("SOFTWARE\Clients\StartMenuInternet")
            If BrowserKeys IsNot Nothing Then
                Dim BrowserNames As String() = BrowserKeys.GetSubKeyNames()
                For Cuenta As Integer = 0 To BrowserNames.Length - 1
                    Dim Browser As New BrowserST : Dim BrowserKey = BrowserKeys.OpenSubKey(BrowserNames(Cuenta))
                    Browser.Nombre = CStr(BrowserKey.GetValue(Nothing)).Replace(" Stable", "") : Dim BrowserKeyPath = BrowserKey.OpenSubKey("shell\open\command") : Browser.Ruta = BrowserKeyPath.GetValue(Nothing).ToString().Replace("""", "")
                    If IO.File.Exists(Browser.Ruta) = True Then Browser.Version = FileVersionInfo.GetVersionInfo(Browser.Ruta).FileVersion Else Browser.Version = "Desconocido"
                    If Browser.Nombre <> "" Then Browsers.Add(Browser)
                Next
            End If
            Dim EdgeVersion As String = Registro.GetRegKey("Classes\Local Settings\Software\Microsoft\Windows\CurrentVersion\AppModel\SystemAppData\Microsoft.MicrosoftEdge_8wekyb3d8bbwe\Schemas", "PackageFullName").Replace("""", "")
            If EdgeVersion <> "" Then
                Dim Result = System.Text.RegularExpressions.Regex.Match(EdgeVersion, "(((([0-9.])\d)+){1})")
                If Result.Success Then
                    Dim EdgeBrowser As BrowserST
                    EdgeBrowser.Nombre = "Microsoft Edge"
                    EdgeBrowser.Version = Result.Value
                    EdgeBrowser.Ruta = ""
                    Browsers.Add(EdgeBrowser)
                End If
            End If
            If Browsers.Count > 1 Then GPaginaWeb_PNavegador.Cursor = Cursors.Hand Else GPaginaWeb_PNavegador.Cursor = Cursors.Default
        Catch : End Try : Return Browsers
    End Function

    Private Function Get_Navegador_Ruta(Nombre As String) As String
        Try
            Dim Browsers As List(Of BrowserST) = GetInstalledBrowsers()
            For Cuenta = 0 To Browsers.Count - 1
                If Browsers(Cuenta).Nombre.ToLower = Nombre.ToLower Then Return Browsers(Cuenta).Ruta
            Next
        Catch : End Try : Return ""
    End Function

#End Region

    Private Sub GPaginaWeb_PNavegador_Click(sender As Object, e As MouseEventArgs) Handles GPaginaWeb_PNavegador.Click, GPaginaWeb_PNavegador.DoubleClick
        If e.Button = MouseButtons.Right Then EjecutarAccion(Comandos_GetByID(ComandoActualID), Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GPaginaWeb_GNavegadores.Visible = False Then
            GPaginaWeb_GNavegadores.Width = 8 : GPaginaWeb_GNavegadores.Refresh()
            GPaginaWeb_GNavegadores_PNavegador1.Visible = False
            GPaginaWeb_GNavegadores_PNavegador2.Visible = False
            GPaginaWeb_GNavegadores_PNavegador3.Visible = False
            GPaginaWeb_GNavegadores_PNavegador4.Visible = False
            GPaginaWeb_GNavegadores_PNavegador5.Visible = False
            GPaginaWeb_GNavegadores_PNavegador6.Visible = False
            GPaginaWeb_GNavegadores_PNavegador7.Visible = False
            Dim Browsers As List(Of BrowserST) = GetInstalledBrowsers() : Dim BrowserIndice As Integer : Dim EdgeAdded As Boolean
            For Cuenta = 0 To Browsers.Count - 1
                Select Case Browsers(Cuenta).Nombre.ToLower
                    Case "google chrome"
                        GetNavegadorPic(BrowserIndice).Image = My.Resources.Navegador_Chrome.ToBitmap : GetNavegadorPic(BrowserIndice).Tag = Browsers(Cuenta).Nombre : GetNavegadorPic(BrowserIndice).Visible = True : GetNavegadorPic(BrowserIndice).Refresh() : BrowserIndice += 1
                    Case "mozilla firefox"
                        GetNavegadorPic(BrowserIndice).Image = My.Resources.Navegador_Firefox.ToBitmap : GetNavegadorPic(BrowserIndice).Tag = Browsers(Cuenta).Nombre : GetNavegadorPic(BrowserIndice).Visible = True : GetNavegadorPic(BrowserIndice).Refresh() : BrowserIndice += 1
                    Case "microsoft edge"
                        If EdgeAdded = True Then Exit Select
                        EdgeAdded = True : GetNavegadorPic(BrowserIndice).Image = My.Resources.Navegador_Edge.ToBitmap : GetNavegadorPic(BrowserIndice).Tag = Browsers(Cuenta).Nombre : GetNavegadorPic(BrowserIndice).Visible = True : GetNavegadorPic(BrowserIndice).Refresh() : BrowserIndice += 1
                    Case "opera"
                        GetNavegadorPic(BrowserIndice).Image = My.Resources.Navegador_Opera.ToBitmap : GetNavegadorPic(BrowserIndice).Tag = Browsers(Cuenta).Nombre : GetNavegadorPic(BrowserIndice).Visible = True : GetNavegadorPic(BrowserIndice).Refresh() : BrowserIndice += 1
                    Case "vivaldi"
                        GetNavegadorPic(BrowserIndice).Image = My.Resources.Navegador_Vivaldi.ToBitmap : GetNavegadorPic(BrowserIndice).Tag = Browsers(Cuenta).Nombre : GetNavegadorPic(BrowserIndice).Visible = True : GetNavegadorPic(BrowserIndice).Refresh() : BrowserIndice += 1
                    Case "uc browser"
                        GetNavegadorPic(BrowserIndice).Image = My.Resources.Navegador_UCBrowser.ToBitmap : GetNavegadorPic(BrowserIndice).Tag = Browsers(Cuenta).Nombre : GetNavegadorPic(BrowserIndice).Visible = True : GetNavegadorPic(BrowserIndice).Refresh() : BrowserIndice += 1
                    Case "brave"
                        GetNavegadorPic(BrowserIndice).Image = My.Resources.Navegador_Brave.ToBitmap : GetNavegadorPic(BrowserIndice).Tag = Browsers(Cuenta).Nombre : GetNavegadorPic(BrowserIndice).Visible = True : GetNavegadorPic(BrowserIndice).Refresh() : BrowserIndice += 1
                    Case "internet explorer"
                    Case Else
                        GetNavegadorPic(BrowserIndice).Image = My.Resources.Navegador_Browser.ToBitmap : GetNavegadorPic(BrowserIndice).Tag = Browsers(Cuenta).Nombre : GetNavegadorPic(BrowserIndice).Visible = True : GetNavegadorPic(BrowserIndice).Refresh() : BrowserIndice += 1
                End Select
            Next
            GPaginaWeb_GNavegadores.Width += (Math.Max(1, BrowserIndice) * 25) : GPaginaWeb_GNavegadores.Refresh()
            If BrowserIndice > 7 Then GPaginaWeb_GNavegadores.Width -= 3
            If BrowserIndice > 1 Then GPaginaWeb_GNavegadores.Visible = True
        Else
            GPaginaWeb_GNavegadores.Visible = False
        End If
    End Sub

    Private Sub GPaginaWeb_PNavegadores_Click(sender As Object, e As MouseEventArgs) Handles GPaginaWeb_GNavegadores_PNavegador1.Click, GPaginaWeb_GNavegadores_PNavegador2.Click, GPaginaWeb_GNavegadores_PNavegador3.Click, GPaginaWeb_GNavegadores_PNavegador4.Click, GPaginaWeb_GNavegadores_PNavegador5.Click, GPaginaWeb_GNavegadores_PNavegador6.Click, GPaginaWeb_GNavegadores_PNavegador7.Click, GPaginaWeb_GNavegadores_PNavegador8.Click, GPaginaWeb_GNavegadores_PNavegador9.Click, GPaginaWeb_GNavegadores_PNavegador10.Click, GPaginaWeb_GNavegadores_PNavegador11.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim PNavegador As PictureBox = CType(sender, PictureBox)
        If PNavegador.Tag = "Google Chrome" Then
            GPaginaWeb_PNavegador.Image = My.Resources.Navegador_Chrome.ToBitmap
        ElseIf PNavegador.Tag = "Mozilla Firefox" Then
            GPaginaWeb_PNavegador.Image = My.Resources.Navegador_Firefox.ToBitmap
        Else
            GPaginaWeb_PNavegador.Image = PNavegador.Image
        End If
        GPaginaWeb_PNavegador.Tag = PNavegador.Tag : GPaginaWeb_PNavegador.Refresh() : GPaginaWeb_GNavegadores.Visible = False : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        Select Case PNavegador.Tag.ToString.ToLower
            Case "microsoft edge"
                GPaginaWeb_CNuevaVentana.Checked = False : GPaginaWeb_CNuevaVentana.Enabled = False : GPaginaWeb_LNuevaVentana.Enabled = False
                GPaginaWeb_CVentanaIncognito.Checked = False : GPaginaWeb_CVentanaIncognito.Enabled = False : GPaginaWeb_LVentanaIncognito.Enabled = False
            Case Else
                GPaginaWeb_CNuevaVentana.Enabled = True : GPaginaWeb_LNuevaVentana.Enabled = True
                GPaginaWeb_CVentanaIncognito.Enabled = True : GPaginaWeb_LVentanaIncognito.Enabled = True
        End Select
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Function GetNavegadorPic(Indice As Integer) As PictureBox
        Select Case Indice
            Case "0" : Return GPaginaWeb_GNavegadores_PNavegador1
            Case "1" : Return GPaginaWeb_GNavegadores_PNavegador2
            Case "2" : Return GPaginaWeb_GNavegadores_PNavegador3
            Case "3" : Return GPaginaWeb_GNavegadores_PNavegador4
            Case "4" : Return GPaginaWeb_GNavegadores_PNavegador5
            Case "5" : Return GPaginaWeb_GNavegadores_PNavegador6
            Case "6" : Return GPaginaWeb_GNavegadores_PNavegador7
            Case "7" : Return GPaginaWeb_GNavegadores_PNavegador8
            Case "8" : Return GPaginaWeb_GNavegadores_PNavegador9
            Case "9" : Return GPaginaWeb_GNavegadores_PNavegador10
            Case "10" : Return GPaginaWeb_GNavegadores_PNavegador11
            Case Else : Return GPaginaWeb_GNavegadores_PNavegador1
        End Select
    End Function

#End Region

#Region " Checks "

    Private Sub GPaginaWeb_NuevaVentana_Click(sender As Object, e As MouseEventArgs) Handles GPaginaWeb_LNuevaVentana.Click, GPaginaWeb_LNuevaVentana.DoubleClick, GPaginaWeb_CNuevaVentana.Click, GPaginaWeb_CNuevaVentana.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GPaginaWeb_CNuevaVentana.Checked = True Then GPaginaWeb_CNuevaVentana.Checked = False Else GPaginaWeb_CNuevaVentana.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GPaginaWeb_VentanaIncognito_Click(sender As Object, e As MouseEventArgs) Handles GPaginaWeb_LVentanaIncognito.Click, GPaginaWeb_LVentanaIncognito.DoubleClick, GPaginaWeb_CVentanaIncognito.Click, GPaginaWeb_CVentanaIncognito.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GPaginaWeb_CVentanaIncognito.Checked = True Then GPaginaWeb_CVentanaIncognito.Checked = False Else GPaginaWeb_CVentanaIncognito.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GPaginaWeb_Administrador_Click(sender As Object, e As MouseEventArgs) Handles GPaginaWeb_LAdmin.Click, GPaginaWeb_LAdmin.DoubleClick, GPaginaWeb_CAdmin.DoubleClick, GPaginaWeb_CAdmin.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GPaginaWeb_CAdmin.Checked = True Then GPaginaWeb_CAdmin.Checked = False Else GPaginaWeb_CAdmin.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Info "

    Private Sub GPaginaWeb_Info_PIcono_Click(sender As Object, e As MouseEventArgs) Handles GPaginaWeb_Info_PIcono.Click
        If e.Button <> MouseButtons.Right Then Exit Sub
        EjecutarAccion(Comandos_GetByID(ComandoActualID), Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Dim Thread_PaginaWeb_Info As New Threading.Thread(AddressOf PaginaWeb_Info)
    Private Sub PaginaWeb_Info(URL As String)
        If URL = "" Then GoTo Salta
        If GPaginaWeb_GInfo.Tag = URL.ToLower Then Exit Sub Else GPaginaWeb_GInfo.Tag = URL.ToLower
        URL = Replace(URL, "http", "http", 1, -1, Constants.vbTextCompare) : If Internet.ValidarURL(URL) = True Then
            GPaginaWeb_Info_SinInformacion.Visible = False
            GPaginaWeb_Info_LNombre.Value1 = "" : GPaginaWeb_Info_LNombre.Value2 = ""
            GPaginaWeb_Info_DNS.Text = "" : GPaginaWeb_Info_DNS.Refresh()
            GPaginaWeb_Info_LTipo.Text = "" : GPaginaWeb_Info_LTipo.Refresh()
            GPaginaWeb_Info_PIcono.Image = Nothing : GPaginaWeb_Info_PIcono.Refresh()
            GPaginaWeb_Info_LoadingCircle.Active = True : GPaginaWeb_Info_LoadingCircle.Visible = True
Repite:     If Thread_PaginaWeb_Info.ThreadState = Threading.ThreadState.Unstarted Or Thread_PaginaWeb_Info.ThreadState = Threading.ThreadState.Aborted Or Thread_PaginaWeb_Info.ThreadState = Threading.ThreadState.Stopped Then
                Thread_PaginaWeb_Info = New Threading.Thread(AddressOf ThreadSub_PaginaWeb_Info)
                Thread_PaginaWeb_Info.IsBackground = True
                Thread_PaginaWeb_Info.Start(URL) : Application.DoEvents()
            ElseIf Thread_PaginaWeb_Info.ThreadState = Threading.ThreadState.Running Then
                Thread_PaginaWeb_Info.Abort() : Application.DoEvents() : GoTo Repite
            Else
                GoTo Repite
            End If : Iconos_Update() : Exit Sub
        End If
Salta:  GPaginaWeb_Info_LNombre.Value1 = "" : GPaginaWeb_Info_LNombre.Value2 = ""
        GPaginaWeb_Info_DNS.Text = "" : GPaginaWeb_Info_DNS.Refresh()
        GPaginaWeb_Info_LTipo.Text = "" : GPaginaWeb_Info_LTipo.Refresh()
        GPaginaWeb_Info_PIcono.Image = Nothing : GPaginaWeb_Info_PIcono.Refresh()
        GPaginaWeb_Info_SinInformacion.Visible = True
        GPaginaWeb_GInfo.Tag = ""
        Iconos_Update()
    End Sub

    Private Sub ThreadSub_PaginaWeb_Info(URL As String)
        Dim URLTitulo As String = ""
        Dim cURLTitulo() As String = New Uri(URL).Host.Split(".") : For Cuenta = 0 To cURLTitulo.Length - 2 : URLTitulo += cURLTitulo(Cuenta) + "." : Next : URLTitulo = URLTitulo.Substring(0, URLTitulo.Length - 1)

        Dim Company As String = "" : Try : Company = Net.Dns.GetHostAddresses(New Uri(URL).Host)(0).ToString() : Catch : End Try : GPaginaWeb_Info_DNS.Refresh()
        Dim Icono As Image = Nothing : If IO.File.Exists(KobaPathTemp + "icono.ico") = True Then IO.File.Delete(KobaPathTemp + "icono.ico")
        Try : My.Computer.Network.DownloadFile("https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://www." + New Uri(URL).Host.ToString + "&size=32", KobaPathTemp + "icono.ico", "", "", False, 500, True) : Catch : Company = "" : GoTo Salta1 : End Try
        Dim Contador As Integer : Do Until IO.File.Exists(KobaPathTemp + "icono.ico") = True Or Contador = 100 : Contador += 1 : Threading.Thread.Sleep(10) : Loop
Salta1: If IO.File.Exists(KobaPathTemp + "icono.ico") = True Then Icono = Imagen.LoadImageClone(KobaPathTemp + "icono.ico") : IO.File.Delete(KobaPathTemp + "icono.ico") Else Icono = Nothing

        GPaginaWeb_Info_LNombre.Text = URLTitulo : Rutas.SetFontSize(GPaginaWeb_Info_LNombre, 8) : GPaginaWeb_Info_LNombre.Text = ""
        If URLTitulo.Length > 1 Then GPaginaWeb_Info_LNombre.Value1 = URLTitulo.Substring(0, 1).ToUpper : GPaginaWeb_Info_LNombre.Value2 = URLTitulo.Substring(1) Else GPaginaWeb_Info_LNombre.Value1 = URLTitulo.ToUpper : GPaginaWeb_Info_LNombre.Value2 = ""
        If Company = "" Then Company = "Offline"
        GPaginaWeb_Info_DNS.Text = Company : GPaginaWeb_Info_DNS.Refresh()
        GPaginaWeb_Info_LTipo.Text = "Website" : GPaginaWeb_Info_LTipo.Refresh()
        If Icono Is Nothing AndAlso IO.File.Exists(KobaPath + "Iconos\WebIcons\" + URL.Replace("\", "_").Replace("/", "_").Replace("?", "_").Replace(".", "_").Replace(":", "").Replace(";", "") + ".ico") = True Then
            Icono = Iconos.Cargar(KobaPath + "Iconos\WebIcons\" + URL.Replace("\", "_").Replace("/", "_").Replace("?", "_").Replace(".", "_").Replace(":", "").Replace(";", "") + ".ico").ToBitmap
        ElseIf Icono Is Nothing Then
            Icono = My.Resources.WebPage.ToBitmap
        Else
            Iconos.Guardar(Icono, KobaPath + "Iconos\WebIcons\" + URL.Replace("\", "_").Replace("/", "_").Replace("?", "_").Replace(".", "_").Replace(":", "").Replace(";", "") + ".ico")
        End If
        GPaginaWeb_Info_PIcono.Image = Icono : GPaginaWeb_Info_PIcono.Refresh()
        GPaginaWeb_Info_LoadingCircle.Visible = False : GPaginaWeb_Info_LoadingCircle.Active = False
        Invoke(Sub() Iconos_Update())
    End Sub

#End Region

#Region " Help "

    Private Sub GPaginaWeb_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GPaginaWeb_LHelp.Click, GPaginaWeb_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Página Web" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GPaginaWeb_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GPaginaWeb_LHelp.MouseEnter
        GPaginaWeb_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GPaginaWeb_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GPaginaWeb_LHelp.MouseLeave
        GPaginaWeb_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_PaginaWeb_Tooltips(sender As Object, e As EventArgs) Handles GPaginaWeb_PNavegador.MouseEnter, GPaginaWeb_GNavegadores_PNavegador1.MouseEnter, GPaginaWeb_GNavegadores_PNavegador2.MouseEnter, GPaginaWeb_GNavegadores_PNavegador3.MouseEnter, GPaginaWeb_GNavegadores_PNavegador4.MouseEnter, GPaginaWeb_GNavegadores_PNavegador5.MouseEnter, GPaginaWeb_GNavegadores_PNavegador6.MouseEnter, GPaginaWeb_GNavegadores_PNavegador7.MouseEnter, GPaginaWeb_GNavegadores_PNavegador8.MouseEnter, GPaginaWeb_GNavegadores_PNavegador9.MouseEnter, GPaginaWeb_GNavegadores_PNavegador10.MouseEnter, GPaginaWeb_GNavegadores_PNavegador11.MouseEnter, GPaginaWeb_LURL.MouseEnter, GPaginaWeb_CNuevaVentana.MouseEnter, GPaginaWeb_LNuevaVentana.MouseEnter, GPaginaWeb_CVentanaIncognito.MouseEnter, GPaginaWeb_LVentanaIncognito.MouseEnter, GPaginaWeb_CAdmin.MouseEnter, GPaginaWeb_LAdmin.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GPaginaWeb_PNavegador", "GPaginaWeb_GNavegadores_PNavegador1", "GPaginaWeb_GNavegadores_PNavegador2", "GPaginaWeb_GNavegadores_PNavegador3", "GPaginaWeb_GNavegadores_PNavegador4", "GPaginaWeb_GNavegadores_PNavegador5", "GPaginaWeb_GNavegadores_PNavegador6", "GPaginaWeb_GNavegadores_PNavegador7", "GPaginaWeb_GNavegadores_PNavegador8", "GPaginaWeb_GNavegadores_PNavegador9", "GPaginaWeb_GNavegadores_PNavegador10", "GPaginaWeb_GNavegadores_PNavegador11"
                Dim TooltipMsg As String = StrConv(sender.Tag, VbStrConv.ProperCase)
                If sender.Tag.ToString.ToLower.Contains("chrome") Then TooltipMsg = "Google Chrome"
                If sender.Tag.ToString.ToLower.Contains("firefox") Then TooltipMsg = "Mozilla Firefox"
                If sender.Tag.ToString.ToLower.Contains("edge") Then TooltipMsg = "Microsoft Edge"
                If sender.Tag.ToString.ToLower.Contains("opera") Then TooltipMsg = "Opera"
                If sender.Tag.ToString.ToLower.Contains("vivaldi") Then TooltipMsg = "Vivaldi"
                If sender.Tag.ToString.ToLower.Contains("uc browser") Then TooltipMsg = "UC Browser"
                If sender.Tag.ToString.ToLower.Contains("brave") Then TooltipMsg = "Brave"
                Show_Tooltip(sender, TooltipMsg)
            Case "GPaginaWeb_URL" : Show_Tooltip(sender, "Dirección URL de la página web")
            Case "GPaginaWeb_NuevaVentana" : If GPaginaWeb_CNuevaVentana.Enabled = True Then Show_Tooltip(sender, "Abre la página web en una nueva ventana del navegador")
            Case "GPaginaWeb_VentanaIncognito" : If GPaginaWeb_CVentanaIncognito.Enabled = True Then Show_Tooltip(sender, "Abre la página web en una nueva ventana de incognito")
            Case "GPaginaWeb_Admin" : If GPaginaWeb_CAdmin.Enabled = True Then Show_Tooltip(sender, "Ejecuta el navegador con privilegios de administrador")
        End Select
    End Sub

#End Region

#End Region

#Region " Aplicaciones "

#Region " Accion "

    Private Sub GAplicaciones_LCAccion_TextChanged(sender As Object, e As EventArgs) Handles GAplicaciones_LCAccion.TextChanged
        Select Case GAplicaciones_LCAccion.Text
            Case "Activar Aplicacion"
                GAplicaciones_CEsperar.Checked = False : GAplicaciones_CEsperar.Visible = True : GAplicaciones_LEsperar.Visible = True : GAplicaciones_LEsperar.Value1 = "E" : GAplicaciones_LEsperar.Value2 = "sperar"
                GAplicaciones_LEsperarA.Visible = False
                GAplicaciones_Esperar_CActivar.Visible = False : GAplicaciones_Esperar_LActivar.Visible = False
                GAplicaciones_Esperar_CAbrir.Visible = False : GAplicaciones_Esperar_LAbrir.Visible = False
                GAplicaciones_Esperar_CCerrar.Visible = False : GAplicaciones_Esperar_LCerrar.Visible = False
            Case "Cerrar Aplicacion"
                GAplicaciones_CEsperar.Checked = False : GAplicaciones_CEsperar.Visible = True : GAplicaciones_LEsperar.Visible = True : GAplicaciones_LEsperar.Value1 = "F" : GAplicaciones_LEsperar.Value2 = "orzar"
                GAplicaciones_LEsperarA.Visible = False
                GAplicaciones_Esperar_CActivar.Visible = False : GAplicaciones_Esperar_LActivar.Visible = False
                GAplicaciones_Esperar_CAbrir.Visible = False : GAplicaciones_Esperar_LAbrir.Visible = False
                GAplicaciones_Esperar_CCerrar.Visible = False : GAplicaciones_Esperar_LCerrar.Visible = False
            Case "Esperar Aplicacion"
                GAplicaciones_CEsperar.Checked = False : GAplicaciones_CEsperar.Visible = False : GAplicaciones_LEsperar.Visible = False : GAplicaciones_LEsperar.Value1 = "E" : GAplicaciones_LEsperar.Value2 = "sperar"
                GAplicaciones_LEsperarA.Visible = True
                GAplicaciones_Esperar_CActivar.Visible = True : GAplicaciones_Esperar_LActivar.Visible = True
                GAplicaciones_Esperar_CAbrir.Visible = True : GAplicaciones_Esperar_LAbrir.Visible = True
                GAplicaciones_Esperar_CCerrar.Visible = True : GAplicaciones_Esperar_LCerrar.Visible = True
        End Select : If Comandos_Accion_ListaAccion.SelectedItems.Length > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GAplicaciones_TAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GAplicaciones_TAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GAplicaciones_TAccion_GotFocus(sender As Object, e As EventArgs) Handles GAplicaciones_TAccion.GotFocus
        GAplicaciones_TAccion.Text = GAplicaciones_TAccion.Text.Trim : GAplicaciones_TAccion.SelectionLength = 0 : HTexto.Focus()
    End Sub

    Private Sub GAplicaciones_TAccion_LostFocus(sender As Object, e As EventArgs) Handles GAplicaciones_TAccion.LostFocus
        GAplicaciones_TAccion.Text = GAplicaciones_TAccion.Text.Trim : GAplicaciones_TAccion.SelectionLength = 0 : GAplicaciones_LCAccion.Text = GAplicaciones_TAccion.Text
    End Sub

    Private Sub GAplicaciones_TAccion_Click(sender As Object, e As MouseEventArgs) Handles GAplicaciones_LCAccion.Click, GAplicaciones_TAccion.Click
        If e.Button = MouseButtons.Left Then GAplicaciones_CAccion.DroppedDown = True : GAplicaciones_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GAplicaciones_PAccion_Click(sender As Object, e As MouseEventArgs) Handles GAplicaciones_PAccion.Click, GAplicaciones_PAccion.DoubleClick
        If e.Button = MouseButtons.Left Then GAplicaciones_CAccion.DroppedDown = True : GAplicaciones_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GAplicaciones_PAccion_MouseEnter(sender As Object, e As EventArgs) Handles GAplicaciones_PAccion.MouseEnter
        GAplicaciones_PAccion.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GAplicaciones_PAccion_MouseLeave(sender As Object, e As EventArgs) Handles GAplicaciones_PAccion.MouseLeave
        GAplicaciones_PAccion.Image = My.Resources.CComandos_Off
    End Sub

#Region " Combo Accion "

    Private Sub GAplicaciones_CAccion_DropDown(sender As Object, e As EventArgs) Handles GAplicaciones_CAccion.DropDown
        GAplicaciones_CAccion.MaxDropDownItems = GAplicaciones_CAccion.Items.Count : Combo_Dropped = True : Combo_TempValue = GAplicaciones_TAccion.Text
        If GAplicaciones_CAccion.Items.Contains(GAplicaciones_TAccion.Text) = True Then GAplicaciones_CAccion.SelectedItem = GAplicaciones_TAccion.Text Else GAplicaciones_CAccion.SelectedIndex = 0
    End Sub

    Private Sub GAplicaciones_CAccion_DropDownClosed(sender As Object, e As EventArgs) Handles GAplicaciones_CAccion.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GAplicaciones_CAccion_LostFocus(sender As Object, e As EventArgs) Handles GAplicaciones_CAccion.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GAplicaciones_CAccion_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GAplicaciones_CAccion.SelectedIndexChanged
        If Combo_TempValue = "" Then GAplicaciones_TAccion.Text = GAplicaciones_CAccion.SelectedItem.Trim : GAplicaciones_LCAccion.Text = GAplicaciones_TAccion.Text : HTexto.Focus()
    End Sub

    Private Sub GAplicaciones_CAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GAplicaciones_CAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then GAplicaciones_TAccion.Text = GAplicaciones_CAccion.SelectedItem.Trim : GAplicaciones_LCAccion.Text = GAplicaciones_TAccion.Text : HTexto.Focus() : e.Handled = True
    End Sub

#End Region

#End Region

#Region " Aplicacion "

    Private Sub GAplicaciones_LCAplicacion_TextChanged(sender As Object, e As EventArgs) Handles GAplicaciones_LCAplicacion.TextChanged
        GAplicaciones_TAplicacion.Enabled = False
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GAplicaciones_LCAplicacion_Click(sender As Object, e As MouseEventArgs) Handles GAplicaciones_LCAplicacion.Click, GAplicaciones_TAplicacion.Click
        If e.Button = MouseButtons.Left Then
            GAplicaciones_CAplicacion.DroppedDown = True : GAplicaciones_CAplicacion.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            GAplicaciones_LCAplicacion.Visible = False : Combo_IgnoreOne = True : GAplicaciones_TAplicacion.ReadOnly = False : GAplicaciones_TAplicacion.Enabled = True : GAplicaciones_TAplicacion.Cursor = Cursors.IBeam : GAplicaciones_TAplicacion.Focus()
        Else : HTexto.Focus() : End If
    End Sub

    Private Sub GAplicaciones_TAplicacion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GAplicaciones_TAplicacion.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GAplicaciones_TAplicacion_KeyDown(sender As Object, e As KeyEventArgs) Handles GAplicaciones_TAplicacion.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GAplicaciones_CAplicacion.DroppedDown = True : GAplicaciones_CAplicacion.Focus()
    End Sub

    Private Sub GAplicaciones_TAplicacion_GotFocus(sender As Object, e As EventArgs) Handles GAplicaciones_TAplicacion.GotFocus
        If GAplicaciones_LCAplicacion.Visible = True Then HTexto.Focus()
        If GAplicaciones_TAplicacion.ForeColor1 = Color.FromArgb(72, 72, 72) Then
            If GAplicaciones_LCAplicacion.Text = "Seleccione una aplicación" Then GAplicaciones_TAplicacion.Text = "" Else GAplicaciones_TAplicacion.Text = GAplicaciones_LCAplicacion.Text
            GAplicaciones_TAplicacion.ForeColor1 = Color.FromArgb(102, 102, 102)
        End If
        Texto_Focused = True
    End Sub

    Private Sub GAplicaciones_TAplicacion_LostFocus(sender As Object, e As EventArgs) Handles GAplicaciones_TAplicacion.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GAplicaciones_LCAplicacion.Visible = False Then GAplicaciones_LCAplicacion.Visible = True : GAplicaciones_TAplicacion.ReadOnly = True : GAplicaciones_TAplicacion.Enabled = False : GAplicaciones_TAplicacion.Cursor = Cursors.Hand
        If GAplicaciones_TAplicacion.Text.Length > 1 Then GAplicaciones_TAplicacion.Text = GAplicaciones_TAplicacion.Text.Trim.Substring(0, 1).ToUpper + GAplicaciones_TAplicacion.Text.Trim.Substring(1) : GAplicaciones_TAplicacion.SelectionLength = 0
        If GAplicaciones_TAplicacion.Text.Trim = "" Then GAplicaciones_LCAplicacion.Text = "Seleccione una aplicación" : GAplicaciones_TAplicacion.ForeColor1 = Color.FromArgb(72, 72, 72) Else GAplicaciones_LCAplicacion.Text = GAplicaciones_TAplicacion.Text
    End Sub

#Region " Combo Aplicacion "

    Private Sub GAplicaciones_CAplicacion_DropDown(sender As Object, e As EventArgs) Handles GAplicaciones_CAplicacion.DropDown
        GAplicaciones_TAplicacion.Enabled = True
        GAplicaciones_CAplicacion.Items.Clear()
        For Each P As Process In Process.GetProcesses
            If NoAñadir.ToLower.Contains(P.ProcessName.ToLower + ",") = True Then GoTo Salta
            If P.ProcessName <> "" Then
                For Cuenta = 0 To GAplicaciones_CAplicacion.Items.Count - 1
                    If P.ProcessName.ToLower = GAplicaciones_CAplicacion.Items(Cuenta).ToString.ToLower Then GoTo Salta
                Next : GAplicaciones_CAplicacion.Items.Add(P.ProcessName.Substring(0, 1).ToUpper + P.ProcessName.Substring(1))
Salta:      End If
        Next
        GAplicaciones_CAplicacion.Sorted = True : GAplicaciones_CAplicacion.Sorted = False
        GAplicaciones_CAplicacion.MaxDropDownItems = 10 : Combo_Dropped = True : Combo_TempValue = GAplicaciones_TAplicacion.Text
        If GAplicaciones_CAplicacion.Items.Contains(GAplicaciones_TAplicacion.Text) = True Then GAplicaciones_CAplicacion.SelectedItem = GAplicaciones_TAplicacion.Text Else GAplicaciones_CAplicacion.SelectedIndex = 0
    End Sub

    Private Sub GAplicaciones_CAplicacion_DropDownClosed(sender As Object, e As EventArgs) Handles GAplicaciones_CAplicacion.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GAplicaciones_CAplicacion_LostFocus(sender As Object, e As EventArgs) Handles GAplicaciones_CAplicacion.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GAplicaciones_CAplicacion_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GAplicaciones_CAplicacion.SelectionChangeCommitted
        GAplicaciones_TAplicacion.Text = GAplicaciones_CAplicacion.SelectedItem.Trim : GAplicaciones_LCAplicacion.Text = GAplicaciones_TAplicacion.Text : HTexto.Focus()
    End Sub

    Private Sub GAplicaciones_CAplicacion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GAplicaciones_CAplicacion.KeyPress
        If Asc(e.KeyChar) = 13 Then GAplicaciones_TAplicacion.Text = GAplicaciones_CAplicacion.SelectedItem.Trim : GAplicaciones_LCAplicacion.Text = GAplicaciones_TAplicacion.Text : HTexto.Focus() : e.Handled = True
    End Sub

#End Region

#Region " Botones "

    Private Sub GAplicaciones_BAñadirAplicacion_Click(sender As Object, e As MouseEventArgs) Handles GAplicaciones_BAñadirAplicacion.Click
        If e IsNot Nothing AndAlso e.Button <> MouseButtons.Left Then Exit Sub
        GAplicaciones_CAplicacion.Items.Clear()
        For Each P As Process In Process.GetProcesses
            If NoAñadir.ToLower.Contains(P.ProcessName.ToLower + ",") = True Then GoTo Salta
            If P.ProcessName <> "" Then
                For Cuenta = 0 To GAplicaciones_CAplicacion.Items.Count - 1
                    If GAplicaciones_CAplicacion.Items(Cuenta).ToLower = P.ProcessName.ToLower Then GoTo Salta
                Next : GAplicaciones_CAplicacion.Items.Add(P.ProcessName.Substring(0, 1).ToUpper + P.ProcessName.Substring(1))
Salta:      End If
        Next
        If GAplicaciones_CAplicacion.Items.Count = 0 Then HTexto.Focus() : Exit Sub
        GAplicaciones_CAplicacion.Sorted = True : GAplicaciones_CAplicacion.Sorted = False
        GAplicaciones_CAplicacion.MaxDropDownItems = 10
        If GAplicaciones_CAplicacion.Items.Contains(GAplicaciones_LCAplicacion.Text) = True Then GAplicaciones_CAplicacion.SelectedItem = GAplicaciones_LCAplicacion.Text Else GAplicaciones_CAplicacion.SelectedIndex = 0
        GAplicaciones_CAplicacion.DroppedDown = True : Combo_Dropped = True : GAplicaciones_CAplicacion.Focus()
    End Sub

    Private Sub GAplicaciones_ExaminarAplicacion_Click(sender As Object, e As MouseEventArgs) Handles GAplicaciones_BExaminarAplicacion.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar aplicacion..." : Abrir.Filter = "Aplicaciones|*.exe|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then GAplicaciones_TAplicacion.Text = IO.Path.GetFileNameWithoutExtension(Abrir.FileName).Substring(0, 1).ToUpper + IO.Path.GetFileNameWithoutExtension(Abrir.FileName).Substring(1) : GAplicaciones_LCAplicacion.Text = GAplicaciones_TAplicacion.Text
        GAplicaciones_BExaminarAplicacion.State = NSButton.MouseState.None : GAplicaciones_BExaminarAplicacion.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub GAplicaciones_BExaminarAplicacion_MouseEnter(sender As Object, e As EventArgs) Handles GAplicaciones_BExaminarAplicacion.MouseEnter, GAplicaciones_BAñadirAplicacion.MouseEnter
        GAplicaciones_CAplicacion.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " Checks "

    Private Sub GAplicaciones_Esperar_Click(sender As Object, e As MouseEventArgs) Handles GAplicaciones_LEsperar.Click, GAplicaciones_LEsperar.DoubleClick, GAplicaciones_CEsperar.Click, GAplicaciones_CEsperar.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GAplicaciones_CEsperar.Checked = True Then GAplicaciones_CEsperar.Checked = False Else GAplicaciones_CEsperar.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GAplicaciones_EsperarRadio_Click(sender As Object, e As MouseEventArgs) Handles GAplicaciones_Esperar_LActivar.Click, GAplicaciones_Esperar_LActivar.DoubleClick, GAplicaciones_Esperar_LAbrir.Click, GAplicaciones_Esperar_LAbrir.DoubleClick, GAplicaciones_Esperar_LCerrar.Click, GAplicaciones_Esperar_LCerrar.DoubleClick, GAplicaciones_Esperar_CActivar.Click, GAplicaciones_Esperar_CActivar.DoubleClick, GAplicaciones_Esperar_CAbrir.Click, GAplicaciones_Esperar_CAbrir.DoubleClick, GAplicaciones_Esperar_CCerrar.Click, GAplicaciones_Esperar_CCerrar.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then
            Select Case sender.Value2
                Case "ctivar" : GAplicaciones_Esperar_CActivar.Checked = True
                Case "brir" : GAplicaciones_Esperar_CAbrir.Checked = True
                Case "errar" : GAplicaciones_Esperar_CCerrar.Checked = True
            End Select
        End If
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Help "

    Private Sub GAplicaciones_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GAplicaciones_LHelp.Click, GAplicaciones_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Aplicaciones" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GAplicaciones_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GAplicaciones_LHelp.MouseEnter
        GAplicaciones_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GAplicaciones_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GAplicaciones_LHelp.MouseLeave
        GAplicaciones_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_Aplicaciones_Tooltips(sender As Object, e As EventArgs) Handles GAplicaciones_LAccion.MouseEnter, GAplicaciones_LCAccion.MouseEnter, GAplicaciones_LAplicacion.MouseEnter, GAplicaciones_CEsperar.MouseEnter, GAplicaciones_LEsperar.MouseEnter, GAplicaciones_LCAplicacion.MouseEnter, GAplicaciones_BAñadirAplicacion.MouseEnter, GAplicaciones_BExaminarAplicacion.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GAplicaciones_Accion", "GAplicaciones_LCAccion"
                Select Case GAplicaciones_LCAccion.Text
                    Case "Activar Aplicacion" : Show_Tooltip(sender, "Activa la aplicación seleccionada")
                    Case "Cerrar Aplicacion" : Show_Tooltip(sender, "Cierra la aplicación seleccionada")
                    Case "Esperar Aplicacion" : Show_Tooltip(sender, "Espera a que la aplicación seleccionada tenga el foco")
                End Select
            Case "GAplicaciones_Aplicacion" : If GAplicaciones_LCAplicacion.Text = "Seleccione una aplicación" Then Show_Tooltip(sender, "Selecciona un proceso que esté en ejecución" + vbCrLf + vbCrLf + "SHIFT + Click: Selecciona un proceso con el ratón") Else Show_Tooltip(sender, "Aplicación a la que se le aplicará la accion" + vbCrLf + vbCrLf + "SHIFT + Click: Selecciona un proceso con el ratón")
            Case "GAplicaciones_CAplicacion" : If GAplicaciones_LCAplicacion.Text = "Seleccione una aplicación" Then Show_Tooltip(sender, "Selecciona un proceso que esté en ejecución" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente" + vbCrLf + "SHIFT + Click: Selecciona un proceso con el ratón") Else Show_Tooltip(sender, "Aplicación a la que se le aplicará la accion" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente" + vbCrLf + "SHIFT + Click: Selecciona un proceso con el ratón")
            Case "GAplicaciones_BAñadirAplicacion" : Show_Tooltip(sender, "Selecciona un proceso que esté en ejecución")
            Case "GAplicaciones_BExaminarAplicacion" : Show_Tooltip(sender, "Selecciona un proceso desde un archivo ejecutable")
            Case "GAplicaciones_Esperar" : If GAplicaciones_LEsperar.Value2 = "sperar" Then Show_Tooltip(sender, "Espera hasta que la aplicación tenga el foco") Else Show_Tooltip(sender, "Fuerza el cierre de la aplicación")
        End Select
    End Sub

#End Region

#End Region

#Region " Ejecutar BAT "

#Region " Textos "

    Private Sub GEjecutarBAT_TNombre_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEjecutarBAT_TNombre.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GEjecutarBAT_TNombre_LostFocus(sender As Object, e As EventArgs) Handles GEjecutarBAT_TNombre.LostFocus
        If GEjecutarBAT_TNombre.Text.Trim = "" Then GEjecutarBAT_TNombre.Text = "Sin Nombre"
        Guardar_BAT_KDesktop(GEjecutarBAT_TTexto.Tag)
    End Sub

    Private Sub GEjecutarBAT_TTexto_GotFocus(sender As Object, e As EventArgs) Handles GEjecutarBAT_TTexto.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub GEjecutarBAT_TTexto_LostFocus(sender As Object, e As EventArgs) Handles GEjecutarBAT_TTexto.LostFocus
        Texto_Focused = False
        GEjecutarBAT_TTexto.Tag = KobaPath + "BATs\" + Comandos_Accion_ListaAccion.SelectedItems(0).Tag2 + ".bat"
        If GEjecutarBAT_TTexto.Text.Trim = "" Then
            If IO.File.Exists(GEjecutarBAT_TTexto.Tag) = True Then IO.File.Delete(GEjecutarBAT_TTexto.Tag)
        Else
            Guardar_BAT_KDesktop(GEjecutarBAT_TTexto.Tag)
        End If
    End Sub

#End Region

#Region " Modo "

    Private Sub GEjecutarBAT_TModo_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEjecutarBAT_TModo.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GEjecutarBAT_TModo_TextChanged(sender As Object, e As EventArgs) Handles GEjecutarBAT_TModo.TextChanged
        GEjecutarBAT_LCModo.Text = GEjecutarBAT_TModo.Text.Trim : Guardar_BAT_KDesktop(GEjecutarBAT_TTexto.Tag)
    End Sub

    Private Sub GEjecutarBAT_TModo_GotFocus(sender As Object, e As EventArgs) Handles GEjecutarBAT_TModo.GotFocus
        GEjecutarBAT_TModo.Text = GEjecutarBAT_TModo.Text.Trim : GEjecutarBAT_TModo.SelectionLength = 0 : HTexto.Focus()
    End Sub

    Private Sub GEjecutarBAT_TModo_LostFocus(sender As Object, e As EventArgs) Handles GEjecutarBAT_TModo.LostFocus
        GEjecutarBAT_TModo.Text = GEjecutarBAT_TModo.Text.Trim : GEjecutarBAT_TModo.SelectionLength = 0
    End Sub

    Private Sub GEjecutarBAT_TModo_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarBAT_TModo.Click, GEjecutarBAT_LCModo.Click
        HTexto.Focus() : If e.Button = MouseButtons.Left Then GEjecutarBAT_CModo.DroppedDown = True : GEjecutarBAT_CModo.Focus()
    End Sub

    Private Sub GEjecutarBAT_PModo_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarBAT_PModo.Click, GEjecutarBAT_PModo.DoubleClick
        If e.Button = MouseButtons.Left Then GEjecutarBAT_CModo.DroppedDown = True : GEjecutarBAT_CModo.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GEjecutarBAT_PModo_MouseEnter(sender As Object, e As EventArgs) Handles GEjecutarBAT_PModo.MouseEnter
        GEjecutarBAT_PModo.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GEjecutarBAT_PModo_MouseLeave(sender As Object, e As EventArgs) Handles GEjecutarBAT_PModo.MouseLeave
        GEjecutarBAT_PModo.Image = My.Resources.CComandos_Off
    End Sub

#Region " Combo "

    Private Sub GEjecutarBAT_CModo_DropDown(sender As Object, e As EventArgs) Handles GEjecutarBAT_CModo.DropDown
        GEjecutarBAT_CModo.MaxDropDownItems = GEjecutarBAT_CModo.Items.Count : Combo_Dropped = True : Combo_TempValue = GEjecutarBAT_TModo.Text : GEjecutarBAT_CModo.SelectedItem = GEjecutarBAT_TModo.Text
        If GEjecutarBAT_CModo.Items.Contains(GEjecutarBAT_TModo.Text) = True Then GEjecutarBAT_CModo.SelectedItem = GEjecutarBAT_TModo.Text Else GEjecutarBAT_CModo.SelectedIndex = 0
    End Sub

    Private Sub GEjecutarBAT_CModo_DropDownClosed(sender As Object, e As EventArgs) Handles GEjecutarBAT_CModo.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GEjecutarBAT_CModo_LostFocus(sender As Object, e As EventArgs) Handles GEjecutarBAT_CModo.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GEjecutarBAT_CModo_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GEjecutarBAT_CModo.SelectedIndexChanged
        If Combo_TempValue = "" Then GEjecutarBAT_TModo.Text = GEjecutarBAT_CModo.SelectedItem.Trim : GEjecutarBAT_LCModo.Text = GEjecutarBAT_TModo.Text : HTexto.Focus()
    End Sub

    Private Sub GEjecutarBAT_CModo_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEjecutarBAT_CModo.KeyPress
        If Asc(e.KeyChar) = 13 Then GEjecutarBAT_TModo.Text = GEjecutarBAT_CModo.SelectedItem.Trim : GEjecutarBAT_LCModo.Text = GEjecutarBAT_TModo.Text : e.Handled = True : HTexto.Focus()
    End Sub

#End Region

#End Region

#Region " Administrador "

    Private Sub GEjecutarBAT_Administrador_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarBAT_LAdministrador.Click, GEjecutarBAT_LAdministrador.DoubleClick, GEjecutarBAT_CAdministrador.DoubleClick, GEjecutarBAT_CAdministrador.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GEjecutarBAT_CAdministrador.Checked = True Then GEjecutarBAT_CAdministrador.Checked = False Else GEjecutarBAT_CAdministrador.Checked = True
        Guardar_BAT_KDesktop(GEjecutarBAT_TTexto.Tag)
    End Sub

#End Region

#Region " Botones "

    Private Sub GEjecutarBAT_PNuevo_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarBAT_PNuevo.Click
        HTexto.Focus() : If e.Button <> MouseButtons.Left Then Exit Sub
        GEjecutarBAT_TTexto.Text = "" : GEjecutarBAT_TNombre.Text = "Sin Nombre" : GEjecutarBAT_TTexto.Tag = KobaPath + "BATs\" + Comandos_Accion_ListaAccion.SelectedItems(0).Tag2 + ".bat"
        If Comandos_Accion_ListaAccion.SelectedItems(0).Tag2 = "" Then Exit Sub
        If IO.File.Exists(KobaPath + "BATs\" + Comandos_Accion_ListaAccion.SelectedItems(0).Tag2 + ".bat") = True Then IO.File.Delete(KobaPath + "BATs\" + Comandos_Accion_ListaAccion.SelectedItems(0).Tag2 + ".bat")
    End Sub

    Private Sub GEjecutarBAT_Abrir_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarBAT_PAbrir.Click
        HTexto.Focus() : If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True : Abrir.Title = "Seleccionar archivo BAT..." : Abrir.Filter = "Archivos BAT|*.bat|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then
            GEjecutarBAT_TTexto.Tag = Abrir.FileName
            Dim Leer As New IO.StreamReader(Abrir.FileName) : GEjecutarBAT_TTexto.Text = Leer.ReadToEnd : Leer.Close()
            GEjecutarBAT_TNombre.Text = IO.Path.GetFileNameWithoutExtension(Abrir.FileName)
            If Comandos_Accion_ListaAccion.SelectedItems(0).Tag2 = "" Then Exit Sub
            GEjecutarBAT_TTexto.Tag = KobaPath + "BATs\" + Comandos_Accion_ListaAccion.SelectedItems(0).Tag2 + ".bat"
            Guardar_BAT_KDesktop(GEjecutarBAT_TTexto.Tag)
        End If
    End Sub

    Private Sub GEjecutarBAT_Guardar_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarBAT_PGuardar.Click
        HTexto.Focus() : If e.Button <> MouseButtons.Left Then Exit Sub
        Dim dGuardar As New SaveFileDialog : dGuardar.OverwritePrompt = True : dGuardar.CheckPathExists = True : dGuardar.Title = "Guardar archivo BAT..." : dGuardar.Filter = "Archivos BAT|*.bat|Todos los Archivos|*.*"
        If GEjecutarBAT_TNombre.Text = "" Then dGuardar.FileName = "Sin Nombre" Else dGuardar.FileName = GEjecutarBAT_TNombre.Text
        If dGuardar.ShowDialog <> DialogResult.Cancel Then
            If IO.File.Exists(dGuardar.FileName) = True Then IO.File.Delete(dGuardar.FileName)
            Dim Guardar As New IO.StreamWriter(dGuardar.FileName) : Guardar.Write(GEjecutarBAT_TTexto.Text) : Guardar.Close()
        End If
    End Sub

    Private Sub Abrir_BAT_KDesktop(Ruta As String)
        Dim Leer As New IO.StreamReader(Ruta) : GEjecutarBAT_TTexto.Text = Leer.ReadToEnd : Leer.Close()
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub Guardar_BAT_KDesktop(Ruta As String)
        If Ruta = "" Or Ruta = KobaPath + "BATs\.bat" Then Exit Sub
        If IO.Directory.Exists(KobaPath + "BATs\") = False Then IO.Directory.CreateDirectory(KobaPath + "BATs\")
        If IO.File.Exists(Ruta) = True Then IO.File.Delete(Ruta)
        Dim Guardar As New IO.StreamWriter(Ruta) : Guardar.Write(GEjecutarBAT_TTexto.Text) : Guardar.Close()
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GEjecutarBAT_PNotepad_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarBAT_PNotepad.Click
        HTexto.Focus() : If e.Button <> MouseButtons.Left Then Exit Sub
        If IO.File.Exists(GEjecutarBAT_TTexto.Tag) = False Then Guardar_BAT_KDesktop(GEjecutarBAT_TTexto.Tag)
        Dim P As New Process : P.StartInfo.FileName = "Notepad.exe" : P.StartInfo.Arguments = """" + GEjecutarBAT_TTexto.Tag + """" : P.Start()
    End Sub

    Private Sub GEjecutarBAT_PProbar_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarBAT_PProbar.Click
        HTexto.Focus() : If e.Button <> MouseButtons.Left AndAlso e.Button <> MouseButtons.Right Then Exit Sub
        If GEjecutarBAT_TTexto.Text.Trim = "" Then Exit Sub
        If GEjecutarBAT_CAdministrador.Checked = False Then
            Dim Boton As String : If e.Button = MouseButtons.Left Then Boton = "Left" Else Boton = "Otro"
            CreateKPS() : RunProcess.RunAsStandar(KobaPathTemp + "KPS.exe", ("Probar BAT|-|" + Boton + "|-|" + GEjecutarBAT_TNombre.Text + "|-|" + GEjecutarBAT_TTexto.Tag + "|-|" + GEjecutarBAT_TModo.Text + "|-|" + IO.Path.GetFileNameWithoutExtension(GEjecutarBAT_TTexto.Tag)).ToString.Replace("""", "|||")) : Exit Sub
        End If

        If e.Button <> MouseButtons.Left Then
            Try : If GEjecutarBAT_Proceso.HasExited = False Then GEjecutarBAT_Proceso.CloseMainWindow()
            Catch : End Try : Exit Sub
        End If
        Try : If GEjecutarBAT_Proceso.HasExited = False Then GEjecutarBAT_Proceso.CloseMainWindow()
        Catch : End Try
        HTexto.Focus() : GEjecutarBAT_Proceso = New Process : GEjecutarBAT_Proceso.StartInfo.FileName = GEjecutarBAT_TTexto.Tag
        Select Case GEjecutarBAT_TModo.Text
            Case "Minimizado" : GEjecutarBAT_Proceso.StartInfo.WindowStyle = ProcessWindowStyle.Minimized
            Case "Maximizado" : GEjecutarBAT_Proceso.StartInfo.WindowStyle = ProcessWindowStyle.Maximized
            Case "Oculto" : GEjecutarBAT_Proceso.StartInfo.UseShellExecute = False : GEjecutarBAT_Proceso.StartInfo.CreateNoWindow = True : GEjecutarBAT_Proceso.StartInfo.RedirectStandardInput = True : GEjecutarBAT_Proceso.StartInfo.WindowStyle = ProcessWindowStyle.Hidden
            Case Else : GEjecutarBAT_Proceso.StartInfo.WindowStyle = ProcessWindowStyle.Normal
        End Select
        GEjecutarBAT_Proceso.Start()
    End Sub

    Private Sub GEjecutarBAT_PBotones_MouseEnter(sender As Object, e As EventArgs) Handles GEjecutarBAT_PNuevo.MouseEnter, GEjecutarBAT_PAbrir.MouseEnter, GEjecutarBAT_PGuardar.MouseEnter, GEjecutarBAT_PNotepad.MouseEnter, GEjecutarBAT_PProbar.MouseEnter
        Select Case sender.Name
            Case "GEjecutarBAT_PNuevo" : GEjecutarBAT_PNuevo.Image = My.Resources.EjecutarBAT_New
            Case "GEjecutarBAT_PAbrir" : GEjecutarBAT_PAbrir.Image = My.Resources.EjecutarBAT_Open
            Case "GEjecutarBAT_PGuardar" : GEjecutarBAT_PGuardar.Image = My.Resources.EjecutarBAT_Save
            Case "GEjecutarBAT_PNotepad" : GEjecutarBAT_PNotepad.Image = My.Resources.EjecutarBAT_Notepad
            Case "GEjecutarBAT_PProbar" : GEjecutarBAT_PProbar.Image = My.Resources.EjecutarBAT_Run
        End Select
    End Sub

    Private Sub GEjecutarBAT_PBotones_MouseLeave(sender As Object, e As EventArgs) Handles GEjecutarBAT_PNuevo.MouseLeave, GEjecutarBAT_PAbrir.MouseLeave, GEjecutarBAT_PGuardar.MouseLeave, GEjecutarBAT_PNotepad.MouseLeave, GEjecutarBAT_PProbar.MouseLeave
        Select Case sender.Name
            Case "GEjecutarBAT_PNuevo" : GEjecutarBAT_PNuevo.Image = My.Resources.EjecutarBAT_New_Off
            Case "GEjecutarBAT_PAbrir" : GEjecutarBAT_PAbrir.Image = My.Resources.EjecutarBAT_Open_Off
            Case "GEjecutarBAT_PGuardar" : GEjecutarBAT_PGuardar.Image = My.Resources.EjecutarBAT_Save_Off
            Case "GEjecutarBAT_PNotepad" : GEjecutarBAT_PNotepad.Image = My.Resources.EjecutarBAT_Notepad_Off
            Case "GEjecutarBAT_PProbar" : GEjecutarBAT_PProbar.Image = My.Resources.EjecutarBAT_Run_Off
        End Select
    End Sub

#End Region

#Region " Help "

    Private Sub GEjecutarBAT_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GEjecutarBAT_LHelp.Click, GEjecutarBAT_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Ejecutar BAT" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GEjecutarBAT_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GEjecutarBAT_LHelp.MouseEnter
        GEjecutarBAT_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GEjecutarBAT_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GEjecutarBAT_LHelp.MouseLeave
        GEjecutarBAT_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_EjecutarBAT_Tooltips(sender As Object, e As EventArgs) Handles GEjecutarBAT_LNombre.MouseEnter, GEjecutarBAT_CAdministrador.MouseEnter, GEjecutarBAT_LAdministrador.MouseEnter, GEjecutarBAT_LModo.MouseEnter, GEjecutarBAT_PNuevo.MouseEnter, GEjecutarBAT_PAbrir.MouseEnter, GEjecutarBAT_PGuardar.MouseEnter, GEjecutarBAT_PNotepad.MouseEnter, GEjecutarBAT_PProbar.MouseEnter, GEjecutarBAT_LCModo.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GEjecutarBAT_Nombre" : Show_Tooltip(sender, "Nombre del archivo BAT")
            Case "GEjecutarBAT_Administrador" : Show_Tooltip(sender, "Ejecuta el archivo BAT con privilegios de administrador")
            Case "GEjecutarBAT_Modo", "GEjecutarBAT_CModo" : Show_Tooltip(sender, "Modo en el que se ejecutará la aplicación")
            Case "GEjecutarBAT_PNuevo" : Show_Tooltip(sender, "Crea un nuevo archivo BAT")
            Case "GEjecutarBAT_PAbrir" : Show_Tooltip(sender, "Abre un archivo BAT")
            Case "GEjecutarBAT_PGuardar" : Show_Tooltip(sender, "Exporta el archivo BAT")
            Case "GEjecutarBAT_PNotepad" : Show_Tooltip(sender, "Abre el archivo BAT en el 'Bloc de Notas")
            Case "GEjecutarBAT_PProbar" : Show_Tooltip(sender, "Ejecuta el archivo BAT" + vbCrLf + "Nota: Click Derecho para cerrarlo")
        End Select
    End Sub

#End Region

#End Region

#End Region

#Region " Audio y Video "

#Region " Captura de Pantalla "

#Region " Sonido "

    Private Sub GCapturaPantalla_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles GCapturaPantalla_LCSonido.TextChanged
        GCapturaPantalla_TSonido.Enabled = False
        GCapturaPantalla_LCSonido.Text = Rutas.Acortar_Ruta(GCapturaPantalla_TSonido.Text, GCapturaPantalla_LCSonido)
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GCapturaPantalla_LCSonido.Text, New Font(GCapturaPantalla_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < GCapturaPantalla_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : GCapturaPantalla_LCSonido.Font = New Font(GCapturaPantalla_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GCapturaPantalla_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles GCapturaPantalla_LCSonido.Click, GCapturaPantalla_TSonido.Click
        If e.Button = MouseButtons.Left Then
            GCapturaPantalla_CSonido.DroppedDown = True : GCapturaPantalla_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            GCapturaPantalla_LCSonido.Visible = False : Combo_IgnoreOne = True : GCapturaPantalla_TSonido.ReadOnly = False : GCapturaPantalla_TSonido.Enabled = True : GCapturaPantalla_TSonido.Cursor = Cursors.IBeam : GCapturaPantalla_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub GCapturaPantalla_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GCapturaPantalla_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GCapturaPantalla_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles GCapturaPantalla_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GCapturaPantalla_CSonido.DroppedDown = True : GCapturaPantalla_CSonido.Focus()
    End Sub

    Private Sub GCapturaPantalla_TSonido_GotFocus(sender As Object, e As EventArgs) Handles GCapturaPantalla_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub GCapturaPantalla_TSonido_LostFocus(sender As Object, e As EventArgs) Handles GCapturaPantalla_TSonido.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GCapturaPantalla_LCSonido.Visible = False Then GCapturaPantalla_LCSonido.Visible = True : GCapturaPantalla_TSonido.ReadOnly = True : GCapturaPantalla_TSonido.Enabled = False : GCapturaPantalla_TSonido.Cursor = Cursors.Hand
        If IO.File.Exists(GCapturaPantalla_TSonido.Text) = False And GCapturaPantalla_CSonido.Items.Contains(StrConv(GCapturaPantalla_TSonido.Text, VbStrConv.ProperCase)) = False Then GCapturaPantalla_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To GCapturaPantalla_CSonido.Items.Count - 1
            If GCapturaPantalla_TSonido.Text.ToLower = GCapturaPantalla_CSonido.Items(Cuenta).ToLower Then GCapturaPantalla_TSonido.Text = GCapturaPantalla_CSonido.Items(Cuenta)
        Next : GCapturaPantalla_TSonido.Text = GCapturaPantalla_TSonido.Text.Trim : GCapturaPantalla_TSonido.SelectionLength = 0 : GCapturaPantalla_LCSonido.Text = GCapturaPantalla_TSonido.Text
    End Sub

    Private Sub GCapturaPantalla_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles GCapturaPantalla_TSonido.MouseEnter, GCapturaPantalla_CSonido.MouseEnter
        GCapturaPantalla_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub GCapturaPantalla_CSonido_DropDown(sender As Object, e As EventArgs) Handles GCapturaPantalla_CSonido.DropDown
        GCapturaPantalla_TSonido.Enabled = True
        GCapturaPantalla_CSonido.MaxDropDownItems = GCapturaPantalla_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = GCapturaPantalla_TSonido.Text
        If GCapturaPantalla_CSonido.Items.Contains(GCapturaPantalla_TSonido.Text) = True Then GCapturaPantalla_CSonido.SelectedItem = GCapturaPantalla_TSonido.Text Else GCapturaPantalla_CSonido.SelectedIndex = 0
    End Sub

    Private Sub GCapturaPantalla_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles GCapturaPantalla_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GCapturaPantalla_CSonido_LostFocus(sender As Object, e As EventArgs) Handles GCapturaPantalla_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GCapturaPantalla_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GCapturaPantalla_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then GCapturaPantalla_TSonido.Text = GCapturaPantalla_CSonido.SelectedItem.Trim : GCapturaPantalla_LCSonido.Text = GCapturaPantalla_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub GCapturaPantalla_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GCapturaPantalla_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then GCapturaPantalla_TSonido.Text = GCapturaPantalla_CSonido.SelectedItem.Trim : GCapturaPantalla_LCSonido.Text = GCapturaPantalla_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub GCapturaPantalla_CSonido_ItemHover(Index As Integer) Handles GCapturaPantalla_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub GCapturaPantalla_BPlay_Click(sender As Object, e As MouseEventArgs) Handles GCapturaPantalla_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GCapturaPantalla_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(GCapturaPantalla_TSonido.Text)
    End Sub

    Private Sub GCapturaPantalla_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles GCapturaPantalla_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then GCapturaPantalla_TSonido.Text = Abrir.FileName : GCapturaPantalla_LCSonido.Text = GCapturaPantalla_TSonido.Text : Sonidos.Play_Block(GCapturaPantalla_TSonido.Text)
        GCapturaPantalla_TSonido.SelectionStart = GCapturaPantalla_TSonido.Text.Length : GCapturaPantalla_TSonido.SelectionLength = 0
        GCapturaPantalla_BExaminar.State = NSButton.MouseState.None : GCapturaPantalla_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub GCapturaPantalla_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles GCapturaPantalla_BExaminar.MouseEnter
        GCapturaPantalla_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " Textos "

    Private Sub GCapturaPantalla_TDuracion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GCapturaPantalla_TDuracion.KeyPress
        If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar) Then e.Handled = True
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GCapturaPantalla_TDuracion_GotFocus(sender As Object, e As EventArgs) Handles GCapturaPantalla_TDuracion.GotFocus
        GCapturaPantalla_TDuracion.Text = GCapturaPantalla_TDuracion.Text.Trim : GCapturaPantalla_TDuracion.SelectionLength = 0
    End Sub

    Private Sub GCapturaPantalla_TDuracion_LostFocus(sender As Object, e As EventArgs) Handles GCapturaPantalla_TDuracion.LostFocus
        GCapturaPantalla_TDuracion.Text = GCapturaPantalla_TDuracion.Text.Trim : GCapturaPantalla_TDuracion.SelectionLength = 0 : If GCapturaPantalla_TDuracion.Text = "" Then GCapturaPantalla_TDuracion.Text = "0"
        GCapturaPantalla_TDuracion.Text = CInt(GCapturaPantalla_TDuracion.Text)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GCapturaPantalla_LFormato_Click(sender As Object, e As MouseEventArgs) Handles GCapturaPantalla_LFormato.Click, GCapturaPantalla_LFormato.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GCapturaPantalla_LFormato.Value2 = "ms" Then GCapturaPantalla_LFormato.Value2 = "sec" : GCapturaPantalla_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GCapturaPantalla_LFormato.Value2 = "sec" Then GCapturaPantalla_LFormato.Value2 = "min" : GCapturaPantalla_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GCapturaPantalla_LFormato.Value2 = "min" Then GCapturaPantalla_LFormato.Value2 = "ms" : GCapturaPantalla_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
    End Sub

#End Region

#Region " Checks "

    Private Sub GCapturaPantalla_CuentaAtras_Click(sender As Object, e As MouseEventArgs) Handles GCapturaPantalla_LCuentaAtras.Click, GCapturaPantalla_LCuentaAtras.DoubleClick, GCapturaPantalla_CCuentaAtras.Click, GCapturaPantalla_CCuentaAtras.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GCapturaPantalla_CCuentaAtras.Checked = True Then GCapturaPantalla_CCuentaAtras.Checked = False Else GCapturaPantalla_CCuentaAtras.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " OSD "

    Private Sub GCapturaPantalla_OSD_Click(sender As Object, e As MouseEventArgs) Handles GCapturaPantalla_LOSD.Click, GCapturaPantalla_LOSD.DoubleClick, GCapturaPantalla_COSD.Click, GCapturaPantalla_COSD.DoubleClick
        If e.Button = MouseButtons.Left Then
            If TypeOf sender Is NSLabel Then If GCapturaPantalla_COSD.Checked = True Then GCapturaPantalla_COSD.Checked = False Else GCapturaPantalla_COSD.Checked = True
            If GCapturaPantalla_COSD.Checked = True Then GCapturaPantalla_CCuentaAtras.Enabled = True : GCapturaPantalla_LCuentaAtras.Enabled = True Else GCapturaPantalla_CCuentaAtras.Enabled = False : GCapturaPantalla_LCuentaAtras.Enabled = False
            GCapturaPantalla_BOSD.Enabled = GCapturaPantalla_COSD.Checked : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        ElseIf e.Button = MouseButtons.Right Then
            If GCapturaPantalla_COSD.Checked = True And TypeOf sender Is NSLabel Then
                Opciones_OSD_Color = GCapturaPantalla_OSD_Color : Opciones_OSD_Font = GCapturaPantalla_OSD_Fuente : ShowOSD("Mensaje de prueba")
            End If
        End If
    End Sub

    Private Sub GCapturaPantalla_BOSD_Click(sender As Object, e As MouseEventArgs) Handles GCapturaPantalla_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = GCapturaPantalla_OSD_Fuente : Opciones_FontDialog.Color = GCapturaPantalla_OSD_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then GCapturaPantalla_OSD_Fuente = Opciones_FontDialog.Font : GCapturaPantalla_OSD_Color = Opciones_FontDialog.Color : GCapturaPantalla_BOSD.ForeColor1 = GCapturaPantalla_OSD_Color : GCapturaPantalla_BOSD.ForeColor3 = GCapturaPantalla_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = GCapturaPantalla_OSD_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then GCapturaPantalla_OSD_Color = Opciones_ColorDialog.Color : GCapturaPantalla_BOSD.ForeColor1 = GCapturaPantalla_OSD_Color : GCapturaPantalla_BOSD.ForeColor3 = GCapturaPantalla_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            GCapturaPantalla_OSD_Fuente = OSD_Default_Font : GCapturaPantalla_OSD_Color = Color.FromArgb(205, 150, 0) : GCapturaPantalla_BOSD.ForeColor1 = GCapturaPantalla_OSD_Color : GCapturaPantalla_BOSD.ForeColor3 = GCapturaPantalla_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : HTexto.Focus()
        Opciones_OSD_Color = GCapturaPantalla_OSD_Color : Opciones_OSD_Font = GCapturaPantalla_OSD_Fuente : ShowOSD("Mensaje de prueba")
    End Sub

#End Region

#Region " Help "

    Private Sub GCapturaPantalla_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GCapturaPantalla_LHelp.Click, GCapturaPantalla_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Capturar Pantalla" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GCapturaPantalla_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GCapturaPantalla_LHelp.MouseEnter
        GCapturaPantalla_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GCapturaPantalla_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GCapturaPantalla_LHelp.MouseLeave
        GCapturaPantalla_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_CapturaPantalla_Tooltips(sender As Object, e As EventArgs) Handles GCapturaPantalla_COSD.MouseEnter, GCapturaPantalla_LOSD.MouseEnter, GCapturaPantalla_BOSD.MouseEnter, GCapturaPantalla_LSonido.MouseEnter, GCapturaPantalla_BPlay.MouseEnter, GCapturaPantalla_BExaminar.MouseEnter, GCapturaPantalla_LDuracion.MouseEnter, GCapturaPantalla_LFormato.MouseEnter, GCapturaPantalla_CCuentaAtras.MouseEnter, GCapturaPantalla_LCuentaAtras.MouseEnter, GCapturaPantalla_LCSonido.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GCapturaPantalla_OSD"
                If sender.Name = "GCapturaPantalla_COSD" Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
                If sender.Name = "GCapturaPantalla_LOSD" Then If GCapturaPantalla_COSD.Checked = True Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción" + vbCrLf + "Nota: Click Derecho para previsualizar") Else Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
            Case "GCapturaPantalla_BOSD" : If GCapturaPantalla_COSD.Checked = True Then Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "GCapturaPantalla_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción")
            Case "GCapturaPantalla_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "GCapturaPantalla_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "GCapturaPantalla_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
            Case "GCapturaPantalla_Duracion" : Show_Tooltip(sender, "Tiempo que de espera antes de ejecutar la acción")
            Case "GCapturaPantalla_Formato" : Show_Tooltip(sender, "Click Izquierdo: Cambiar el modo de tiempo (min, sec, o ms)")
            Case "GCapturaPantalla_CuentaAtras" : Show_Tooltip(sender, "Muestra una cuenta atras en el OSD")
        End Select
    End Sub

#End Region

#End Region

#Region " Grabacion de Pantalla "

#Region " Sonido "

    Private Sub GGrabacionPantalla_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LCSonido.TextChanged
        GGrabacionPantalla_TSonido.Enabled = False
        GGrabacionPantalla_LCSonido.Text = Rutas.Acortar_Ruta(GGrabacionPantalla_TSonido.Text, GGrabacionPantalla_LCSonido)
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GGrabacionPantalla_LCSonido.Text, New Font(GGrabacionPantalla_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < GGrabacionPantalla_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : GGrabacionPantalla_LCSonido.Font = New Font(GGrabacionPantalla_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionPantalla_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LCSonido.Click, GGrabacionPantalla_TSonido.Click
        If e.Button = MouseButtons.Left Then
            GGrabacionPantalla_CSonido.DroppedDown = True : GGrabacionPantalla_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            GGrabacionPantalla_LCSonido.Visible = False : Combo_IgnoreOne = True : GGrabacionPantalla_TSonido.ReadOnly = False : GGrabacionPantalla_TSonido.Enabled = True : GGrabacionPantalla_TSonido.Cursor = Cursors.IBeam : GGrabacionPantalla_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub GGrabacionPantalla_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GGrabacionPantalla_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GGrabacionPantalla_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles GGrabacionPantalla_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GGrabacionPantalla_CSonido.DroppedDown = True : GGrabacionPantalla_CSonido.Focus()
    End Sub

    Private Sub GGrabacionPantalla_TSonido_GotFocus(sender As Object, e As EventArgs) Handles GGrabacionPantalla_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub GGrabacionPantalla_TSonido_LostFocus(sender As Object, e As EventArgs) Handles GGrabacionPantalla_TSonido.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GGrabacionPantalla_LCSonido.Visible = False Then GGrabacionPantalla_LCSonido.Visible = True : GGrabacionPantalla_TSonido.ReadOnly = True : GGrabacionPantalla_TSonido.Enabled = False : GGrabacionPantalla_TSonido.Cursor = Cursors.Hand
        If IO.File.Exists(GGrabacionPantalla_TSonido.Text) = False And GGrabacionPantalla_CSonido.Items.Contains(StrConv(GGrabacionPantalla_TSonido.Text, VbStrConv.ProperCase)) = False Then GGrabacionPantalla_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To GGrabacionPantalla_CSonido.Items.Count - 1
            If GGrabacionPantalla_TSonido.Text.ToLower = GGrabacionPantalla_CSonido.Items(Cuenta).ToLower Then GGrabacionPantalla_TSonido.Text = GGrabacionPantalla_CSonido.Items(Cuenta)
        Next : GGrabacionPantalla_TSonido.Text = GGrabacionPantalla_TSonido.Text.Trim : GGrabacionPantalla_TSonido.SelectionLength = 0 : GGrabacionPantalla_LCSonido.Text = GGrabacionPantalla_TSonido.Text
    End Sub

    Private Sub GGrabacionPantalla_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles GGrabacionPantalla_TSonido.MouseEnter, GGrabacionPantalla_CSonido.MouseEnter
        GGrabacionPantalla_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub GGrabacionPantalla_CSonido_DropDown(sender As Object, e As EventArgs) Handles GGrabacionPantalla_CSonido.DropDown
        GGrabacionPantalla_TSonido.Enabled = True
        GGrabacionPantalla_CSonido.MaxDropDownItems = GGrabacionPantalla_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = GGrabacionPantalla_TSonido.Text
        If GGrabacionPantalla_CSonido.Items.Contains(GGrabacionPantalla_TSonido.Text) = True Then GGrabacionPantalla_CSonido.SelectedItem = GGrabacionPantalla_TSonido.Text Else GGrabacionPantalla_CSonido.SelectedIndex = 0
    End Sub

    Private Sub GGrabacionPantalla_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles GGrabacionPantalla_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GGrabacionPantalla_CSonido_LostFocus(sender As Object, e As EventArgs) Handles GGrabacionPantalla_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GGrabacionPantalla_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GGrabacionPantalla_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then GGrabacionPantalla_TSonido.Text = GGrabacionPantalla_CSonido.SelectedItem.Trim : GGrabacionPantalla_LCSonido.Text = GGrabacionPantalla_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub GGrabacionPantalla_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GGrabacionPantalla_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then GGrabacionPantalla_TSonido.Text = GGrabacionPantalla_CSonido.SelectedItem.Trim : GGrabacionPantalla_LCSonido.Text = GGrabacionPantalla_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub GGrabacionPantalla_CSonido_ItemHover(Index As Integer) Handles GGrabacionPantalla_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub GGrabacionPantalla_BPlay_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GGrabacionPantalla_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(GGrabacionPantalla_TSonido.Text)
    End Sub

    Private Sub GGrabacionPantalla_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then GGrabacionPantalla_TSonido.Text = Abrir.FileName : GGrabacionPantalla_LCSonido.Text = GGrabacionPantalla_TSonido.Text : Sonidos.Play_Block(GGrabacionPantalla_TSonido.Text)
        GGrabacionPantalla_TSonido.SelectionStart = GGrabacionPantalla_TSonido.Text.Length : GGrabacionPantalla_TSonido.SelectionLength = 0
        GGrabacionPantalla_BExaminar.State = NSButton.MouseState.None : GGrabacionPantalla_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub GGrabacionPantalla_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles GGrabacionPantalla_BExaminar.MouseEnter
        GGrabacionPantalla_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " Textos "

    Private Sub GGrabacionPantalla_TDuracion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GGrabacionPantalla_TDuracion.KeyPress
        If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar) Then e.Handled = True
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GGrabacionPantalla_TDuracion_GotFocus(sender As Object, e As EventArgs) Handles GGrabacionPantalla_TDuracion.GotFocus
        GGrabacionPantalla_TDuracion.Text = GGrabacionPantalla_TDuracion.Text.Trim : GGrabacionPantalla_TDuracion.SelectionLength = 0
    End Sub

    Private Sub GGrabacionPantalla_TDuracion_LostFocus(sender As Object, e As EventArgs) Handles GGrabacionPantalla_TDuracion.LostFocus
        GGrabacionPantalla_TDuracion.Text = GGrabacionPantalla_TDuracion.Text.Trim : GGrabacionPantalla_TDuracion.SelectionLength = 0 : If GGrabacionPantalla_TDuracion.Text = "" Then GGrabacionPantalla_TDuracion.Text = "0"
        GGrabacionPantalla_TDuracion.Text = CInt(GGrabacionPantalla_TDuracion.Text)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionPantalla_LFormato_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LFormato.Click, GGrabacionPantalla_LFormato.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GGrabacionPantalla_LFormato.Value2 = "ms" Then GGrabacionPantalla_LFormato.Value2 = "sec" : GGrabacionPantalla_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GGrabacionPantalla_LFormato.Value2 = "sec" Then GGrabacionPantalla_LFormato.Value2 = "min" : GGrabacionPantalla_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GGrabacionPantalla_LFormato.Value2 = "min" Then GGrabacionPantalla_LFormato.Value2 = "ms" : GGrabacionPantalla_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
    End Sub

#End Region

#Region " Checks "

    Private Sub GGrabacionPantalla_CuentaAtras_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LCuentaAtras.Click, GGrabacionPantalla_LCuentaAtras.DoubleClick, GGrabacionPantalla_CCuentaAtras.Click, GGrabacionPantalla_CCuentaAtras.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GGrabacionPantalla_CCuentaAtras.Checked = True Then GGrabacionPantalla_CCuentaAtras.Checked = False Else GGrabacionPantalla_CCuentaAtras.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionPantalla_MarcarClicks_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LMarcarClicks.Click, GGrabacionPantalla_LMarcarClicks.DoubleClick, GGrabacionPantalla_CMarcarClicks.Click, GGrabacionPantalla_CMarcarClicks.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GGrabacionPantalla_CMarcarClicks.Checked = True Then GGrabacionPantalla_CMarcarClicks.Checked = False Else GGrabacionPantalla_CMarcarClicks.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionPantalla_DesktopDuplication_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LDesktopDuplication.Click, GGrabacionPantalla_LDesktopDuplication.DoubleClick, GGrabacionPantalla_CDesktopDuplication.Click, GGrabacionPantalla_CDesktopDuplication.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GGrabacionPantalla_CDesktopDuplication.Checked = True Then GGrabacionPantalla_CDesktopDuplication.Checked = False Else GGrabacionPantalla_CDesktopDuplication.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionPantalla_Sonido_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LGSonido.Click, GGrabacionPantalla_LGSonido.DoubleClick, GGrabacionPantalla_CGSonido.Click, GGrabacionPantalla_CGSonido.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GGrabacionPantalla_CGSonido.Checked = True Then GGrabacionPantalla_CGSonido.Checked = False Else GGrabacionPantalla_CGSonido.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionPantalla_Microfono_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LGMicrofono.Click, GGrabacionPantalla_LGMicrofono.DoubleClick, GGrabacionPantalla_CGMicrofono.Click, GGrabacionPantalla_CGMicrofono.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GGrabacionPantalla_CGMicrofono.Checked = True Then GGrabacionPantalla_CGMicrofono.Checked = False Else GGrabacionPantalla_CGMicrofono.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#Region " Pantallas "

    Private Sub GGrabacionPantalla_Pantalla1_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LPantalla1.Click, GGrabacionPantalla_LPantalla1.DoubleClick, GGrabacionPantalla_CPantalla1.Click, GGrabacionPantalla_CPantalla1.DoubleClick
        If TypeOf sender Is NSLabel Then GGrabacionPantalla_CPantalla1.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionPantalla_Pantalla2_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LPantalla2.Click, GGrabacionPantalla_LPantalla2.DoubleClick, GGrabacionPantalla_CPantalla2.Click, GGrabacionPantalla_CPantalla2.DoubleClick
        If TypeOf sender Is NSLabel Then GGrabacionPantalla_CPantalla2.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionPantalla_Pantalla3_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LPantalla3.Click, GGrabacionPantalla_LPantalla3.DoubleClick, GGrabacionPantalla_CPantalla3.Click, GGrabacionPantalla_CPantalla3.DoubleClick
        If TypeOf sender Is NSLabel Then GGrabacionPantalla_CPantalla3.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionPantalla_Pantalla4_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LPantalla4.Click, GGrabacionPantalla_LPantalla4.DoubleClick, GGrabacionPantalla_CPantalla4.Click, GGrabacionPantalla_CPantalla4.DoubleClick
        If TypeOf sender Is NSLabel Then GGrabacionPantalla_CPantalla4.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionPantalla_Preguntar_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LPreguntar.Click, GGrabacionPantalla_LPreguntar.DoubleClick, GGrabacionPantalla_CPreguntar.Click, GGrabacionPantalla_CPreguntar.DoubleClick
        If TypeOf sender Is NSLabel Then GGrabacionPantalla_CPreguntar.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionPantalla_BIdentificar_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_BIdentificar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        For i As Integer = 0 To (Screen.AllScreens.Length - 1)
            Dim f As New FIdentificarPantalla
            f.NumberToDraw = i + 1
            f.Location = New Point(Screen.AllScreens(i).Bounds.Location.X, Screen.AllScreens(i).Bounds.Location.Y)
            f.Show()
        Next
    End Sub

#End Region

#End Region

#Region " OSD "

    Private Sub GGrabacionPantalla_OSD_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LOSD.Click, GGrabacionPantalla_LOSD.DoubleClick, GGrabacionPantalla_COSD.Click, GGrabacionPantalla_COSD.DoubleClick
        If e.Button = MouseButtons.Left Then
            If TypeOf sender Is NSLabel Then If GGrabacionPantalla_COSD.Checked = True Then GGrabacionPantalla_COSD.Checked = False Else GGrabacionPantalla_COSD.Checked = True
            If GGrabacionPantalla_COSD.Checked = True Then GGrabacionPantalla_CCuentaAtras.Enabled = True : GGrabacionPantalla_LCuentaAtras.Enabled = True Else GGrabacionPantalla_CCuentaAtras.Enabled = False : GGrabacionPantalla_LCuentaAtras.Enabled = False
            GGrabacionPantalla_BOSD.Enabled = GGrabacionPantalla_COSD.Checked : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        ElseIf e.Button = MouseButtons.Right Then
            If GGrabacionPantalla_COSD.Checked = True And TypeOf sender Is NSLabel Then
                Opciones_OSD_Color = GGrabacionPantalla_OSD_Color : Opciones_OSD_Font = GGrabacionPantalla_OSD_Fuente : ShowOSD("Mensaje de prueba")
            End If
        End If
    End Sub

    Private Sub GGrabacionPantalla_BOSD_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = GGrabacionPantalla_OSD_Fuente : Opciones_FontDialog.Color = GGrabacionPantalla_OSD_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then GGrabacionPantalla_OSD_Fuente = Opciones_FontDialog.Font : GGrabacionPantalla_OSD_Color = Opciones_FontDialog.Color : GGrabacionPantalla_BOSD.ForeColor1 = GGrabacionPantalla_OSD_Color : GGrabacionPantalla_BOSD.ForeColor3 = GGrabacionPantalla_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = GGrabacionPantalla_OSD_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then GGrabacionPantalla_OSD_Color = Opciones_ColorDialog.Color : GGrabacionPantalla_BOSD.ForeColor1 = GGrabacionPantalla_OSD_Color : GGrabacionPantalla_BOSD.ForeColor3 = GGrabacionPantalla_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            GGrabacionPantalla_OSD_Fuente = OSD_Default_Font : GGrabacionPantalla_OSD_Color = Color.FromArgb(205, 150, 0) : GGrabacionPantalla_BOSD.ForeColor1 = GGrabacionPantalla_OSD_Color : GGrabacionPantalla_BOSD.ForeColor3 = GGrabacionPantalla_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : HTexto.Focus()
        Opciones_OSD_Color = GGrabacionPantalla_OSD_Color : Opciones_OSD_Font = GGrabacionPantalla_OSD_Fuente : ShowOSD("Mensaje de prueba")
    End Sub

#End Region

#Region " Help "

    Private Sub GGrabacionPantalla_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionPantalla_LHelp.Click, GGrabacionPantalla_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Grabar Pantalla" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GGrabacionPantalla_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LHelp.MouseEnter
        GGrabacionPantalla_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GGrabacionPantalla_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LHelp.MouseLeave
        GGrabacionPantalla_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_GrabacionPantalla_Tooltips(sender As Object, e As EventArgs) Handles GGrabacionPantalla_COSD.MouseEnter, GGrabacionPantalla_LOSD.MouseEnter, GGrabacionPantalla_BOSD.MouseEnter, GGrabacionPantalla_LSonido.MouseEnter, GGrabacionPantalla_BPlay.MouseEnter, GGrabacionPantalla_BExaminar.MouseEnter, GGrabacionPantalla_LDuracion.MouseEnter, GGrabacionPantalla_LFormato.MouseEnter, GGrabacionPantalla_CCuentaAtras.MouseEnter, GGrabacionPantalla_LCuentaAtras.MouseEnter, GGrabacionPantalla_CGSonido.MouseEnter, GGrabacionPantalla_LGSonido.MouseEnter, GGrabacionPantalla_CGMicrofono.MouseEnter, GGrabacionPantalla_LGMicrofono.MouseEnter, GGrabacionPantalla_CDesktopDuplication.MouseEnter, GGrabacionPantalla_LDesktopDuplication.MouseEnter, GGrabacionPantalla_CMarcarClicks.MouseEnter, GGrabacionPantalla_LMarcarClicks.MouseEnter, GGrabacionPantalla_CPantalla1.MouseEnter, GGrabacionPantalla_LPantalla1.MouseEnter, GGrabacionPantalla_CPantalla2.MouseEnter, GGrabacionPantalla_LPantalla2.MouseEnter, GGrabacionPantalla_CPantalla3.MouseEnter, GGrabacionPantalla_LPantalla3.MouseEnter, GGrabacionPantalla_CPantalla4.MouseEnter, GGrabacionPantalla_LPantalla4.MouseEnter, GGrabacionPantalla_CPreguntar.MouseEnter, GGrabacionPantalla_LPreguntar.MouseEnter, GGrabacionPantalla_BIdentificar.MouseEnter, GGrabacionPantalla_LCSonido.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GGrabacionPantalla_OSD"
                If sender.Name = "GGrabacionPantalla_COSD" Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
                If sender.Name = "GGrabacionPantalla_LOSD" Then If GGrabacionPantalla_COSD.Checked = True Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción" + vbCrLf + "Nota: Click Derecho para previsualizar") Else Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
            Case "GGrabacionPantalla_BOSD" : If GGrabacionPantalla_COSD.Checked = True Then Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "GGrabacionPantalla_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción")
            Case "GGrabacionPantalla_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "GGrabacionPantalla_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "GGrabacionPantalla_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
            Case "GGrabacionPantalla_Duracion" : Show_Tooltip(sender, "Tiempo que de espera antes de ejecutar la acción")
            Case "GGrabacionPantalla_Formato" : Show_Tooltip(sender, "Click Izquierdo: Cambiar el modo de tiempo (min, sec, o ms)")
            Case "GGrabacionPantalla_CuentaAtras" : Show_Tooltip(sender, "Muestra una cuenta atras en el OSD")
            Case "GGrabacionPantalla_GSonido" : Show_Tooltip(sender, "Graba el sonido del ordenador")
            Case "GGrabacionPantalla_GMicrofono" : Show_Tooltip(sender, "Graba el sonido del micrófono")
            Case "GGrabacionPantalla_DesktopDuplication" : Show_Tooltip(sender, "Graba usando el modo 'Desktop Duplication'" + vbCrLf + vbCrLf + "Nota: En este modo puede grabar en aplicaciones" + vbCrLf + " que usan pantalla completa")
            Case "GGrabacionPantalla_MarcarClicks" : Show_Tooltip(sender, "Marca los clicks del ratón en la grabación")
            Case "GGrabacionPantalla_Pantalla1", "GGrabacionPantalla_Pantalla2", "GGrabacionPantalla_Pantalla3", "GGrabacionPantalla_Pantalla4" : Show_Tooltip(sender, "Graba la pantalla seleccionada")
            Case "GGrabacionPantalla_Preguntar" : Show_Tooltip(sender, "Muestra una ventana para seleccionar la pantalla que se grabará")
            Case "GGrabacionPantalla_BIdentificar" : Show_Tooltip(sender, "Identifica las pantallas del ordenador")
        End Select
    End Sub

#End Region

#End Region

#Region " Grabacion de Audio "

#Region " Sonido "

    Private Sub GGrabacionAudio_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles GGrabacionAudio_LCSonido.TextChanged
        GGrabacionAudio_TSonido.Enabled = False
        GGrabacionAudio_LCSonido.Text = Rutas.Acortar_Ruta(GGrabacionAudio_TSonido.Text, GGrabacionAudio_LCSonido)
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GGrabacionAudio_LCSonido.Text, New Font(GGrabacionAudio_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < GGrabacionAudio_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : GGrabacionAudio_LCSonido.Font = New Font(GGrabacionAudio_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionAudio_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionAudio_LCSonido.Click, GGrabacionAudio_TSonido.Click
        If e.Button = MouseButtons.Left Then
            GGrabacionAudio_CSonido.DroppedDown = True : GGrabacionAudio_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            GGrabacionAudio_LCSonido.Visible = False : Combo_IgnoreOne = True : GGrabacionAudio_TSonido.ReadOnly = False : GGrabacionAudio_TSonido.Enabled = True : GGrabacionAudio_TSonido.Cursor = Cursors.IBeam : GGrabacionAudio_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub GGrabacionAudio_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GGrabacionAudio_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GGrabacionAudio_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles GGrabacionAudio_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GGrabacionAudio_CSonido.DroppedDown = True : GGrabacionAudio_CSonido.Focus()
    End Sub

    Private Sub GGrabacionAudio_TSonido_GotFocus(sender As Object, e As EventArgs) Handles GGrabacionAudio_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub GGrabacionAudio_TSonido_LostFocus(sender As Object, e As EventArgs) Handles GGrabacionAudio_TSonido.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GGrabacionAudio_LCSonido.Visible = False Then GGrabacionAudio_LCSonido.Visible = True : GGrabacionAudio_TSonido.ReadOnly = True : GGrabacionAudio_TSonido.Enabled = False : GGrabacionAudio_TSonido.Cursor = Cursors.Hand
        If IO.File.Exists(GGrabacionAudio_TSonido.Text) = False And GGrabacionAudio_CSonido.Items.Contains(StrConv(GGrabacionAudio_TSonido.Text, VbStrConv.ProperCase)) = False Then GGrabacionAudio_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To GGrabacionAudio_CSonido.Items.Count - 1
            If GGrabacionAudio_TSonido.Text.ToLower = GGrabacionAudio_CSonido.Items(Cuenta).ToLower Then GGrabacionAudio_TSonido.Text = GGrabacionAudio_CSonido.Items(Cuenta)
        Next : GGrabacionAudio_TSonido.Text = GGrabacionAudio_TSonido.Text.Trim : GGrabacionAudio_TSonido.SelectionLength = 0 : GGrabacionAudio_LCSonido.Text = GGrabacionAudio_TSonido.Text
    End Sub

    Private Sub GGrabacionAudio_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles GGrabacionAudio_TSonido.MouseEnter, GGrabacionAudio_CSonido.MouseEnter
        GGrabacionAudio_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub GGrabacionAudio_CSonido_DropDown(sender As Object, e As EventArgs) Handles GGrabacionAudio_CSonido.DropDown
        GGrabacionAudio_TSonido.Enabled = True
        GGrabacionAudio_CSonido.MaxDropDownItems = GGrabacionAudio_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = GGrabacionAudio_TSonido.Text
        If GGrabacionAudio_CSonido.Items.Contains(GGrabacionAudio_TSonido.Text) = True Then GGrabacionAudio_CSonido.SelectedItem = GGrabacionAudio_TSonido.Text Else GGrabacionAudio_CSonido.SelectedIndex = 0
    End Sub

    Private Sub GGrabacionAudio_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles GGrabacionAudio_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GGrabacionAudio_CSonido_LostFocus(sender As Object, e As EventArgs) Handles GGrabacionAudio_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GGrabacionAudio_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GGrabacionAudio_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then GGrabacionAudio_TSonido.Text = GGrabacionAudio_CSonido.SelectedItem.Trim : GGrabacionAudio_LCSonido.Text = GGrabacionAudio_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub GGrabacionAudio_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GGrabacionAudio_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then GGrabacionAudio_TSonido.Text = GGrabacionAudio_CSonido.SelectedItem.Trim : GGrabacionAudio_LCSonido.Text = GGrabacionAudio_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub GGrabacionAudio_CSonido_ItemHover(Index As Integer) Handles GGrabacionAudio_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub GGrabacionAudio_BPlay_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionAudio_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GGrabacionAudio_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(GGrabacionAudio_TSonido.Text)
    End Sub

    Private Sub GGrabacionAudio_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionAudio_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then GGrabacionAudio_TSonido.Text = Abrir.FileName : GGrabacionAudio_LCSonido.Text = GGrabacionAudio_TSonido.Text : Sonidos.Play_Block(GGrabacionAudio_TSonido.Text)
        GGrabacionAudio_TSonido.SelectionStart = GGrabacionAudio_TSonido.Text.Length : GGrabacionAudio_TSonido.SelectionLength = 0
        GGrabacionAudio_BExaminar.State = NSButton.MouseState.None : GGrabacionAudio_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub GGrabacionAudio_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles GGrabacionAudio_BExaminar.MouseEnter
        GGrabacionAudio_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " Textos "

    Private Sub GGrabacionAudio_TDuracion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GGrabacionAudio_TDuracion.KeyPress
        If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar) Then e.Handled = True
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GGrabacionAudio_TDuracion_GotFocus(sender As Object, e As EventArgs) Handles GGrabacionAudio_TDuracion.GotFocus
        GGrabacionAudio_TDuracion.Text = GGrabacionAudio_TDuracion.Text.Trim : GGrabacionAudio_TDuracion.SelectionLength = 0
    End Sub

    Private Sub GGrabacionAudio_TDuracion_LostFocus(sender As Object, e As EventArgs) Handles GGrabacionAudio_TDuracion.LostFocus
        GGrabacionAudio_TDuracion.Text = GGrabacionAudio_TDuracion.Text.Trim : GGrabacionAudio_TDuracion.SelectionLength = 0 : If GGrabacionAudio_TDuracion.Text = "" Then GGrabacionAudio_TDuracion.Text = "0"
        GGrabacionAudio_TDuracion.Text = CInt(GGrabacionAudio_TDuracion.Text)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GGrabacionAudio_LFormato_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionAudio_LFormato.Click, GGrabacionAudio_LFormato.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GGrabacionAudio_LFormato.Value2 = "ms" Then GGrabacionAudio_LFormato.Value2 = "sec" : GGrabacionAudio_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GGrabacionAudio_LFormato.Value2 = "sec" Then GGrabacionAudio_LFormato.Value2 = "min" : GGrabacionAudio_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GGrabacionAudio_LFormato.Value2 = "min" Then GGrabacionAudio_LFormato.Value2 = "ms" : GGrabacionAudio_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
    End Sub

#End Region

#Region " Checks "

    Private Sub GGrabacionAudio_CuentaAtras_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionAudio_LCuentaAtras.Click, GGrabacionAudio_LCuentaAtras.DoubleClick, GGrabacionAudio_CCuentaAtras.Click, GGrabacionAudio_CCuentaAtras.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GGrabacionAudio_CCuentaAtras.Checked = True Then GGrabacionAudio_CCuentaAtras.Checked = False Else GGrabacionAudio_CCuentaAtras.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " OSD "

    Private Sub GGrabacionAudio_OSD_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionAudio_LOSD.Click, GGrabacionAudio_LOSD.DoubleClick, GGrabacionAudio_COSD.Click, GGrabacionAudio_COSD.DoubleClick
        If e.Button = MouseButtons.Left Then
            If TypeOf sender Is NSLabel Then If GGrabacionAudio_COSD.Checked = True Then GGrabacionAudio_COSD.Checked = False Else GGrabacionAudio_COSD.Checked = True
            If GGrabacionAudio_COSD.Checked = True Then GGrabacionAudio_CCuentaAtras.Enabled = True : GGrabacionAudio_LCuentaAtras.Enabled = True Else GGrabacionAudio_CCuentaAtras.Enabled = False : GGrabacionAudio_LCuentaAtras.Enabled = False
            GGrabacionAudio_BOSD.Enabled = GGrabacionAudio_COSD.Checked : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        ElseIf e.Button = MouseButtons.Right Then
            If GGrabacionAudio_COSD.Checked = True And TypeOf sender Is NSLabel Then
                Opciones_OSD_Color = GGrabacionAudio_OSD_Color : Opciones_OSD_Font = GGrabacionAudio_OSD_Fuente : ShowOSD("Mensaje de prueba")
            End If
        End If
    End Sub

    Private Sub GGrabacionAudio_BOSD_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionAudio_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = GGrabacionAudio_OSD_Fuente : Opciones_FontDialog.Color = GGrabacionAudio_OSD_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then GGrabacionAudio_OSD_Fuente = Opciones_FontDialog.Font : GGrabacionAudio_OSD_Color = Opciones_FontDialog.Color : GGrabacionAudio_BOSD.ForeColor1 = GGrabacionAudio_OSD_Color : GGrabacionAudio_BOSD.ForeColor3 = GGrabacionAudio_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = GGrabacionAudio_OSD_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then GGrabacionAudio_OSD_Color = Opciones_ColorDialog.Color : GGrabacionAudio_BOSD.ForeColor1 = GGrabacionAudio_OSD_Color : GGrabacionAudio_BOSD.ForeColor3 = GGrabacionAudio_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            GGrabacionAudio_OSD_Fuente = OSD_Default_Font : GGrabacionAudio_OSD_Color = Color.FromArgb(205, 150, 0) : GGrabacionAudio_BOSD.ForeColor1 = GGrabacionAudio_OSD_Color : GGrabacionAudio_BOSD.ForeColor3 = GGrabacionAudio_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : HTexto.Focus()
        Opciones_OSD_Color = GGrabacionAudio_OSD_Color : Opciones_OSD_Font = GGrabacionAudio_OSD_Fuente : ShowOSD("Mensaje de prueba")
    End Sub

#End Region

#Region " Help "

    Private Sub GGrabacionAudio_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GGrabacionAudio_LHelp.Click, GGrabacionAudio_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Grabar Audio" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GGrabacionAudio_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GGrabacionAudio_LHelp.MouseEnter
        GGrabacionAudio_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GGrabacionAudio_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GGrabacionAudio_LHelp.MouseLeave
        GGrabacionAudio_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_GrabacionAudio_Tooltips(sender As Object, e As EventArgs) Handles GGrabacionAudio_COSD.MouseEnter, GGrabacionAudio_LOSD.MouseEnter, GGrabacionAudio_BOSD.MouseEnter, GGrabacionAudio_LSonido.MouseEnter, GGrabacionAudio_BPlay.MouseEnter, GGrabacionAudio_BExaminar.MouseEnter, GGrabacionAudio_LDuracion.MouseEnter, GGrabacionAudio_LFormato.MouseEnter, GGrabacionAudio_CCuentaAtras.MouseEnter, GGrabacionAudio_LCuentaAtras.MouseEnter, GGrabacionAudio_LCSonido.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GGrabacionAudio_OSD"
                If sender.Name = "GGrabacionAudio_COSD" Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
                If sender.Name = "GGrabacionAudio_LOSD" Then If GGrabacionAudio_COSD.Checked = True Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción" + vbCrLf + "Nota: Click Derecho para previsualizar") Else Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
            Case "GGrabacionAudio_BOSD" : If GGrabacionAudio_COSD.Checked = True Then Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "GGrabacionAudio_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción")
            Case "GGrabacionAudio_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "GGrabacionAudio_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "GGrabacionAudio_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
            Case "GGrabacionAudio_Duracion" : Show_Tooltip(sender, "Tiempo que de espera antes de ejecutar la acción")
            Case "GGrabacionAudio_Formato" : Show_Tooltip(sender, "Click Izquierdo: Cambiar el modo de tiempo (min, sec, o ms)")
            Case "GGrabacionAudio_CuentaAtras" : Show_Tooltip(sender, "Muestra una cuenta atras en el OSD")
        End Select
    End Sub

#End Region

#End Region

#Region " Reproducir Sonido "

#Region " Sonido "

    Private Sub GReproducirSonido_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles GReproducirSonido_LCSonido.TextChanged
        GReproducirSonido_TSonido.Enabled = False
        GReproducirSonido_LCSonido.Text = Rutas.Acortar_Ruta(GReproducirSonido_TSonido.Text, GReproducirSonido_LCSonido)
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GReproducirSonido_LCSonido.Text, New Font(GReproducirSonido_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < GReproducirSonido_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : GReproducirSonido_LCSonido.Font = New Font(GReproducirSonido_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GReproducirSonido_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles GReproducirSonido_LCSonido.Click, GReproducirSonido_TSonido.Click
        If e.Button = MouseButtons.Left Then
            GReproducirSonido_CSonido.DroppedDown = True : GReproducirSonido_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            GReproducirSonido_LCSonido.Visible = False : Combo_IgnoreOne = True : GReproducirSonido_TSonido.ReadOnly = False : GReproducirSonido_TSonido.Enabled = True : GReproducirSonido_TSonido.Cursor = Cursors.IBeam : GReproducirSonido_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub GReproducirSonido_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GReproducirSonido_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GReproducirSonido_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles GReproducirSonido_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GReproducirSonido_CSonido.DroppedDown = True : GReproducirSonido_CSonido.Focus()
    End Sub

    Private Sub GReproducirSonido_TSonido_GotFocus(sender As Object, e As EventArgs) Handles GReproducirSonido_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub GReproducirSonido_TSonido_LostFocus(sender As Object, e As EventArgs) Handles GReproducirSonido_TSonido.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GReproducirSonido_LCSonido.Visible = False Then GReproducirSonido_LCSonido.Visible = True : GReproducirSonido_TSonido.ReadOnly = True : GReproducirSonido_TSonido.Enabled = False : GReproducirSonido_TSonido.Cursor = Cursors.Hand
        If IO.File.Exists(GReproducirSonido_TSonido.Text) = False And GReproducirSonido_CSonido.Items.Contains(StrConv(GReproducirSonido_TSonido.Text, VbStrConv.ProperCase)) = False Then GReproducirSonido_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To GReproducirSonido_CSonido.Items.Count - 1
            If GReproducirSonido_TSonido.Text.ToLower = GReproducirSonido_CSonido.Items(Cuenta).ToLower Then GReproducirSonido_TSonido.Text = GReproducirSonido_CSonido.Items(Cuenta)
        Next : GReproducirSonido_TSonido.Text = GReproducirSonido_TSonido.Text.Trim : GReproducirSonido_TSonido.SelectionLength = 0 : GReproducirSonido_LCSonido.Text = GReproducirSonido_TSonido.Text
    End Sub

    Private Sub GReproducirSonido_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles GReproducirSonido_TSonido.MouseEnter, GReproducirSonido_CSonido.MouseEnter
        GReproducirSonido_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub GReproducirSonido_CSonido_DropDown(sender As Object, e As EventArgs) Handles GReproducirSonido_CSonido.DropDown
        GReproducirSonido_TSonido.Enabled = True
        GReproducirSonido_CSonido.MaxDropDownItems = GReproducirSonido_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = GReproducirSonido_TSonido.Text
        If GReproducirSonido_CSonido.Items.Contains(GReproducirSonido_TSonido.Text) = True Then GReproducirSonido_CSonido.SelectedItem = GReproducirSonido_TSonido.Text Else GReproducirSonido_CSonido.SelectedIndex = 0
    End Sub

    Private Sub GReproducirSonido_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles GReproducirSonido_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GReproducirSonido_CSonido_LostFocus(sender As Object, e As EventArgs) Handles GReproducirSonido_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GReproducirSonido_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GReproducirSonido_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then GReproducirSonido_TSonido.Text = GReproducirSonido_CSonido.SelectedItem.Trim : GReproducirSonido_LCSonido.Text = GReproducirSonido_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub GReproducirSonido_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GReproducirSonido_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then GReproducirSonido_TSonido.Text = GReproducirSonido_CSonido.SelectedItem.Trim : GReproducirSonido_LCSonido.Text = GReproducirSonido_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub GReproducirSonido_CSonido_ItemHover(Index As Integer) Handles GReproducirSonido_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub GReproducirSonido_BPlay_Click(sender As Object, e As MouseEventArgs) Handles GReproducirSonido_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GReproducirSonido_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(GReproducirSonido_TSonido.Text)
    End Sub

    Private Sub GReproducirSonido_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles GReproducirSonido_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then GReproducirSonido_TSonido.Text = Abrir.FileName : GReproducirSonido_LCSonido.Text = GReproducirSonido_TSonido.Text : Sonidos.Play_Block(GReproducirSonido_TSonido.Text)
        GReproducirSonido_TSonido.SelectionStart = GReproducirSonido_TSonido.Text.Length : GReproducirSonido_TSonido.SelectionLength = 0
        GReproducirSonido_BExaminar.State = NSButton.MouseState.None : GReproducirSonido_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub GReproducirSonido_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles GReproducirSonido_BExaminar.MouseEnter
        GReproducirSonido_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " Checks "

    Private Sub GReproducirSonido_Esperar_Click(sender As Object, e As MouseEventArgs) Handles GReproducirSonido_LEsperar.Click, GReproducirSonido_LEsperar.DoubleClick, GReproducirSonido_CEsperar.Click, GReproducirSonido_CEsperar.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GReproducirSonido_CEsperar.Checked = True Then GReproducirSonido_CEsperar.Checked = False Else GReproducirSonido_CEsperar.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Help "

    Private Sub GReproducirSonido_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GReproducirSonido_LHelp.Click, GReproducirSonido_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Reproducir Sonido" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GReproducirSonido_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GReproducirSonido_LHelp.MouseEnter
        GReproducirSonido_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GReproducirSonido_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GReproducirSonido_LHelp.MouseLeave
        GReproducirSonido_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_ReproducirSonido_Tooltips(sender As Object, e As EventArgs) Handles GReproducirSonido_LSonido.MouseEnter, GReproducirSonido_BPlay.MouseEnter, GReproducirSonido_BExaminar.MouseEnter, GReproducirSonido_CEsperar.MouseEnter, GReproducirSonido_LEsperar.MouseEnter, GReproducirSonido_LCSonido.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GReproducirSonido_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción")
            Case "GReproducirSonido_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "GReproducirSonido_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "GReproducirSonido_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
            Case "GReproducirSonido_Esperar" : Show_Tooltip(sender, "Espera a que termine de reproducirse el sonido")
        End Select
    End Sub

#End Region

#End Region

#Region " Salida de Audio "

#Region " Listas "

#Region " Lista Disponibles "

    Private Sub GSalidaAudio_ListaDisponibles_GotFocus(sender As Object, e As EventArgs) Handles GSalidaAudio_ListaDisponibles.GotFocus
        GSalidaAudio_ListaSeleccionados.SelectItem(-1) : GSalidaAudio_ListaSeleccionados.Invalidate()
    End Sub

    Private Sub GSalidaAudio_ListaDisponibles_SelectedIndexChanged(sender As Object, Indice As Integer) Handles GSalidaAudio_ListaDisponibles.SelectedIndexChanged
        If Indice = -1 Then
            GSalidaAudio_SinInformacion.Visible = True
            GSalidaAudio_LNombre.Text = "" : GSalidaAudio_LNombre.Invalidate()
            GSalidaAudio_LHardware.Text = "" : GSalidaAudio_LHardware.Invalidate()
            GSalidaAudio_LEstado.Text = "" : GSalidaAudio_LEstado.Invalidate()
            GSalidaAudio_LPredeterminado.Visible = False
            GSalidaAudio_LComunicaciones.Visible = False
            GSalidaAudio_PIcono.Image = Nothing : GSalidaAudio_PIcono.Invalidate()
            Exit Sub
        End If
        GSalidaAudio_ListaSeleccionados.SelectItem(-1)
        If GSalidaAudio_ListaDisponibles.Items.Count = 0 Then Exit Sub
        Dim AudioDevice As AudioAPI.AudioDeviceST = Audio.GetAudioDevice(GSalidaAudio_ListaDisponibles.Items(Indice).Tag)
        If AudioDevice.ID <> "" Then
            GSalidaAudio_SinInformacion.Visible = False
            GSalidaAudio_LNombre.Text = AudioDevice.Name : GSalidaAudio_LNombre.Invalidate()
            GSalidaAudio_LHardware.Text = AudioDevice.Manufacter : GSalidaAudio_LHardware.Invalidate()
            GSalidaAudio_LEstado.Text = AudioDevice.State.ToString.Replace("Active", "Conectado").Replace("Disabled", "Deshabilitado").Replace("Unplugged", "No conectado") : GSalidaAudio_LEstado.Invalidate()
            If AudioDevice.Multimedia Then GSalidaAudio_LPredeterminado.Visible = True Else GSalidaAudio_LPredeterminado.Visible = False
            If AudioDevice.Communications Then GSalidaAudio_LComunicaciones.Visible = True Else GSalidaAudio_LComunicaciones.Visible = False
            GSalidaAudio_PIcono.Image = Iconos.ExtraerIcono(AudioDevice.IconPath.Split(",")(0).Replace("%windir%", Environment.GetFolderPath(Environment.SpecialFolder.Windows)), AudioDevice.IconPath.Split(",")(1)) : GSalidaAudio_PIcono.Invalidate()
            Dim TextSize As Single = 8.25 : Do Until TextRenderer.MeasureText(GSalidaAudio_LNombre.Text, New Font(GSalidaAudio_LNombre.Font.Name, TextSize, FontStyle.Regular)).Width < GSalidaAudio_LNombre.Width Or TextSize < 5 : TextSize -= 1 : Loop : GSalidaAudio_LNombre.Font = New Font(GSalidaAudio_LNombre.Font.Name, TextSize, FontStyle.Regular)
            TextSize = 7.25 : Do Until TextRenderer.MeasureText(GSalidaAudio_LHardware.Text, New Font(GSalidaAudio_LHardware.Font.Name, TextSize, FontStyle.Regular)).Width < GSalidaAudio_LHardware.Width Or TextSize < 5 : TextSize -= 1 : Loop : GSalidaAudio_LHardware.Font = New Font(GSalidaAudio_LHardware.Font.Name, TextSize, FontStyle.Regular)
        Else
            GSalidaAudio_SinInformacion.Visible = True
            GSalidaAudio_LNombre.Text = "" : GSalidaAudio_LNombre.Invalidate()
            GSalidaAudio_LHardware.Text = "" : GSalidaAudio_LHardware.Invalidate()
            GSalidaAudio_LEstado.Text = "" : GSalidaAudio_LEstado.Invalidate()
            GSalidaAudio_LPredeterminado.Visible = False
            GSalidaAudio_LComunicaciones.Visible = False
            GSalidaAudio_PIcono.Image = Nothing : GSalidaAudio_PIcono.Invalidate()
        End If
    End Sub

    Private Sub GSalidaAudio_ListaDisponibles_DobleClick(sender As Object, e As EventArgs, Indice As Integer) Handles GSalidaAudio_ListaDisponibles.DobleClick
        If GSalidaAudio_ListaDisponibles.Items.Count = 0 OrElse GSalidaAudio_ListaDisponibles.SelectedIndex(0) = -1 Then Exit Sub
        For Cuenta = 0 To GSalidaAudio_ListaSeleccionados.Items.Count - 1
            If GSalidaAudio_ListaSeleccionados.Items(Cuenta).Tag = GSalidaAudio_ListaDisponibles.SelectedItems(0).Tag Then Exit Sub
        Next
        GSalidaAudio_ListaSeleccionados.AddItem(GSalidaAudio_ListaDisponibles.Items(Indice).Text, GSalidaAudio_ListaDisponibles.Items(Indice).Tag)
        Dim AudioDevice As AudioAPI.AudioDeviceST = Audio.GetAudioDevice(GSalidaAudio_ListaDisponibles.Items(Indice).Tag)
        If AudioDevice.Multimedia Then GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.Items.Count - 1).Marked = True Else GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.Items.Count - 1).Marked = False
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GSalidaAudio_ListaDisponibles_KeyDown(sender As Object, e As KeyEventArgs) Handles GSalidaAudio_ListaDisponibles.KeyDown
        If e.KeyCode = Keys.Enter Then
            e.Handled = True
            For Cuenta = 0 To GSalidaAudio_ListaSeleccionados.Items.Count - 1
                If GSalidaAudio_ListaSeleccionados.Items(Cuenta).Tag = GSalidaAudio_ListaDisponibles.SelectedItems(0).Tag Then Exit Sub
            Next
            GSalidaAudio_ListaSeleccionados.AddItem(GSalidaAudio_ListaDisponibles.SelectedItems(0).Text, GSalidaAudio_ListaDisponibles.SelectedItems(0).Tag)
            If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If
    End Sub

#Region " DragDrop "

    Private Sub GSalidaAudio_ListaDisponibles_MouseDown(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_ListaDisponibles.MouseDown
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GSalidaAudio_ListaDisponibles.Items.Count = 0 OrElse GSalidaAudio_ListaDisponibles.SelectedIndex(0) = -1 Then GSalidaAudio_ListaDisponibles.AllowDrop = False : GSalidaAudio_ListaDisponibles.AllowDrop = False : Exit Sub
        StartMovingItemList = True : GSalidaAudio_MouseDown_Pos = e.Location
    End Sub

    Private Sub GSalidaAudio_ListaDisponibles_MouseUp(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_ListaDisponibles.MouseUp
        If StartMovingItemList = True AndAlso e.Button = MouseButtons.Left Then StartMovingItemList = False : MovingStartPos = -1
    End Sub

    Private Sub GSalidaAudio_ListaDisponibles_MouseMove(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_ListaDisponibles.MouseMove
        If StartMovingItemList = True AndAlso (Math.Abs(GSalidaAudio_MouseDown_Pos.X - e.Location.X) > 5 Or Math.Abs(GSalidaAudio_MouseDown_Pos.Y - e.Location.Y) > 5) Then
            StartMovingItemList = False
            GSalidaAudio_ListaSeleccionados.AllowDrop = True : GSalidaAudio_ListaDisponibles.AllowDrop = True : Comandos_Accion_ListaAccion.AllowDrop = False
            GSalidaAudio_ListaDisponibles.DoDragDrop("Lista Disponibles", DragDropEffects.Move)
        End If
    End Sub

    Private Sub GSalidaAudio_ListaDisponibles_DragLeave(sender As Object, e As DragEventArgs) Handles GSalidaAudio_ListaDisponibles.DragLeave
        MovingItemList = False
    End Sub

    Private Sub GSalidaAudio_ListaDisponibles_DragEnter(sender As Object, e As DragEventArgs) Handles GSalidaAudio_ListaDisponibles.DragEnter
        If e.Data.GetData(DataFormats.Text) = "Lista Seleccionados" Then
            e.Effect = DragDropEffects.Move
        Else
            If GSalidaAudio_ListaDisponibles.Items.Count = 0 OrElse GSalidaAudio_ListaDisponibles.SelectedIndex(0) = -1 Then Exit Sub
            e.Effect = DragDropEffects.Move
            MovingStartPos = GSalidaAudio_ListaDisponibles.SelectedIndex(0)
            MovingDataList = GSalidaAudio_ListaDisponibles.SelectedItems(0)
            MovingItemList = True
        End If
    End Sub

    Private Sub GSalidaAudio_ListaDisponibles_DragDrop(sender As Object, e As DragEventArgs) Handles GSalidaAudio_ListaDisponibles.DragDrop
        MovingItemList = False
        If e.Data.GetData(DataFormats.Text) = "Lista Seleccionados" Then
            GSalidaAudio_ListaSeleccionados.RemoveItemAt(GSalidaAudio_ListaSeleccionados.SelectedIndex(0))
            Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
            If GSalidaAudio_ListaSeleccionados.Items.Count > 0 Then GSalidaAudio_ListaSeleccionados.SelectItem(0) : GSalidaAudio_ListaSeleccionados.EnsureVisibleAt(0) Else GSalidaAudio_ListaSeleccionados.SelectItem(-1)
        End If
    End Sub

#End Region

#End Region

#Region " Lista Seleccionados "

    Private Sub GSalidaAudio_ListaSeleccionados_GotFocus(sender As Object, e As EventArgs) Handles GSalidaAudio_ListaSeleccionados.GotFocus
        GSalidaAudio_ListaDisponibles.SelectItem(-1) : GSalidaAudio_ListaDisponibles.Invalidate()
    End Sub

    Private Sub GSalidaAudio_ListaSeleccionados_SelectedIndexChanged(sender As Object, Indice As Integer) Handles GSalidaAudio_ListaSeleccionados.SelectedIndexChanged
        If Indice = -1 Then
            GSalidaAudio_SinInformacion.Visible = True
            GSalidaAudio_LNombre.Text = "" : GSalidaAudio_LNombre.Invalidate()
            GSalidaAudio_LHardware.Text = "" : GSalidaAudio_LHardware.Invalidate()
            GSalidaAudio_LEstado.Text = "" : GSalidaAudio_LEstado.Invalidate()
            GSalidaAudio_LPredeterminado.Visible = False
            GSalidaAudio_LComunicaciones.Visible = False
            GSalidaAudio_PIcono.Image = Nothing : GSalidaAudio_PIcono.Invalidate()
            Exit Sub
        End If
        GSalidaAudio_ListaDisponibles.SelectItem(-1)
        Dim AudioDevice As AudioAPI.AudioDeviceST = Audio.GetAudioDevice(GSalidaAudio_ListaSeleccionados.Items(Indice).Tag)
        If AudioDevice.ID <> "" Then
            GSalidaAudio_SinInformacion.Visible = False
            GSalidaAudio_LNombre.Text = AudioDevice.Name : GSalidaAudio_LNombre.Invalidate()
            GSalidaAudio_LHardware.Text = AudioDevice.Manufacter : GSalidaAudio_LHardware.Invalidate()
            GSalidaAudio_LEstado.Text = AudioDevice.State.ToString.Replace("Active", "Conectado").Replace("Disabled", "Deshabilitado").Replace("Unplugged", "No conectado") : GSalidaAudio_LEstado.Invalidate()
            If AudioDevice.Multimedia Then GSalidaAudio_LPredeterminado.Visible = True Else GSalidaAudio_LPredeterminado.Visible = False
            If AudioDevice.Communications Then GSalidaAudio_LComunicaciones.Visible = True Else GSalidaAudio_LComunicaciones.Visible = False
            GSalidaAudio_PIcono.Image = Iconos.ExtraerIcono(AudioDevice.IconPath.Split(",")(0).Replace("%windir%", Environment.GetFolderPath(Environment.SpecialFolder.Windows)), AudioDevice.IconPath.Split(",")(1)) : GSalidaAudio_PIcono.Invalidate()
            Dim TextSize As Single = 8.25 : Do Until TextRenderer.MeasureText(GSalidaAudio_LNombre.Text, New Font(GSalidaAudio_LNombre.Font.Name, TextSize, FontStyle.Regular)).Width < GSalidaAudio_LNombre.Width Or TextSize < 5 : TextSize -= 1 : Loop : GSalidaAudio_LNombre.Font = New Font(GSalidaAudio_LNombre.Font.Name, TextSize, FontStyle.Regular)
            TextSize = 7.25 : Do Until TextRenderer.MeasureText(GSalidaAudio_LHardware.Text, New Font(GSalidaAudio_LHardware.Font.Name, TextSize, FontStyle.Regular)).Width < GSalidaAudio_LHardware.Width Or TextSize < 5 : TextSize -= 1 : Loop : GSalidaAudio_LHardware.Font = New Font(GSalidaAudio_LHardware.Font.Name, TextSize, FontStyle.Regular)
        Else
            GSalidaAudio_SinInformacion.Visible = True
            GSalidaAudio_LNombre.Text = "" : GSalidaAudio_LNombre.Invalidate()
            GSalidaAudio_LHardware.Text = "" : GSalidaAudio_LHardware.Invalidate()
            GSalidaAudio_LEstado.Text = "" : GSalidaAudio_LEstado.Invalidate()
            GSalidaAudio_LPredeterminado.Visible = False
            GSalidaAudio_LComunicaciones.Visible = False
            GSalidaAudio_PIcono.Image = Nothing : GSalidaAudio_PIcono.Invalidate()
        End If
    End Sub

    Private Sub GSalidaAudio_ListaSeleccionados_DobleClick(sender As Object, e As EventArgs, Indice As Integer) Handles GSalidaAudio_ListaSeleccionados.DobleClick
        Dim cIndex As Integer = GSalidaAudio_ListaSeleccionados.SelectedIndex(0)
        GSalidaAudio_ListaSeleccionados.RemoveItemAt(cIndex)
        cIndex = Math.Min(cIndex, GSalidaAudio_ListaSeleccionados.Items.Count - 1)
        GSalidaAudio_ListaSeleccionados.SelectItem(cIndex) : GSalidaAudio_ListaSeleccionados.EnsureVisibleAt(cIndex)
        If GSalidaAudio_ListaSeleccionados.Items.Count = 0 Then GSalidaAudio_ListaSeleccionados_SelectedIndexChanged(sender, cIndex)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GSalidaAudio_ListaSeleccionados_KeyDown(sender As Object, e As KeyEventArgs) Handles GSalidaAudio_ListaSeleccionados.KeyDown
        If e.KeyCode = Keys.Delete Then
            e.Handled = True
            Dim cIndex As Integer = GSalidaAudio_ListaSeleccionados.SelectedIndex(0)
            GSalidaAudio_ListaSeleccionados.RemoveItemAt(cIndex)
            cIndex = Math.Min(cIndex, GSalidaAudio_ListaSeleccionados.Items.Count - 1)
            GSalidaAudio_ListaSeleccionados.SelectItem(cIndex) : GSalidaAudio_ListaSeleccionados.EnsureVisibleAt(cIndex)
            If GSalidaAudio_ListaSeleccionados.Items.Count = 0 Then GSalidaAudio_ListaSeleccionados_SelectedIndexChanged(sender, cIndex)
            If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If
    End Sub

#Region " DragDrop "

    Private Sub GSalidaAudio_ListaSeleccionados_MouseDown(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_ListaSeleccionados.MouseDown
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GSalidaAudio_ListaSeleccionados.Items.Count = 0 OrElse GSalidaAudio_ListaSeleccionados.SelectedIndex(0) = -1 Then GSalidaAudio_ListaSeleccionados.AllowDrop = False : GSalidaAudio_ListaDisponibles.AllowDrop = False : Exit Sub
        StartMovingItemList = True : GSalidaAudio_MouseDown_Pos = e.Location
    End Sub

    Private Sub GSalidaAudio_ListaSeleccionados_MouseUp(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_ListaSeleccionados.MouseUp
        If StartMovingItemList = True AndAlso e.Button = MouseButtons.Left Then StartMovingItemList = False : MovingStartPos = -1
    End Sub

    Private Sub GSalidaAudio_ListaSeleccionados_MouseMove(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_ListaSeleccionados.MouseMove
        If StartMovingItemList = True AndAlso (Math.Abs(GSalidaAudio_MouseDown_Pos.X - e.Location.X) > 5 Or Math.Abs(GSalidaAudio_MouseDown_Pos.Y - e.Location.Y) > 5) Then
            GSalidaAudio_ListaSeleccionados.AllowDrop = True : GSalidaAudio_ListaDisponibles.AllowDrop = True : Comandos_Accion_ListaAccion.AllowDrop = False
            StartMovingItemList = False
            GSalidaAudio_ListaSeleccionados.DoDragDrop("Lista Seleccionados", DragDropEffects.Move)
        End If
    End Sub

    Private Sub GSalidaAudio_ListaSeleccionados_DragEnter(sender As Object, e As DragEventArgs) Handles GSalidaAudio_ListaSeleccionados.DragEnter
        If e.Data.GetData(DataFormats.Text) = "Lista Disponibles" Then
            e.Effect = DragDropEffects.Move
            MovingItemList = True
        Else
            If GSalidaAudio_ListaSeleccionados.Items.Count = 0 OrElse GSalidaAudio_ListaSeleccionados.SelectedIndex(0) = -1 Then Exit Sub
            e.Effect = DragDropEffects.Move
            MovingStartPos = GSalidaAudio_ListaSeleccionados.SelectedIndex(0)
            MovingDataList = GSalidaAudio_ListaSeleccionados.SelectedItems(0)
            MovingItemList = True
        End If
    End Sub

    Private Sub GSalidaAudio_ListaSeleccionados_DragLeave(sender As Object, e As DragEventArgs) Handles GSalidaAudio_ListaSeleccionados.DragLeave
        MovingItemList = False
    End Sub

    Private Sub GSalidaAudio_ListaSeleccionados_DragDrop(sender As Object, e As DragEventArgs) Handles GSalidaAudio_ListaSeleccionados.DragDrop
        Try : MovingItemList = False
            Dim Position As Integer = -1
            If e.Data.GetData(DataFormats.Text) = "Lista Disponibles" Then
                If e.Effect = DragDropEffects.Move Then
                    For Cuenta = 0 To GSalidaAudio_ListaSeleccionados.Items.Count - 1
                        If GSalidaAudio_ListaSeleccionados.Items(Cuenta).Tag = GSalidaAudio_ListaDisponibles.SelectedItems(0).Tag Then
                            GSalidaAudio_ListaSeleccionados.RemoveItemAt(Cuenta)
                            Exit For
                        End If
                    Next
                    Dim pt As New Point(PointToClient(MousePosition).X - (PanelComandos.Left + GSalidaAudio.Left + GSalidaAudio_ListaSeleccionados.Left), PointToClient(MousePosition).Y - (PanelComandos.Top + GSalidaAudio.Top + GSalidaAudio_ListaSeleccionados.Top))
                    For Cuenta As Integer = 0 To GSalidaAudio_ListaSeleccionados.Items.Count - 1
                        If GSalidaAudio_ListaSeleccionados.Items(Cuenta).Area.Contains(pt) Then
                            Position = Cuenta
                            GoTo Salta1
                        End If
                    Next
Salta1:             If Position = -1 Then
                        GSalidaAudio_ListaSeleccionados.AddItem(MovingDataList.Text, MovingDataList.Tag)
                        GSalidaAudio_ListaSeleccionados.Focus() : GSalidaAudio_ListaDisponibles.SelectItem(-1)
                        GSalidaAudio_ListaSeleccionados.SelectItem(GSalidaAudio_ListaSeleccionados.Items.Count - 1) : GSalidaAudio_ListaSeleccionados.EnsureVisibleAt(GSalidaAudio_ListaSeleccionados.Items.Count - 1)
                        Dim AudioDevice As AudioAPI.AudioDeviceST = Audio.GetAudioDevice(GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.Items.Count - 1).Tag)
                        If AudioDevice.Multimedia Then GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.Items.Count - 1).Marked = True Else GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.Items.Count - 1).Marked = False
                    Else
                        GSalidaAudio_ListaSeleccionados.InsertItemAt(Position, MovingDataList)
                        GSalidaAudio_ListaSeleccionados.Focus() : GSalidaAudio_ListaDisponibles.SelectItem(-1)
                        GSalidaAudio_ListaSeleccionados.SelectItem(Position) : GSalidaAudio_ListaSeleccionados.EnsureVisibleAt(Position)
                        Dim AudioDevice As AudioAPI.AudioDeviceST = Audio.GetAudioDevice(GSalidaAudio_ListaSeleccionados.Items(Position).Tag)
                        If AudioDevice.Multimedia Then GSalidaAudio_ListaSeleccionados.Items(Position).Marked = True Else GSalidaAudio_ListaSeleccionados.Items(Position).Marked = False
                    End If
                    Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
                End If
            Else
                If e.Effect = DragDropEffects.Move Then
                    Dim pt As New Point(PointToClient(MousePosition).X - (PanelComandos.Left + GSalidaAudio.Left + GSalidaAudio_ListaSeleccionados.Left), PointToClient(MousePosition).Y - (PanelComandos.Top + GSalidaAudio.Top + GSalidaAudio_ListaSeleccionados.Top))
                    For Cuenta As Integer = 0 To GSalidaAudio_ListaSeleccionados.Items.Count - 1
                        If GSalidaAudio_ListaSeleccionados.Items(Cuenta).Area.Contains(pt) Then
                            Position = Cuenta
                            GoTo Salta2
                        End If
                    Next
Salta2:             GSalidaAudio_ListaSeleccionados.RemoveItemAt(MovingStartPos)
                End If
                If Position = -1 Then
                    GSalidaAudio_ListaSeleccionados.AddItem(MovingDataList.Text, MovingDataList.Tag)
                    GSalidaAudio_ListaSeleccionados.SelectItem(GSalidaAudio_ListaSeleccionados.Items.Count - 1)
                Else
                    GSalidaAudio_ListaSeleccionados.InsertItemAt(Position, MovingDataList)
                    GSalidaAudio_ListaSeleccionados.SelectItem(Position)
                End If
                Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
            End If
        Catch : End Try
    End Sub

#End Region

#Region " Up / Down "

    Private Sub GSalidaAudio_Up_Click(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_Up.Click, GSalidaAudio_Up.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GSalidaAudio_ListaSeleccionados.Items.Count = 0 Then Exit Sub
        If GSalidaAudio_ListaSeleccionados.SelectedIndex(0) = -1 Or GSalidaAudio_ListaSeleccionados.SelectedIndex(0) = 0 Then Exit Sub
        Dim Item As NSListView.NSListViewItem = GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.SelectedIndex(0))
        Dim NewIndex As Integer = GSalidaAudio_ListaSeleccionados.SelectedIndex(0) - 1 : GSalidaAudio_ListaSeleccionados.RemoveItemAt(GSalidaAudio_ListaSeleccionados.SelectedIndex(0)) : GSalidaAudio_ListaSeleccionados.InsertItemAt(NewIndex, Item) : GSalidaAudio_ListaSeleccionados.SelectItem(NewIndex) : GSalidaAudio_ListaSeleccionados.EnsureVisibleAt(NewIndex)
        If Lista.SelectedIndex(0) <> -1 Then If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GSalidaAudio_Down_Click(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_Down.Click, GSalidaAudio_Down.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GSalidaAudio_ListaSeleccionados.Items.Count = 0 Then Exit Sub
        If GSalidaAudio_ListaSeleccionados.SelectedIndex(0) = -1 Or GSalidaAudio_ListaSeleccionados.SelectedIndex(0) = GSalidaAudio_ListaSeleccionados.Items.Count - 1 Then Exit Sub
        Dim Item As NSListView.NSListViewItem = GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.SelectedIndex(0))
        Dim NewIndex As Integer = GSalidaAudio_ListaSeleccionados.SelectedIndex(0) + 1 : GSalidaAudio_ListaSeleccionados.RemoveItemAt(GSalidaAudio_ListaSeleccionados.SelectedIndex(0)) : GSalidaAudio_ListaSeleccionados.InsertItemAt(NewIndex, Item) : GSalidaAudio_ListaSeleccionados.SelectItem(NewIndex) : GSalidaAudio_ListaSeleccionados.EnsureVisibleAt(NewIndex)
        If Lista.SelectedIndex(0) <> -1 Then If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#End Region

#End Region

#Region " Botones "

    Private Sub GSalidaAudio_BAdministradorSonido_Click(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_BAdministradorSonido.Click
        If e.Button = MouseButtons.Left Then Shell("control mmsys.cpl sounds")
    End Sub

#End Region

#Region " Menu "

#Region " Eventos "

    Private Sub GSalidaAudio_Menu_Opening(sender As Object, e As System.ComponentModel.CancelEventArgs) Handles GSalidaAudio_Menu.Opening
        Dim cLista As NSListView = CType(sender.SourceControl, NSListView)
        If cLista.SelectedIndex(0) = -1 Then e.Cancel = True : Exit Sub
        GSalidaAudio_Menu_SeleccionarQuitar.Visible = True
        GSalidaAudio_Menu_Separador0.Visible = True
        GSalidaAudio_Menu_Establecer.Visible = True
        GSalidaAudio_Menu.Height = 54
        Dim AudioDevice As AudioAPI.AudioDeviceST = Audio.GetAudioDevice(cLista.SelectedItems(0).Tag)
        If AudioDevice.ID <> "" Then
            If AudioDevice.Multimedia = True Or AudioDevice.State.ToString = "Disabled" Or AudioDevice.State.ToString = "Unplugged" Then
                GSalidaAudio_Menu_Separador0.Visible = False
                GSalidaAudio_Menu_Establecer.Visible = False
                GSalidaAudio_Menu.Height = 26
            End If
        End If
        If cLista.Name = "GSalidaAudio_ListaDisponibles" Then
            For Cuenta = 0 To GSalidaAudio_ListaSeleccionados.Items.Count - 1
                If GSalidaAudio_ListaSeleccionados.Items(Cuenta).Tag = cLista.SelectedItems(0).Tag Then
                    If GSalidaAudio_Menu.Height = 26 Then e.Cancel = True : Exit Sub
                    GSalidaAudio_Menu_SeleccionarQuitar.Visible = False
                    GSalidaAudio_Menu_Separador0.Visible = False
                    GSalidaAudio_Menu.Height = 26
                    Exit Sub
                End If
            Next
            GSalidaAudio_Menu_SeleccionarQuitar.Text = "&Seleccionar"
        Else
            GSalidaAudio_Menu_SeleccionarQuitar.Text = "&Eliminar"
        End If
    End Sub

    Private Sub GSalidaAudio_Menu_MouseEnter(sender As Object, e As EventArgs) Handles GSalidaAudio_Menu_SeleccionarQuitar.MouseEnter, GSalidaAudio_Menu_Establecer.MouseEnter
        Dim QMItem As ToolStripMenuItem = CType(sender, ToolStripMenuItem) : QMItem.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GSalidaAudio_Menu_MouseLeave(sender As Object, e As EventArgs) Handles GSalidaAudio_Menu_SeleccionarQuitar.MouseLeave, GSalidaAudio_Menu_Establecer.MouseLeave
        Dim QMItem As ToolStripMenuItem = CType(sender, ToolStripMenuItem) : QMItem.ForeColor = Color.FromArgb(130, 130, 130)
    End Sub

#End Region

#Region " Seleccionar / Eliminar "

    Private Sub GSalidaAudio_Menu_SeleccionarQuitar_Click(sender As Object, e As EventArgs) Handles GSalidaAudio_Menu_SeleccionarQuitar.Click
        Dim cLista As NSListView = CType(sender.Owner.SourceControl, NSListView)
        If cLista.SelectedIndex(0) = -1 Then Exit Sub
        If cLista.Name = "GSalidaAudio_ListaDisponibles" Then
            For Cuenta = 0 To GSalidaAudio_ListaSeleccionados.Items.Count - 1
                If GSalidaAudio_ListaSeleccionados.Items(Cuenta).Tag = GSalidaAudio_ListaDisponibles.SelectedItems(0).Tag Then Exit Sub
            Next
            GSalidaAudio_ListaSeleccionados.AddItem(cLista.SelectedItems(0).Text, cLista.SelectedItems(0).Tag)
            Dim AudioDevice As AudioAPI.AudioDeviceST = Audio.GetAudioDevice(cLista.SelectedItems(0).Tag)
            If AudioDevice.Multimedia Then GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.Items.Count - 1).Marked = True Else GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.Items.Count - 1).Marked = False
            If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        Else
            Dim cIndex As Integer = GSalidaAudio_ListaSeleccionados.SelectedIndex(0)
            GSalidaAudio_ListaSeleccionados.RemoveItemAt(cIndex)
            cIndex = Math.Min(cIndex, GSalidaAudio_ListaSeleccionados.Items.Count - 1)
            GSalidaAudio_ListaSeleccionados.SelectItem(cIndex) : GSalidaAudio_ListaSeleccionados.EnsureVisibleAt(cIndex)
            If GSalidaAudio_ListaSeleccionados.Items.Count = 0 Then GSalidaAudio_ListaSeleccionados_SelectedIndexChanged(sender, cIndex)
            If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If
    End Sub

#End Region

#Region " Establecer "

    Private Sub GSalidaAudio_Menu_Establecer_Click(sender As Object, e As EventArgs) Handles GSalidaAudio_Menu_Establecer.Click
        Dim cLista As NSListView = CType(sender.Owner.SourceControl, NSListView)
        If cLista.SelectedIndex(0) = -1 Then Exit Sub
        Dim AudioDevice As AudioAPI.AudioDeviceST = Audio.GetAudioDevice(cLista.SelectedItems(0).Tag)
        If AudioDevice.ID <> "" Then
            Audio.SetDefault(AudioDevice.ID)
            If cLista.Name = "GSalidaAudio_ListaDisponibles" Then
                GSalidaAudio_ListaDisponibles_SelectedIndexChanged(sender, cLista.SelectedIndex(0))
            Else
                GSalidaAudio_ListaSeleccionados_SelectedIndexChanged(sender, cLista.SelectedIndex(0))
            End If
        End If
    End Sub

#End Region

#End Region

#Region " Sonido "

    Private Sub GSalidaAudio_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles GSalidaAudio_LCSonido.TextChanged
        GSalidaAudio_TSonido.Enabled = False
        GSalidaAudio_LCSonido.Text = Rutas.Acortar_Ruta(GSalidaAudio_TSonido.Text, GSalidaAudio_LCSonido)
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GSalidaAudio_LCSonido.Text, New Font(GSalidaAudio_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < GSalidaAudio_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : GSalidaAudio_LCSonido.Font = New Font(GSalidaAudio_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GSalidaAudio_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_LCSonido.Click, GSalidaAudio_TSonido.Click
        If e.Button = MouseButtons.Left Then
            GSalidaAudio_CSonido.DroppedDown = True : GSalidaAudio_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            GSalidaAudio_LCSonido.Visible = False : Combo_IgnoreOne = True : GSalidaAudio_TSonido.ReadOnly = False : GSalidaAudio_TSonido.Enabled = True : GSalidaAudio_TSonido.Cursor = Cursors.IBeam : GSalidaAudio_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub GSalidaAudio_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GSalidaAudio_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GSalidaAudio_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles GSalidaAudio_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GSalidaAudio_CSonido.DroppedDown = True : GSalidaAudio_CSonido.Focus()
    End Sub

    Private Sub GSalidaAudio_TSonido_GotFocus(sender As Object, e As EventArgs) Handles GSalidaAudio_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub GSalidaAudio_TSonido_LostFocus(sender As Object, e As EventArgs) Handles GSalidaAudio_TSonido.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GSalidaAudio_LCSonido.Visible = False Then GSalidaAudio_LCSonido.Visible = True : GSalidaAudio_TSonido.ReadOnly = True : GSalidaAudio_TSonido.Enabled = False : GSalidaAudio_TSonido.Cursor = Cursors.Hand
        If IO.File.Exists(GSalidaAudio_TSonido.Text) = False And GSalidaAudio_CSonido.Items.Contains(StrConv(GSalidaAudio_TSonido.Text, VbStrConv.ProperCase)) = False Then GSalidaAudio_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To GSalidaAudio_CSonido.Items.Count - 1
            If GSalidaAudio_TSonido.Text.ToLower = GSalidaAudio_CSonido.Items(Cuenta).ToLower Then GSalidaAudio_TSonido.Text = GSalidaAudio_CSonido.Items(Cuenta)
        Next : GSalidaAudio_TSonido.Text = GSalidaAudio_TSonido.Text.Trim : GSalidaAudio_TSonido.SelectionLength = 0 : GSalidaAudio_LCSonido.Text = GSalidaAudio_TSonido.Text
    End Sub

    Private Sub GSalidaAudio_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles GSalidaAudio_TSonido.MouseEnter, GSalidaAudio_CSonido.MouseEnter
        GSalidaAudio_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub GSalidaAudio_CSonido_DropDown(sender As Object, e As EventArgs) Handles GSalidaAudio_CSonido.DropDown
        GSalidaAudio_TSonido.Enabled = True
        GSalidaAudio_CSonido.MaxDropDownItems = GSalidaAudio_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = GSalidaAudio_TSonido.Text
        If GSalidaAudio_CSonido.Items.Contains(GSalidaAudio_TSonido.Text) = True Then GSalidaAudio_CSonido.SelectedItem = GSalidaAudio_TSonido.Text Else GSalidaAudio_CSonido.SelectedIndex = 0
    End Sub

    Private Sub GSalidaAudio_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles GSalidaAudio_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GSalidaAudio_CSonido_LostFocus(sender As Object, e As EventArgs) Handles GSalidaAudio_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GSalidaAudio_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GSalidaAudio_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then GSalidaAudio_TSonido.Text = GSalidaAudio_CSonido.SelectedItem.Trim : GSalidaAudio_LCSonido.Text = GSalidaAudio_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub GSalidaAudio_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GSalidaAudio_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then GSalidaAudio_TSonido.Text = GSalidaAudio_CSonido.SelectedItem.Trim : GSalidaAudio_LCSonido.Text = GSalidaAudio_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub GSalidaAudio_CSonido_ItemHover(Index As Integer) Handles GSalidaAudio_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub GSalidaAudio_BPlay_Click(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GSalidaAudio_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(GSalidaAudio_TSonido.Text)
    End Sub

    Private Sub GSalidaAudio_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then GSalidaAudio_TSonido.Text = Abrir.FileName : GSalidaAudio_LCSonido.Text = GSalidaAudio_TSonido.Text : Sonidos.Play_Block(GSalidaAudio_TSonido.Text)
        GSalidaAudio_TSonido.SelectionStart = GSalidaAudio_TSonido.Text.Length : GSalidaAudio_TSonido.SelectionLength = 0
        GSalidaAudio_BExaminar.State = NSButton.MouseState.None : GSalidaAudio_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub GSalidaAudio_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles GSalidaAudio_BExaminar.MouseEnter
        GSalidaAudio_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " OSD "

    Private Sub GSalidaAudio_OSD_Click(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_LOSD.Click, GSalidaAudio_LOSD.DoubleClick, GSalidaAudio_COSD.Click, GSalidaAudio_COSD.DoubleClick
        If e.Button = MouseButtons.Left Then
            If TypeOf sender Is NSLabel Then If GSalidaAudio_COSD.Checked = True Then GSalidaAudio_COSD.Checked = False Else GSalidaAudio_COSD.Checked = True
            GSalidaAudio_BOSD.Enabled = GSalidaAudio_COSD.Checked : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        ElseIf e.Button = MouseButtons.Right Then
            If GSalidaAudio_COSD.Checked = True And TypeOf sender Is NSLabel Then
                Opciones_OSD_Color = GSalidaAudio_OSD_Color : Opciones_OSD_Font = GSalidaAudio_OSD_Fuente : ShowOSD("Mensaje de prueba")
            End If
        End If
    End Sub

    Private Sub GSalidaAudio_BOSD_Click(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = GSalidaAudio_OSD_Fuente : Opciones_FontDialog.Color = GSalidaAudio_OSD_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then GSalidaAudio_OSD_Fuente = Opciones_FontDialog.Font : GSalidaAudio_OSD_Color = Opciones_FontDialog.Color : GSalidaAudio_BOSD.ForeColor1 = GSalidaAudio_OSD_Color : GSalidaAudio_BOSD.ForeColor3 = GSalidaAudio_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = GSalidaAudio_OSD_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then GSalidaAudio_OSD_Color = Opciones_ColorDialog.Color : GSalidaAudio_BOSD.ForeColor1 = GSalidaAudio_OSD_Color : GSalidaAudio_BOSD.ForeColor3 = GSalidaAudio_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            GSalidaAudio_OSD_Fuente = OSD_Default_Font : GSalidaAudio_OSD_Color = Color.FromArgb(205, 150, 0) : GSalidaAudio_BOSD.ForeColor1 = GSalidaAudio_OSD_Color : GSalidaAudio_BOSD.ForeColor3 = GSalidaAudio_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : HTexto.Focus()
        Opciones_OSD_Color = GSalidaAudio_OSD_Color : Opciones_OSD_Font = GSalidaAudio_OSD_Fuente : ShowOSD("Mensaje de prueba")
    End Sub

#End Region

#Region " Actualizar "

    Private Sub AudioDevices_Update(ID As String, Action As String) Handles NotificationClient.AudioDevices_Update
        Audio_Action = Action
    End Sub

    Private Sub AudioDevices_Updated() Handles Audio.AudioDevices_Updated
        Audio_Update_Action = True
    End Sub

    Private Sub GSalidaAudio_AudioTimer_Tick()
        If Audio_Action = "OnDefaultDeviceChanged" Or Audio_Action = "OnDeviceStateChanged" Then
            If Audio.Check_AudioDevices_Changed = True Then
                Audio.LoadDevices()
                If GSalidaAudio.Visible = True Then

                    GSalidaAudio_ListaDisponibles.Clear()
                    If Audio.AudioDevices IsNot Nothing Then
                        For Cuenta = 0 To Audio.AudioDevices.Length - 1
                            If Audio.AudioDevices(Cuenta).ID IsNot Nothing OrElse Audio.AudioDevices(Cuenta).ID <> "" Then
                                GSalidaAudio_ListaDisponibles.AddItem(Audio.AudioDevices(Cuenta).Name, Audio.AudioDevices(Cuenta).ID.ToString)
                                If Audio.AudioDevices(Cuenta).Multimedia = True Then GSalidaAudio_ListaDisponibles.Items(GSalidaAudio_ListaDisponibles.Items.Count - 1).Marked = True Else GSalidaAudio_ListaDisponibles.Items(GSalidaAudio_ListaDisponibles.Items.Count - 1).Marked = False
                            End If
                        Next
                    End If

                    GSalidaAudio_ListaSeleccionados.Clear()
                    Dim IndiceComando = Comandos_GetByID(ComandoActualID) : If IndiceComando = -1 Then ComandoActualID = "Negativo"
                    Dim Settings() As String : If ComandoActualID = "Negativo" Then Settings = Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Settings, "|-|", , CompareMethod.Text) Else Settings = Split(Comandos(IndiceComando).Accion(Comandos_Accion_ListaAccion.SelectedItems(0).Tag).Settings, "|-|", , CompareMethod.Text)
                    If Settings.Length > 4 Then
                        For Cuenta = 4 To Settings.Length - 1
                            Dim cAudioDevice As AudioAPI.AudioDeviceST
                            cAudioDevice = Audio.GetAudioDevice(Settings(Cuenta))
                            If cAudioDevice.ID <> "" Then
                                GSalidaAudio_ListaSeleccionados.AddItem(cAudioDevice.Name, cAudioDevice.ID.ToString)
                                If cAudioDevice.Multimedia = True Then GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.Items.Count - 1).Marked = True Else GSalidaAudio_ListaSeleccionados.Items(GSalidaAudio_ListaSeleccionados.Items.Count - 1).Marked = False
                            End If
                        Next
                    End If
                End If
            Else
                Audio.UpdateAudioDevices()
            End If : Audio_Action = ""
        End If
        If Audio_Update_Action = True Then
            Audio_Update_Action = False
            If GSalidaAudio.Visible = True Then
                For Cuenta = 0 To Audio.AudioDevices.Length - 1
                    For Cuenta2 = 0 To GSalidaAudio_ListaDisponibles.Items.Count - 1
                        Application.DoEvents()
                        If Audio.AudioDevices(Cuenta).ID.ToString = GSalidaAudio_ListaDisponibles.Items(Cuenta2).Tag Then
                            GSalidaAudio_ListaDisponibles.Items(Cuenta2).Text = Audio.AudioDevices(Cuenta).Name
                            If Audio.AudioDevices(Cuenta).Multimedia = True Then GSalidaAudio_ListaDisponibles.Items(Cuenta2).Marked = True Else GSalidaAudio_ListaDisponibles.Items(Cuenta2).Marked = False
                        End If
                    Next
                    For Cuenta2 = 0 To GSalidaAudio_ListaSeleccionados.Items.Count - 1
                        Application.DoEvents()
                        If Audio.AudioDevices(Cuenta).ID.ToString = GSalidaAudio_ListaSeleccionados.Items(Cuenta2).Tag Then
                            GSalidaAudio_ListaSeleccionados.Items(Cuenta2).Text = Audio.AudioDevices(Cuenta).Name
                            If Audio.AudioDevices(Cuenta).Multimedia = True Then GSalidaAudio_ListaSeleccionados.Items(Cuenta2).Marked = True Else GSalidaAudio_ListaSeleccionados.Items(Cuenta2).Marked = False
                        End If
                    Next
                Next : GSalidaAudio_ListaDisponibles.Refresh() : GSalidaAudio_ListaSeleccionados.Refresh()

                If GSalidaAudio_ListaSeleccionados.SelectedIndex(0) <> -1 Then
                    For Cuenta = 0 To Audio.AudioDevices.Length - 1
                        Application.DoEvents()
                        If Audio.AudioDevices(Cuenta).ID.ToString = GSalidaAudio_ListaSeleccionados.SelectedItems(0).Tag Then
                            If Audio.AudioDevices(Cuenta).Name <> GSalidaAudio_LNombre.Text Then GSalidaAudio_ListaSeleccionados_SelectedIndexChanged(Nothing, GSalidaAudio_ListaSeleccionados.SelectedIndex(0)) : Exit Sub
                            If Audio.AudioDevices(Cuenta).State.ToString.Replace("Active", "Conectado").Replace("Disabled", "Deshabilitado").Replace("Unplugged", "No conectado") <> GSalidaAudio_LEstado.Text Then GSalidaAudio_ListaSeleccionados_SelectedIndexChanged(Nothing, GSalidaAudio_ListaSeleccionados.SelectedIndex(0)) : Exit Sub
                            If Audio.AudioDevices(Cuenta).Multimedia = True And GSalidaAudio_LPredeterminado.Visible = False Then GSalidaAudio_ListaSeleccionados_SelectedIndexChanged(Nothing, GSalidaAudio_ListaSeleccionados.SelectedIndex(0)) : Exit Sub
                            If Audio.AudioDevices(Cuenta).Multimedia = False And GSalidaAudio_LPredeterminado.Visible = True Then GSalidaAudio_ListaSeleccionados_SelectedIndexChanged(Nothing, GSalidaAudio_ListaSeleccionados.SelectedIndex(0)) : Exit Sub
                            If Audio.AudioDevices(Cuenta).Communications = True And GSalidaAudio_LComunicaciones.Visible = False Then GSalidaAudio_ListaSeleccionados_SelectedIndexChanged(Nothing, GSalidaAudio_ListaSeleccionados.SelectedIndex(0)) : Exit Sub
                            If Audio.AudioDevices(Cuenta).Communications = False And GSalidaAudio_LComunicaciones.Visible = True Then GSalidaAudio_ListaSeleccionados_SelectedIndexChanged(Nothing, GSalidaAudio_ListaSeleccionados.SelectedIndex(0)) : Exit Sub
                        End If
                    Next
                ElseIf GSalidaAudio_ListaDisponibles.SelectedIndex(0) <> -1 Then
                    For Cuenta = 0 To Audio.AudioDevices.Length - 1
                        Application.DoEvents()
                        If Audio.AudioDevices(Cuenta).ID.ToString = GSalidaAudio_ListaDisponibles.SelectedItems(0).Tag Then
                            If Audio.AudioDevices(Cuenta).Name <> GSalidaAudio_LNombre.Text Then GSalidaAudio_ListaDisponibles_SelectedIndexChanged(Nothing, GSalidaAudio_ListaDisponibles.SelectedIndex(0)) : Exit Sub
                            If Audio.AudioDevices(Cuenta).State.ToString.Replace("Active", "Conectado").Replace("Disabled", "Deshabilitado").Replace("Unplugged", "No conectado") <> GSalidaAudio_LEstado.Text Then GSalidaAudio_ListaDisponibles_SelectedIndexChanged(Nothing, GSalidaAudio_ListaDisponibles.SelectedIndex(0)) : Exit Sub
                            If Audio.AudioDevices(Cuenta).Multimedia = True And GSalidaAudio_LPredeterminado.Visible = False Then GSalidaAudio_ListaDisponibles_SelectedIndexChanged(Nothing, GSalidaAudio_ListaDisponibles.SelectedIndex(0)) : Exit Sub
                            If Audio.AudioDevices(Cuenta).Multimedia = False And GSalidaAudio_LPredeterminado.Visible = True Then GSalidaAudio_ListaDisponibles_SelectedIndexChanged(Nothing, GSalidaAudio_ListaDisponibles.SelectedIndex(0)) : Exit Sub
                            If Audio.AudioDevices(Cuenta).Communications = True And GSalidaAudio_LComunicaciones.Visible = False Then GSalidaAudio_ListaDisponibles_SelectedIndexChanged(Nothing, GSalidaAudio_ListaDisponibles.SelectedIndex(0)) : Exit Sub
                            If Audio.AudioDevices(Cuenta).Communications = False And GSalidaAudio_LComunicaciones.Visible = True Then GSalidaAudio_ListaDisponibles_SelectedIndexChanged(Nothing, GSalidaAudio_ListaDisponibles.SelectedIndex(0)) : Exit Sub
                        End If
                    Next
                End If
            End If
        End If
    End Sub

#End Region

#Region " Help "

    Private Sub GSalidaAudio_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GSalidaAudio_LHelp.Click, GSalidaAudio_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Salida de Audio" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GSalidaAudio_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GSalidaAudio_LHelp.MouseEnter
        GSalidaAudio_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GSalidaAudio_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GSalidaAudio_LHelp.MouseLeave
        GSalidaAudio_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_SalidaAudio_Tooltips(sender As Object, e As EventArgs) Handles GSalidaAudio_COSD.MouseEnter, GSalidaAudio_LOSD.MouseEnter, GSalidaAudio_BOSD.MouseEnter, GSalidaAudio_LSonido.MouseEnter, GSalidaAudio_BPlay.MouseEnter, GSalidaAudio_BExaminar.MouseEnter, GSalidaAudio_LListaDisponibles.MouseEnter, GSalidaAudio_LListaSeleccionados.MouseEnter, GSalidaAudio_LPredeterminado.MouseEnter, GSalidaAudio_LComunicaciones.MouseEnter, GSalidaAudio_BAdministradorSonido.MouseEnter, GSalidaAudio_LCSonido.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GSalidaAudio_OSD"
                If sender.Name = "GSalidaAudio_COSD" Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
                If sender.Name = "GSalidaAudio_LOSD" Then If GSalidaAudio_COSD.Checked = True Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción" + vbCrLf + "Nota: Click Derecho para previsualizar") Else Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
            Case "GSalidaAudio_BOSD" : If GSalidaAudio_COSD.Checked = True Then Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "GSalidaAudio_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción")
            Case "GSalidaAudio_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "GSalidaAudio_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "GSalidaAudio_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
            Case "GSalidaAudio_ListaDisponibles" : Show_Tooltip(sender, "Muestra los dispositivos de audio disponibles")
            Case "GSalidaAudio_ListaSeleccionados" : Show_Tooltip(sender, "Muestra los dispositivos de audio seleccionados")
            Case "GSalidaAudio_Predeterminado" : Show_Tooltip(sender, "Este dispositivo de audio es el predeterminado")
            Case "GSalidaAudio_Comunicaciones" : Show_Tooltip(sender, "Este dispositivo de audio se usará para las comunicaciones")
            Case "GSalidaAudio_BAdministradorSonido" : Show_Tooltip(sender, "Abre el 'Administrador de Sonidos' de Windows")
        End Select
    End Sub

#End Region

#End Region

#Region " Volumen "

#Region " Accion "

    Private Sub GVolumen_LCAccion_TextChanged(sender As Object, e As EventArgs) Handles GVolumen_LCAccion.TextChanged
        Select Case GVolumen_LCAccion.Text
            Case "Establecer Volumen"
                GVolumen_LIntervalo.Visible = True : GVolumen_TIntervalo.Visible = True
                If GVolumen_TIntervalo.Text = "" Then GVolumen_TIntervalo.Text = "30"
                If GVolumen_TIntervalo.Text = "0" Then GVolumen_TIntervalo.Focus() Else HTexto.Focus()
            Case "Subir Volumen", "Bajar Volumen", "Silenciar Volumen"
                GVolumen_LIntervalo.Visible = False : GVolumen_TIntervalo.Visible = False
        End Select : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GVolumen_TAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GVolumen_TAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GVolumen_TAccion_GotFocus(sender As Object, e As EventArgs) Handles GVolumen_TAccion.GotFocus
        GVolumen_TAccion.Text = GVolumen_TAccion.Text.Trim : GVolumen_TAccion.SelectionLength = 0 : HTexto.Focus()
    End Sub

    Private Sub GVolumen_TAccion_LostFocus(sender As Object, e As EventArgs) Handles GVolumen_TAccion.LostFocus
        GVolumen_TAccion.Text = GVolumen_TAccion.Text.Trim : GVolumen_TAccion.SelectionLength = 0 : GVolumen_LCAccion.Text = GVolumen_TAccion.Text
    End Sub

    Private Sub GVolumen_TAccion_MouseEnter(sender As Object, e As EventArgs) Handles GVolumen_TAccion.MouseEnter, GVolumen_CAccion.MouseEnter
        GVolumen_CAccion.State = NSComboBox.MouseState.None
    End Sub

    Private Sub GVolumen_TAccion_Click(sender As Object, e As MouseEventArgs) Handles GVolumen_LCAccion.Click, GVolumen_TAccion.Click
        If e.Button = MouseButtons.Left Then GVolumen_CAccion.DroppedDown = True : GVolumen_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GVolumen_TIntervalo_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GVolumen_TIntervalo.KeyPress
        If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar) Then e.Handled = True
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub
    Private Sub GVolumen_TIntervalo_GotFocus(sender As Object, e As EventArgs) Handles GVolumen_TIntervalo.GotFocus
        GVolumen_TIntervalo.Text = GVolumen_TIntervalo.Text.Trim : GVolumen_TIntervalo.SelectionLength = 0
    End Sub

    Private Sub GVolumen_TIntervalo_LostFocus(sender As Object, e As EventArgs) Handles GVolumen_TIntervalo.LostFocus
        GVolumen_TIntervalo.Text = GVolumen_TIntervalo.Text.Trim : GVolumen_TIntervalo.SelectionLength = 0 : If GVolumen_TIntervalo.Text = "" Then GVolumen_TIntervalo.Text = "0"
        If GVolumen_TIntervalo.Text.Trim <> "" Then If CInt(GVolumen_TIntervalo.Text) > 100 Then GVolumen_TIntervalo.Text = "100"
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GVolumen_PAccion_Click(sender As Object, e As MouseEventArgs) Handles GVolumen_PAccion.Click, GVolumen_PAccion.DoubleClick
        If e.Button = MouseButtons.Left Then GVolumen_CAccion.DroppedDown = True : GVolumen_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GVolumen_PAccion_MouseEnter(sender As Object, e As EventArgs) Handles GVolumen_PAccion.MouseEnter
        GVolumen_PAccion.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GVolumen_PAccion_MouseLeave(sender As Object, e As EventArgs) Handles GVolumen_PAccion.MouseLeave
        GVolumen_PAccion.Image = My.Resources.CComandos_Off
    End Sub

#Region " Combo Accion "

    Private Sub GVolumen_CAccion_DropDown(sender As Object, e As EventArgs) Handles GVolumen_CAccion.DropDown
        GVolumen_CAccion.MaxDropDownItems = GVolumen_CAccion.Items.Count : Combo_Dropped = True : Combo_TempValue = GVolumen_TAccion.Text
        If GVolumen_CAccion.Items.Contains(GVolumen_TAccion.Text) = True Then GVolumen_CAccion.SelectedItem = GVolumen_TAccion.Text Else GVolumen_CAccion.SelectedIndex = 0
    End Sub

    Private Sub GVolumen_CAccion_DropDownClosed(sender As Object, e As EventArgs) Handles GVolumen_CAccion.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GVolumen_CAccion_LostFocus(sender As Object, e As EventArgs) Handles GVolumen_CAccion.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GVolumen_CAccion_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GVolumen_CAccion.SelectedIndexChanged
        If Combo_TempValue = "" Then GVolumen_TAccion.Text = GVolumen_CAccion.SelectedItem.Trim : GVolumen_LCAccion.Text = GVolumen_TAccion.Text : If GVolumen_LCAccion.Text <> "Establecer Volumen" Then HTexto.Focus()
    End Sub

    Private Sub GVolumen_CAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GVolumen_CAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then GVolumen_TAccion.Text = GVolumen_CAccion.SelectedItem.Trim : GVolumen_LCAccion.Text = GVolumen_TAccion.Text : HTexto.Focus() : e.Handled = True
    End Sub

#End Region

#End Region

#Region " Botones "

    Private Sub GVolumen_BControlVolumen_Click(sender As Object, e As MouseEventArgs) Handles GVolumen_BControlVolumen.Click
        If e.Button = MouseButtons.Left Then Process.Start("sndvol")
    End Sub

#End Region

#Region " Help "

    Private Sub GVolumen_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GVolumen_LHelp.Click, GVolumen_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Volumen" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GVolumen_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GVolumen_LHelp.MouseEnter
        GVolumen_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GVolumen_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GVolumen_LHelp.MouseLeave
        GVolumen_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_Volumen_Tooltips(sender As Object, e As EventArgs) Handles GVolumen_LAccion.MouseEnter, GVolumen_LCAccion.MouseEnter, GVolumen_LIntervalo.MouseEnter, GVolumen_BControlVolumen.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GVolumen_Accion", "GVolumen_CAccion"
                Select Case GVolumen_LCAccion.Text
                    Case "Establecer Volumen" : Show_Tooltip(sender, "Establece el volumen al valor especificado")
                    Case "Silenciar Volumen" : Show_Tooltip(sender, "Silencia o restaura el volumen del ordenador")
                    Case "Subir Volumen" : Show_Tooltip(sender, "Sube el volumen del ordenador")
                    Case "Bajar Volumen" : Show_Tooltip(sender, "Baja el volumen del ordenador")
                End Select
            Case "GVolumen_Intervalo" : Show_Tooltip(sender, "Valor al que se establecerá el volumen")
            Case "GVolumen_BControlVolumen" : Show_Tooltip(sender, "Abre el 'Control de Volumen' de Windows")
        End Select
    End Sub

#End Region

#End Region

#End Region

#Region " Utilidades "

#Region " Macros "

#Region " Lista "

    Private Sub GMacro_Lista_SelectedIndexChanged(sender As Object, Indice As Integer) Handles GMacro_Lista.SelectedIndexChanged
        If GMacro_Grabando = True Then Exit Sub
        If GMacro_Editando = True Then GMacro_Lista.MultiSelect = False : GMacro_PEditar_Click(sender, Nothing) Else GMacro_Lista.MultiSelect = True
        GMacro_Lista.Focus()
    End Sub

    Private Sub GMacro_Lista_DobleClick(sender As Object, e As MouseEventArgs, Indice As Integer) Handles GMacro_Lista.DobleClick
        If GMacro_Grabando = False Then GMacro_Lista.MultiSelect = False : GMacro_PEditar_Click(sender, e)
    End Sub

    Private Sub GMacro_Lista_KeyDown(sender As Object, e As KeyEventArgs) Handles GMacro_Lista.KeyDown
        If e.KeyCode = Keys.Delete Then
            e.Handled = True
            If GMacro_Grabando = True Then Exit Sub
            Dim cIndex As Integer = GMacro_Lista.SelectedIndex(0)
            GMacro_Lista.RemoveItems(GMacro_Lista.SelectedItems)
            cIndex = Math.Min(cIndex, GMacro_Lista.Items.Count - 1)
            GMacro_Lista.SelectItem(cIndex) : GMacro_Lista.EnsureVisibleAt(cIndex)
            If GMacro_Lista.Items.Count = 0 Then GMacro_Lista_SelectedIndexChanged(sender, cIndex)
            GuardarMacro()
        End If
        If e.KeyCode = Keys.Enter Then
            GMacro_PEditar_Click(sender, Nothing)
        End If
        GMacro_Lista.Focus()
    End Sub

    Private Sub GMacro_Lista_GotFocus(sender As Object, e As EventArgs) Handles GMacro_Lista.GotFocus
        If GMacro_Grabando = True Then HTexto.Focus()
    End Sub

#Region " DragDrop "

    Private Sub GMacro_Lista_MouseDown(sender As Object, e As MouseEventArgs) Handles GMacro_Lista.MouseDown
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GMacro_Lista.Items.Count < 2 OrElse GMacro_Lista.SelectedIndex(0) = -1 Then GMacro_Lista.AllowDrop = False : Exit Sub
        StartMovingItemList = True : GMacro_MouseDown_Pos = e.Location
    End Sub

    Private Sub GMacro_Lista_MouseUp(sender As Object, e As MouseEventArgs) Handles GMacro_Lista.MouseUp
        If StartMovingItemList = True AndAlso e.Button = MouseButtons.Left Then StartMovingItemList = False : MovingStartPos = -1
    End Sub

    Private Sub GMacro_Lista_MouseMove(sender As Object, e As MouseEventArgs) Handles GMacro_Lista.MouseMove
        If StartMovingItemList = True AndAlso (Math.Abs(GMacro_MouseDown_Pos.X - e.Location.X) > 5 Or Math.Abs(GMacro_MouseDown_Pos.Y - e.Location.Y) > 5) Then StartMovingItemList = False : GMacro_Lista.AllowDrop = True : GMacro_Lista.DoDragDrop("Lista Macros", DragDropEffects.Move)
    End Sub

    Private Sub GMacro_Lista_DragEnter(sender As Object, e As DragEventArgs) Handles GMacro_Lista.DragEnter
        If GMacro_Lista.Items.Count = 0 OrElse GMacro_Lista.SelectedIndex(0) = -1 Then Exit Sub
        e.Effect = DragDropEffects.Move
        MovingStartPos = GMacro_Lista.SelectedIndex(0)
        MovingDataListMK = GMacro_Lista.SelectedItems(0)
        MovingDataListMKTipo = GMacro_Lista.SelectedItems(0).Tipo
        MovingItemList = True
    End Sub

    Private Sub GMacro_Lista_DragLeave(sender As Object, e As DragEventArgs) Handles GMacro_Lista.DragLeave
        MovingItemList = False
    End Sub

    Private Sub GMacro_Lista_DragDrop(sender As Object, e As DragEventArgs) Handles GMacro_Lista.DragDrop
        Try : MovingItemList = False
            Dim Position As Integer = -1
            If e.Effect = DragDropEffects.Move Then
                Dim pt As New Point(PointToClient(MousePosition).X - (PanelComandos.Left + GMacro.Left + GMacro_Lista.Left), PointToClient(MousePosition).Y - (PanelComandos.Top + GMacro.Top + GMacro_Lista.Top))
                For Cuenta As Integer = 0 To GMacro_Lista.Items.Count - 1
                    If GMacro_Lista.Items(Cuenta).Area.Contains(pt) Then
                        Position = Cuenta
                        GoTo Salta2
                    End If
                Next
Salta2:         GMacro_Lista.RemoveItemAt(MovingStartPos)
            End If
            If Position = -1 Then
                GMacro_Lista.AddItem(MovingDataListMK.Text, MovingDataListMK.Tag)
                GMacro_Lista.Items(GMacro_Lista.Items.Count - 1).Tipo = MovingDataListMKTipo
                GMacro_Lista.SelectItem(GMacro_Lista.Items.Count - 1)
            Else
                GMacro_Lista.InsertItemAt(Position, MovingDataListMK)
                GMacro_Lista.Items(Position).Tipo = MovingDataListMKTipo
                GMacro_Lista.SelectItem(Position)
            End If
            GuardarMacro()
        Catch : End Try
    End Sub

#End Region

#Region " Guardar / Cargar "

    Private Sub GuardarMacro()
        Dim Accion_ID As String = "" : If Comandos_Accion_ListaAccion.Items.Count > 0 Then Accion_ID = Comandos_Accion_ListaAccion.Items(Comandos_Accion_ListaAccion.SelectedIndex(0)).Tag2
        If Accion_ID = "" Then Exit Sub
        If GMacro_Lista.Items.Count = 0 AndAlso IO.File.Exists(KobaPath + "MACROs\" + Accion_ID + ".mcr") Then IO.File.Delete(KobaPath + "MACROs\" + Accion_ID + ".mcr") : Exit Sub
        If IO.Directory.Exists(KobaPath + "MACROs\") = False Then IO.Directory.CreateDirectory(KobaPath + "MACROs\")
        If IO.File.Exists(KobaPath + "MACROs\" + Accion_ID + ".mcr") = True Then IO.File.Delete(KobaPath + "MACROs\" + Accion_ID + ".mcr")
        If GMacro_Editando = False Then
            If GMacro_Pausar = True Then GMacro_Lista.RemoveItemAt(GMacro_Lista.Items.Count - 1)
            For Cuenta = GMacro_Lista.Items.Count - 1 To 0 Step -1
                If GMacro_Lista.Items(Cuenta).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion Then GMacro_Lista.RemoveItemAt(Cuenta) Else Exit For
            Next
        End If
        Dim Guardar As New IO.StreamWriter(KobaPath + "MACROs\" + Accion_ID + ".mcr")
        For Cuenta = 0 To GMacro_Lista.Items.Count - 1
            Guardar.WriteLine(GMacro_Lista.Items(Cuenta).Tag.ToString + "|-|" + CInt(GMacro_Lista.Items(Cuenta).Tipo).ToString)
        Next : Guardar.Close()
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub CargarMacro()
        Dim Accion_ID As String = Comandos_Accion_ListaAccion.Items(Comandos_Accion_ListaAccion.SelectedIndex(0)).Tag2
        GMacro_Lista.Clear() : If IO.File.Exists(KobaPath + "MACROs\" + Accion_ID + ".mcr") = False Then Exit Sub
        Dim Linea() As String : Dim Tipo As NSListViewSK.NSListViewItemSK.TipoEN : Dim Leer As New IO.StreamReader(KobaPath + "MACROs\" + Accion_ID + ".mcr")
        Do Until Leer.EndOfStream
            Linea = Split(Leer.ReadLine, "|-|", , CompareMethod.Text)
            Tipo = CInt(Linea(1))
            GMacro_Lista.AddItem(Tipo_to_Texto(Linea(0), Tipo), Linea(0), Tipo)
        Loop : Leer.Close()
    End Sub

    Private Function Tipo_to_Texto(Accion As String, Tipo As NSListViewSK.NSListViewItemSK.TipoEN) As String
        Select Case Tipo
            Case NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion
                Return "Pausar " + Accion + " ms."
            Case NSListViewSK.NSListViewItemSK.TipoEN.KeyDown
                Return "Pulsar la tecla " + Accion
            Case NSListViewSK.NSListViewItemSK.TipoEN.KeyUp
                Return "Soltar la tecla " + Accion
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseDown
                Return "Pulsar " + Accion
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseUp
                Return "Soltar " + Accion
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelDown
                Return "Rueda del ratón " + Accion
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelUp
                Return "Rueda del ratón " + Accion
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelDown
                Return "Rueda del ratón " + Accion
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelUp
                Return "Rueda del ratón " + Accion
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseMove
                Return "Mover ratón (" + Accion + ")"
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseMoveR
                Return "Desplazar ratón (" + Accion + ")"
        End Select : Return ""
    End Function

#End Region

#Region " Up / Down "

    Private Sub GMacro_Up_Click(sender As Object, e As MouseEventArgs) Handles GMacro_Up.Click, GMacro_Up.DoubleClick
        If e.Button <> MouseButtons.Left Or GMacro_Lista.SelectedIndex.Count > 1 Then Exit Sub
        If GMacro_Lista.Items.Count = 0 Or GMacro_Lista.SelectedIndex.Length = 0 Then Exit Sub
        If GMacro_Lista.SelectedIndex(0) = -1 Or GMacro_Lista.SelectedIndex(0) = 0 Then Exit Sub
        Dim Item As NSListViewSK.NSListViewItemSK = GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0))
        Dim NewIndex As Integer = GMacro_Lista.SelectedIndex(0) - 1 : GMacro_Lista.RemoveItemAt(GMacro_Lista.SelectedIndex(0)) : GMacro_Lista.InsertItemAt(NewIndex, Item) : GMacro_Lista.SelectItem(NewIndex) : GMacro_Lista.EnsureVisibleAt(NewIndex)
        GuardarMacro()
    End Sub

    Private Sub GMacro_Down_Click(sender As Object, e As MouseEventArgs) Handles GMacro_Down.Click, GMacro_Down.DoubleClick
        If e.Button <> MouseButtons.Left Or GMacro_Lista.SelectedIndex.Count > 1 Then Exit Sub
        If GMacro_Lista.Items.Count = 0 Or GMacro_Lista.SelectedIndex.Length = 0 Then Exit Sub
        If GMacro_Lista.SelectedIndex(0) = -1 Or GMacro_Lista.SelectedIndex(0) = GMacro_Lista.Items.Count - 1 Then Exit Sub
        Dim Item As NSListViewSK.NSListViewItemSK = GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0))
        Dim NewIndex As Integer = GMacro_Lista.SelectedIndex(0) + 1 : GMacro_Lista.RemoveItemAt(GMacro_Lista.SelectedIndex(0)) : GMacro_Lista.InsertItemAt(NewIndex, Item) : GMacro_Lista.SelectItem(NewIndex) : GMacro_Lista.EnsureVisibleAt(NewIndex)
        GuardarMacro()
    End Sub

#End Region

#Region " Menu "

    Private Sub Macros_MenuLista_Opening(sender As Object, e As System.ComponentModel.CancelEventArgs) Handles Macros_MenuLista.Opening
        Dim cLista As NSListViewSK = CType(sender.SourceControl, NSListViewSK)
        If GMacro_Grabando = True Then e.Cancel = True : Exit Sub
        If cLista.SelectedIndex(0) = -1 Then
            Macros_Menu_Separador0.Visible = False
            Macros_Menu_Editar.Visible = False
            Macros_Menu_Separador1.Visible = False
            Macros_Menu_Eliminar.Visible = False
            Macros_MenuLista.Height = 26
        Else
            If cLista.SelectedItems.Length > 1 Then
                Macros_Menu_Separador0.Visible = False
                Macros_Menu_Editar.Visible = False
                Macros_Menu_Separador1.Visible = True
                Macros_Menu_Eliminar.Visible = True
                Macros_MenuLista.Height = 54
            Else
                Macros_Menu_Separador1.Visible = True
                Macros_Menu_Eliminar.Visible = True
                If GMacro_Editando = True Then
                    Macros_Menu_Separador0.Visible = False
                    Macros_Menu_Editar.Visible = False
                    Macros_MenuLista.Height = 54
                Else
                    Macros_Menu_Separador0.Visible = True
                    Macros_Menu_Editar.Visible = True
                    Macros_MenuLista.Height = 82
                End If
            End If
        End If
    End Sub

    Private Sub Macros_Menu_Nuevo_Click(sender As Object, e As EventArgs) Handles Macros_Menu_Nuevo.Click
        GMacro_PAñadir_Click(sender, Nothing)
    End Sub

    Private Sub Macros_Menu_Editar_Click(sender As Object, e As EventArgs) Handles Macros_Menu_Editar.Click
        GMacro_PEditar_Click(sender, Nothing)
    End Sub

    Private Sub Macros_Menu_Eliminar_Click(sender As Object, e As EventArgs) Handles Macros_Menu_Eliminar.Click
        GMacro_PEliminar_Click(sender, Nothing)
    End Sub

#End Region

#End Region

#Region " Checks "

    Private Sub GMacro_PausasEjecucion_Click(sender As Object, e As MouseEventArgs) Handles GMacro_LPausasEjecucion.Click, GMacro_LPausasEjecucion.DoubleClick, GMacro_CPausasEjecucion.Click, GMacro_CPausasEjecucion.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GMacro_CPausasEjecucion.Checked = True Then GMacro_CPausasEjecucion.Checked = False Else GMacro_CPausasEjecucion.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GMacro_EventosTeclado_Click(sender As Object, e As MouseEventArgs) Handles GMacro_LEventosTeclado.Click, GMacro_LEventosTeclado.DoubleClick, GMacro_CEventosTeclado.Click, GMacro_CEventosTeclado.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GMacro_CEventosTeclado.Checked = True Then GMacro_CEventosTeclado.Checked = False Else GMacro_CEventosTeclado.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GMacro_Clicks_Position_Click(sender As Object, e As MouseEventArgs) Handles GMacro_LClicks_Position.Click, GMacro_LClicks_Position.DoubleClick, GMacro_CClicks_Position.Click, GMacro_CClicks_Position.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GMacro_CClicks_Position.Checked = True Then GMacro_CClicks_Position.Checked = False Else GMacro_CClicks_Position.Checked = True
        If GMacro_CClicks_Position.Checked = True Then GMacro_CClicsRaton.Checked = False
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GMacro_ClicsRaton_Click(sender As Object, e As MouseEventArgs) Handles GMacro_LClicsRaton.Click, GMacro_LClicsRaton.DoubleClick, GMacro_CClicsRaton.Click, GMacro_CClicsRaton.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GMacro_CClicsRaton.Checked = True Then GMacro_CClicsRaton.Checked = False Else GMacro_CClicsRaton.Checked = True
        If GMacro_CClicsRaton.Checked = True Then GMacro_CClicks_Position.Checked = False
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GMacro_RuedaRaton_Click(sender As Object, e As MouseEventArgs) Handles GMacro_LRuedaRaton.Click, GMacro_LRuedaRaton.DoubleClick, GMacro_CRuedaRaton.Click, GMacro_CRuedaRaton.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GMacro_CRuedaRaton.Checked = True Then GMacro_CRuedaRaton.Checked = False Else GMacro_CRuedaRaton.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GMacro_MovimientoRaton_Click(sender As Object, e As MouseEventArgs) Handles GMacro_LMovimientoRaton.Click, GMacro_LMovimientoRaton.DoubleClick, GMacro_CMovimientoRaton.Click, GMacro_CMovimientoRaton.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GMacro_CMovimientoRaton.Checked = True Then GMacro_CMovimientoRaton.Checked = False Else GMacro_CMovimientoRaton.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GMacro_Repetir_Click(sender As Object, e As MouseEventArgs) Handles GMacro_LRepetir.Click, GMacro_LRepetir.DoubleClick, GMacro_CRepetir.Click, GMacro_CRepetir.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GMacro_CRepetir.Checked = True Then GMacro_CRepetir.Checked = False Else GMacro_CRepetir.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GMacro_Esperar_Click(sender As Object, e As MouseEventArgs) Handles GMacro_LEsperar.Click, GMacro_LEsperar.DoubleClick, GMacro_CEsperar.Click, GMacro_CEsperar.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GMacro_CEsperar.Checked = True Then GMacro_CEsperar.Checked = False Else GMacro_CEsperar.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Añadir "

#Region " Accion "

    Private Sub GMacro_LCAccion_TextChanged(sender As Object, e As EventArgs) Handles GMacro_LCAccion.TextChanged
        GMacro_LTecla.Visible = False
        GMacro_LCTecla.Visible = False
        GMacro_TTecla.Visible = False
        GMacro_PTecla.Visible = False
        'Boton
        GMacro_LBoton.Visible = False
        GMacro_LCBoton.Visible = False
        GMacro_TBoton.Visible = False
        GMacro_PBoton.Visible = False
        GMacro_CBoton.Visible = False
        'Mover
        GMacro_CoorLMouse.Visible = False
        GMacro_CoorLX.Visible = False
        GMacro_CoorLY.Visible = False
        GMacro_CoorLCX.Visible = False
        GMacro_CoorLCY.Visible = False
        GMacro_LX.Visible = False
        GMacro_LY.Visible = False
        GMacro_TX.Visible = False
        GMacro_TY.Visible = False
        GMacro_LAplicarActuales.Visible = False
        'Pausa
        GMacro_LPausa.Visible = False
        GMacro_TPausa.Visible = False
        GMacro_Lms.Visible = False
        Select Case GMacro_LCAccion.Text
            Case "Pulsar Tecla", "Soltar Tecla"
                GMacro_LTecla.Visible = True
                GMacro_LCTecla.Visible = True
                GMacro_TTecla.Visible = True
                GMacro_PTecla.Visible = True
                GMacro_LCTecla.Text = "A"
            Case "Pulsar Ratón", "Soltar Ratón"
                GMacro_CBoton.Items.Clear() : GMacro_CBoton.Items.AddRange({"Mouse 1", "Mouse 2", "Mouse 3", "Mouse 4", "Mouse 5"}) : GMacro_CBoton.SelectedIndex = 0
                GMacro_LBoton.Visible = True
                GMacro_LCBoton.Visible = True
                GMacro_TBoton.Visible = True
                GMacro_PBoton.Visible = True
                GMacro_CBoton.Visible = True
            Case "Rueda Ratón"
                GMacro_CBoton.Items.Clear() : GMacro_CBoton.Items.AddRange({"Rueda Arriba", "Rueda Abajo", "Rueda Izquierda", "Rueda Derecha"}) : GMacro_CBoton.SelectedIndex = 0
                GMacro_LBoton.Visible = True
                GMacro_LCBoton.Visible = True
                GMacro_TBoton.Visible = True
                GMacro_PBoton.Visible = True
                GMacro_CBoton.Visible = True
            Case "Mover Ratón"
                GMacro_TX.Text = "0" : GMacro_TY.Text = "0"
                GMacro_CoorLMouse.Visible = True
                GMacro_CoorLX.Visible = True
                GMacro_CoorLY.Visible = True
                GMacro_CoorLCX.Visible = True
                GMacro_CoorLCY.Visible = True
                GMacro_LX.Visible = True
                GMacro_LY.Visible = True
                GMacro_TX.Visible = True
                GMacro_TY.Visible = True
                GMacro_LAplicarActuales.Visible = True
            Case "Desplazar Ratón"
                GMacro_TX.Text = "0" : GMacro_TY.Text = "0"
                GMacro_LX.Visible = True
                GMacro_LY.Visible = True
                GMacro_TX.Visible = True
                GMacro_TY.Visible = True
            Case "Pausar"
                GMacro_TPausa.Text = "0"
                GMacro_LPausa.Visible = True
                GMacro_TPausa.Visible = True
                GMacro_Lms.Visible = True
        End Select
        GMacro_Cambios()
    End Sub

    Private Sub GMacro_TAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GMacro_TAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GMacro_TAccion_GotFocus(sender As Object, e As EventArgs) Handles GMacro_TAccion.GotFocus
        GMacro_TAccion.Text = GMacro_TAccion.Text.Trim : GMacro_TAccion.SelectionLength = 0 : HTexto.Focus()
    End Sub

    Private Sub GMacro_TAccion_LostFocus(sender As Object, e As EventArgs) Handles GMacro_TAccion.LostFocus
        GMacro_TAccion.Text = GMacro_TAccion.Text.Trim : GMacro_TAccion.SelectionLength = 0 : GMacro_LCAccion.Text = GMacro_TAccion.Text
    End Sub

    Private Sub GMacro_TAccion_Click(sender As Object, e As MouseEventArgs) Handles GMacro_LCAccion.Click, GMacro_TAccion.Click
        If e.Button = MouseButtons.Left Then GMacro_CAccion.DroppedDown = True : GMacro_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GMacro_PAccion_Click(sender As Object, e As MouseEventArgs) Handles GMacro_PAccion.Click, GMacro_PAccion.DoubleClick
        If e.Button = MouseButtons.Left Then GMacro_CAccion.DroppedDown = True : GMacro_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GMacro_PAccion_MouseEnter(sender As Object, e As EventArgs) Handles GMacro_PAccion.MouseEnter
        GMacro_PAccion.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GMacro_PAccion_MouseLeave(sender As Object, e As EventArgs) Handles GMacro_PAccion.MouseLeave
        GMacro_PAccion.Image = My.Resources.CComandos_Off
    End Sub

#Region " Combo Accion "

    Private Sub GMacro_CAccion_DropDown(sender As Object, e As EventArgs) Handles GMacro_CAccion.DropDown
        GMacro_CAccion.MaxDropDownItems = GMacro_CAccion.Items.Count : Combo_Dropped = True : Combo_TempValue = GMacro_TAccion.Text
        If GMacro_CAccion.Items.Contains(GMacro_LCAccion.Text) = True Then GMacro_CAccion.SelectedItem = GMacro_LCAccion.Text Else GMacro_CAccion.SelectedIndex = 0
    End Sub

    Private Sub GMacro_CAccion_DropDownClosed(sender As Object, e As EventArgs) Handles GMacro_CAccion.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GMacro_CAccion_LostFocus(sender As Object, e As EventArgs) Handles GMacro_CAccion.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GMacro_CAccion_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GMacro_CAccion.SelectedIndexChanged
        If Combo_TempValue = "" Then GMacro_TAccion.Text = GMacro_CAccion.SelectedItem.Trim : GMacro_LCAccion.Text = GMacro_TAccion.Text : HTexto.Focus()
    End Sub

    Private Sub GMacro_CAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GMacro_CAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then GMacro_TAccion.Text = GMacro_CAccion.SelectedItem.Trim : GMacro_LCAccion.Text = GMacro_TAccion.Text : HTexto.Focus() : e.Handled = True
    End Sub

#End Region

#End Region

#Region " Boton "

    Private Sub GMacro_LCBoton_TextChanged(sender As Object, e As EventArgs) Handles GMacro_LCBoton.TextChanged
        GMacro_Cambios()
    End Sub

    Private Sub GMacro_LCBoton_Click(sender As Object, e As MouseEventArgs) Handles GMacro_LCBoton.Click, GMacro_TBoton.Click
        If e.Button = MouseButtons.Left Then GMacro_CBoton.DroppedDown = True : GMacro_CBoton.Focus() Else HTexto.Focus()
    End Sub

    Private Sub GMacro_TBoton_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GMacro_TBoton.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GMacro_TBoton_GotFocus(sender As Object, e As EventArgs) Handles GMacro_TBoton.GotFocus
        GMacro_TBoton.Text = GMacro_TBoton.Text.Trim : GMacro_TBoton.SelectionLength = 0 : HTexto.Focus()
    End Sub

    Private Sub GMacro_TBoton_LostFocus(sender As Object, e As EventArgs) Handles GMacro_TBoton.LostFocus
        GMacro_TBoton.Text = GMacro_TBoton.Text.Trim : GMacro_TBoton.SelectionLength = 0 : GMacro_LCBoton.Text = GMacro_TBoton.Text
    End Sub

    Private Sub GMacro_PBoton_Click(sender As Object, e As MouseEventArgs) Handles GMacro_PBoton.Click, GMacro_PBoton.DoubleClick
        If e.Button = MouseButtons.Left Then GMacro_CBoton.DroppedDown = True : GMacro_CBoton.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GMacro_PBoton_MouseEnter(sender As Object, e As EventArgs) Handles GMacro_PBoton.MouseEnter
        GMacro_PBoton.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GMacro_PBoton_MouseLeave(sender As Object, e As EventArgs) Handles GMacro_PBoton.MouseLeave
        GMacro_PBoton.Image = My.Resources.CComandos_Off
    End Sub

#Region " Combo Boton "

    Private Sub GMacro_CBoton_DropDown(sender As Object, e As EventArgs) Handles GMacro_CBoton.DropDown
        Combo_Dropped = True : Combo_TempValue = GMacro_TBoton.Text
        If GMacro_CBoton.Items.Contains(GMacro_TBoton.Text) = True Then GMacro_CBoton.SelectedItem = GMacro_TBoton.Text Else GMacro_CBoton.SelectedIndex = 0
    End Sub

    Private Sub GMacro_CBoton_DropDownClosed(sender As Object, e As EventArgs) Handles GMacro_CBoton.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GMacro_CBoton_LostFocus(sender As Object, e As EventArgs) Handles GMacro_CBoton.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GMacro_CBoton_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GMacro_CBoton.SelectedIndexChanged
        If Combo_TempValue = "" Then GMacro_TBoton.Text = GMacro_CBoton.SelectedItem.Trim : GMacro_LCBoton.Text = GMacro_TBoton.Text : HTexto.Focus()
    End Sub

    Private Sub GMacro_CBoton_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GMacro_CBoton.KeyPress
        If Asc(e.KeyChar) = 13 Then GMacro_TBoton.Text = GMacro_CBoton.SelectedItem.Trim : GMacro_LCBoton.Text = GMacro_TBoton.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub GMacro_CBoton_MouseEnter(sender As Object, e As EventArgs) Handles GMacro_TBoton.MouseEnter, GMacro_CBoton.MouseEnter
        GMacro_CBoton.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " Tecla "

    Private Sub GMacro_TTecla_DoubleClick(sender As Object, e As EventArgs) Handles GMacro_TTecla.DoubleClick, GMacro_LCTecla.DoubleClick
        GMacro_TTecla.Text = ""
    End Sub

    Private Sub GMacro_TTecla_TextChanged(sender As Object, e As EventArgs) Handles GMacro_TTecla.TextChanged
        GMacro_LCTecla.Text = GMacro_TTecla.Text
    End Sub

    Private Sub GMacro_LCTecla_TextChanged(sender As Object, e As EventArgs) Handles GMacro_LCTecla.TextChanged
        GMacro_LCTecla.Font = New Font(GMacro_LCTecla.Font.FontFamily, 6.75)
        If GMacro_LCTecla.Text.Length > 17 Then GMacro_LCTecla.Font = New Font(GMacro_LCTecla.Font.FontFamily, 6)
        GMacro_Cambios()
    End Sub

    Private Sub GMacro_TTecla_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GMacro_TTecla.KeyPress
        e.Handled = True : If Asc(e.KeyChar) = 13 Then HTexto.Focus()
    End Sub

    Private Sub GMacro_TTecla_GotFocus(sender As Object, e As EventArgs) Handles GMacro_TTecla.GotFocus, GMacro_LCTecla.Click
        If GMacro_Grabando = True Then HTexto.Focus() : Exit Sub
        Mouse_HotKey = True
        GMacro_TTecla.Width = 106
        GMacro_TTecla.isKeyLog = True : GMacro_TTecla.Cursor = Cursors.Default : GMacro_TTecla.Invalidate()
        Get_Macro_Key = True : GMacro_MacroM = True
    End Sub

    Private Sub GMacro_LCTecla_Click(sender As Object, e As EventArgs) Handles GMacro_LCTecla.Click
        If GMacro_Grabando = True Then HTexto.Focus() : Exit Sub
        Mouse_HotKey = True
        GMacro_TTecla.isKeyLog = True : GMacro_TTecla.Invalidate()
        Get_Macro_Key = True : GMacro_MacroM = True : HTexto.Focus()
    End Sub

    Private Sub GMacro_PTecla_Click(sender As Object, e As MouseEventArgs) Handles GMacro_PTecla.Click, GMacro_PTecla.DoubleClick
        HTexto.Focus() : If e.Button <> MouseButtons.Left Then Exit Sub
        GMacros_Teclas_Menu.Show(Left + PanelComandos.Left + GMacro.Left + GMacro_GAñadirMacro.Left + sender.Left + sender.Width + 3, Top + PanelComandos.Top + GMacro.Top + GMacro_GAñadirMacro.Top + sender.Top)
    End Sub

    Private Sub GMacro_PTecla_MouseEnter(sender As Object, e As EventArgs) Handles GMacro_PTecla.MouseEnter
        GMacro_PTecla.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GMacro_PTecla_MouseLeave(sender As Object, e As EventArgs) Handles GMacro_PTecla.MouseLeave
        GMacro_PTecla.Image = My.Resources.CComandos_Off
    End Sub

#Region " Menu Teclas "

    Private Sub GMacros_Teclas_Menu_MouseDown(sender As Object, e As MouseEventArgs)
        GMacro_TTecla.Text = sender.Tag
    End Sub

#Region " KeyPress "

    Private Sub GMacros_Teclas_Menu_KeyDown(sender As Object, e As PreviewKeyDownEventArgs)
        'Try
        If e.KeyCode = Keys.Enter Then
            For Each cItem As Object In sender.Items
                If cItem.Selected = True Then
                    If cItem.Tag = "" Then Exit Sub
                    GComandos_TComandos.Text = cItem.Text
                    GComandos_TComandos.Tag = cItem.Tag
                    GComandos_LCComandos.Text = cItem.Text
                    Exit For
                End If
            Next : Exit Sub
        End If
        If e.KeyCode <> Keys.Up And e.KeyCode <> Keys.Down And e.KeyCode <> Keys.Left And e.KeyCode <> Keys.Right And e.KeyCode <> Keys.Home And e.KeyCode <> Keys.End And e.KeyCode <> Keys.Escape Then Exit Sub
        QuickMenu_ForeColor_Off(GComandos_Comandos_Menu) : Dim Selected As Boolean
        If e.KeyCode = Keys.Up Or e.KeyCode = Keys.Down Then
            For Cuenta = 0 To sender.Items.Count - 1
                If sender.Items(Cuenta).Selected = True Then
                    If e.KeyCode = Keys.Up Then
                        If Cuenta = 0 Then
                            sender.Items(GetNextItem_ForSelect(sender, sender.Items.Count - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
                        Else
                            sender.Items(GetNextItem_ForSelect(sender, Cuenta - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
                        End If
                    End If
                    If e.KeyCode = Keys.Down Then
                        If Cuenta = sender.Items.Count - 1 Then
                            sender.Items(GetNextItem_ForSelect(sender, 0, False)).ForeColor = Color.FromArgb(205, 150, 0)
                        Else
                            sender.Items(GetNextItem_ForSelect(sender, Cuenta + 1, False)).ForeColor = Color.FromArgb(205, 150, 0)
                        End If
                    End If : Selected = True : Exit For
                End If
            Next
            If Selected = False Then
                If e.KeyCode = Keys.Up AndAlso sender.Items.Count > 0 Then
                    sender.Items(GetNextItem_ForSelect(sender, sender.Items.Count - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
                End If
                If e.KeyCode = Keys.Down AndAlso sender.Items.Count > 0 Then
                    sender.Items(GetNextItem_ForSelect(sender, 0, False)).ForeColor = Color.FromArgb(205, 150, 0)
                End If
            End If
        End If
        If e.KeyCode = Keys.Right Then
            For Each cItem As Object In sender.Items
                If cItem.Selected = True Then
                    If cItem.DropDownItems.Count > 0 Then
                        cItem.DropDownItems(0).ForeColor = Color.FromArgb(205, 150, 0) : Exit For
                    Else
                        For Each nItem As Object In GComandos_Comandos_Menu.Items
                            If nItem.Selected = True Then nItem.ForeColor = Color.FromArgb(205, 150, 0) : Exit For
                        Next : Exit For
                    End If
                End If
            Next
        End If
        If e.KeyCode = Keys.Left Or e.KeyCode = Keys.Escape Then
            If TypeOf sender IsNot NSContextMenu Then
                sender.OwnerItem.ForeColor = Color.FromArgb(205, 150, 0)
            Else
                For Each nItem As Object In QuickMenu_Editor.Items
                    If nItem.Selected = True Then nItem.ForeColor = Color.FromArgb(205, 150, 0) : Exit For
                Next
            End If
        End If
        If e.KeyCode = Keys.Home Then sender.Items(0).ForeColor = Color.FromArgb(205, 150, 0)
        If e.KeyCode = Keys.End Then sender.Items(sender.Items.Count - 1).ForeColor = Color.FromArgb(205, 150, 0)
        'Catch : End Try
    End Sub

    Private Sub GMacros_Teclas_Menu_MouseEnter(sender As Object, e As EventArgs)
        sender.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GMacros_Teclas_Menu_MouseLeave(sender As Object, e As EventArgs)
        sender.ForeColor = Color.FromArgb(130, 130, 130)
    End Sub

#End Region

#End Region

#End Region

#Region " Mover "

    Private Sub GMacro_TXY_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GMacro_TX.KeyPress, GMacro_TY.KeyPress
        Dim cControl As NSTextBox = CType(sender, NSTextBox)
        If Asc(e.KeyChar) = 45 And cControl.Text.Contains("-") = False And cControl.SelectionStart = 0 Then Exit Sub
        If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar) Then e.Handled = True
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GMacro_TXY_GotFocus(sender As Object, e As EventArgs) Handles GMacro_TX.GotFocus, GMacro_TY.GotFocus
        Dim cControl As NSTextBox = CType(sender, NSTextBox)
        cControl.Text = cControl.Text.Trim : cControl.SelectionLength = 0
    End Sub

    Private Sub GMacro_TXY_LostFocus(sender As Object, e As EventArgs) Handles GMacro_TX.LostFocus, GMacro_TY.LostFocus
        Dim cControl As NSTextBox = CType(sender, NSTextBox)
        cControl.Text = cControl.Text.Trim : cControl.SelectionLength = 0 : If cControl.Text = "" Then cControl.Text = "0"
        cControl.Text = CInt(cControl.Text).ToString
        GMacro_Cambios()
    End Sub

#End Region

#Region " Pausar "

    Private Sub GMacro_TPausa_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GMacro_TPausa.KeyPress
        If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar) Then e.Handled = True
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GMacro_TPausa_GotFocus(sender As Object, e As EventArgs) Handles GMacro_TPausa.GotFocus
        GMacro_TPausa.Text = GMacro_TPausa.Text.Trim : GMacro_TPausa.SelectionLength = 0
    End Sub

    Private Sub GMacro_TPausa_LostFocus(sender As Object, e As EventArgs) Handles GMacro_TPausa.LostFocus
        GMacro_TPausa.Text = GMacro_TPausa.Text.Trim : GMacro_TPausa.SelectionLength = 0 : If GMacro_TPausa.Text = "" Then GMacro_TPausa.Text = "0"
        GMacro_TPausa.Text = CInt(GMacro_TPausa.Text).ToString
        GMacro_Cambios()
    End Sub

#End Region

#Region " Botones "

    Private Sub GMacro_Cambios(Optional Nuevo As Boolean = False)
        If GMacro_EditandoCarga = True Then Exit Sub
        If GMacro_LAñadirMacro.Value1 = "Añadir" Or Nuevo = True Then
            Select Case GMacro_LCAccion.Text
                Case "Pulsar Tecla"
                    If GMacro_LCTecla.Text <> "" Then GMacro_Lista.AddItem(Tipo_to_Texto(GMacro_LCTecla.Text, NSListViewSK.NSListViewItemSK.TipoEN.KeyDown), GMacro_LCTecla.Text, NSListViewSK.NSListViewItemSK.TipoEN.KeyDown) Else Exit Sub
                Case "Soltar Tecla"
                    If GMacro_LCTecla.Text <> "" Then GMacro_Lista.AddItem(Tipo_to_Texto(GMacro_LCTecla.Text, NSListViewSK.NSListViewItemSK.TipoEN.KeyUp), GMacro_LCTecla.Text, NSListViewSK.NSListViewItemSK.TipoEN.KeyUp) Else Exit Sub
                Case "Pulsar Ratón"
                    GMacro_Lista.AddItem(Tipo_to_Texto(GMacro_LCBoton.Text, NSListViewSK.NSListViewItemSK.TipoEN.MouseDown), GMacro_LCBoton.Text, NSListViewSK.NSListViewItemSK.TipoEN.MouseDown)
                Case "Soltar Ratón"
                    GMacro_Lista.AddItem(Tipo_to_Texto(GMacro_LCBoton.Text, NSListViewSK.NSListViewItemSK.TipoEN.MouseUp), GMacro_LCBoton.Text, NSListViewSK.NSListViewItemSK.TipoEN.MouseUp)
                Case "Rueda Ratón"
                    Select Case GMacro_LCBoton.Text.Replace("Rueda ", "")
                        Case "Arriba" : GMacro_Lista.AddItem(Tipo_to_Texto("arriba", NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelDown), "arriba", NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelDown)
                        Case "Abajo" : GMacro_Lista.AddItem(Tipo_to_Texto("abajo", NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelUp), "abajo", NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelUp)
                        Case "Izquierda" : GMacro_Lista.AddItem(Tipo_to_Texto("izquierda", NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelDown), "izquierda", NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelDown)
                        Case "Derecha" : GMacro_Lista.AddItem(Tipo_to_Texto("derecha", NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelUp), "derecha", NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelUp)
                    End Select
                Case "Mover Ratón"
                    GMacro_Lista.AddItem(Tipo_to_Texto("{X=" + GMacro_TX.Text + ",Y=" + GMacro_TY.Text + "}", NSListViewSK.NSListViewItemSK.TipoEN.MouseMove), "{X=" + GMacro_TX.Text + ",Y=" + GMacro_TY.Text + "}", NSListViewSK.NSListViewItemSK.TipoEN.MouseMove)
                Case "Desplazar Ratón"
                    GMacro_Lista.AddItem(Tipo_to_Texto("{X=" + GMacro_TX.Text + ",Y=" + GMacro_TY.Text + "}", NSListViewSK.NSListViewItemSK.TipoEN.MouseMoveR), "{X=" + GMacro_TX.Text + ",Y=" + GMacro_TY.Text + "}", NSListViewSK.NSListViewItemSK.TipoEN.MouseMoveR)
                Case "Pausar"
                    GMacro_Lista.AddItem(Tipo_to_Texto(GMacro_TPausa.Text, NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion), GMacro_TPausa.Text, NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion)
            End Select
            'GMacro_Lista.Invalidate() : GuardarMacro() : If Nuevo = False Then GMacro_Lista.SelectItem(GMacro_Lista.Items.Count - 1) : GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
        Else
            If GMacro_Lista.SelectedIndex.Length = 0 OrElse GMacro_Lista.SelectedIndex(0) = -1 Then Exit Sub
            Select Case GMacro_LCAccion.Text
                Case "Pulsar Tecla"
                    If GMacro_LCTecla.Text <> "" Then
                        GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Text = Tipo_to_Texto(GMacro_LCTecla.Text, NSListViewSK.NSListViewItemSK.TipoEN.KeyDown)
                        GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tag = GMacro_LCTecla.Text
                        GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.KeyDown
                    Else
                        Exit Sub
                    End If
                Case "Soltar Tecla"
                    If GMacro_LCTecla.Text <> "" Then
                        GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Text = Tipo_to_Texto(GMacro_LCTecla.Text, NSListViewSK.NSListViewItemSK.TipoEN.KeyUp)
                        GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tag = GMacro_LCTecla.Text
                        GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.KeyUp
                    Else
                        Exit Sub
                    End If
                Case "Pulsar Ratón"
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Text = Tipo_to_Texto(GMacro_LCBoton.Text, NSListViewSK.NSListViewItemSK.TipoEN.MouseDown)
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tag = GMacro_LCBoton.Text
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.MouseDown
                Case "Soltar Ratón"
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Text = Tipo_to_Texto(GMacro_LCBoton.Text, NSListViewSK.NSListViewItemSK.TipoEN.MouseUp)
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tag = GMacro_LCBoton.Text
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.MouseUp
                Case "Rueda Ratón"
                    Select Case GMacro_LCBoton.Text.Replace("Rueda ", "")
                        Case "Arriba"
                            GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Text = Tipo_to_Texto("arriba", NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelDown)
                            GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tag = "arriba"
                            GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelDown
                        Case "Abajo"
                            GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Text = Tipo_to_Texto("abajo", NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelUp)
                            GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tag = "abajo"
                            GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelUp
                        Case "Izquierda"
                            GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Text = Tipo_to_Texto("izquierda", NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelDown)
                            GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tag = "izquierda"
                            GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelDown
                        Case "Derecha"
                            GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Text = Tipo_to_Texto("derecha", NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelUp)
                            GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tag = "derecha"
                            GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelUp
                    End Select
                Case "Mover Ratón"
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Text = Tipo_to_Texto("{X=" + GMacro_TX.Text + ",Y=" + GMacro_TY.Text + "}", NSListViewSK.NSListViewItemSK.TipoEN.MouseMove)
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tag = "{X=" + GMacro_TX.Text + ",Y=" + GMacro_TY.Text + "}"
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.MouseMove
                Case "Desplazar Ratón"
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Text = Tipo_to_Texto("{X=" + GMacro_TX.Text + ",Y=" + GMacro_TY.Text + "}", NSListViewSK.NSListViewItemSK.TipoEN.MouseMoveR)
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tag = "{X=" + GMacro_TX.Text + ",Y=" + GMacro_TY.Text + "}"
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.MouseMoveR
                Case "Pausar"
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Text = Tipo_to_Texto(GMacro_TPausa.Text, NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion)
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tag = GMacro_TPausa.Text
                    GMacro_Lista.Items(GMacro_Lista.SelectedIndex(0)).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion
            End Select
        End If
        GMacro_Lista.Invalidate() : GuardarMacro() : If Nuevo = True Then GMacro_Lista.SelectItem(GMacro_Lista.Items.Count - 1) : GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
    End Sub

    Private Sub GMacro_BAñadirEvento_Click(sender As Object, e As MouseEventArgs) Handles GMacro_BAñadirEvento.Click
        If e.Button <> MouseButtons.Left Or GMacro_Grabando = True Then Exit Sub
        GMacro_Cambios(True)
    End Sub

#End Region

#Region " Cerrar "

    Private Sub GMacro_LCerrar_Click(sender As Object, e As MouseEventArgs) Handles GMacro_LCerrar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        GMacro_Editando = False : GMacro_GAñadirMacro.Visible = False : GMacro_LAñadirMacro.Visible = False : GMacro_Separador2.Visible = False : GMacro_PPausas.Visible = False
    End Sub

    Private Sub GMacro_LCerrar_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GMacro_LCerrar.MouseEnter
        GMacro_LCerrar.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GMacro_LCerrar_MouseLeave(sender As Object, e As EventArgs) Handles GMacro_LCerrar.MouseLeave
        GMacro_LCerrar.ForeColor1 = Color.Gray
    End Sub

#End Region

#Region " Añadir Pausas "

    Private Sub GMacros_TAñadirPausa_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GMacros_TAñadirPausa.KeyPress
        If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar) Then e.Handled = True
        If Asc(e.KeyChar) = 13 Then e.Handled = True : AñadirPausas = True : HTexto.Focus()
    End Sub

    Private Sub GMacros_TAñadirPausa_GotFocus(sender As Object, e As EventArgs) Handles GMacros_TAñadirPausa.GotFocus
        GMacros_TAñadirPausa.Text = GMacros_TAñadirPausa.Text.Trim : GMacros_TAñadirPausa.SelectionLength = 0
    End Sub

    Private Sub GMacros_TAñadirPausa_LostFocus(sender As Object, e As EventArgs) Handles GMacros_TAñadirPausa.LostFocus
        GMacros_TAñadirPausa.Text = GMacros_TAñadirPausa.Text.Trim : GMacros_TAñadirPausa.SelectionLength = 0 : If GMacros_TAñadirPausa.Text = "" Then GMacros_TAñadirPausa.Text = "0"
        GMacros_TAñadirPausa.Text = CInt(GMacros_TAñadirPausa.Text)
        If AñadirPausas = True Then AñadirPausas = False : GMacro_BAñadirPausa_Click(sender, Nothing)
    End Sub

    Private Sub GMacro_BAñadirPausa_Click(sender As Object, e As MouseEventArgs) Handles GMacros_BAñadirPausa.Click
        If e IsNot Nothing AndAlso e.Button <> MouseButtons.Left Then Exit Sub
        Dim Cuenta As Integer : Do Until Cuenta >= GMacro_Lista.Items.Count - 1
            If GMacro_Lista.Items(Cuenta).Tipo <> NSListViewSK.NSListViewItemSK.TipoEN.MouseMove And GMacro_Lista.Items(Cuenta).Tipo <> NSListViewSK.NSListViewItemSK.TipoEN.MouseMoveR AndAlso GMacro_Lista.Items(Cuenta).Tipo <> NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion AndAlso Cuenta + 1 < GMacro_Lista.Items.Count AndAlso GMacro_Lista.Items(Cuenta + 1).Tipo <> NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion Then
                Dim cItem As New NSListViewSK.NSListViewItemSK
                cItem.Text = "Pausar 0 ms." : cItem.Tag = 0 : cItem.Tipo = NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion
                GMacro_Lista.InsertItemAt(Cuenta + 1, cItem) : Cuenta += 2
            Else : Cuenta += 2 : End If
        Loop
        For Cuenta = 0 To GMacro_Lista.Items.Count - 1
            If GMacro_Lista.Items(Cuenta).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion Then
                GMacro_Lista.Items(Cuenta).Tag = GMacros_TAñadirPausa.Text : GMacro_Lista.Items(Cuenta).Text = Tipo_to_Texto(GMacro_Lista.Items(Cuenta).Tag.ToString, NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion)
            End If
        Next : GMacro_Lista.Invalidate() : GuardarMacro()
    End Sub

#End Region

#End Region

#Region " Botones "

    Private Sub GMacro_PBotones_MouseEnter(sender As Object, e As EventArgs) Handles GMacro_PAñadir.MouseEnter, GMacro_PEditar.MouseEnter, GMacro_PCopiar.MouseEnter, GMacro_PPegar.MouseEnter, GMacro_PResetTime.MouseEnter, GMacro_PSetTime.MouseEnter, GMacro_PEliminar.MouseEnter, GMacro_PClear.MouseEnter, GMacro_PGrabar.MouseEnter
        If GMacro_Grabando = True AndAlso sender.Name <> "GMacro_PGrabar" Then Exit Sub
        Select Case sender.Name
            Case "GMacro_PAñadir" : GMacro_PAñadir.Image = My.Resources.Macro_Añadir
            Case "GMacro_PEditar" : GMacro_PEditar.Image = My.Resources.Macro_Editar
            Case "GMacro_PCopiar" : GMacro_PCopiar.Image = My.Resources.Macro_Copiar
            Case "GMacro_PPegar" : GMacro_PPegar.Image = My.Resources.Macro_Pegar
            Case "GMacro_PResetTime" : GMacro_PResetTime.Image = My.Resources.Macro_ResetTime
            Case "GMacro_PSetTime" : GMacro_PSetTime.Image = My.Resources.Macro_SetTime
            Case "GMacro_PEliminar" : GMacro_PEliminar.Image = My.Resources.Macro_Eliminar
            Case "GMacro_PClear" : GMacro_PClear.Image = My.Resources.Macro_Clear
            Case "GMacro_PGrabar" : Macros_OnRecordButton = True : If GMacro_Grabando = True Then GMacro_PGrabar.Image = My.Resources.Macro_GrabarSi Else GMacro_PGrabar.Image = My.Resources.Macro_GrabarNo
        End Select
    End Sub

    Private Sub GMacro_PBotones_MouseLeave(sender As Object, e As EventArgs) Handles GMacro_PAñadir.MouseLeave, GMacro_PEditar.MouseLeave, GMacro_PCopiar.MouseLeave, GMacro_PPegar.MouseLeave, GMacro_PResetTime.MouseLeave, GMacro_PSetTime.MouseLeave, GMacro_PEliminar.MouseLeave, GMacro_PClear.MouseLeave, GMacro_PGrabar.MouseLeave
        Select Case sender.Name
            Case "GMacro_PAñadir" : GMacro_PAñadir.Image = My.Resources.Macro_Añadir_Off
            Case "GMacro_PEditar" : GMacro_PEditar.Image = My.Resources.Macro_Editar_Off
            Case "GMacro_PCopiar" : GMacro_PCopiar.Image = My.Resources.Macro_Copiar_Off
            Case "GMacro_PPegar" : GMacro_PPegar.Image = My.Resources.Macro_Pegar_Off
            Case "GMacro_PResetTime" : GMacro_PResetTime.Image = My.Resources.Macro_ResetTime_Off
            Case "GMacro_PSetTime" : GMacro_PSetTime.Image = My.Resources.Macro_SetTime_Off
            Case "GMacro_PEliminar" : GMacro_PEliminar.Image = My.Resources.Macro_Eliminar_Off
            Case "GMacro_PClear" : GMacro_PClear.Image = My.Resources.Macro_Clear_Off
            Case "GMacro_PGrabar" : Macros_OnRecordButton = False : If GMacro_Grabando = True Then GMacro_PGrabar.Image = My.Resources.Macro_GrabarSi_Off Else GMacro_PGrabar.Image = My.Resources.Macro_GrabarNo_Off
        End Select
    End Sub

    Private Sub GMacro_PAñadir_Click(sender As Object, e As MouseEventArgs) Handles GMacro_PAñadir.Click, GMacro_PAñadir.DoubleClick
        If e IsNot Nothing AndAlso e.Button <> MouseButtons.Left Or GMacro_Grabando = True Then Exit Sub
        GMacro_Lista.MultiSelect = False
        GMacro_Editando = True
        GMacro_EditandoCarga = True
        GMacro_GAñadirMacro.Visible = True
        GMacro_Separador2.Visible = True
        GMacro_Separador2.BringToFront()
        GMacro_LAñadirMacro.Visible = True
        GMacro_LAñadirMacro.BringToFront()
        GMacro_LAñadirMacro.Value1 = "Añadir"
        GMacro_PPausas.Visible = False
        'Tecla
        GMacro_LTecla.Visible = True
        GMacro_LCTecla.Visible = True
        GMacro_TTecla.Visible = True
        'Boton
        GMacro_LBoton.Visible = False
        GMacro_LCBoton.Visible = False
        GMacro_TBoton.Visible = False
        GMacro_CBoton.Visible = False
        'Mover
        GMacro_CoorLMouse.Visible = False
        GMacro_CoorLX.Visible = False
        GMacro_CoorLY.Visible = False
        GMacro_CoorLCX.Visible = False
        GMacro_CoorLCY.Visible = False
        GMacro_LX.Visible = False
        GMacro_LY.Visible = False
        GMacro_TX.Visible = False
        GMacro_TY.Visible = False
        GMacro_LAplicarActuales.Visible = False
        'Pausa
        GMacro_LPausa.Visible = False
        GMacro_TPausa.Visible = False
        GMacro_Lms.Visible = False
        GMacro_Lista.AddItem(Tipo_to_Texto("A", NSListViewSK.NSListViewItemSK.TipoEN.KeyDown), "A", NSListViewSK.NSListViewItemSK.TipoEN.KeyDown)
        GMacro_Lista.Invalidate() : GMacro_Lista.SelectItem(GMacro_Lista.Items.Count - 1) : GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1) : GuardarMacro()
    End Sub

    Private Sub GMacro_PEditar_Click(sender As Object, e As MouseEventArgs) Handles GMacro_PEditar.Click, GMacro_PEditar.DoubleClick
        If e IsNot Nothing AndAlso e.Button <> MouseButtons.Left Or GMacro_Grabando = True Or GMacro_Lista.Items.Count = 0 OrElse GMacro_Lista.SelectedIndex(0) = -1 Then Exit Sub
        GMacro_Lista.MultiSelect = False
        GMacro_Editando = True
        GMacro_EditandoCarga = True
        GMacro_GAñadirMacro.Visible = True
        GMacro_Separador2.Visible = True
        GMacro_Separador2.BringToFront()
        GMacro_LAñadirMacro.Visible = True
        GMacro_LAñadirMacro.BringToFront()
        GMacro_LAñadirMacro.Value1 = "Editar"
        GMacro_PPausas.Visible = False
        'Tecla
        GMacro_LTecla.Visible = False
        GMacro_LCTecla.Visible = False
        GMacro_TTecla.Visible = False
        'Boton
        GMacro_LBoton.Visible = False
        GMacro_LCBoton.Visible = False
        GMacro_TBoton.Visible = False
        GMacro_CBoton.Visible = False
        'Mover
        GMacro_CoorLMouse.Visible = False
        GMacro_CoorLX.Visible = False
        GMacro_CoorLY.Visible = False
        GMacro_CoorLCX.Visible = False
        GMacro_CoorLCY.Visible = False
        GMacro_LX.Visible = False
        GMacro_LY.Visible = False
        GMacro_TX.Visible = False
        GMacro_TY.Visible = False
        GMacro_LAplicarActuales.Visible = False
        'Pausa
        GMacro_LPausa.Visible = False
        GMacro_TPausa.Visible = False
        GMacro_Lms.Visible = False
        Select Case GMacro_Lista.SelectedItems(0).Tipo
            Case NSListViewSK.NSListViewItemSK.TipoEN.KeyDown
                GMacro_LTecla.Visible = True
                GMacro_LCTecla.Visible = True
                GMacro_TTecla.Visible = True
                GMacro_LCAccion.Text = "Pulsar Tecla"
                GMacro_LCTecla.Text = GMacro_Lista.SelectedItems(0).Tag
            Case NSListViewSK.NSListViewItemSK.TipoEN.KeyUp
                GMacro_LTecla.Visible = True
                GMacro_LCTecla.Visible = True
                GMacro_TTecla.Visible = True
                GMacro_LCAccion.Text = "Soltar Tecla"
                GMacro_LCTecla.Text = GMacro_Lista.SelectedItems(0).Tag
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseDown
                GMacro_LBoton.Visible = True
                GMacro_LCBoton.Visible = True
                GMacro_TBoton.Visible = True
                GMacro_CBoton.Visible = True
                GMacro_LCAccion.Text = "Pulsar Ratón"
                GMacro_LCBoton.Text = GMacro_Lista.SelectedItems(0).Tag
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseUp
                GMacro_LBoton.Visible = True
                GMacro_LCBoton.Visible = True
                GMacro_TBoton.Visible = True
                GMacro_CBoton.Visible = True
                GMacro_LCAccion.Text = "Soltar Ratón"
                GMacro_LCBoton.Text = GMacro_Lista.SelectedItems(0).Tag
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelDown, NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelUp, NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelDown, NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelUp
                GMacro_LBoton.Visible = True
                GMacro_LCBoton.Visible = True
                GMacro_TBoton.Visible = True
                GMacro_CBoton.Visible = True
                GMacro_LCAccion.Text = "Rueda Ratón"
                GMacro_LCBoton.Text = "Rueda " + GMacro_Lista.SelectedItems(0).Tag.ToString.Substring(0, 1).ToUpper + GMacro_Lista.SelectedItems(0).Tag.ToString.Substring(1)
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseMove
                GMacro_CoorLMouse.Visible = True
                GMacro_CoorLX.Visible = True
                GMacro_CoorLY.Visible = True
                GMacro_CoorLCX.Visible = True
                GMacro_CoorLCY.Visible = True
                GMacro_LX.Visible = True
                GMacro_LY.Visible = True
                GMacro_TX.Visible = True
                GMacro_TY.Visible = True
                GMacro_LAplicarActuales.Visible = True
                GMacro_LCAccion.Text = "Mover Ratón"
                Dim cPosition As Point = String_to_Point(GMacro_Lista.SelectedItems(0).Tag)
                GMacro_TX.Text = cPosition.X.ToString : GMacro_TY.Text = cPosition.Y.ToString
            Case NSListViewSK.NSListViewItemSK.TipoEN.MouseMoveR
                GMacro_CoorLMouse.Visible = False
                GMacro_CoorLX.Visible = False
                GMacro_CoorLY.Visible = False
                GMacro_CoorLCX.Visible = False
                GMacro_CoorLCY.Visible = False
                GMacro_LX.Visible = True
                GMacro_LY.Visible = True
                GMacro_TX.Visible = True
                GMacro_TY.Visible = True
                GMacro_LAplicarActuales.Visible = False
                GMacro_LCAccion.Text = "Desplazar Ratón"
                Dim cPosition As Point = String_to_Point(GMacro_Lista.SelectedItems(0).Tag)
                GMacro_TX.Text = cPosition.X.ToString : GMacro_TY.Text = cPosition.Y.ToString
            Case NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion
                GMacro_LPausa.Visible = True
                GMacro_TPausa.Visible = True
                GMacro_Lms.Visible = True
                GMacro_LCAccion.Text = "Pausar"
                GMacro_TPausa.Text = GMacro_Lista.SelectedItems(0).Tag
        End Select
        GMacro_EditandoCarga = False
    End Sub

    Private Sub GMacro_PCopiar_Click(sender As Object, e As MouseEventArgs) Handles GMacro_PCopiar.Click, GMacro_PCopiar.DoubleClick
        If e.Button <> MouseButtons.Left Or GMacro_Grabando = True Then Exit Sub
        If GMacro_Lista.SelectedItems.Count = 0 Then
            ReDim GMacro_CopiarLista(GMacro_Lista.Items.Count - 1)
            Dim Contador As Integer = 0
            For Cuenta = 0 To GMacro_Lista.Items.Count - 1
                GMacro_CopiarLista(Contador) = GMacro_Lista.Items(Cuenta) : Contador += 1
            Next
        Else
            ReDim GMacro_CopiarLista(GMacro_Lista.SelectedItems.Count - 1)
            Dim Contador As Integer = 0
            For Cuenta = 0 To GMacro_Lista.Items.Count - 1
                If GMacro_Lista.SelectedItems.Contains(GMacro_Lista.Items(Cuenta)) = True Then GMacro_CopiarLista(Contador) = GMacro_Lista.Items(Cuenta) : Contador += 1
            Next
        End If
    End Sub

    Private Sub GMacro_PPegar_Click(sender As Object, e As MouseEventArgs) Handles GMacro_PPegar.Click, GMacro_PPegar.DoubleClick
        If e.Button <> MouseButtons.Left Or GMacro_Grabando = True Then Exit Sub
        If GMacro_CopiarLista.Count > 0 Then GMacro_Lista.AddItem(GMacro_CopiarLista)
        GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1) : GMacro_Lista.Invalidate() : GuardarMacro()
    End Sub

    Private Sub GMacro_PSetTime_Click(sender As Object, e As MouseEventArgs) Handles GMacro_PSetTime.Click, GMacro_PSetTime.DoubleClick
        If e.Button <> MouseButtons.Left Or GMacro_Grabando = True Or GMacro_Lista.Items.Count = 0 Then Exit Sub
        GMacro_Lista.MultiSelect = False
        GMacro_Editando = True
        GMacro_EditandoCarga = True
        GMacro_GAñadirMacro.Visible = True
        GMacro_Separador2.Visible = True
        GMacro_Separador2.BringToFront()
        GMacro_LAñadirMacro.Visible = False
        GMacro_PPausas.Visible = True
    End Sub

    Private Sub GMacro_PResetTime_Click(sender As Object, e As MouseEventArgs) Handles GMacro_PResetTime.Click, GMacro_PResetTime.DoubleClick
        If e.Button <> MouseButtons.Left Or GMacro_Grabando = True Then Exit Sub
        For Cuenta = 0 To GMacro_Lista.Items.Count - 1
            If GMacro_Lista.Items(Cuenta).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion Then GMacro_Lista.Items(Cuenta).Tag = 0 : GMacro_Lista.Items(Cuenta).Text = "Pausar 0 ms."
        Next : GMacro_Lista.Invalidate() : GuardarMacro()
    End Sub

    Private Sub GMacro_PEliminar_Click(sender As Object, e As MouseEventArgs) Handles GMacro_PEliminar.Click, GMacro_PEliminar.DoubleClick
        If (e IsNot Nothing AndAlso e.Button <> MouseButtons.Left) Or GMacro_Lista.Items.Count = 0 Or (GMacro_Lista.SelectedIndex.Length = 0 OrElse GMacro_Lista.SelectedIndex(0) = -1) Or GMacro_Grabando = True Then Exit Sub
        Dim cIndex As Integer = GMacro_Lista.SelectedIndex(0)
        GMacro_Lista.RemoveItems(GMacro_Lista.SelectedItems)
        cIndex = Math.Min(cIndex, GMacro_Lista.Items.Count - 1)
        GMacro_Lista.SelectItem(cIndex) : GMacro_Lista.EnsureVisibleAt(cIndex)
        If GMacro_Lista.Items.Count = 0 Then GMacro_Lista_SelectedIndexChanged(sender, -1)
        GMacro_Lista.Invalidate() : GuardarMacro()
        If GMacro_Lista.Items.Count = 0 Then GMacro_GAñadirMacro.Visible = False : GMacro_LAñadirMacro.Visible = False : GMacro_Separador2.Visible = False : GMacro_Editando = False
    End Sub

    Private Sub GMacro_PClear_Click(sender As Object, e As MouseEventArgs) Handles GMacro_PClear.Click, GMacro_PClear.DoubleClick
        If e.Button <> MouseButtons.Left Or GMacro_Lista.Items.Count = 0 Or GMacro_Grabando = True Then Exit Sub
        If ShowMessageBox("¿Borrar todas las macros?", Version, MsgBoxStyle.YesNo) = DialogResult.Cancel Then Exit Sub
        GMacro_Lista.Clear() : If GMacro_Grabando = False Then GuardarMacro() : GMacro_GAñadirMacro.Visible = False : GMacro_LAñadirMacro.Visible = False : GMacro_Separador2.Visible = False : GMacro_Editando = False
    End Sub

    Private Sub GMacro_PGrabar_Click(sender As Object, e As MouseEventArgs) Handles GMacro_PGrabar.Click, GMacro_PGrabar.DoubleClick
        If (e IsNot Nothing AndAlso (e.Button <> MouseButtons.Left And e.Button <> MouseButtons.Right)) Then Exit Sub
        If GMacro_Pausar = True Then GMacro_Pausar = False : Exit Sub
        If GMacro_Grabando = True Then
            If e Is Nothing And GMacro_GrabandoOculto AndAlso GMacro_ESCs = 2 Then
                Opciones_OSD.Hide() : Dim Contador As Integer = 0
                If GMacro_CEventosTeclado.Checked = True Then
                    For Cuenta = GMacro_Lista.Items.Count - 1 To 0 Step -1
                        If Contador = 6 Then Exit For
                        If (GMacro_Lista.Items(Cuenta).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.KeyDown Or GMacro_Lista.Items(Cuenta).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.KeyUp) AndAlso GMacro_Lista.Items(Cuenta).Tag = "Escape" Then
                            GMacro_Lista.RemoveItemAt(Cuenta) : Contador += 1
                            If GMacro_CPausasEjecucion.Checked = True Then If Cuenta - 1 > -1 AndAlso GMacro_Lista.Items(Cuenta - 1).Tipo = NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion Then GMacro_Lista.RemoveItemAt(Cuenta - 1) : If Cuenta = 0 Then Exit For Else Cuenta -= 1
                        End If
                    Next
                End If
                GMacro_ESCs = -1 : ShowF("Show")
            End If
            GMacro_Grabando = False : GMacro_PGrabar.Image = My.Resources.Macro_GrabarNo : GMacro_Lista.Invalidate() : GuardarMacro()
        Else
            Estadisticas.Estadisticas.Macros_Grabadas += 1
            GMacro_Editando = False : GMacro_GAñadirMacro.Visible = False : GMacro_LAñadirMacro.Visible = False : GMacro_Separador2.Visible = False
            Keyboard.Hotkeys.Clear() : GMacro_PrimerComando = True : GMacro_Grabando = True : GMacro_GrabandoOculto = False : GMacro_PGrabar.Image = My.Resources.Macro_GrabarSi
        End If
        If (e IsNot Nothing AndAlso e.Button = MouseButtons.Right) And GMacro_Grabando = True Then
            Estadisticas.Estadisticas.Macros_Grabadas += 1 : Estadisticas.Guardar()
            GMacro_GrabandoOculto = True
            Opciones_OSD_Font = Opciones_MensajeIniciar_Fuente : Opciones_OSD_Color = Opciones_MensajeIniciar_Color
            ShowOSD("Presione ESC tres veces para detener la grabación", 5000)
            ShowF("Hide_Macro")
            GMacro_PGrabar.Image = My.Resources.Macro_GrabarSi_Off : GMacro_PGrabar.Invalidate()
        End If
    End Sub

    Private Sub GMacro_PGrabar_MouseDown(sender As Object, e As MouseEventArgs) Handles GMacro_PGrabar.MouseDown
        If e.Button <> MouseButtons.Left And e.Button <> MouseButtons.Right Then Exit Sub
        If GMacro_Grabando = True And (GMacro_CClicsRaton.Checked = True Or GMacro_CClicsRaton.Checked = True) Then
            GMacro_Pausar = True
            If GMacro_Grabando = True Then
                GMacro_Grabando = False : GMacro_PGrabar.Image = My.Resources.Macro_GrabarNo : GMacro_Lista.Invalidate() : GuardarMacro()
            Else
                Keyboard.Hotkeys.Clear() : GMacro_PrimerComando = True : GMacro_Grabando = True : GMacro_PGrabar.Image = My.Resources.Macro_GrabarSi
            End If
        End If
    End Sub

#End Region

#Region " Help "

    Private Sub GMacro_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GMacro_LHelp.Click, GMacro_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Macros" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GMacro_LHelp_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GMacro_LHelp.MouseEnter
        GMacro_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GMacro_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GMacro_LHelp.MouseLeave
        GMacro_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_Macros_Tooltips(sender As Object, e As EventArgs) Handles GMacro_PAñadir.MouseEnter, GMacro_PEditar.MouseEnter, GMacro_PCopiar.MouseEnter, GMacro_PPegar.MouseEnter, GMacro_PResetTime.MouseEnter, GMacro_PSetTime.MouseEnter, GMacro_PEliminar.MouseEnter, GMacro_PClear.MouseEnter, GMacro_PGrabar.MouseEnter, GMacro_CPausasEjecucion.MouseEnter, GMacro_LPausasEjecucion.MouseEnter, GMacro_CEventosTeclado.MouseEnter, GMacro_LEventosTeclado.MouseEnter, GMacro_CClicks_Position.MouseEnter, GMacro_LClicks_Position.MouseEnter, GMacro_CClicks_Position.MouseEnter, GMacro_LClicks_Position.MouseEnter, GMacro_CClicsRaton.MouseEnter, GMacro_LClicsRaton.MouseEnter, GMacro_CRuedaRaton.MouseEnter, GMacro_LRuedaRaton.MouseEnter, GMacro_CMovimientoRaton.MouseEnter, GMacro_LMovimientoRaton.MouseEnter, GMacro_CRepetir.MouseEnter, GMacro_LRepetir.MouseEnter, GMacro_CEsperar.MouseEnter, GMacro_LEsperar.MouseEnter, GMacro_LAccion.MouseEnter, GMacro_LCAccion.MouseEnter, GMacro_LPausa.MouseEnter, GMacro_LX.MouseEnter, GMacro_LY.MouseEnter, GMacro_CoorLX.MouseEnter, GMacro_CoorLY.MouseEnter, GMacro_CoorLCX.MouseEnter, GMacro_CoorLCY.MouseEnter, GMacro_LBoton.MouseEnter, GMacro_LCBoton.MouseEnter, GMacro_LTecla.MouseEnter, GMacro_BAñadirEvento.MouseEnter, GMacros_BAñadirPausa.MouseEnter, GMacro_LAñadirPausa.MouseEnter, GMacro_CoorLMouse.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GMacro_PAñadir" : Show_Tooltip(sender, "Añade un evento nuevo a la macro")
            Case "GMacro_PEditar" : Show_Tooltip(sender, "Edita el evento seleccionado")
            Case "GMacro_PCopiar" : Show_Tooltip(sender, "Copia el evento seleccionado")
            Case "GMacro_PPegar" : Show_Tooltip(sender, "Pega un evento previamente copiado")
            Case "GMacro_PResetTime" : Show_Tooltip(sender, "Establece todas las pausas de ejecución a '0 ms'")
            Case "GMacro_PSetTime" : Show_Tooltip(sender, "Permite establecer todas las pausas de ejecución a un valor")
            Case "GMacro_PEliminar" : Show_Tooltip(sender, "Elimina el evento seleccionado")
            Case "GMacro_PClear" : Show_Tooltip(sender, "Elimina todos los eventos de la macro")
            Case "GMacro_PGrabar" : If GMacro_Grabando = True Then Show_Tooltip(sender, "Detiene la grabación de la macro" + vbCrLf + vbCrLf + "Presione la tecla 'ESC' tres veces siguidas " + vbCrLf + "para detener la grabación") Else Show_Tooltip(sender, "Click Izquierdo: Comienza la grabación de la macro" + vbCrLf + "Click Derecho: Comienza la grabación de la macro y oculta la ventana de K-Desktop" + vbCrLf + vbCrLf + "Presione la tecla 'ESC' tres veces siguidas para detener la grabación")

            Case "GMacro_PausasEjecucion" : Show_Tooltip(sender, "Grabar las pausas de tiempo entre eventos")
            Case "GMacro_EventosTeclado" : Show_Tooltip(sender, "Grabar las pulsaciones de teclado")
            Case "GMacro_Clicks_Position" : Show_Tooltip(sender, "Graba los clicks del ratón y su posición en la pantalla")
            Case "GMacro_ClicsRaton" : Show_Tooltip(sender, "Graba los clicks del ratón")
            Case "GMacro_RuedaRaton" : Show_Tooltip(sender, "Graba los eventos de la rueda del ratón")
            Case "GMacro_MovimientoRaton" : Show_Tooltip(sender, "Graba la posición del ratón en la pantalla")
            Case "GMacro_Repetir" : Show_Tooltip(sender, "Repite la macro continuamente al ejecutarse")
            Case "GMacro_Esperar" : Show_Tooltip(sender, "Espera a que termine de ejcutarse la macro " + vbCrLf + "antes de seguir con la siguiente acción")

            Case "GMacro_Accion", "GMacro_CAccion"
                Select Case GMacro_LCAccion.Text
                    Case "Pausar" : Show_Tooltip(sender, "Añade una pausa de ejecución")
                    Case "Pulsar Tecla" : Show_Tooltip(sender, "Añade un evento 'Pulsar Tecla'")
                    Case "Soltar Tecla" : Show_Tooltip(sender, "Añade un evento 'Soltar Tecla'")
                    Case "Pulsar Ratón" : Show_Tooltip(sender, "Añade un evento 'Pulsar un botón del ratón'")
                    Case "Soltar Ratón" : Show_Tooltip(sender, "Añade un evento 'Soltar un botón del ratón'")
                    Case "Rueda Ratón" : Show_Tooltip(sender, "Añade un evento 'Rueda del ratón")
                    Case "Mover Ratón" : Show_Tooltip(sender, "Añade una posición del ratón en la pantalla")
                    Case "Desplazar Ratón" : Show_Tooltip(sender, "Añade un desplazamiento del ratón relativo a su posición")
                End Select
            Case "GMacro_Pausa" : Show_Tooltip(sender, "Tiempo en milisegundos de la pausa de ejecución")
            Case "GMacro_X" : If GMacro_LCAccion.Text = "Mover Ratón" Then Show_Tooltip(sender, "Coordenada X de la posición del ratón") Else Show_Tooltip(sender, "Valor que se añadirá o restará a la coordenada X del ratón")
            Case "GMacro_Y" : If GMacro_LCAccion.Text = "Mover Ratón" Then Show_Tooltip(sender, "Coordenada Y de la posición del ratón") Else Show_Tooltip(sender, "Valor que se añadirá o restará a la coordenada Y del ratón")
            Case "GMacro_oorLMouse" : Show_Tooltip(sender, "Muestra las coordenadas actuales del ratón")
            Case "GMacro_oorLX", "GMacro_oorLCX" : Show_Tooltip(sender, "Coordenada X de la posición actual del ratón")
            Case "GMacro_oorLY", "GMacro_oorLCY" : Show_Tooltip(sender, "Coordenada Y de la posición actual del ratón")
            Case "GMacro_Boton", "GMacro_CBoton"
                Select Case GMacro_LCBoton.Text
                    Case "Mouse 1", "Mouse 2", "Mouse 3", "Mouse 4", "Mouse 5" : Show_Tooltip(sender, "Botón del ratón que se añadirá al evento")
                    Case "Rueda Arriba", "Rueda Abajo", "Rueda Izquierda", "Rueda Derecha" : Show_Tooltip(sender, "Dirección de la rueda del ratón que se añadirá al evento")
                End Select
            Case "GMacro_Tecla" : Show_Tooltip(sender, "Tecla que se añadirá al evento")
            Case "GMacro_BAñadirEvento" : Show_Tooltip(sender, "Añadir un evento con los valores introducidos")
            Case "GMacro_AñadirPausa" : Show_Tooltip(sender, "Tiempo en milisegundos que se asignaran a todos las pausas de ejecución")
            Case "GMacros_BAñadirPausa" : Show_Tooltip(sender, "Establecer todas las pausas de ejecución con el valor introducido")
        End Select
    End Sub

#End Region

#End Region

#Region " K-Board "

#Region " Accion "

    Private Sub GKBoard_LCAccion_TextChanged(sender As Object, e As EventArgs) Handles GKBoard_LCAccion.TextChanged
        Select Case GKBoard_LCAccion.Text
            Case "K-Board (On/Off)"

            Case "Activar K-Board"

            Case "Desactivar K-Board"

            Case "Habilitar K-Board"

            Case "Deshabilitar K-Board"

        End Select : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GKBoard_TAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GKBoard_TAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GKBoard_TAccion_GotFocus(sender As Object, e As EventArgs) Handles GKBoard_TAccion.GotFocus
        GKBoard_TAccion.Text = GKBoard_TAccion.Text.Trim : GKBoard_TAccion.SelectionLength = 0 : HTexto.Focus()
    End Sub

    Private Sub GKBoard_TAccion_LostFocus(sender As Object, e As EventArgs) Handles GKBoard_TAccion.LostFocus
        GKBoard_TAccion.Text = GKBoard_TAccion.Text.Trim : GKBoard_TAccion.SelectionLength = 0 : GKBoard_LCAccion.Text = GKBoard_TAccion.Text
    End Sub

    Private Sub GKBoard_TAccion_Click(sender As Object, e As MouseEventArgs) Handles GKBoard_LCAccion.Click, GKBoard_TAccion.Click
        If e.Button = MouseButtons.Left Then GKBoard_CAccion.DroppedDown = True : GKBoard_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GKBoard_PAccion_Click(sender As Object, e As MouseEventArgs) Handles GKBoard_PAccion.Click, GKBoard_PAccion.DoubleClick
        If e.Button = MouseButtons.Left Then GKBoard_CAccion.DroppedDown = True : GKBoard_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GKBoard_PAccion_MouseEnter(sender As Object, e As EventArgs) Handles GKBoard_PAccion.MouseEnter
        GKBoard_PAccion.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GKBoard_PAccion_MouseLeave(sender As Object, e As EventArgs) Handles GKBoard_PAccion.MouseLeave
        GKBoard_PAccion.Image = My.Resources.CComandos_Off
    End Sub

#Region " Combo Accion "

    Private Sub GKBoard_CAccion_DropDown(sender As Object, e As EventArgs) Handles GKBoard_CAccion.DropDown
        GKBoard_CAccion.MaxDropDownItems = GKBoard_CAccion.Items.Count : Combo_Dropped = True : Combo_TempValue = GKBoard_TAccion.Text
        If GKBoard_CAccion.Items.Contains(GKBoard_TAccion.Text) = True Then GKBoard_CAccion.SelectedItem = GKBoard_TAccion.Text Else GKBoard_CAccion.SelectedIndex = 0
    End Sub

    Private Sub GKBoard_CAccion_DropDownClosed(sender As Object, e As EventArgs) Handles GKBoard_CAccion.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GKBoard_CAccion_LostFocus(sender As Object, e As EventArgs) Handles GKBoard_CAccion.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GKBoard_CAccion_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GKBoard_CAccion.SelectedIndexChanged
        If Combo_TempValue = "" Then GKBoard_TAccion.Text = GKBoard_CAccion.SelectedItem.Trim : GKBoard_LCAccion.Text = GKBoard_TAccion.Text : HTexto.Focus()
    End Sub

    Private Sub GKBoard_CAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GKBoard_CAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then GKBoard_TAccion.Text = GKBoard_CAccion.SelectedItem.Trim : GKBoard_LCAccion.Text = GKBoard_TAccion.Text : HTexto.Focus() : e.Handled = True
    End Sub

#End Region

#End Region

#Region " Nombre "

    Private Sub GKBoard_LCNombre_TextChanged(sender As Object, e As EventArgs) Handles GKBoard_LCNombre.TextChanged
        If GKBoard_LCNombre.Text = "No hay K-Boards" Or GKBoard_LCNombre.Text = "Seleccione un K-Board" Then GKBoard_PPreview.Visible = False Else GKBoard_PPreview.Visible = True
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GKBoard_LCNombre.Text, New Font(GKBoard_LCNombre.Font.Name, TextSize, FontStyle.Regular)).Width < GKBoard_LCNombre.Width Or TextSize < 4 : TextSize -= 1 : Loop : GKBoard_LCNombre.Font = New Font(GKBoard_LCNombre.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GKBoard_LCNombre_Click(sender As Object, e As MouseEventArgs) Handles GKBoard_LCNombre.Click, GKBoard_TNombre.Click
        If e.Button <> MouseButtons.Left Or GKBoard_CNombre.Items.Count = 0 Then HTexto.Focus() : Exit Sub
        GKBoard_CNombre.DroppedDown = True : GKBoard_CNombre.Focus()
    End Sub

    Private Sub GKBoard_TNombre_GotFocus(sender As Object, e As EventArgs) Handles GKBoard_TNombre.GotFocus
        HTexto.Focus()
    End Sub

#Region " Combo Nombre "

    Private Sub GKBoard_CNombre_DropDown(sender As Object, e As EventArgs) Handles GKBoard_CNombre.DropDown
        GKBoard_CNombre.MaxDropDownItems = 10 : Combo_Dropped = True : Combo_TempValue = GKBoard_LCNombre.Text
        If GKBoard_CNombre.Items.Contains(GKBoard_LCNombre.Text) = True Then GKBoard_CNombre.SelectedItem = GKBoard_LCNombre.Text Else GKBoard_CNombre.SelectedIndex = 0
    End Sub

    Private Sub GKBoard_CNombre_DropDownClosed(sender As Object, e As EventArgs) Handles GKBoard_CNombre.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GKBoard_CNombre_LostFocus(sender As Object, e As EventArgs) Handles GKBoard_CNombre.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GKBoard_CNombre_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GKBoard_CNombre.SelectionChangeCommitted
        GKBoard_LCNombre.Text = GKBoard_CNombre.SelectedItem.Trim : HTexto.Focus()
    End Sub

    Private Sub GKBoard_CNombre_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GKBoard_CNombre.KeyPress
        If Asc(e.KeyChar) = 13 Then GKBoard_LCNombre.Text = GKBoard_CNombre.SelectedItem.Trim : HTexto.Focus() : e.Handled = True
    End Sub

#End Region

#Region " Info "

    Private Sub GKBoard_PPreview_Click(sender As Object, e As MouseEventArgs) Handles GKBoard_PPreview.Click
        If e.Button <> MouseButtons.Left Then Exit Sub

    End Sub

#End Region

#End Region

#Region " OSD "

    Private Sub GKBoard_OSD_Click(sender As Object, e As MouseEventArgs) Handles GKBoard_LOSD.Click, GKBoard_LOSD.DoubleClick, GKBoard_COSD.Click, GKBoard_COSD.DoubleClick
        If e.Button = MouseButtons.Left Then
            If TypeOf sender Is NSLabel Then If GKBoard_COSD.Checked = True Then GKBoard_COSD.Checked = False Else GKBoard_COSD.Checked = True
            GKBoard_BOSD.Enabled = GKBoard_COSD.Checked : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        ElseIf e.Button = MouseButtons.Right Then
            If GKBoard_COSD.Checked = True And TypeOf sender Is NSLabel Then
                Opciones_OSD_Color = GKBoard_OSD_Color : Opciones_OSD_Font = GKBoard_OSD_Fuente : ShowOSD("Mensaje de prueba")
            End If
        End If
    End Sub

    Private Sub GKBoard_BOSD_Click(sender As Object, e As MouseEventArgs) Handles GKBoard_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = GKBoard_OSD_Fuente : Opciones_FontDialog.Color = GKBoard_OSD_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then GKBoard_OSD_Fuente = Opciones_FontDialog.Font : GKBoard_OSD_Color = Opciones_FontDialog.Color : GKBoard_BOSD.ForeColor1 = GKBoard_OSD_Color : GKBoard_BOSD.ForeColor3 = GKBoard_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = GKBoard_OSD_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then GKBoard_OSD_Color = Opciones_ColorDialog.Color : GKBoard_BOSD.ForeColor1 = GKBoard_OSD_Color : GKBoard_BOSD.ForeColor3 = GKBoard_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            GKBoard_OSD_Fuente = OSD_Default_Font : GKBoard_OSD_Color = Color.FromArgb(205, 150, 0) : GKBoard_BOSD.ForeColor1 = GKBoard_OSD_Color : GKBoard_BOSD.ForeColor3 = GKBoard_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : HTexto.Focus()
        Opciones_OSD_Color = GKBoard_OSD_Color : Opciones_OSD_Font = GKBoard_OSD_Fuente : ShowOSD("Mensaje de prueba")
    End Sub

#End Region

#Region " Help "

    Private Sub GKBoard_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GKBoard_LHelp.Click, GKBoard_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Accion K-Board" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GKBoard_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GKBoard_LHelp.MouseEnter
        GKBoard_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GKBoard_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GKBoard_LHelp.MouseLeave
        GKBoard_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_KBoard_Tooltips(sender As Object, e As EventArgs) Handles GKBoard_LAccion.MouseEnter, GKBoard_LCAccion.MouseEnter, GKBoard_LNombre.MouseEnter, GKBoard_LCNombre.MouseEnter, GKBoard_PPreview.MouseEnter, GKBoard_COSD.MouseEnter, GKBoard_LOSD.MouseEnter, GKBoard_BOSD.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GKBoard_OSD"
                If sender.Name = "GKBoard_COSD" Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
                If sender.Name = "GKBoard_LOSD" Then If GRedAdHoc_COSD.Checked = True Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción" + vbCrLf + "Nota: Click Derecho para previsualizar") Else Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
            Case "GKBoard_BOSD" : If GRedAdHoc_COSD.Checked = True Then Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "GKBoard_Accion", "GKBoard_CAccion"
                Select Case GKBoard_LCAccion.Text
                    Case "K-Board (On/Off)" : Show_Tooltip(sender, "Activa o desactiva el K-Board seleccionado" + vbCrLf + vbCrLf + "Activar / Desactivar: Ejecuta o detiene la ejecución del K-Board" + vbCrLf + "Habilitar / Deshabilitar: Permite o impide la ejecución del K-Board")
                    Case "Activar K-Board" : Show_Tooltip(sender, "Activa el K-Board seleccionado" + vbCrLf + vbCrLf + "Activar / Desactivar: Ejecuta o detiene la ejecución del K-Board" + vbCrLf + "Habilitar / Deshabilitar: Permite o impide la ejecución del K-Board")
                    Case "Desactivar K-Board" : Show_Tooltip(sender, "Desactiva el K-Board seleccionado" + vbCrLf + vbCrLf + "Activar / Desactivar: Ejecuta o detiene la ejecución del K-Board" + vbCrLf + "Habilitar / Deshabilitar: Permite o impide la ejecución del K-Board")
                    Case "Habilitar K-Board" : Show_Tooltip(sender, "Habilita el K-Board seleccionado" + vbCrLf + vbCrLf + "Activar / Desactivar: Ejecuta o detiene la ejecución del K-Board" + vbCrLf + "Habilitar / Deshabilitar: Permite o impide la ejecución del K-Board")
                    Case "Deshabilitar K-Board" : Show_Tooltip(sender, "Deshabilita el K-Board seleccionado" + vbCrLf + vbCrLf + "Activar / Desactivar: Ejecuta o detiene la ejecución del K-Board" + vbCrLf + "Habilitar / Deshabilitar: Permite o impide la ejecución del K-Board")
                End Select
            Case "GKBoard_Nombre" : Show_Tooltip(sender, "Aplicación a la que se le aplicará la accion")
            Case "GKBoard_CNombre"
                If GKBoard_LCNombre.Text = "No hay K-Boards" Then Show_Tooltip(sender, "No se ha creado ningún K-Board")
                If GKBoard_LCNombre.Text = "Seleccione un K-Board" Then Show_Tooltip(sender, "Selecciona un K-Board de la lista")
            Case "GKBoard_PPreview" : Show_Tooltip(sender, "Previsualizar el K-Board seleccionado")
        End Select
    End Sub

#End Region

#End Region

#Region " QuickMenu "

#Region " Nombre "

    Private Sub GQuickMenu_LCNombre_TextChanged(sender As Object, e As EventArgs) Handles GQuickMenu_LCNombre.TextChanged
        If GQuickMenu_LCNombre.Text = "No hay QuickMenus" Or GQuickMenu_LCNombre.Text = "Seleccione un QuickMenu" Then GQuickMenu_PQuickMenu.Visible = False Else GQuickMenu_PQuickMenu.Visible = True
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GQuickMenu_LCNombre.Text, New Font(GQuickMenu_LCNombre.Font.Name, TextSize, FontStyle.Regular)).Width < GQuickMenu_LCNombre.Width Or TextSize < 4 : TextSize -= 1 : Loop : GQuickMenu_LCNombre.Font = New Font(GQuickMenu_LCNombre.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GQuickMenu_LCNombre_Click(sender As Object, e As MouseEventArgs) Handles GQuickMenu_LCNombre.Click, GQuickMenu_TNombre.Click
        If e.Button <> MouseButtons.Left Or GQuickMenu_CNombre.Items.Count = 0 Then HTexto.Focus() : Exit Sub
        GQuickMenu_CNombre.DroppedDown = True : GQuickMenu_CNombre.Focus()
    End Sub

    Private Sub GQuickMenu_TNombre_GotFocus(sender As Object, e As EventArgs) Handles GQuickMenu_TNombre.GotFocus
        HTexto.Focus()
    End Sub

#Region " Combo Nombre "

    Private Sub GQuickMenu_CNombre_DropDown(sender As Object, e As EventArgs) Handles GQuickMenu_CNombre.DropDown
        GQuickMenu_CNombre.MaxDropDownItems = 10 : Combo_Dropped = True : Combo_TempValue = GQuickMenu_LCNombre.Text
        If GQuickMenu_CNombre.Items.Contains(GQuickMenu_LCNombre.Text) = True Then GQuickMenu_CNombre.SelectedItem = GQuickMenu_LCNombre.Text Else GQuickMenu_CNombre.SelectedIndex = 0
    End Sub

    Private Sub GQuickMenu_CNombre_DropDownClosed(sender As Object, e As EventArgs) Handles GQuickMenu_CNombre.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GQuickMenu_CNombre_LostFocus(sender As Object, e As EventArgs) Handles GQuickMenu_CNombre.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GQuickMenu_CNombre_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GQuickMenu_CNombre.SelectionChangeCommitted
        GQuickMenu_LCNombre.Text = GQuickMenu_CNombre.SelectedItem.Trim : HTexto.Focus()
    End Sub

    Private Sub GQuickMenu_CNombre_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GQuickMenu_CNombre.KeyPress
        If Asc(e.KeyChar) = 13 Then GQuickMenu_LCNombre.Text = GQuickMenu_CNombre.SelectedItem.Trim : HTexto.Focus() : e.Handled = True
    End Sub

#End Region

#Region " Info "

    Private Sub GQuickMenu_PQuickMenu_Click(sender As Object, e As MouseEventArgs) Handles GQuickMenu_PQuickMenu.Click
        If e.Button = MouseButtons.Left Then
            For Cuenta = 0 To QuickMenus.Length - 1
                If QuickMenus_F(Cuenta).Nombre = GQuickMenu_LCNombre.Text Then QuickMenus_F(Cuenta).Show(Left + 500, Top + 510) : QuickMenu_Editor_ZOrder = False : Exit Sub
            Next
        ElseIf e.Button = MouseButtons.Middle Then
            Paneles_Click(BPanelQuickMenu, Nothing) : QuickMenu_Nombre_CNombre.SelectedItem = GQuickMenu_LCNombre.Text : QuickMenu_Editor_Load(GQuickMenu_LCNombre.Text)
        End If
    End Sub

#End Region

#End Region

#Region " Help "

    Private Sub GQuickMenu_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GQuickMenu_LHelp.Click, GQuickMenu_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Accion QuickMenu" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GQuickMenu_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GQuickMenu_LHelp.MouseEnter
        GQuickMenu_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GQuickMenu_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GQuickMenu_LHelp.MouseLeave
        GQuickMenu_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_QuickMenu_Tooltips(sender As Object, e As EventArgs) Handles GQuickMenu_LNombre.MouseEnter, GQuickMenu_LCNombre.MouseEnter, GQuickMenu_PQuickMenu.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GQuickMenu_Nombre" : Show_Tooltip(sender, "QuickMenu que se mostrará al ejecutar la acción")
            Case "GQuickMenu_CNombre"
                If GQuickMenu_LCNombre.Text = "No hay QuickMenus" Then Show_Tooltip(sender, "No se ha creado ningún QuickMenu")
                If GQuickMenu_LCNombre.Text = "Seleccione un QuickMenu" Then Show_Tooltip(sender, "Selecciona un QuickMenu de la lista")
            Case "GQuickMenu_PQuickMenu" : Show_Tooltip(sender, "Mostrar el QuickMenu seleccionado")
        End Select
    End Sub

#End Region

#End Region

#Region " Red Ad-Hoc "

#Region " Textos "

    Private Sub GRedAdHoc_Textos_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GRedAdHoc_TNombre.KeyPress, GRedAdHoc_TContraseña.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GRedAdHoc_Textos_LostFocus(sender As Object, e As EventArgs) Handles GRedAdHoc_TNombre.LostFocus, GRedAdHoc_TContraseña.LostFocus
        GRedAdHoc_TNombre.Text = GRedAdHoc_TNombre.Text.Substring(0, 1).ToUpper + GRedAdHoc_TNombre.Text.Substring(1)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GRedAdHoc_Textos_TextChanged(sender As Object, e As EventArgs) Handles GRedAdHoc_TNombre.TextChanged, GRedAdHoc_TContraseña.TextChanged
        If GRedAdHoc_TContraseña.Text.Length >= 8 Then GRedAdHoc_BCrearRed.Enabled = True Else GRedAdHoc_BCrearRed.Enabled = False
    End Sub

#End Region

#Region " Sonido "

    Private Sub GRedAdHoc_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles GRedAdHoc_LCSonido.TextChanged
        GRedAdHoc_TSonido.Enabled = False
        GRedAdHoc_LCSonido.Text = Rutas.Acortar_Ruta(GRedAdHoc_TSonido.Text, GRedAdHoc_LCSonido)
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GRedAdHoc_LCSonido.Text, New Font(GRedAdHoc_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < GRedAdHoc_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : GRedAdHoc_LCSonido.Font = New Font(GRedAdHoc_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GRedAdHoc_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles GRedAdHoc_LCSonido.Click, GRedAdHoc_TSonido.Click
        If GRedAdHoc_CSonido.Enabled = False Then HTexto.Focus() : Exit Sub
        If e.Button = MouseButtons.Left Then
            GRedAdHoc_CSonido.DroppedDown = True : GRedAdHoc_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            GRedAdHoc_LCSonido.Visible = False : Combo_IgnoreOne = True : GRedAdHoc_TSonido.ReadOnly = False : GRedAdHoc_TSonido.Enabled = True : GRedAdHoc_TSonido.Cursor = Cursors.IBeam : GRedAdHoc_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub GRedAdHoc_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GRedAdHoc_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GRedAdHoc_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles GRedAdHoc_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GRedAdHoc_CSonido.DroppedDown = True : GRedAdHoc_CSonido.Focus()
    End Sub

    Private Sub GRedAdHoc_TSonido_GotFocus(sender As Object, e As EventArgs) Handles GRedAdHoc_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub GRedAdHoc_TSonido_LostFocus(sender As Object, e As EventArgs) Handles GRedAdHoc_TSonido.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GRedAdHoc_LCSonido.Visible = False Then GRedAdHoc_LCSonido.Visible = True : GRedAdHoc_TSonido.ReadOnly = True : GRedAdHoc_TSonido.Enabled = False : GRedAdHoc_TSonido.Cursor = Cursors.Arrow
        If IO.File.Exists(GRedAdHoc_TSonido.Text) = False And GRedAdHoc_CSonido.Items.Contains(StrConv(GRedAdHoc_TSonido.Text, VbStrConv.ProperCase)) = False Then GRedAdHoc_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To GRedAdHoc_CSonido.Items.Count - 1
            If GRedAdHoc_TSonido.Text.ToLower = GRedAdHoc_CSonido.Items(Cuenta).ToLower Then GRedAdHoc_TSonido.Text = GRedAdHoc_CSonido.Items(Cuenta)
        Next : GRedAdHoc_TSonido.Text = GRedAdHoc_TSonido.Text.Trim : GRedAdHoc_TSonido.SelectionLength = 0 : GRedAdHoc_LCSonido.Text = GRedAdHoc_TSonido.Text
    End Sub

    Private Sub GRedAdHoc_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles GRedAdHoc_TSonido.MouseEnter, GRedAdHoc_CSonido.MouseEnter
        GRedAdHoc_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub GRedAdHoc_CSonido_DropDown(sender As Object, e As EventArgs) Handles GRedAdHoc_CSonido.DropDown
        GRedAdHoc_TSonido.Enabled = True
        GRedAdHoc_CSonido.MaxDropDownItems = GRedAdHoc_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = GRedAdHoc_TSonido.Text
        If GRedAdHoc_CSonido.Items.Contains(GRedAdHoc_TSonido.Text) = True Then GRedAdHoc_CSonido.SelectedItem = GRedAdHoc_TSonido.Text Else GRedAdHoc_CSonido.SelectedIndex = 0
    End Sub

    Private Sub GRedAdHoc_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles GRedAdHoc_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GRedAdHoc_CSonido_LostFocus(sender As Object, e As EventArgs) Handles GRedAdHoc_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GRedAdHoc_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GRedAdHoc_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then GRedAdHoc_TSonido.Text = GRedAdHoc_CSonido.SelectedItem.Trim : GRedAdHoc_LCSonido.Text = GRedAdHoc_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub GRedAdHoc_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GRedAdHoc_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then GRedAdHoc_TSonido.Text = GRedAdHoc_CSonido.SelectedItem.Trim : GRedAdHoc_LCSonido.Text = GRedAdHoc_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub GRedAdHoc_CSonido_ItemHover(Index As Integer) Handles GRedAdHoc_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub GRedAdHoc_BPlay_Click(sender As Object, e As MouseEventArgs) Handles GRedAdHoc_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GRedAdHoc_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(GRedAdHoc_TSonido.Text)
    End Sub

    Private Sub GRedAdHoc_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles GRedAdHoc_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then GRedAdHoc_TSonido.Text = Abrir.FileName : GRedAdHoc_LCSonido.Text = GRedAdHoc_TSonido.Text : Sonidos.Play_Block(GRedAdHoc_TSonido.Text)
        GRedAdHoc_TSonido.SelectionStart = GRedAdHoc_TSonido.Text.Length : GRedAdHoc_TSonido.SelectionLength = 0
        GRedAdHoc_BExaminar.State = NSButton.MouseState.None : GRedAdHoc_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub GRedAdHoc_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles GRedAdHoc_BExaminar.MouseEnter
        GRedAdHoc_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " OSD "

    Private Sub GRedAdHoc_OSD_Click(sender As Object, e As MouseEventArgs) Handles GRedAdHoc_LOSD.Click, GRedAdHoc_LOSD.DoubleClick, GRedAdHoc_COSD.Click, GRedAdHoc_COSD.DoubleClick
        If e.Button = MouseButtons.Left Then
            If TypeOf sender Is NSLabel Then If GRedAdHoc_COSD.Checked = True Then GRedAdHoc_COSD.Checked = False Else GRedAdHoc_COSD.Checked = True
            GRedAdHoc_BOSD.Enabled = GRedAdHoc_COSD.Checked : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        ElseIf e.Button = MouseButtons.Right Then
            If GRedAdHoc_COSD.Checked = True And TypeOf sender Is NSLabel Then
                Opciones_OSD_Color = GRedAdHoc_OSD_Color : Opciones_OSD_Font = GRedAdHoc_OSD_Fuente : ShowOSD("Mensaje de prueba")
            End If
        End If
    End Sub

    Private Sub GRedAdhoc_BOSD_Click(sender As Object, e As MouseEventArgs) Handles GRedAdHoc_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = GRedAdHoc_OSD_Fuente : Opciones_FontDialog.Color = GRedAdHoc_OSD_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then GRedAdHoc_OSD_Fuente = Opciones_FontDialog.Font : GRedAdHoc_OSD_Color = Opciones_FontDialog.Color : GRedAdHoc_BOSD.ForeColor1 = GRedAdHoc_OSD_Color : GRedAdHoc_BOSD.ForeColor3 = GRedAdHoc_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = GRedAdHoc_OSD_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then GRedAdHoc_OSD_Color = Opciones_ColorDialog.Color : GRedAdHoc_BOSD.ForeColor1 = GRedAdHoc_OSD_Color : GRedAdHoc_BOSD.ForeColor3 = GRedAdHoc_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            GRedAdHoc_OSD_Fuente = OSD_Default_Font : GRedAdHoc_OSD_Color = Color.FromArgb(205, 150, 0) : GRedAdHoc_BOSD.ForeColor1 = GRedAdHoc_OSD_Color : GRedAdHoc_BOSD.ForeColor3 = GRedAdHoc_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : HTexto.Focus()
        Opciones_OSD_Color = GRedAdHoc_OSD_Color : Opciones_OSD_Font = GRedAdHoc_OSD_Fuente : ShowOSD("Mensaje de prueba")
    End Sub

#End Region

#Region " Botones "

    Private Sub GRedAdHoc_BCrearRed_Click(sender As Object, e As MouseEventArgs) Handles GRedAdHoc_BCrearRed.Click
        GRedAdHoc_BCrearRed.Width = 96 : GRedAdHoc_BCrearRed.Text = "Modificar Red" : GRedAdHoc_BCerrarRed.Visible = True : Crear_Red_AdHoc(GRedAdHoc_TNombre.Text, GRedAdHoc_TContraseña.Text)
    End Sub

    Private Sub GRedAdHoc_BCerrarRed_Click(sender As Object, e As MouseEventArgs) Handles GRedAdHoc_BCerrarRed.Click
        GRedAdHoc_BCrearRed.Width = 118 : GRedAdHoc_BCrearRed.Text = "Crear Red" : GRedAdHoc_BCerrarRed.Visible = False : Crear_Red_AdHoc(GRedAdHoc_TNombre.Text, GRedAdHoc_TContraseña.Text, True)
    End Sub

#End Region

#Region " Funciones "

    Private Sub Crear_Red_AdHoc(Nombre As String, Contraseña As String, Optional Cerrar As Boolean = False)
        Dim p As New Process()
        p.StartInfo.CreateNoWindow = True : p.StartInfo.WindowStyle = ProcessWindowStyle.Hidden : p.StartInfo.RedirectStandardOutput = False : p.StartInfo.UseShellExecute = False : p.StartInfo.FileName = "cmd.exe"
        If Cerrar = False Then
            p.StartInfo.Arguments = " /C " + "netsh wlan set hostednetwork mode=allow ssid=" + Nombre + " key=" + Contraseña + " && netsh wlan start hostednetwork" : p.Start() : ICS()
        Else
            p.StartInfo.Arguments = " /C " + "netsh wlan stop hostednetwork" : p.Start()
        End If
    End Sub

    Private Function Red_AdHoc_Soportada() As Boolean
        Dim p As New Process()
        p.StartInfo.CreateNoWindow = True : p.StartInfo.WindowStyle = ProcessWindowStyle.Hidden : p.StartInfo.RedirectStandardOutput = True : p.StartInfo.UseShellExecute = False
        p.StartInfo.FileName = "cmd.exe" : p.StartInfo.Arguments = " /C " + "netsh wlan show drivers" : p.Start()
        Dim Texto As String = p.StandardOutput.ReadToEnd.ToString.ToLower
        If Texto.Contains("red hospedada admitida: s¡") = True Or Texto.Contains("hosted network supported: yes") = True Then Return True Else Return False
    End Function

    Private Function Red_AdHoc_Activa() As Boolean
        Try : For Each NetworkCard As Net.NetworkInformation.NetworkInterface In Net.NetworkInformation.NetworkInterface.GetAllNetworkInterfaces
                If NetworkCard.Description = "Microsoft Hosted Network Virtual Adapter" Then
                    If NetworkCard.OperationalStatus = Net.NetworkInformation.OperationalStatus.Up Then Return True
                End If
            Next
        Catch : End Try : Return False
    End Function

    Private Function GetCMDValue(Command As String, Key As String, Optional ValueSeparator As String = ":") As String
        Dim p As New Process()
        p.StartInfo.CreateNoWindow = True : p.StartInfo.WindowStyle = ProcessWindowStyle.Hidden : p.StartInfo.RedirectStandardOutput = True : p.StartInfo.UseShellExecute = False
        p.StartInfo.FileName = "cmd.exe" : p.StartInfo.Arguments = " /C " + Command : p.Start()
        Dim Line As String : Do Until p.StandardOutput.EndOfStream
            Line = p.StandardOutput.ReadLine.Trim : If Line.ToLower.StartsWith(Key.ToLower) Then Return Line.Split(ValueSeparator)(1).Trim
        Loop : Return ""
    End Function

    Private Sub ICS()
        Dim AdHocNetwork As String = "" : Dim LocalNetwork As String = "" : If Internet.IsConnectedToInternet() = True Then LocalNetwork = GetBestInterface(Net.Dns.GetHostEntry("www.google.com").AddressList.First, 80).Name : If LocalNetwork Is Nothing Then LocalNetwork = ""
        For Each NetworkCard As Net.NetworkInformation.NetworkInterface In Net.NetworkInformation.NetworkInterface.GetAllNetworkInterfaces
            'For Each GatewayAddr As Net.NetworkInformation.GatewayIPAddressInformation In NetworkCard.GetIPProperties.GatewayAddresses
            '    If GatewayAddr.Address.ToString <> "0.0.0.0" And NetworkCard.OperationalStatus.ToString() = "Up" Then LocalNetwork = NetworkCard.Name
            'Next
            If NetworkCard.Description = "Microsoft Hosted Network Virtual Adapter" Then
                Dim objShell, objFolder, colItems, objItem : objShell = CreateObject("Shell.Application") : objFolder = objShell.Namespace(&H31&) : colItems = objFolder.Items
                For Each objItem In colItems
                    If objItem.Name = NetworkCard.Name Then objItem.Name = "AdHoc Network" : Exit For
                Next : AdHocNetwork = "AdHoc Network" : Exit For
            End If
        Next : If LocalNetwork = "" Or AdHocNetwork = "" Then Exit Sub
        Dim oNetSharingManager, oConnectionCollection, oItem, EveryConnection, objNCProps : oNetSharingManager = CreateObject("HNetCfg.HNetShare.1")
        oConnectionCollection = oNetSharingManager.EnumEveryConnection : For Each oItem In oConnectionCollection
            EveryConnection = oNetSharingManager.INetSharingConfigurationForINetConnection(oItem) : objNCProps = oNetSharingManager.NetConnectionProps(oItem)
            If objNCProps.name = AdHocNetwork Then EveryConnection.EnableSharing(1)
            If objNCProps.name = LocalNetwork Then EveryConnection.EnableSharing(0)
        Next
    End Sub

    Private Function GetBestInterface(address As Net.IPAddress, port As Integer) As Net.NetworkInformation.NetworkInterface
        Try : Dim socket As New Net.Sockets.Socket(Net.Sockets.AddressFamily.InterNetwork, Net.Sockets.SocketType.Stream, Net.Sockets.ProtocolType.IP) : Dim outgoingInterface As Net.NetworkInformation.NetworkInterface = Nothing
            socket.Connect(New Net.IPEndPoint(address, port)) : Threading.Thread.Sleep(250)
            If socket.Connected Then
                Dim interfaces As List(Of Net.NetworkInformation.NetworkInterface) = Net.NetworkInformation.NetworkInterface.GetAllNetworkInterfaces.ToList()
                For Each nic As Net.NetworkInformation.NetworkInterface In interfaces
                    Dim properties As Net.NetworkInformation.IPInterfaceProperties = nic.GetIPProperties
                    For Each unicastAddress In properties.UnicastAddresses
                        If unicastAddress.Address.Equals(DirectCast(socket.LocalEndPoint, Net.IPEndPoint).Address) Then outgoingInterface = nic
                    Next
                Next : Return outgoingInterface
            End If
        Catch : End Try : Return Nothing
    End Function

#End Region

#Region " Help "

    Private Sub GRedAdHoc_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GRedAdHoc_LHelp.Click, GRedAdHoc_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Red Ad-Hoc" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GRedAdHoc_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GRedAdHoc_LHelp.MouseEnter
        GRedAdHoc_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GRedAdHoc_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GRedAdHoc_LHelp.MouseLeave
        GRedAdHoc_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_RedAdHoc_Tooltips(sender As Object, e As EventArgs) Handles GRedAdHoc_COSD.MouseEnter, GRedAdHoc_LOSD.MouseEnter, GRedAdHoc_BOSD.MouseEnter, GRedAdHoc_LSonido.MouseEnter, GRedAdHoc_BPlay.MouseEnter, GRedAdHoc_BExaminar.MouseEnter, GRedAdHoc_LNombre.MouseEnter, GRedAdHoc_LContraseña.MouseEnter, GRedAdHoc_BCrearRed.MouseEnter, GRedAdHoc_BCerrarRed.MouseEnter, GRedAdHoc_LCSonido.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GRedAdHoc_OSD"
                If sender.Name = "GRedAdHoc_COSD" Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
                If sender.Name = "GRedAdHoc_LOSD" Then If GRedAdHoc_COSD.Checked = True Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción" + vbCrLf + "Nota: Click Derecho para previsualizar") Else Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
            Case "GRedAdHoc_BOSD" : If GRedAdHoc_COSD.Checked = True Then Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "GRedAdHoc_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción")
            Case "GRedAdHoc_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "GRedAdHoc_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "GRedAdHoc_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
            Case "GRedAdHoc_Nombre" : Show_Tooltip(sender, "Nombre que se le asignarará a la 'Red Ad-Hoc' (SSID)")
            Case "GRedAdHoc_Contraseña" : Show_Tooltip(sender, "Contraseña de la 'Red Ad-Hoc'")
            Case "GRedAdHoc_BCrearRed" : If GRedAdHoc_BCrearRed.Text = "Crear Red" Then Show_Tooltip(sender, "Crear una 'Red Ad-Hoc' con los valores introducidos") Else Show_Tooltip(sender, "Modificar la configuración de la 'Red Ad-Hoc'")
            Case "GRedAdHoc_BCerrarRed" : Show_Tooltip(sender, "Desconectar y eliminar la 'Red Ad-Hoc'")
        End Select
    End Sub

#End Region

#End Region

#End Region

#Region " Acciones "

#Region " Enviar Pulsacion "

#Region " Accion "

    Private Sub GEnviarPulsacion_LCAccion_TextChanged(sender As Object, e As EventArgs) Handles GEnviarPulsacion_LCAccion.TextChanged
        Select Case GEnviarPulsacion_LCAccion.Text
            Case "Enviar Pulsación"
                GEnviarPulsacion_LTexto.Visible = False : GEnviarPulsacion_TTexto.Visible = False
                GEnviarPulsacion_LPulsacion.Visible = True : GEnviarPulsacion_TPulsacion.Visible = True : GEnviarPulsacion_LCPulsacion.Visible = True : GEnviarPulsacion_CPulsacion.Visible = True : GEnviarPulsacion_PPulsacion.Visible = True
                GEnviarPulsacion_LCTRL.Visible = True : GEnviarPulsacion_CCTRL.Visible = True
                GEnviarPulsacion_LSHIFT.Visible = True : GEnviarPulsacion_CSHIFT.Visible = True
                GEnviarPulsacion_LALT.Visible = True : GEnviarPulsacion_CALT.Visible = True
                GEnviarPulsacion_LWIN.Visible = True : GEnviarPulsacion_CWin.Visible = True
                GEnviarPulsacion_LX.Visible = False : GEnviarPulsacion_CoorLX.Visible = False : GEnviarPulsacion_CoorLCX.Visible = False : GEnviarPulsacion_TX.Visible = False
                GEnviarPulsacion_LY.Visible = False : GEnviarPulsacion_CoorLY.Visible = False : GEnviarPulsacion_CoorLCY.Visible = False : GEnviarPulsacion_TY.Visible = False
                GEnviarPulsacion_CoorLMouse.Visible = False : GEnviarPulsacion_LAplicarActuales.Visible = False
                GEnviarPulsacion_TTexto.Text = "" : GEnviarPulsacion_TX.Text = "0" : GEnviarPulsacion_TY.Text = "0"
            Case "Mover Ratón"
                GEnviarPulsacion_LPulsacion.Visible = False : GEnviarPulsacion_TPulsacion.Visible = False : GEnviarPulsacion_LCPulsacion.Visible = False : GEnviarPulsacion_CPulsacion.Visible = False : GEnviarPulsacion_PPulsacion.Visible = False
                GEnviarPulsacion_LTexto.Visible = True : GEnviarPulsacion_TTexto.Visible = True
                GEnviarPulsacion_LCTRL.Visible = False : GEnviarPulsacion_CCTRL.Visible = False
                GEnviarPulsacion_LSHIFT.Visible = False : GEnviarPulsacion_CSHIFT.Visible = False
                GEnviarPulsacion_LALT.Visible = False : GEnviarPulsacion_CALT.Visible = False
                GEnviarPulsacion_LWIN.Visible = False : GEnviarPulsacion_CWin.Visible = False
                GEnviarPulsacion_LTexto.Visible = False : GEnviarPulsacion_TTexto.Visible = False
                GEnviarPulsacion_LX.Visible = True : GEnviarPulsacion_CoorLX.Visible = True : GEnviarPulsacion_CoorLCX.Visible = True : GEnviarPulsacion_TX.Visible = True
                GEnviarPulsacion_LY.Visible = True : GEnviarPulsacion_CoorLY.Visible = True : GEnviarPulsacion_CoorLCY.Visible = True : GEnviarPulsacion_TY.Visible = True
                GEnviarPulsacion_CoorLMouse.Visible = True : GEnviarPulsacion_LAplicarActuales.Visible = True
                GEnviarPulsacion_TTexto.Text = "" : GEnviarPulsacion_TPulsacion.Text = "" : GEnviarPulsacion_LCPulsacion.Text = "" : GEnviarPulsacion_TX.Text = "0" : GEnviarPulsacion_TY.Text = "0"
            Case "Desplazar Ratón"
                GEnviarPulsacion_LPulsacion.Visible = False : GEnviarPulsacion_TPulsacion.Visible = False : GEnviarPulsacion_LCPulsacion.Visible = False : GEnviarPulsacion_CPulsacion.Visible = False : GEnviarPulsacion_PPulsacion.Visible = False
                GEnviarPulsacion_LTexto.Visible = True : GEnviarPulsacion_TTexto.Visible = True
                GEnviarPulsacion_LCTRL.Visible = False : GEnviarPulsacion_CCTRL.Visible = False
                GEnviarPulsacion_LSHIFT.Visible = False : GEnviarPulsacion_CSHIFT.Visible = False
                GEnviarPulsacion_LALT.Visible = False : GEnviarPulsacion_CALT.Visible = False
                GEnviarPulsacion_LWIN.Visible = False : GEnviarPulsacion_CWin.Visible = False
                GEnviarPulsacion_LTexto.Visible = False : GEnviarPulsacion_TTexto.Visible = False
                GEnviarPulsacion_LX.Visible = True : GEnviarPulsacion_CoorLX.Visible = False : GEnviarPulsacion_CoorLCX.Visible = False : GEnviarPulsacion_TX.Visible = True
                GEnviarPulsacion_LY.Visible = True : GEnviarPulsacion_CoorLY.Visible = False : GEnviarPulsacion_CoorLCY.Visible = False : GEnviarPulsacion_TY.Visible = True
                GEnviarPulsacion_CoorLMouse.Visible = False : GEnviarPulsacion_LAplicarActuales.Visible = False
                GEnviarPulsacion_TTexto.Text = "" : GEnviarPulsacion_TPulsacion.Text = "" : GEnviarPulsacion_LCPulsacion.Text = "" : GEnviarPulsacion_TX.Text = "0" : GEnviarPulsacion_TY.Text = "0"
            Case "Enviar Texto"
                GEnviarPulsacion_LPulsacion.Visible = False : GEnviarPulsacion_TPulsacion.Visible = False : GEnviarPulsacion_LCPulsacion.Visible = False : GEnviarPulsacion_CPulsacion.Visible = False : GEnviarPulsacion_PPulsacion.Visible = False
                GEnviarPulsacion_LTexto.Visible = True : GEnviarPulsacion_TTexto.Visible = True
                GEnviarPulsacion_LCTRL.Visible = False : GEnviarPulsacion_CCTRL.Visible = False
                GEnviarPulsacion_LSHIFT.Visible = False : GEnviarPulsacion_CSHIFT.Visible = False
                GEnviarPulsacion_LALT.Visible = False : GEnviarPulsacion_CALT.Visible = False
                GEnviarPulsacion_LWIN.Visible = False : GEnviarPulsacion_CWin.Visible = False
                GEnviarPulsacion_LX.Visible = False : GEnviarPulsacion_CoorLX.Visible = False : GEnviarPulsacion_CoorLCX.Visible = False : GEnviarPulsacion_TX.Visible = False
                GEnviarPulsacion_LY.Visible = False : GEnviarPulsacion_CoorLY.Visible = False : GEnviarPulsacion_CoorLCY.Visible = False : GEnviarPulsacion_TY.Visible = False
                GEnviarPulsacion_CoorLMouse.Visible = False : GEnviarPulsacion_LAplicarActuales.Visible = False
                If GEnviarPulsacion_TTexto.Text.Trim = "" Then GEnviarPulsacion_TTexto.Text = "Texto a enviar" : GEnviarPulsacion_TTexto.ForeColor1 = Color.FromArgb(72, 72, 72)
                GEnviarPulsacion_TPulsacion.Text = "" : GEnviarPulsacion_LCPulsacion.Text = "" : GEnviarPulsacion_TX.Text = "0" : GEnviarPulsacion_TY.Text = "0"
        End Select : If Comandos_Accion_ListaAccion.SelectedItems.Length > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GEnviarPulsacion_TAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEnviarPulsacion_TAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GEnviarPulsacion_TAccion_GotFocus(sender As Object, e As EventArgs) Handles GEnviarPulsacion_TAccion.GotFocus
        GEnviarPulsacion_TAccion.Text = GEnviarPulsacion_TAccion.Text.Trim : GEnviarPulsacion_TAccion.SelectionLength = 0 : HTexto.Focus()
    End Sub

    Private Sub GEnviarPulsacion_TAccion_LostFocus(sender As Object, e As EventArgs) Handles GEnviarPulsacion_TAccion.LostFocus
        GEnviarPulsacion_TAccion.Text = GEnviarPulsacion_TAccion.Text.Trim : GEnviarPulsacion_TAccion.SelectionLength = 0 : GEnviarPulsacion_LCAccion.Text = GEnviarPulsacion_TAccion.Text
    End Sub

    Private Sub GEnviarPulsacion_TAccion_MouseEnter(sender As Object, e As EventArgs) Handles GEnviarPulsacion_TAccion.MouseEnter, GEnviarPulsacion_CAccion.MouseEnter
        GEnviarPulsacion_CAccion.State = NSComboBox.MouseState.None
    End Sub

    Private Sub GEnviarPulsacion_TAccion_Click(sender As Object, e As MouseEventArgs) Handles GEnviarPulsacion_LCAccion.Click, GEnviarPulsacion_TAccion.Click
        If e.Button = MouseButtons.Left Then GEnviarPulsacion_CAccion.DroppedDown = True : GEnviarPulsacion_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GEnviarPulsacion_PAccion_Click(sender As Object, e As MouseEventArgs) Handles GEnviarPulsacion_PAccion.Click, GEnviarPulsacion_PAccion.DoubleClick
        If e.Button = MouseButtons.Left Then GEnviarPulsacion_CAccion.DroppedDown = True : GEnviarPulsacion_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GEnviarPulsacion_PAccion_MouseEnter(sender As Object, e As EventArgs) Handles GEnviarPulsacion_PAccion.MouseEnter
        GEnviarPulsacion_PAccion.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GEnviarPulsacion_PAccion_MouseLeave(sender As Object, e As EventArgs) Handles GEnviarPulsacion_PAccion.MouseLeave
        GEnviarPulsacion_PAccion.Image = My.Resources.CComandos_Off
    End Sub

#Region " Combo Accion "

    Private Sub GEnviarPulsacion_CAccion_DropDown(sender As Object, e As EventArgs) Handles GEnviarPulsacion_CAccion.DropDown
        GEnviarPulsacion_CAccion.MaxDropDownItems = GEnviarPulsacion_CAccion.Items.Count : Combo_Dropped = True : Combo_TempValue = GEnviarPulsacion_TAccion.Text
        If GEnviarPulsacion_CAccion.Items.Contains(GEnviarPulsacion_TAccion.Text) = True Then GEnviarPulsacion_CAccion.SelectedItem = GEnviarPulsacion_TAccion.Text Else GEnviarPulsacion_CAccion.SelectedIndex = 0
    End Sub

    Private Sub GEnviarPulsacion_CAccion_DropDownClosed(sender As Object, e As EventArgs) Handles GEnviarPulsacion_CAccion.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GEnviarPulsacion_CAccion_LostFocus(sender As Object, e As EventArgs) Handles GEnviarPulsacion_CAccion.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GEnviarPulsacion_CAccion_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GEnviarPulsacion_CAccion.SelectedIndexChanged
        If Combo_TempValue = "" Then
            GEnviarPulsacion_TAccion.Text = GEnviarPulsacion_CAccion.SelectedItem.Trim
            GEnviarPulsacion_LCAccion.Text = GEnviarPulsacion_TAccion.Text
            If NoFocusLista = False Then HTexto.Focus()
        End If
    End Sub

    Private Sub GEnviarPulsacion_CAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEnviarPulsacion_CAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then GEnviarPulsacion_TAccion.Text = GEnviarPulsacion_CAccion.SelectedItem.Trim : GEnviarPulsacion_LCAccion.Text = GEnviarPulsacion_TAccion.Text : HTexto.Focus() : e.Handled = True
    End Sub

#End Region

#End Region

#Region " Pulsacion "

#Region " TPulsacion "

    Private Sub GEnviarPulsacion_Pulsacion_DoubleClick(sender As Object, e As EventArgs) Handles GEnviarPulsacion_TPulsacion.DoubleClick, GEnviarPulsacion_LCPulsacion.DoubleClick
        GEnviarPulsacion_TPulsacion.Text = "" : GEnviarPulsacion_TPulsacion.Tag = ""
        GEnviarPulsacion_CWin.Checked = False : GEnviarPulsacion_CCTRL.Checked = False : GEnviarPulsacion_CSHIFT.Checked = False : GEnviarPulsacion_CALT.Checked = False
    End Sub

    Private Sub GEnviarPulsacion_TPulsacion_TextChanged(sender As Object, e As EventArgs) Handles GEnviarPulsacion_TPulsacion.TextChanged
        GEnviarPulsacion_LCPulsacion.Text = GEnviarPulsacion_TPulsacion.Text
        If Comandos_Accion_ListaAccion.SelectedItems.Length > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GEnviarPulsacion_LCPulsacion_TextChanged(sender As Object, e As EventArgs) Handles GEnviarPulsacion_LCPulsacion.TextChanged
        GEnviarPulsacion_LCPulsacion.Font = New Font(GEnviarPulsacion_LCPulsacion.Font.FontFamily, 6.75)
        If GEnviarPulsacion_LCPulsacion.Text.Length > 17 Then GEnviarPulsacion_LCPulsacion.Font = New Font(GEnviarPulsacion_LCPulsacion.Font.FontFamily, 6)
    End Sub

    Private Sub GEnviarPulsacion_TPulsacion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEnviarPulsacion_TPulsacion.KeyPress
        e.Handled = True : If Asc(e.KeyChar) = 13 Then HTexto.Focus()
    End Sub

    Private Sub GEnviarPulsacion_Pulsacion_GotFocus(sender As Object, e As EventArgs) Handles GEnviarPulsacion_TPulsacion.GotFocus, GEnviarPulsacion_LCPulsacion.Click
        If GMacro_Grabando = True Then HTexto.Focus() : Exit Sub
        Mouse_HotKey = True
        GEnviarPulsacion_TPulsacion.Width = 146
        GEnviarPulsacion_TPulsacion.isKeyLog = True : GEnviarPulsacion_LCPulsacion.Cursor = Cursors.Default : GEnviarPulsacion_TPulsacion.Invalidate()
        Get_Pulsacion_Key = True : GEnviarPulsacion_PulsacionM = True
    End Sub

    Private Sub GEnviarPulsacion_LCPulsacion_Click(sender As Object, e As EventArgs) Handles GEnviarPulsacion_LCPulsacion.Click
        If GMacro_Grabando = True Then HTexto.Focus() : Exit Sub
        Mouse_HotKey = True
        GEnviarPulsacion_TPulsacion.isKeyLog = True : GEnviarPulsacion_LCPulsacion.Cursor = Cursors.Default : GEnviarPulsacion_TPulsacion.Invalidate()
        Get_Pulsacion_Key = True : GEnviarPulsacion_PulsacionM = True : HTexto.Focus()
    End Sub

    Private Sub GEnviarPulsacion_PPulsacion_Click(sender As Object, e As MouseEventArgs) Handles GEnviarPulsacion_PPulsacion.Click, GEnviarPulsacion_PPulsacion.DoubleClick
        HTexto.Focus() : If e.Button <> MouseButtons.Left Then Exit Sub
        GPulsacion_Teclas_Menu.Show(Left + PanelComandos.Left + GEnviarPulsacion.Left + sender.Left + sender.Width + 3, Top + PanelComandos.Top + GEnviarPulsacion.Top + sender.Top)
    End Sub

    Private Sub GEnviarPulsacion_PPulsacion_MouseEnter(sender As Object, e As EventArgs) Handles GEnviarPulsacion_PPulsacion.MouseEnter
        GEnviarPulsacion_PPulsacion.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GEnviarPulsacion_PPulsacion_MouseLeave(sender As Object, e As EventArgs) Handles GEnviarPulsacion_PPulsacion.MouseLeave
        GEnviarPulsacion_PPulsacion.Image = My.Resources.CComandos_Off
    End Sub

#End Region

#Region " Checks "

    Private Sub GEnviarPulsacion_CTRL_Click(sender As Object, e As MouseEventArgs) Handles GEnviarPulsacion_LCTRL.Click, GEnviarPulsacion_LCTRL.DoubleClick, GEnviarPulsacion_CCTRL.Click, GEnviarPulsacion_CCTRL.DoubleClick
        ExitHotKey()
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GEnviarPulsacion_CCTRL.Checked = True Then GEnviarPulsacion_CCTRL.Checked = False Else GEnviarPulsacion_CCTRL.Checked = True
        Dim cPulsacion As String = GEnviarPulsacion_TPulsacion.Tag
        If cPulsacion.ToLower.Contains("ctrl") Then cPulsacion = cPulsacion.Replace("CTRL", "")
        If cPulsacion.ToLower.Contains("shift") Then cPulsacion = cPulsacion.Replace("SHIFT", "")
        If cPulsacion.ToLower.Contains("alt") Then cPulsacion = cPulsacion.Replace("ALT", "")
        If cPulsacion.ToLower.Contains("win") Then cPulsacion = cPulsacion.Replace("WIN", "")
        If cPulsacion.EndsWith("+") Then cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "") + "+" Else cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "")
        cPulsacion = cPulsacion.Replace("Mouse1", "Mouse 1").Replace("Mouse2", "Mouse 2").Replace("Mouse3", "Mouse 3").Replace("Mouse4", "Mouse 4").Replace("Mouse5", "Mouse 5").Replace("WheelDown", "Wheel Down").Replace("WheelUp", "Wheel Up")
        Dim TempText As String = cPulsacion : cPulsacion = ""
        If GEnviarPulsacion_CWin.Checked = True Then cPulsacion += "WIN + "
        If GEnviarPulsacion_CCTRL.Checked = True Then cPulsacion += "CTRL + "
        If GEnviarPulsacion_CSHIFT.Checked = True Then cPulsacion += "SHIFT + "
        If GEnviarPulsacion_CALT.Checked = True Then cPulsacion += "ALT + "
        GEnviarPulsacion_TPulsacion.Tag = cPulsacion + TempText
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GEnviarPulsacion_SHIFT_Click(sender As Object, e As MouseEventArgs) Handles GEnviarPulsacion_LSHIFT.Click, GEnviarPulsacion_LSHIFT.DoubleClick, GEnviarPulsacion_CSHIFT.Click, GEnviarPulsacion_CSHIFT.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GEnviarPulsacion_CSHIFT.Checked = True Then GEnviarPulsacion_CSHIFT.Checked = False Else GEnviarPulsacion_CSHIFT.Checked = True
        Dim cPulsacion As String = GEnviarPulsacion_TPulsacion.Tag
        If cPulsacion.ToLower.Contains("ctrl") Then cPulsacion = cPulsacion.Replace("CTRL", "")
        If cPulsacion.ToLower.Contains("shift") Then cPulsacion = cPulsacion.Replace("SHIFT", "")
        If cPulsacion.ToLower.Contains("alt") Then cPulsacion = cPulsacion.Replace("ALT", "")
        If cPulsacion.ToLower.Contains("win") Then cPulsacion = cPulsacion.Replace("WIN", "")
        If cPulsacion.EndsWith("+") Then cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "") + "+" Else cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "")
        cPulsacion = cPulsacion.Replace("Mouse1", "Mouse 1").Replace("Mouse2", "Mouse 2").Replace("Mouse3", "Mouse 3").Replace("Mouse4", "Mouse 4").Replace("Mouse5", "Mouse 5").Replace("WheelDown", "Wheel Down").Replace("WheelUp", "Wheel Up")
        Dim TempText As String = cPulsacion : cPulsacion = ""
        If GEnviarPulsacion_CWin.Checked = True Then cPulsacion += "WIN + "
        If GEnviarPulsacion_CCTRL.Checked = True Then cPulsacion += "CTRL + "
        If GEnviarPulsacion_CSHIFT.Checked = True Then cPulsacion += "SHIFT + "
        If GEnviarPulsacion_CALT.Checked = True Then cPulsacion += "ALT + "
        GEnviarPulsacion_TPulsacion.Tag = cPulsacion + TempText
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GEnviarPulsacion_ALT_Click(sender As Object, e As MouseEventArgs) Handles GEnviarPulsacion_LALT.Click, GEnviarPulsacion_LALT.DoubleClick, GEnviarPulsacion_CALT.Click, GEnviarPulsacion_CALT.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GEnviarPulsacion_CALT.Checked = True Then GEnviarPulsacion_CALT.Checked = False Else GEnviarPulsacion_CALT.Checked = True
        Dim cPulsacion As String = GEnviarPulsacion_TPulsacion.Tag
        If cPulsacion.ToLower.Contains("ctrl") Then cPulsacion = cPulsacion.Replace("CTRL", "")
        If cPulsacion.ToLower.Contains("shift") Then cPulsacion = cPulsacion.Replace("SHIFT", "")
        If cPulsacion.ToLower.Contains("alt") Then cPulsacion = cPulsacion.Replace("ALT", "")
        If cPulsacion.ToLower.Contains("win") Then cPulsacion = cPulsacion.Replace("WIN", "")
        If cPulsacion.EndsWith("+") Then cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "") + "+" Else cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "")
        cPulsacion = cPulsacion.Replace("Mouse1", "Mouse 1").Replace("Mouse2", "Mouse 2").Replace("Mouse3", "Mouse 3").Replace("Mouse4", "Mouse 4").Replace("Mouse5", "Mouse 5").Replace("WheelDown", "Wheel Down").Replace("WheelUp", "Wheel Up")
        Dim TempText As String = cPulsacion : cPulsacion = ""
        If GEnviarPulsacion_CWin.Checked = True Then cPulsacion += "WIN + "
        If GEnviarPulsacion_CCTRL.Checked = True Then cPulsacion += "CTRL + "
        If GEnviarPulsacion_CSHIFT.Checked = True Then cPulsacion += "SHIFT + "
        If GEnviarPulsacion_CALT.Checked = True Then cPulsacion += "ALT + "
        GEnviarPulsacion_TPulsacion.Tag = cPulsacion + TempText
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GEnviarPulsacion_WIN_Click(sender As Object, e As MouseEventArgs) Handles GEnviarPulsacion_LWIN.Click, GEnviarPulsacion_LWIN.DoubleClick, GEnviarPulsacion_CWin.Click, GEnviarPulsacion_CWin.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GEnviarPulsacion_CWin.Checked = True Then GEnviarPulsacion_CWin.Checked = False Else GEnviarPulsacion_CWin.Checked = True
        Dim cPulsacion As String = GEnviarPulsacion_TPulsacion.Tag
        If cPulsacion.ToLower.Contains("ctrl") Then cPulsacion = cPulsacion.Replace("CTRL", "")
        If cPulsacion.ToLower.Contains("shift") Then cPulsacion = cPulsacion.Replace("SHIFT", "")
        If cPulsacion.ToLower.Contains("alt") Then cPulsacion = cPulsacion.Replace("ALT", "")
        If cPulsacion.ToLower.Contains("win") Then cPulsacion = cPulsacion.Replace("WIN", "")
        If cPulsacion.EndsWith("+") Then cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "") + "+" Else cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "")
        cPulsacion = cPulsacion.Replace("Mouse1", "Mouse 1").Replace("Mouse2", "Mouse 2").Replace("Mouse3", "Mouse 3").Replace("Mouse4", "Mouse 4").Replace("Mouse5", "Mouse 5").Replace("WheelDown", "Wheel Down").Replace("WheelUp", "Wheel Up")
        Dim TempText As String = cPulsacion : cPulsacion = ""
        If GEnviarPulsacion_CWin.Checked = True Then cPulsacion += "WIN + "
        If GEnviarPulsacion_CCTRL.Checked = True Then cPulsacion += "CTRL + "
        If GEnviarPulsacion_CSHIFT.Checked = True Then cPulsacion += "SHIFT + "
        If GEnviarPulsacion_CALT.Checked = True Then cPulsacion += "ALT + "
        GEnviarPulsacion_TPulsacion.Tag = cPulsacion + TempText
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Menu Teclas "

    Private Sub GPulsacion_Teclas_Menu_MouseDown(sender As Object, e As MouseEventArgs)
        GEnviarPulsacion_TPulsacion.Text = sender.Tag
    End Sub

#Region " KeyPress "

    Private Sub GPulsacion_Teclas_Menu_KeyDown(sender As Object, e As PreviewKeyDownEventArgs)
        'Try
        If e.KeyCode = Keys.Enter Then
            For Each cItem As Object In sender.Items
                If cItem.Selected = True Then
                    If cItem.Tag = "" Then Exit Sub
                    GComandos_TComandos.Text = cItem.Text
                    GComandos_TComandos.Tag = cItem.Tag
                    GComandos_LCComandos.Text = cItem.Text
                    Exit For
                End If
            Next : Exit Sub
        End If
        If e.KeyCode <> Keys.Up And e.KeyCode <> Keys.Down And e.KeyCode <> Keys.Left And e.KeyCode <> Keys.Right And e.KeyCode <> Keys.Home And e.KeyCode <> Keys.End And e.KeyCode <> Keys.Escape Then Exit Sub
        QuickMenu_ForeColor_Off(GComandos_Comandos_Menu) : Dim Selected As Boolean
        If e.KeyCode = Keys.Up Or e.KeyCode = Keys.Down Then
            For Cuenta = 0 To sender.Items.Count - 1
                If sender.Items(Cuenta).Selected = True Then
                    If e.KeyCode = Keys.Up Then
                        If Cuenta = 0 Then
                            sender.Items(GetNextItem_ForSelect(sender, sender.Items.Count - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
                        Else
                            sender.Items(GetNextItem_ForSelect(sender, Cuenta - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
                        End If
                    End If
                    If e.KeyCode = Keys.Down Then
                        If Cuenta = sender.Items.Count - 1 Then
                            sender.Items(GetNextItem_ForSelect(sender, 0, False)).ForeColor = Color.FromArgb(205, 150, 0)
                        Else
                            sender.Items(GetNextItem_ForSelect(sender, Cuenta + 1, False)).ForeColor = Color.FromArgb(205, 150, 0)
                        End If
                    End If : Selected = True : Exit For
                End If
            Next
            If Selected = False Then
                If e.KeyCode = Keys.Up AndAlso sender.Items.Count > 0 Then
                    sender.Items(GetNextItem_ForSelect(sender, sender.Items.Count - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
                End If
                If e.KeyCode = Keys.Down AndAlso sender.Items.Count > 0 Then
                    sender.Items(GetNextItem_ForSelect(sender, 0, False)).ForeColor = Color.FromArgb(205, 150, 0)
                End If
            End If
        End If
        If e.KeyCode = Keys.Right Then
            For Each cItem As Object In sender.Items
                If cItem.Selected = True Then
                    If cItem.DropDownItems.Count > 0 Then
                        cItem.DropDownItems(0).ForeColor = Color.FromArgb(205, 150, 0) : Exit For
                    Else
                        For Each nItem As Object In GComandos_Comandos_Menu.Items
                            If nItem.Selected = True Then nItem.ForeColor = Color.FromArgb(205, 150, 0) : Exit For
                        Next : Exit For
                    End If
                End If
            Next
        End If
        If e.KeyCode = Keys.Left Or e.KeyCode = Keys.Escape Then
            If TypeOf sender IsNot NSContextMenu Then
                sender.OwnerItem.ForeColor = Color.FromArgb(205, 150, 0)
            Else
                For Each nItem As Object In QuickMenu_Editor.Items
                    If nItem.Selected = True Then nItem.ForeColor = Color.FromArgb(205, 150, 0) : Exit For
                Next
            End If
        End If
        If e.KeyCode = Keys.Home Then sender.Items(0).ForeColor = Color.FromArgb(205, 150, 0)
        If e.KeyCode = Keys.End Then sender.Items(sender.Items.Count - 1).ForeColor = Color.FromArgb(205, 150, 0)
        'Catch : End Try
    End Sub

    Private Sub GPulsacion_Teclas_Menu_MouseEnter(sender As Object, e As EventArgs)
        sender.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GPulsacion_Teclas_Menu_MouseLeave(sender As Object, e As EventArgs)
        sender.ForeColor = Color.FromArgb(130, 130, 130)
    End Sub

#End Region

#End Region

#End Region

#Region " Mover "

    Private Sub GEnviarPulsacion_TXY_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEnviarPulsacion_TX.KeyPress, GEnviarPulsacion_TY.KeyPress
        Dim cControl As NSTextBox = CType(sender, NSTextBox)
        If Asc(e.KeyChar) = 45 And cControl.Text.Contains("-") = False And cControl.SelectionStart = 0 Then Exit Sub
        If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar) Then e.Handled = True
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GEnviarPulsacion_TXY_GotFocus(sender As Object, e As EventArgs) Handles GEnviarPulsacion_TX.GotFocus, GEnviarPulsacion_TY.GotFocus
        Dim cControl As NSTextBox = CType(sender, NSTextBox)
        cControl.Text = cControl.Text.Trim : cControl.SelectionLength = 0
    End Sub

    Private Sub GEnviarPulsacion_TXY_LostFocus(sender As Object, e As EventArgs) Handles GEnviarPulsacion_TX.LostFocus, GEnviarPulsacion_TY.LostFocus
        Dim cControl As NSTextBox = CType(sender, NSTextBox)
        cControl.Text = cControl.Text.Trim : cControl.SelectionLength = 0 : If cControl.Text = "" Then cControl.Text = "0"
        cControl.Text = CInt(cControl.Text).ToString
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Textos "

    Private Sub GEnviarPulsacion_TTexto_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEnviarPulsacion_TTexto.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
        If Asc(e.KeyChar) = 8 Then Exit Sub
        'e.KeyChar = LCase(e.KeyChar)
        'If Keyboard.String_to_Key(e.KeyChar).ToString = "None" Then e.Handled = True
    End Sub

    Private Sub GEnviarPulsacion_TTexto_GotFocus(sender As Object, e As EventArgs) Handles GEnviarPulsacion_TTexto.GotFocus
        If GEnviarPulsacion_TTexto.ForeColor1 = Color.FromArgb(72, 72, 72) Then GEnviarPulsacion_TTexto.Text = "" : GEnviarPulsacion_TTexto.ForeColor1 = Color.FromArgb(102, 102, 102)
        GEnviarPulsacion_TTexto.Text = GEnviarPulsacion_TTexto.Text.Trim : GEnviarPulsacion_TTexto.SelectionLength = 0
    End Sub

    Private Sub GEnviarPulsacion_TTexto_LostFocus(sender As Object, e As EventArgs) Handles GEnviarPulsacion_TTexto.LostFocus
        If GEnviarPulsacion_TTexto.Text.Trim = "" Then GEnviarPulsacion_TTexto.Text = "Texto a enviar" : GEnviarPulsacion_TTexto.ForeColor1 = Color.FromArgb(72, 72, 72)
        GEnviarPulsacion_TTexto.SelectionLength = 0
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub


#End Region

#Region " Help "

    Private Sub GEnviarPulsacion_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GEnviarPulsacion_LHelp.Click, GEnviarPulsacion_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Enviar Pulsación" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GEnviarPulsacion_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GEnviarPulsacion_LHelp.MouseEnter
        GComandos_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GEnviarPulsacion_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GEnviarPulsacion_LHelp.MouseLeave
        GComandos_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_EnviarPulsacion_Tooltips(sender As Object, e As EventArgs) Handles GEnviarPulsacion_LAccion.MouseEnter, GEnviarPulsacion_LCAccion.MouseEnter, GEnviarPulsacion_LPulsacion.MouseEnter, GEnviarPulsacion_LX.MouseEnter, GEnviarPulsacion_LY.MouseEnter, GEnviarPulsacion_CoorLMouse.MouseEnter, GEnviarPulsacion_CoorLX.MouseEnter, GEnviarPulsacion_CoorLY.MouseEnter, GEnviarPulsacion_CoorLCX.MouseEnter, GEnviarPulsacion_CoorLCY.MouseEnter, GEnviarPulsacion_LWIN.MouseEnter, GEnviarPulsacion_LCTRL.MouseEnter, GEnviarPulsacion_LSHIFT.MouseEnter, GEnviarPulsacion_LALT.MouseEnter, GEnviarPulsacion_CWin.MouseEnter, GEnviarPulsacion_CCTRL.MouseEnter, GEnviarPulsacion_CSHIFT.MouseEnter, GEnviarPulsacion_CALT.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GEnviarPulsacion_Accion", "GEnviarPulsacion_CAccion"
                Select Case GEnviarPulsacion_LCAccion.Text
                    Case "Enviar Pulsación" : Show_Tooltip(sender, "Envía una pulsación de tecla a la aplicación activa")
                    Case "Enviar Texto" : Show_Tooltip(sender, "Envía un texto a la aplicación activa")
                    Case "Mover Ratón" : Show_Tooltip(sender, "Mueve el ratón a un posición de la pantalla")
                    Case "Desplazar Ratón" : Show_Tooltip(sender, "Desplaza el ratón desde su posición actual")
                End Select
            Case "GEnviarPulsacion_Pulsacion" : If GEnviarPulsacion_LCAccion.Text = "Enviar Pulsación" Then Show_Tooltip(sender, "Pulsación de tecla que se enviará al ejecutar la acción") Else Show_Tooltip(sender, "Texto que se enviará al ejecutar la acción")
            Case "GEnviarPulsacion_X" : If GEnviarPulsacion_LCAccion.Text = "Mover Ratón" Then Show_Tooltip(sender, "Coordenada X de la posición del ratón") Else Show_Tooltip(sender, "Valor que se añadirá o restará a la coordenada X del ratón")
            Case "GEnviarPulsacion_Y" : If GEnviarPulsacion_LCAccion.Text = "Mover Ratón" Then Show_Tooltip(sender, "Coordenada Y de la posición del ratón") Else Show_Tooltip(sender, "Valor que se añadirá o restará a la coordenada Y del ratón")
            Case "GEnviarPulsacion_oorLMouse" : Show_Tooltip(sender, "Muestra las coordenadas actuales del ratón")
            Case "GEnviarPulsacion_oorLX", "GEnviarPulsacion_oorLCX" : Show_Tooltip(sender, "Coordenada X de la posición actual del ratón")
            Case "GEnviarPulsacion_oorLY", "GEnviarPulsacion_oorLCY" : Show_Tooltip(sender, "Coordenada Y de la posición actual del ratón")

            Case "GEnviarPulsacion_WIN" : Show_Tooltip(sender, "Determina si se envía la tecla 'Windows (WIN)' al enviar la pulsación")
            Case "GEnviarPulsacion_CTRL" : Show_Tooltip(sender, "Determina si se envía la tecla 'Control (CTRL)' al enviar la pulsación")
            Case "GEnviarPulsacion_SHIFT" : Show_Tooltip(sender, "Determina si se envía la tecla 'Mayúsculas (SHIFT)' al enviar la pulsación")
            Case "GEnviarPulsacion_ALT" : Show_Tooltip(sender, "Determina si se envía la tecla 'Alternativa (ALT)' al enviar la pulsación")
        End Select
    End Sub

#End Region

#End Region

#Region " TopMost "

#Region " Sonido "

    Private Sub GTopMost_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles GTopMost_LCSonido.TextChanged
        GTopMost_TSonido.Enabled = False
        GTopMost_LCSonido.Text = Rutas.Acortar_Ruta(GTopMost_TSonido.Text, GTopMost_LCSonido)
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GTopMost_LCSonido.Text, New Font(GTopMost_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < GTopMost_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : GTopMost_LCSonido.Font = New Font(GTopMost_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GTopMost_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles GTopMost_LCSonido.Click, GTopMost_TSonido.Click
        If e.Button = MouseButtons.Left Then
            GTopMost_CSonido.DroppedDown = True : GTopMost_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            GTopMost_LCSonido.Visible = False : Combo_IgnoreOne = True : GTopMost_TSonido.ReadOnly = False : GTopMost_TSonido.Enabled = True : GTopMost_TSonido.Cursor = Cursors.IBeam : GTopMost_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub GTopMost_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GTopMost_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GTopMost_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles GTopMost_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GTopMost_CSonido.DroppedDown = True : GTopMost_CSonido.Focus()
    End Sub

    Private Sub GTopMost_TSonido_GotFocus(sender As Object, e As EventArgs) Handles GTopMost_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub GTopMost_TSonido_LostFocus(sender As Object, e As EventArgs) Handles GTopMost_TSonido.LostFocus
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GTopMost_LCSonido.Visible = False Then GTopMost_LCSonido.Visible = True : GTopMost_TSonido.ReadOnly = True : GTopMost_TSonido.Enabled = False : GTopMost_TSonido.Cursor = Cursors.Hand
        If IO.File.Exists(GTopMost_TSonido.Text) = False And GTopMost_CSonido.Items.Contains(StrConv(GTopMost_TSonido.Text, VbStrConv.ProperCase)) = False Then GTopMost_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To GTopMost_CSonido.Items.Count - 1
            If GTopMost_TSonido.Text.ToLower = GTopMost_CSonido.Items(Cuenta).ToLower Then GTopMost_TSonido.Text = GTopMost_CSonido.Items(Cuenta)
        Next : GTopMost_TSonido.Text = GTopMost_TSonido.Text.Trim : GTopMost_TSonido.SelectionLength = 0 : GTopMost_LCSonido.Text = GTopMost_TSonido.Text
    End Sub

    Private Sub GTopMost_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles GTopMost_TSonido.MouseEnter, GTopMost_CSonido.MouseEnter
        GTopMost_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub GTopMost_CSonido_DropDown(sender As Object, e As EventArgs) Handles GTopMost_CSonido.DropDown
        GTopMost_TSonido.Enabled = True
        GTopMost_CSonido.MaxDropDownItems = GTopMost_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = GTopMost_TSonido.Text
        If GTopMost_CSonido.Items.Contains(GTopMost_TSonido.Text) = True Then GTopMost_CSonido.SelectedItem = GTopMost_TSonido.Text Else GTopMost_CSonido.SelectedIndex = 0
    End Sub

    Private Sub GTopMost_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles GTopMost_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GTopMost_CSonido_LostFocus(sender As Object, e As EventArgs) Handles GTopMost_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GTopMost_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GTopMost_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then GTopMost_TSonido.Text = GTopMost_CSonido.SelectedItem.Trim : GTopMost_LCSonido.Text = GTopMost_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub GTopMost_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GTopMost_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then GTopMost_TSonido.Text = GTopMost_CSonido.SelectedItem.Trim : GTopMost_LCSonido.Text = GTopMost_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub GTopMost_CSonido_ItemHover(Index As Integer) Handles GTopMost_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub GTopMost_BPlay_Click(sender As Object, e As MouseEventArgs) Handles GTopMost_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GTopMost_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(GTopMost_TSonido.Text)
    End Sub

    Private Sub GTopMost_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles GTopMost_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then GTopMost_TSonido.Text = Abrir.FileName : GTopMost_LCSonido.Text = GTopMost_TSonido.Text : Sonidos.Play_Block(GTopMost_TSonido.Text)
        GTopMost_TSonido.SelectionStart = GTopMost_TSonido.Text.Length : GTopMost_TSonido.SelectionLength = 0
        GTopMost_BExaminar.State = NSButton.MouseState.None : GTopMost_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub GTopMost_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles GTopMost_BExaminar.MouseEnter
        GTopMost_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " OSD "

    Private Sub GTopMost_OSD_Click(sender As Object, e As MouseEventArgs) Handles GTopMost_LOSD.Click, GTopMost_LOSD.DoubleClick, GTopMost_COSD.Click, GTopMost_COSD.DoubleClick
        If e.Button = MouseButtons.Left Then
            If TypeOf sender Is NSLabel Then If GTopMost_COSD.Checked = True Then GTopMost_COSD.Checked = False Else GTopMost_COSD.Checked = True
            GTopMost_BOSD.Enabled = GTopMost_COSD.Checked : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        ElseIf e.Button = MouseButtons.Right Then
            If GTopMost_COSD.Checked = True And TypeOf sender Is NSLabel Then
                Opciones_OSD_Color = GTopMost_OSD_Color : Opciones_OSD_Font = GTopMost_OSD_Fuente : ShowOSD("Mensaje de prueba")
            End If
        End If
    End Sub

    Private Sub GTopMost_BOSD_Click(sender As Object, e As MouseEventArgs) Handles GTopMost_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = GTopMost_OSD_Fuente : Opciones_FontDialog.Color = GTopMost_OSD_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then GTopMost_OSD_Fuente = Opciones_FontDialog.Font : GTopMost_OSD_Color = Opciones_FontDialog.Color : GTopMost_BOSD.ForeColor1 = GTopMost_OSD_Color : GTopMost_BOSD.ForeColor3 = GTopMost_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = GTopMost_OSD_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then GTopMost_OSD_Color = Opciones_ColorDialog.Color : GTopMost_BOSD.ForeColor1 = GTopMost_OSD_Color : GTopMost_BOSD.ForeColor3 = GTopMost_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            GTopMost_OSD_Fuente = OSD_Default_Font : GTopMost_OSD_Color = Color.FromArgb(205, 150, 0) : GTopMost_BOSD.ForeColor1 = GTopMost_OSD_Color : GTopMost_BOSD.ForeColor3 = GTopMost_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : HTexto.Focus()
        Opciones_OSD_Color = GTopMost_OSD_Color : Opciones_OSD_Font = GTopMost_OSD_Fuente : ShowOSD("Mensaje de prueba")
    End Sub

#End Region

#Region " Help "

    Private Sub GTopMost_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GTopMost_LHelp.Click, GTopMost_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "TopMost" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GTopMost_LHelp_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GTopMost_LHelp.MouseEnter
        GTopMost_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GTopMost_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GTopMost_LHelp.MouseLeave
        GTopMost_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_TopMost_Tooltips(sender As Object, e As EventArgs) Handles GTopMost_COSD.MouseEnter, GTopMost_LOSD.MouseEnter, GTopMost_BOSD.MouseEnter, GTopMost_LSonido.MouseEnter, GTopMost_BPlay.MouseEnter, GTopMost_BExaminar.MouseEnter, GTopMost_LCSonido.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GTopMost_OSD"
                If sender.Name = "GTopMost_COSD" Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
                If sender.Name = "GTopMost_LOSD" Then If GTopMost_COSD.Checked = True Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción" + vbCrLf + "Nota: Click Derecho para previsualizar") Else Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
            Case "GTopMost_BOSD" : If GTopMost_COSD.Checked = True Then Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "GTopMost_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción")
            Case "GTopMost_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "GTopMost_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "GTopMost_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
        End Select
    End Sub

#End Region

#End Region

#Region " Archivos Ocultos "

#Region " Sonido "

    Private Sub GArchivosOcultos_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles GArchivosOcultos_LCSonido.TextChanged
        GArchivosOcultos_TSonido.Enabled = False
        GArchivosOcultos_LCSonido.Text = Rutas.Acortar_Ruta(GArchivosOcultos_TSonido.Text, GArchivosOcultos_LCSonido)
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GArchivosOcultos_LCSonido.Text, New Font(GArchivosOcultos_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < GArchivosOcultos_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : GArchivosOcultos_LCSonido.Font = New Font(GArchivosOcultos_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GArchivosOcultos_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles GArchivosOcultos_LCSonido.Click, GArchivosOcultos_TSonido.Click
        If e.Button = MouseButtons.Left Then
            GArchivosOcultos_CSonido.DroppedDown = True : GArchivosOcultos_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            GArchivosOcultos_LCSonido.Visible = False : Combo_IgnoreOne = True : GArchivosOcultos_TSonido.ReadOnly = False : GArchivosOcultos_TSonido.Enabled = True : GArchivosOcultos_TSonido.Cursor = Cursors.IBeam : GArchivosOcultos_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub GArchivosOcultos_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GArchivosOcultos_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GArchivosOcultos_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles GArchivosOcultos_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GArchivosOcultos_CSonido.DroppedDown = True : GArchivosOcultos_CSonido.Focus()
    End Sub

    Private Sub GArchivosOcultos_TSonido_GotFocus(sender As Object, e As EventArgs) Handles GArchivosOcultos_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub GArchivosOcultos_TSonido_LostFocus(sender As Object, e As EventArgs) Handles GArchivosOcultos_TSonido.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GArchivosOcultos_LCSonido.Visible = False Then GArchivosOcultos_LCSonido.Visible = True : GArchivosOcultos_TSonido.ReadOnly = True : GArchivosOcultos_TSonido.Enabled = False : GArchivosOcultos_TSonido.Cursor = Cursors.Hand
        If IO.File.Exists(GArchivosOcultos_TSonido.Text) = False And GArchivosOcultos_CSonido.Items.Contains(StrConv(GArchivosOcultos_TSonido.Text, VbStrConv.ProperCase)) = False Then GArchivosOcultos_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To GArchivosOcultos_CSonido.Items.Count - 1
            If GArchivosOcultos_TSonido.Text.ToLower = GArchivosOcultos_CSonido.Items(Cuenta).ToLower Then GArchivosOcultos_TSonido.Text = GArchivosOcultos_CSonido.Items(Cuenta)
        Next : GArchivosOcultos_TSonido.Text = GArchivosOcultos_TSonido.Text.Trim : GArchivosOcultos_TSonido.SelectionLength = 0 : GArchivosOcultos_LCSonido.Text = GArchivosOcultos_TSonido.Text
    End Sub

    Private Sub GArchivosOcultos_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles GArchivosOcultos_TSonido.MouseEnter, GArchivosOcultos_CSonido.MouseEnter
        GArchivosOcultos_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub GArchivosOcultos_CSonido_DropDown(sender As Object, e As EventArgs) Handles GArchivosOcultos_CSonido.DropDown
        GArchivosOcultos_TSonido.Enabled = True
        GArchivosOcultos_CSonido.MaxDropDownItems = GArchivosOcultos_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = GArchivosOcultos_TSonido.Text
        If GArchivosOcultos_CSonido.Items.Contains(GArchivosOcultos_TSonido.Text) = True Then GArchivosOcultos_CSonido.SelectedItem = GArchivosOcultos_TSonido.Text Else GArchivosOcultos_CSonido.SelectedIndex = 0
    End Sub

    Private Sub GArchivosOcultos_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles GArchivosOcultos_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GArchivosOcultos_CSonido_LostFocus(sender As Object, e As EventArgs) Handles GArchivosOcultos_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GArchivosOcultos_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GArchivosOcultos_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then GArchivosOcultos_TSonido.Text = GArchivosOcultos_CSonido.SelectedItem.Trim : GArchivosOcultos_LCSonido.Text = GArchivosOcultos_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub GArchivosOcultos_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GArchivosOcultos_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then GArchivosOcultos_TSonido.Text = GArchivosOcultos_CSonido.SelectedItem.Trim : GArchivosOcultos_LCSonido.Text = GArchivosOcultos_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub GArchivosOcultos_CSonido_ItemHover(Index As Integer) Handles GArchivosOcultos_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub GArchivosOcultos_BPlay_Click(sender As Object, e As MouseEventArgs) Handles GArchivosOcultos_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GArchivosOcultos_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(GArchivosOcultos_TSonido.Text)
    End Sub

    Private Sub GArchivosOcultos_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles GArchivosOcultos_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then GArchivosOcultos_TSonido.Text = Abrir.FileName : GArchivosOcultos_LCSonido.Text = GArchivosOcultos_TSonido.Text : Sonidos.Play_Block(GArchivosOcultos_TSonido.Text)
        GArchivosOcultos_TSonido.SelectionStart = GArchivosOcultos_TSonido.Text.Length : GArchivosOcultos_TSonido.SelectionLength = 0
        GArchivosOcultos_BExaminar.State = NSButton.MouseState.None : GArchivosOcultos_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub GArchivosOcultos_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles GArchivosOcultos_BExaminar.MouseEnter
        GArchivosOcultos_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " OSD "

    Private Sub GArchivosOcultos_OSD_Click(sender As Object, e As MouseEventArgs) Handles GArchivosOcultos_LOSD.Click, GArchivosOcultos_LOSD.DoubleClick, GArchivosOcultos_COSD.Click, GArchivosOcultos_COSD.DoubleClick
        If e.Button = MouseButtons.Left Then
            If TypeOf sender Is NSLabel Then If GArchivosOcultos_COSD.Checked = True Then GArchivosOcultos_COSD.Checked = False Else GArchivosOcultos_COSD.Checked = True
            GArchivosOcultos_BOSD.Enabled = GArchivosOcultos_COSD.Checked : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        ElseIf e.Button = MouseButtons.Right Then
            If GArchivosOcultos_COSD.Checked = True And TypeOf sender Is NSLabel Then
                Opciones_OSD_Color = GArchivosOcultos_OSD_Color : Opciones_OSD_Font = GArchivosOcultos_OSD_Fuente : ShowOSD("Mensaje de prueba")
            End If
        End If
    End Sub

    Private Sub GArchivosOcultos_BOSD_Click(sender As Object, e As MouseEventArgs) Handles GArchivosOcultos_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = GArchivosOcultos_OSD_Fuente : Opciones_FontDialog.Color = GArchivosOcultos_OSD_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then GArchivosOcultos_OSD_Fuente = Opciones_FontDialog.Font : GArchivosOcultos_OSD_Color = Opciones_FontDialog.Color : GArchivosOcultos_BOSD.ForeColor1 = GArchivosOcultos_OSD_Color : GArchivosOcultos_BOSD.ForeColor3 = GArchivosOcultos_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = GArchivosOcultos_OSD_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then GArchivosOcultos_OSD_Color = Opciones_ColorDialog.Color : GArchivosOcultos_BOSD.ForeColor1 = GArchivosOcultos_OSD_Color : GArchivosOcultos_BOSD.ForeColor3 = GArchivosOcultos_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            GArchivosOcultos_OSD_Fuente = OSD_Default_Font : GArchivosOcultos_OSD_Color = Color.FromArgb(205, 150, 0) : GArchivosOcultos_BOSD.ForeColor1 = GArchivosOcultos_OSD_Color : GArchivosOcultos_BOSD.ForeColor3 = GArchivosOcultos_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : HTexto.Focus()
        Opciones_OSD_Color = GArchivosOcultos_OSD_Color : Opciones_OSD_Font = GArchivosOcultos_OSD_Fuente : ShowOSD("Mensaje de prueba")
    End Sub

#End Region

#Region " Help "

    Private Sub GArchivosOcultos_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GArchivosOcultos_LHelp.Click, GArchivosOcultos_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Archivos Ocultos" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GArchivosOcultos_LHelp_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GArchivosOcultos_LHelp.MouseEnter
        GArchivosOcultos_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GArchivosOcultos_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GArchivosOcultos_LHelp.MouseLeave
        GArchivosOcultos_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_ArchivosOcultos_Tooltips(sender As Object, e As EventArgs) Handles GArchivosOcultos_COSD.MouseEnter, GArchivosOcultos_LOSD.MouseEnter, GArchivosOcultos_BOSD.MouseEnter, GArchivosOcultos_LSonido.MouseEnter, GArchivosOcultos_BPlay.MouseEnter, GArchivosOcultos_BExaminar.MouseEnter, GArchivosOcultos_LCSonido.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GArchivosOcultos_OSD"
                If sender.Name = "GArchivosOcultos_COSD" Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
                If sender.Name = "GArchivosOcultos_LOSD" Then If GArchivosOcultos_COSD.Checked = True Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción" + vbCrLf + "Nota: Click Derecho para previsualizar") Else Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
            Case "GArchivosOcultos_BOSD" : If GArchivosOcultos_COSD.Checked = True Then Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "GArchivosOcultos_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción")
            Case "GArchivosOcultos_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "GArchivosOcultos_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "GArchivosOcultos_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
        End Select
    End Sub

#End Region

#End Region

#Region " Desactivar en "

#Region " Sonido "

    Private Sub GDesactivarEn_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles GDesactivarEn_LCSonido.TextChanged
        GDesactivarEn_TSonido.Enabled = False
        GDesactivarEn_LCSonido.Text = Rutas.Acortar_Ruta(GDesactivarEn_TSonido.Text, GDesactivarEn_LCSonido)
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GDesactivarEn_LCSonido.Text, New Font(GDesactivarEn_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < GDesactivarEn_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : GDesactivarEn_LCSonido.Font = New Font(GDesactivarEn_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GDesactivarEn_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles GDesactivarEn_LCSonido.Click, GDesactivarEn_TSonido.Click
        If e.Button = MouseButtons.Left Then
            GDesactivarEn_CSonido.DroppedDown = True : GDesactivarEn_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            GDesactivarEn_LCSonido.Visible = False : Combo_IgnoreOne = True : GDesactivarEn_TSonido.ReadOnly = False : GDesactivarEn_TSonido.Enabled = True : GDesactivarEn_TSonido.Cursor = Cursors.IBeam : GDesactivarEn_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub GDesactivarEn_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GDesactivarEn_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GDesactivarEn_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles GDesactivarEn_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GDesactivarEn_CSonido.DroppedDown = True : GDesactivarEn_CSonido.Focus()
    End Sub

    Private Sub GDesactivarEn_TSonido_GotFocus(sender As Object, e As EventArgs) Handles GDesactivarEn_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub GDesactivarEn_TSonido_LostFocus(sender As Object, e As EventArgs) Handles GDesactivarEn_TSonido.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GDesactivarEn_LCSonido.Visible = False Then GDesactivarEn_LCSonido.Visible = True : GDesactivarEn_TSonido.ReadOnly = True : GDesactivarEn_TSonido.Enabled = False : GDesactivarEn_TSonido.Cursor = Cursors.Hand
        If IO.File.Exists(GDesactivarEn_TSonido.Text) = False And GDesactivarEn_CSonido.Items.Contains(StrConv(GDesactivarEn_TSonido.Text, VbStrConv.ProperCase)) = False Then GDesactivarEn_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To GDesactivarEn_CSonido.Items.Count - 1
            If GDesactivarEn_TSonido.Text.ToLower = GDesactivarEn_CSonido.Items(Cuenta).ToLower Then GDesactivarEn_TSonido.Text = GDesactivarEn_CSonido.Items(Cuenta)
        Next : GDesactivarEn_TSonido.Text = GDesactivarEn_TSonido.Text.Trim : GDesactivarEn_TSonido.SelectionLength = 0 : GDesactivarEn_LCSonido.Text = GDesactivarEn_TSonido.Text
    End Sub

    Private Sub GDesactivarEn_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles GDesactivarEn_TSonido.MouseEnter, GDesactivarEn_CSonido.MouseEnter
        GDesactivarEn_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub GDesactivarEn_CSonido_DropDown(sender As Object, e As EventArgs) Handles GDesactivarEn_CSonido.DropDown
        GDesactivarEn_TSonido.Enabled = True
        GDesactivarEn_CSonido.MaxDropDownItems = GDesactivarEn_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = GDesactivarEn_TSonido.Text
        If GDesactivarEn_CSonido.Items.Contains(GDesactivarEn_TSonido.Text) = True Then GDesactivarEn_CSonido.SelectedItem = GDesactivarEn_TSonido.Text Else GDesactivarEn_CSonido.SelectedIndex = 0
    End Sub

    Private Sub GDesactivarEn_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles GDesactivarEn_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GDesactivarEn_CSonido_LostFocus(sender As Object, e As EventArgs) Handles GDesactivarEn_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GDesactivarEn_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GDesactivarEn_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then GDesactivarEn_TSonido.Text = GDesactivarEn_CSonido.SelectedItem.Trim : GDesactivarEn_LCSonido.Text = GDesactivarEn_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub GDesactivarEn_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GDesactivarEn_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then GDesactivarEn_TSonido.Text = GDesactivarEn_CSonido.SelectedItem.Trim : GDesactivarEn_LCSonido.Text = GDesactivarEn_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub GDesactivarEn_CSonido_ItemHover(Index As Integer) Handles GDesactivarEn_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub GDesactivarEn_BPlay_Click(sender As Object, e As MouseEventArgs) Handles GDesactivarEn_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GDesactivarEn_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(GDesactivarEn_TSonido.Text)
    End Sub

    Private Sub GDesactivarEn_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles GDesactivarEn_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then GDesactivarEn_TSonido.Text = Abrir.FileName : GDesactivarEn_LCSonido.Text = GDesactivarEn_TSonido.Text : Sonidos.Play_Block(GDesactivarEn_TSonido.Text)
        GDesactivarEn_TSonido.SelectionStart = GDesactivarEn_TSonido.Text.Length : GDesactivarEn_TSonido.SelectionLength = 0
        GDesactivarEn_BExaminar.State = NSButton.MouseState.None : GDesactivarEn_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub GDesactivarEn_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles GDesactivarEn_BExaminar.MouseEnter
        GDesactivarEn_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " OSD "

    Private Sub GDesactivarEn_OSD_Click(sender As Object, e As MouseEventArgs) Handles GDesactivarEn_LOSD.Click, GDesactivarEn_LOSD.DoubleClick, GDesactivarEn_COSD.Click, GDesactivarEn_COSD.DoubleClick
        If e.Button = MouseButtons.Left Then
            If TypeOf sender Is NSLabel Then If GDesactivarEn_COSD.Checked = True Then GDesactivarEn_COSD.Checked = False Else GDesactivarEn_COSD.Checked = True
            GDesactivarEn_BOSD.Enabled = GDesactivarEn_COSD.Checked : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        ElseIf e.Button = MouseButtons.Right Then
            If GDesactivarEn_COSD.Checked = True And TypeOf sender Is NSLabel Then
                Opciones_OSD_Color = GDesactivarEn_OSD_Color : Opciones_OSD_Font = GDesactivarEn_OSD_Fuente : ShowOSD("Mensaje de prueba")
            End If
        End If
    End Sub

    Private Sub GDesactivarEn_BOSD_Click(sender As Object, e As MouseEventArgs) Handles GDesactivarEn_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = GDesactivarEn_OSD_Fuente : Opciones_FontDialog.Color = GDesactivarEn_OSD_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then GDesactivarEn_OSD_Fuente = Opciones_FontDialog.Font : GDesactivarEn_OSD_Color = Opciones_FontDialog.Color : GDesactivarEn_BOSD.ForeColor1 = GDesactivarEn_OSD_Color : GDesactivarEn_BOSD.ForeColor3 = GDesactivarEn_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = GDesactivarEn_OSD_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then GDesactivarEn_OSD_Color = Opciones_ColorDialog.Color : GDesactivarEn_BOSD.ForeColor1 = GDesactivarEn_OSD_Color : GDesactivarEn_BOSD.ForeColor3 = GDesactivarEn_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            GDesactivarEn_OSD_Fuente = OSD_Default_Font : GDesactivarEn_OSD_Color = Color.FromArgb(205, 150, 0) : GDesactivarEn_BOSD.ForeColor1 = GDesactivarEn_OSD_Color : GDesactivarEn_BOSD.ForeColor3 = GDesactivarEn_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : HTexto.Focus()
        Opciones_OSD_Color = GDesactivarEn_OSD_Color : Opciones_OSD_Font = GDesactivarEn_OSD_Fuente : ShowOSD("Mensaje de prueba")
    End Sub

#End Region

#Region " Help "

    Private Sub GDesactivarEn_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GDesactivarEn_LHelp.Click, GDesactivarEn_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Desactivar en" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GDesactivarEn_LHelp_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GDesactivarEn_LHelp.MouseEnter
        GDesactivarEn_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GDesactivarEn_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GDesactivarEn_LHelp.MouseLeave
        GDesactivarEn_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_DesactivarEn_Tooltips(sender As Object, e As EventArgs) Handles GDesactivarEn_COSD.MouseEnter, GDesactivarEn_LOSD.MouseEnter, GDesactivarEn_BOSD.MouseEnter, GDesactivarEn_LSonido.MouseEnter, GDesactivarEn_BPlay.MouseEnter, GDesactivarEn_BExaminar.MouseEnter, GDesactivarEn_LCSonido.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GDesactivarEn_OSD"
                If sender.Name = "GDesactivarEn_COSD" Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
                If sender.Name = "GDesactivarEn_LOSD" Then If GDesactivarEn_COSD.Checked = True Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción" + vbCrLf + "Nota: Click Derecho para previsualizar") Else Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
            Case "GDesactivarEn_BOSD" : If GDesactivarEn_COSD.Checked = True Then Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "GDesactivarEn_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción")
            Case "GDesactivarEn_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "GDesactivarEn_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "GDesactivarEn_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
        End Select
    End Sub

#End Region

#End Region

#Region " Mostrar Mensaje "

#Region " Textos "

    Private Sub GMostrarMensaje_LMensaje_Click(sender As Object, e As MouseEventArgs) Handles GMostrarMensaje_LMensaje.Click
        If e.Button = MouseButtons.Right Then
            Dim Mensaje As String : If GMostrarMensaje_TMensaje.ForeColor1 = Color.FromArgb(102, 102, 102) Then Mensaje = GMostrarMensaje_TMensaje.Text Else Mensaje = "Mensaje de prueba"
            Opciones_OSD_Color = GMostrarMensaje_OSD_Color : Opciones_OSD_Font = GMostrarMensaje_OSD_Fuente : ShowOSD(Mensaje)
        End If
    End Sub

    Private Sub GMostrarMensaje_TMensaje_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GMostrarMensaje_TMensaje.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GMostrarMensaje_TMensaje_GotFocus(sender As Object, e As EventArgs) Handles GMostrarMensaje_TMensaje.GotFocus
        If GMostrarMensaje_TMensaje.ForeColor1 = Color.FromArgb(72, 72, 72) Then GMostrarMensaje_TMensaje.Text = "" : GMostrarMensaje_TMensaje.ForeColor1 = Color.FromArgb(102, 102, 102)
        GMostrarMensaje_TMensaje.Text = GMostrarMensaje_TMensaje.Text.Trim : GMostrarMensaje_TMensaje.SelectionLength = 0
    End Sub

    Private Sub GMostrarMensaje_TMensaje_LostFocus(sender As Object, e As EventArgs) Handles GMostrarMensaje_TMensaje.LostFocus
        If GMostrarMensaje_TMensaje.Text.Trim = "" Then GMostrarMensaje_TMensaje.Text = "Mensaje a mostrar" : GMostrarMensaje_TMensaje.ForeColor1 = Color.FromArgb(72, 72, 72)
        GMostrarMensaje_TMensaje.Text = GMostrarMensaje_TMensaje.Text.Trim.Substring(0, 1).ToUpper + GMostrarMensaje_TMensaje.Text.Trim.Substring(1) : GMostrarMensaje_TMensaje.SelectionLength = 0
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GMostrarMensaje_TDuracion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GMostrarMensaje_TDuracion.KeyPress
        If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar) Then e.Handled = True
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GMostrarMensaje_TDuracion_GotFocus(sender As Object, e As EventArgs) Handles GMostrarMensaje_TDuracion.GotFocus
        GMostrarMensaje_TDuracion.Text = GMostrarMensaje_TDuracion.Text.Trim : GMostrarMensaje_TDuracion.SelectionLength = 0
    End Sub

    Private Sub GMostrarMensaje_TDuracion_LostFocus(sender As Object, e As EventArgs) Handles GMostrarMensaje_TDuracion.LostFocus
        GMostrarMensaje_TDuracion.Text = GMostrarMensaje_TDuracion.Text.Trim : GMostrarMensaje_TDuracion.SelectionLength = 0 : If GMostrarMensaje_TDuracion.Text = "" Then GMostrarMensaje_TDuracion.Text = "0"
        GMostrarMensaje_TDuracion.Text = CInt(GMostrarMensaje_TDuracion.Text)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GMostrarMensaje_LFormato_Click(sender As Object, e As MouseEventArgs) Handles GMostrarMensaje_LFormato.Click, GMostrarMensaje_LFormato.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GMostrarMensaje_LFormato.Value2 = "ms" Then GMostrarMensaje_LFormato.Value2 = "sec" : GMostrarMensaje_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GMostrarMensaje_LFormato.Value2 = "sec" Then GMostrarMensaje_LFormato.Value2 = "min" : GMostrarMensaje_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GMostrarMensaje_LFormato.Value2 = "min" Then GMostrarMensaje_LFormato.Value2 = "ms" : GMostrarMensaje_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
    End Sub

#End Region

#Region " Sonido "

    Private Sub GMostrarMensaje_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles GMostrarMensaje_LCSonido.TextChanged
        GMostrarMensaje_TSonido.Enabled = False
        GMostrarMensaje_LCSonido.Text = Rutas.Acortar_Ruta(GMostrarMensaje_TSonido.Text, GMostrarMensaje_LCSonido)
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GMostrarMensaje_LCSonido.Text, New Font(GMostrarMensaje_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < GMostrarMensaje_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : GMostrarMensaje_LCSonido.Font = New Font(GMostrarMensaje_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GMostrarMensaje_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles GMostrarMensaje_LCSonido.Click, GMostrarMensaje_TSonido.Click
        If e.Button = MouseButtons.Left Then
            GMostrarMensaje_CSonido.DroppedDown = True : GMostrarMensaje_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            If GMostrarMensaje_LCSonido.Text = "Sin Sonido" Then GMostrarMensaje_TSonido.Text = ""
            GMostrarMensaje_LCSonido.Visible = False : Combo_IgnoreOne = True : GMostrarMensaje_TSonido.ReadOnly = False : GMostrarMensaje_TSonido.Enabled = True : GMostrarMensaje_TSonido.Cursor = Cursors.IBeam : GMostrarMensaje_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub GMostrarMensaje_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GMostrarMensaje_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GMostrarMensaje_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles GMostrarMensaje_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GMostrarMensaje_CSonido.DroppedDown = True : GMostrarMensaje_CSonido.Focus()
    End Sub

    Private Sub GMostrarMensaje_TSonido_GotFocus(sender As Object, e As EventArgs) Handles GMostrarMensaje_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub GMostrarMensaje_TSonido_LostFocus(sender As Object, e As EventArgs) Handles GMostrarMensaje_TSonido.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GMostrarMensaje_LCSonido.Visible = False Then GMostrarMensaje_LCSonido.Visible = True : GMostrarMensaje_TSonido.ReadOnly = True : GMostrarMensaje_TSonido.Enabled = False : GMostrarMensaje_TSonido.Cursor = Cursors.Hand
        If IO.File.Exists(GMostrarMensaje_TSonido.Text) = False And GMostrarMensaje_CSonido.Items.Contains(StrConv(GMostrarMensaje_TSonido.Text, VbStrConv.ProperCase)) = False Then GMostrarMensaje_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To GMostrarMensaje_CSonido.Items.Count - 1
            If GMostrarMensaje_TSonido.Text.ToLower = GMostrarMensaje_CSonido.Items(Cuenta).ToLower Then GMostrarMensaje_TSonido.Text = GMostrarMensaje_CSonido.Items(Cuenta)
        Next : GMostrarMensaje_TSonido.Text = GMostrarMensaje_TSonido.Text.Trim : GMostrarMensaje_TSonido.SelectionLength = 0 : GMostrarMensaje_LCSonido.Text = GMostrarMensaje_TSonido.Text
    End Sub

    Private Sub GMostrarMensaje_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles GMostrarMensaje_TSonido.MouseEnter, GMostrarMensaje_CSonido.MouseEnter
        GMostrarMensaje_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub GMostrarMensaje_CSonido_DropDown(sender As Object, e As EventArgs) Handles GMostrarMensaje_CSonido.DropDown
        GMostrarMensaje_TSonido.Enabled = True
        GMostrarMensaje_CSonido.MaxDropDownItems = GMostrarMensaje_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = GMostrarMensaje_TSonido.Text
        If GMostrarMensaje_CSonido.Items.Contains(GMostrarMensaje_TSonido.Text) = True Then GMostrarMensaje_CSonido.SelectedItem = GMostrarMensaje_TSonido.Text Else GMostrarMensaje_CSonido.SelectedIndex = 0
    End Sub

    Private Sub GMostrarMensaje_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles GMostrarMensaje_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GMostrarMensaje_CSonido_LostFocus(sender As Object, e As EventArgs) Handles GMostrarMensaje_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GMostrarMensaje_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GMostrarMensaje_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then GMostrarMensaje_TSonido.Text = GMostrarMensaje_CSonido.SelectedItem.Trim : GMostrarMensaje_LCSonido.Text = GMostrarMensaje_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub GMostrarMensaje_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GMostrarMensaje_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then GMostrarMensaje_TSonido.Text = GMostrarMensaje_CSonido.SelectedItem.Trim : GMostrarMensaje_LCSonido.Text = GMostrarMensaje_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub GMostrarMensaje_CSonido_ItemHover(Index As Integer) Handles GMostrarMensaje_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub GMostrarMensaje_BPlay_Click(sender As Object, e As MouseEventArgs) Handles GMostrarMensaje_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GMostrarMensaje_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(GMostrarMensaje_TSonido.Text)
    End Sub

    Private Sub GMostrarMensaje_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles GMostrarMensaje_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then GMostrarMensaje_TSonido.Text = Abrir.FileName : GMostrarMensaje_LCSonido.Text = GMostrarMensaje_TSonido.Text : Sonidos.Play_Block(GMostrarMensaje_TSonido.Text)
        GMostrarMensaje_TSonido.SelectionStart = GMostrarMensaje_TSonido.Text.Length : GMostrarMensaje_TSonido.SelectionLength = 0
        GMostrarMensaje_BExaminar.State = NSButton.MouseState.None : GMostrarMensaje_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub GMostrarMensaje_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles GMostrarMensaje_BExaminar.MouseEnter
        GMostrarMensaje_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " Checks "

    Private Sub GMostrarMensaje_CuentaAtras_Click(sender As Object, e As MouseEventArgs) Handles GMostrarMensaje_LCuentaAtras.Click, GMostrarMensaje_LCuentaAtras.DoubleClick, GMostrarMensaje_CCuentaAtras.Click, GMostrarMensaje_CCuentaAtras.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GMostrarMensaje_CCuentaAtras.Checked = True Then GMostrarMensaje_CCuentaAtras.Checked = False Else GMostrarMensaje_CCuentaAtras.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GMostrarMensaje_Esperar_Click(sender As Object, e As MouseEventArgs) Handles GMostrarMensaje_LEsperar.Click, GMostrarMensaje_LEsperar.DoubleClick, GMostrarMensaje_CEsperar.Click, GMostrarMensaje_CEsperar.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GMostrarMensaje_CEsperar.Checked = True Then GMostrarMensaje_CEsperar.Checked = False Else GMostrarMensaje_CEsperar.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " OSD "

    Private Sub GMostrarMensaje_BOSD_Click(sender As Object, e As MouseEventArgs) Handles GMostrarMensaje_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = GMostrarMensaje_OSD_Fuente : Opciones_FontDialog.Color = GMostrarMensaje_OSD_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then GMostrarMensaje_OSD_Fuente = Opciones_FontDialog.Font : GMostrarMensaje_OSD_Color = Opciones_FontDialog.Color : GMostrarMensaje_BOSD.ForeColor1 = GMostrarMensaje_OSD_Color : GMostrarMensaje_BOSD.ForeColor3 = GMostrarMensaje_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = GMostrarMensaje_OSD_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then GMostrarMensaje_OSD_Color = Opciones_ColorDialog.Color : GMostrarMensaje_BOSD.ForeColor1 = GMostrarMensaje_OSD_Color : GMostrarMensaje_BOSD.ForeColor3 = GMostrarMensaje_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            GMostrarMensaje_OSD_Fuente = OSD_Default_Font : GMostrarMensaje_OSD_Color = Color.FromArgb(205, 150, 0) : GMostrarMensaje_BOSD.ForeColor1 = GMostrarMensaje_OSD_Color : GMostrarMensaje_BOSD.ForeColor3 = GMostrarMensaje_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : HTexto.Focus()
        Dim Mensaje As String : If GMostrarMensaje_TMensaje.ForeColor1 = Color.FromArgb(102, 102, 102) Then Mensaje = GMostrarMensaje_TMensaje.Text Else Mensaje = "Mensaje de prueba"
        Opciones_OSD_Color = GMostrarMensaje_OSD_Color : Opciones_OSD_Font = GMostrarMensaje_OSD_Fuente : ShowOSD(Mensaje)
    End Sub

#End Region

#Region " Help "

    Private Sub GMostrarMensaje_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GMostrarMensaje_LHelp.Click, GMostrarMensaje_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Mostrar Mensaje" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GMostrarMensaje_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GMostrarMensaje_LHelp.MouseEnter
        GMostrarMensaje_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GMostrarMensaje_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GMostrarMensaje_LHelp.MouseLeave
        GMostrarMensaje_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_MostrarMensaje_Tooltips(sender As Object, e As EventArgs) Handles GMostrarMensaje_BOSD.MouseEnter, GMostrarMensaje_LSonido.MouseEnter, GMostrarMensaje_BPlay.MouseEnter, GMostrarMensaje_BExaminar.MouseEnter, GMostrarMensaje_LDuracion.MouseEnter, GMostrarMensaje_LFormato.MouseEnter, GMostrarMensaje_CCuentaAtras.MouseEnter, GMostrarMensaje_LCuentaAtras.MouseEnter, GMostrarMensaje_CEsperar.MouseEnter, GMostrarMensaje_LEsperar.MouseEnter, GMostrarMensaje_LMensaje.MouseEnter, GMostrarMensaje_LCSonido.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GMostrarMensaje_Mensaje" : Show_Tooltip(sender, "Mensaje que se mostrará al ejecutar la acción")
            Case "GMostrarMensaje_BOSD" : Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "GMostrarMensaje_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción")
            Case "GMostrarMensaje_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "GMostrarMensaje_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "GMostrarMensaje_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
            Case "GMostrarMensaje_Duracion" : Show_Tooltip(sender, "Tiempo que se mostrará el mensaje")
            Case "GMostrarMensaje_Formato" : Show_Tooltip(sender, "Click Izquierdo: Cambiar el modo de tiempo (min, sec, o ms)")
            Case "GMostrarMensaje_CuentaAtras" : Show_Tooltip(sender, "Muestra una cuenta atras en el OSD")
            Case "GMostrarMensaje_Esperar" : Show_Tooltip(sender, "Espera a que se termine de mostrar el mensaje " + vbCrLf + "antes de ejecutar la siguiente acción")
        End Select
    End Sub

#End Region

#End Region

#Region " Apagar Equipo "

#Region " Textos "

    Private Sub GApagarEquipo_TDuracion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GApagarEquipo_TDuracion.KeyPress
        If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar) Then e.Handled = True
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GApagarEquipo_TDuracion_GotFocus(sender As Object, e As EventArgs) Handles GApagarEquipo_TDuracion.GotFocus
        GApagarEquipo_TDuracion.Text = GApagarEquipo_TDuracion.Text.Trim : GApagarEquipo_TDuracion.SelectionLength = 0
    End Sub

    Private Sub GApagarEquipo_TDuracion_LostFocus(sender As Object, e As EventArgs) Handles GApagarEquipo_TDuracion.LostFocus
        GApagarEquipo_TDuracion.Text = GApagarEquipo_TDuracion.Text.Trim : GApagarEquipo_TDuracion.SelectionLength = 0 : If GApagarEquipo_TDuracion.Text = "" Then GApagarEquipo_TDuracion.Text = "0"
        GApagarEquipo_TDuracion.Text = CInt(GApagarEquipo_TDuracion.Text)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GApagarEquipo_LFormato_Click(sender As Object, e As MouseEventArgs) Handles GApagarEquipo_LFormato.Click, GApagarEquipo_LFormato.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GApagarEquipo_LFormato.Value2 = "ms" Then GApagarEquipo_LFormato.Value2 = "sec" : GApagarEquipo_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GApagarEquipo_LFormato.Value2 = "sec" Then GApagarEquipo_LFormato.Value2 = "min" : GApagarEquipo_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GApagarEquipo_LFormato.Value2 = "min" Then GApagarEquipo_LFormato.Value2 = "ms" : GApagarEquipo_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
    End Sub

#End Region

#Region " Checks "

    Private Sub GApagarEquipo_CuentaAtras_Click(sender As Object, e As MouseEventArgs) Handles GApagarEquipo_LCuentaAtras.Click, GApagarEquipo_LCuentaAtras.DoubleClick, GApagarEquipo_CCuentaAtras.Click, GApagarEquipo_CCuentaAtras.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GApagarEquipo_CCuentaAtras.Checked = True Then GApagarEquipo_CCuentaAtras.Checked = False Else GApagarEquipo_CCuentaAtras.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Accion "

    Private Sub GApagarEquipo_LCAccion_TextChanged(sender As Object, e As EventArgs) Handles GApagarEquipo_LCAccion.TextChanged
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GApagarEquipo_TAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GApagarEquipo_TAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GApagarEquipo_TAccion_GotFocus(sender As Object, e As EventArgs) Handles GApagarEquipo_TAccion.GotFocus
        GApagarEquipo_TAccion.Text = GApagarEquipo_TAccion.Text.Trim : GApagarEquipo_TAccion.SelectionLength = 0 : HTexto.Focus()
    End Sub

    Private Sub GApagarEquipo_TAccion_LostFocus(sender As Object, e As EventArgs) Handles GApagarEquipo_TAccion.LostFocus
        GApagarEquipo_TAccion.Text = GApagarEquipo_TAccion.Text.Trim : GApagarEquipo_TAccion.SelectionLength = 0 : GApagarEquipo_LCAccion.Text = GApagarEquipo_TAccion.Text
    End Sub

    Private Sub GApagarEquipo_TAccion_MouseEnter(sender As Object, e As EventArgs) Handles GApagarEquipo_TAccion.MouseEnter, GApagarEquipo_CAccion.MouseEnter
        GApagarEquipo_CAccion.State = NSComboBox.MouseState.None
    End Sub

    Private Sub GApagarEquipo_TAccion_Click(sender As Object, e As MouseEventArgs) Handles GApagarEquipo_LCAccion.Click, GApagarEquipo_TAccion.Click
        If e.Button = MouseButtons.Left Then GApagarEquipo_CAccion.DroppedDown = True : GApagarEquipo_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GApagarEquipo_PAccion_Click(sender As Object, e As MouseEventArgs) Handles GApagarEquipo_PAccion.Click, GApagarEquipo_PAccion.DoubleClick
        If e.Button = MouseButtons.Left Then GApagarEquipo_CAccion.DroppedDown = True : GApagarEquipo_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GApagarEquipo_PAccion_MouseEnter(sender As Object, e As EventArgs) Handles GApagarEquipo_PAccion.MouseEnter
        GApagarEquipo_PAccion.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GApagarEquipo_PAccion_MouseLeave(sender As Object, e As EventArgs) Handles GApagarEquipo_PAccion.MouseLeave
        GApagarEquipo_PAccion.Image = My.Resources.CComandos_Off
    End Sub

#Region " Combo Accion "

    Private Sub GApagarEquipo_CAccion_DropDown(sender As Object, e As EventArgs) Handles GApagarEquipo_CAccion.DropDown
        GApagarEquipo_CAccion.MaxDropDownItems = GApagarEquipo_CAccion.Items.Count : Combo_Dropped = True : Combo_TempValue = GApagarEquipo_TAccion.Text
        If GApagarEquipo_CAccion.Items.Contains(GApagarEquipo_TAccion.Text) = True Then GApagarEquipo_CAccion.SelectedItem = GApagarEquipo_TAccion.Text Else GApagarEquipo_CAccion.SelectedIndex = 0
    End Sub

    Private Sub GApagarEquipo_CAccion_DropDownClosed(sender As Object, e As EventArgs) Handles GApagarEquipo_CAccion.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GApagarEquipo_CAccion_LostFocus(sender As Object, e As EventArgs) Handles GApagarEquipo_CAccion.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GApagarEquipo_CAccion_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GApagarEquipo_CAccion.SelectedIndexChanged
        If Combo_TempValue = "" Then
            GApagarEquipo_TAccion.Text = GApagarEquipo_CAccion.SelectedItem.Trim
            GApagarEquipo_LCAccion.Text = GApagarEquipo_TAccion.Text
            If NoFocusLista = False Then HTexto.Focus()
        End If
    End Sub

    Private Sub GApagarEquipo_CAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GApagarEquipo_CAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then GApagarEquipo_TAccion.Text = GApagarEquipo_CAccion.SelectedItem.Trim : GApagarEquipo_LCAccion.Text = GApagarEquipo_TAccion.Text : HTexto.Focus() : e.Handled = True
    End Sub

#End Region

#End Region

#Region " Sonido "

    Private Sub GApagarEquipo_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles GApagarEquipo_LCSonido.TextChanged
        GApagarEquipo_TSonido.Enabled = False
        GApagarEquipo_LCSonido.Text = Rutas.Acortar_Ruta(GApagarEquipo_TSonido.Text, GApagarEquipo_LCSonido)
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GApagarEquipo_LCSonido.Text, New Font(GApagarEquipo_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < GApagarEquipo_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : GApagarEquipo_LCSonido.Font = New Font(GApagarEquipo_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GApagarEquipo_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles GApagarEquipo_LCSonido.Click, GApagarEquipo_TSonido.Click
        If e.Button = MouseButtons.Left Then
            GApagarEquipo_CSonido.DroppedDown = True : GApagarEquipo_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            GApagarEquipo_LCSonido.Visible = False : Combo_IgnoreOne = True : GApagarEquipo_TSonido.ReadOnly = False : GApagarEquipo_TSonido.Enabled = True : GApagarEquipo_TSonido.Cursor = Cursors.IBeam : GApagarEquipo_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub GApagarEquipo_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GApagarEquipo_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GApagarEquipo_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles GApagarEquipo_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : GApagarEquipo_CSonido.DroppedDown = True : GApagarEquipo_CSonido.Focus()
    End Sub

    Private Sub GApagarEquipo_TSonido_GotFocus(sender As Object, e As EventArgs) Handles GApagarEquipo_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub GApagarEquipo_TSonido_LostFocus(sender As Object, e As EventArgs) Handles GApagarEquipo_TSonido.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If GApagarEquipo_LCSonido.Visible = False Then GApagarEquipo_LCSonido.Visible = True : GApagarEquipo_TSonido.ReadOnly = True : GApagarEquipo_TSonido.Enabled = False : GApagarEquipo_TSonido.Cursor = Cursors.Hand
        If IO.File.Exists(GApagarEquipo_TSonido.Text) = False And GApagarEquipo_CSonido.Items.Contains(StrConv(GApagarEquipo_TSonido.Text, VbStrConv.ProperCase)) = False Then GApagarEquipo_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To GApagarEquipo_CSonido.Items.Count - 1
            If GApagarEquipo_TSonido.Text.ToLower = GApagarEquipo_CSonido.Items(Cuenta).ToLower Then GApagarEquipo_TSonido.Text = GApagarEquipo_CSonido.Items(Cuenta)
        Next : GApagarEquipo_TSonido.Text = GApagarEquipo_TSonido.Text.Trim : GApagarEquipo_TSonido.SelectionLength = 0 : GApagarEquipo_LCSonido.Text = GApagarEquipo_TSonido.Text
    End Sub

    Private Sub GApagarEquipo_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles GApagarEquipo_TSonido.MouseEnter, GApagarEquipo_CSonido.MouseEnter
        GApagarEquipo_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub GApagarEquipo_CSonido_DropDown(sender As Object, e As EventArgs) Handles GApagarEquipo_CSonido.DropDown
        GApagarEquipo_TSonido.Enabled = True
        GApagarEquipo_CSonido.MaxDropDownItems = GApagarEquipo_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = GApagarEquipo_TSonido.Text
        If GApagarEquipo_CSonido.Items.Contains(GApagarEquipo_TSonido.Text) = True Then GApagarEquipo_CSonido.SelectedItem = GApagarEquipo_TSonido.Text Else GApagarEquipo_CSonido.SelectedIndex = 0
    End Sub

    Private Sub GApagarEquipo_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles GApagarEquipo_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GApagarEquipo_CSonido_LostFocus(sender As Object, e As EventArgs) Handles GApagarEquipo_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GApagarEquipo_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GApagarEquipo_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then GApagarEquipo_TSonido.Text = GApagarEquipo_CSonido.SelectedItem.Trim : GApagarEquipo_LCSonido.Text = GApagarEquipo_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub GApagarEquipo_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GApagarEquipo_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then GApagarEquipo_TSonido.Text = GApagarEquipo_CSonido.SelectedItem.Trim : GApagarEquipo_LCSonido.Text = GApagarEquipo_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub GApagarEquipo_CSonido_ItemHover(Index As Integer) Handles GApagarEquipo_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub GApagarEquipo_BPlay_Click(sender As Object, e As MouseEventArgs) Handles GApagarEquipo_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GApagarEquipo_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(GApagarEquipo_TSonido.Text)
    End Sub

    Private Sub GApagarEquipo_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles GApagarEquipo_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then GApagarEquipo_TSonido.Text = Abrir.FileName : GApagarEquipo_LCSonido.Text = GApagarEquipo_TSonido.Text : Sonidos.Play_Block(GApagarEquipo_TSonido.Text)
        GApagarEquipo_TSonido.SelectionStart = GApagarEquipo_TSonido.Text.Length : GApagarEquipo_TSonido.SelectionLength = 0
        GApagarEquipo_BExaminar.State = NSButton.MouseState.None : GApagarEquipo_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub GApagarEquipo_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles GApagarEquipo_BExaminar.MouseEnter
        GApagarEquipo_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#Region " OSD "

    Private Sub GApagarEquipo_OSD_Click(sender As Object, e As MouseEventArgs) Handles GApagarEquipo_LOSD.Click, GApagarEquipo_LOSD.DoubleClick, GApagarEquipo_COSD.Click, GApagarEquipo_COSD.DoubleClick
        If e.Button = MouseButtons.Left Then
            If TypeOf sender Is NSLabel Then If GApagarEquipo_COSD.Checked = True Then GApagarEquipo_COSD.Checked = False Else GApagarEquipo_COSD.Checked = True
            GApagarEquipo_BOSD.Enabled = GApagarEquipo_COSD.Checked : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
            GApagarEquipo_CCuentaAtras.Enabled = GApagarEquipo_COSD.Checked : GApagarEquipo_LCuentaAtras.Enabled = GApagarEquipo_COSD.Checked
        ElseIf e.Button = MouseButtons.Right Then
            If GApagarEquipo_COSD.Checked = True And TypeOf sender Is NSLabel Then
                Opciones_OSD_Color = GApagarEquipo_OSD_Color : Opciones_OSD_Font = GApagarEquipo_OSD_Fuente : ShowOSD("Mensaje de prueba")
            End If
        End If
    End Sub

    Private Sub GApagarEquipo_BOSD_Click(sender As Object, e As MouseEventArgs) Handles GApagarEquipo_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = GApagarEquipo_OSD_Fuente : Opciones_FontDialog.Color = GApagarEquipo_OSD_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then GApagarEquipo_OSD_Fuente = Opciones_FontDialog.Font : GApagarEquipo_OSD_Color = Opciones_FontDialog.Color : GApagarEquipo_BOSD.ForeColor1 = GApagarEquipo_OSD_Color : GApagarEquipo_BOSD.ForeColor3 = GApagarEquipo_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = GApagarEquipo_OSD_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then GApagarEquipo_OSD_Color = Opciones_ColorDialog.Color : GApagarEquipo_BOSD.ForeColor1 = GApagarEquipo_OSD_Color : GApagarEquipo_BOSD.ForeColor3 = GApagarEquipo_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            GApagarEquipo_OSD_Fuente = OSD_Default_Font : GApagarEquipo_OSD_Color = Color.FromArgb(205, 150, 0) : GApagarEquipo_BOSD.ForeColor1 = GApagarEquipo_OSD_Color : GApagarEquipo_BOSD.ForeColor3 = GApagarEquipo_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : HTexto.Focus()
        Opciones_OSD_Color = GApagarEquipo_OSD_Color : Opciones_OSD_Font = GApagarEquipo_OSD_Fuente : ShowOSD("Mensaje de prueba")
    End Sub

#End Region

#Region " Help "

    Private Sub GApagarEquipo_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GApagarEquipo_LHelp.Click, GApagarEquipo_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Apagar Equipo" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GApagarEquipo_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GApagarEquipo_LHelp.MouseEnter
        GApagarEquipo_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GApagarEquipo_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GApagarEquipo_LHelp.MouseLeave
        GApagarEquipo_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_ApagarEquipo_Tooltips(sender As Object, e As EventArgs) Handles GApagarEquipo_LAccion.MouseEnter, GApagarEquipo_LCAccion.MouseEnter, GApagarEquipo_COSD.MouseEnter, GApagarEquipo_LOSD.MouseEnter, GApagarEquipo_BOSD.MouseEnter, GApagarEquipo_LSonido.MouseEnter, GApagarEquipo_BPlay.MouseEnter, GApagarEquipo_BExaminar.MouseEnter, GApagarEquipo_CCuentaAtras.MouseEnter, GApagarEquipo_LCuentaAtras.MouseEnter, GApagarEquipo_LDuracion.MouseEnter, GApagarEquipo_LFormato.MouseEnter, GApagarEquipo_LCSonido.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GApagarEquipo_OSD"
                If sender.Name = "GApagarEquipo_COSD" Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
                If sender.Name = "GApagarEquipo_LOSD" Then If GApagarEquipo_COSD.Checked = True Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción" + vbCrLf + "Nota: Click Derecho para previsualizar") Else Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
            Case "GApagarEquipo_BOSD" : If GApagarEquipo_COSD.Checked = True Then Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "GApagarEquipo_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción")
            Case "GApagarEquipo_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al ejecutarse la acción" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "GApagarEquipo_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "GApagarEquipo_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
            Case "GApagarEquipo_Duracion" : Show_Tooltip(sender, "Tiempo que de espera antes de ejecutar la acción")
            Case "GApagarEquipo_Formato" : Show_Tooltip(sender, "Click Izquierdo: Cambiar el modo de tiempo (min, sec, o ms)")
            Case "GApagarEquipo_CuentaAtras" : Show_Tooltip(sender, "Muestra una cuenta atras en el OSD")

            Case "GApagarEquipo_Accion", "GApagarEquipo_CAccion"
                Select Case GApagarEquipo_LCAccion.Text
                    Case "Apagar Equipo" : Show_Tooltip(sender, "Apaga el ordenador")
                    Case "Reiniciar Equipo" : Show_Tooltip(sender, "Reinicia el ordenador")
                    Case "Cerrar Sesion" : Show_Tooltip(sender, "Cierra la sesión del usuario actual")
                    Case "Cambiar Usuario" : Show_Tooltip(sender, "Muestra la ventana 'Cambiar Usuario' de Windows")
                End Select
        End Select
    End Sub

#End Region

#End Region

#Region " Comandos "

#Region " Accion "

    Private Sub GComandos_LCAccion_TextChanged(sender As Object, e As EventArgs) Handles GComandos_LCAccion.TextChanged
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GComandos_TAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GComandos_TAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GComandos_TAccion_GotFocus(sender As Object, e As EventArgs) Handles GComandos_TAccion.GotFocus
        GComandos_TAccion.Text = GComandos_TAccion.Text.Trim : GComandos_TAccion.SelectionLength = 0 : HTexto.Focus()
    End Sub

    Private Sub GComandos_TAccion_LostFocus(sender As Object, e As EventArgs) Handles GComandos_TAccion.LostFocus
        GComandos_TAccion.Text = GComandos_TAccion.Text.Trim : GComandos_TAccion.SelectionLength = 0 : GComandos_LCAccion.Text = GComandos_TAccion.Text
    End Sub

    Private Sub GComandos_TAccion_Click(sender As Object, e As MouseEventArgs) Handles GComandos_LCAccion.Click, GComandos_TAccion.Click
        If e.Button = MouseButtons.Left Then GComandos_CAccion.DroppedDown = True : GComandos_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GComandos_PAccion_Click(sender As Object, e As MouseEventArgs) Handles GComandos_PAccion.Click, GComandos_PAccion.DoubleClick
        If e.Button = MouseButtons.Left Then GComandos_CAccion.DroppedDown = True : GComandos_CAccion.Focus() : Exit Sub Else HTexto.Focus()
    End Sub

    Private Sub GComandos_PAccion_MouseEnter(sender As Object, e As EventArgs) Handles GComandos_PAccion.MouseEnter
        GComandos_PAccion.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GComandos_PAccion_MouseLeave(sender As Object, e As EventArgs) Handles GComandos_PAccion.MouseLeave
        GComandos_PAccion.Image = My.Resources.CComandos_Off
    End Sub

#Region " Combo Accion "

    Private Sub GComandos_CAccion_DropDown(sender As Object, e As EventArgs) Handles GComandos_CAccion.DropDown
        GComandos_CAccion.MaxDropDownItems = GComandos_CAccion.Items.Count : Combo_Dropped = True : Combo_TempValue = GComandos_TAccion.Text
        If GComandos_CAccion.Items.Contains(GComandos_TAccion.Text) = True Then GComandos_CAccion.SelectedItem = GComandos_TAccion.Text Else GComandos_CAccion.SelectedIndex = 0
    End Sub

    Private Sub GComandos_CAccion_DropDownClosed(sender As Object, e As EventArgs) Handles GComandos_CAccion.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub GComandos_CAccion_LostFocus(sender As Object, e As EventArgs) Handles GComandos_CAccion.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub GComandos_CAccion_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GComandos_CAccion.SelectedIndexChanged
        If Combo_TempValue = "" Then GComandos_TAccion.Text = GComandos_CAccion.SelectedItem.Trim : GComandos_LCAccion.Text = GComandos_TAccion.Text
    End Sub

    Private Sub GComandos_CAccion_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GComandos_CAccion.KeyPress
        If Asc(e.KeyChar) = 13 Then GComandos_TAccion.Text = GComandos_CAccion.SelectedItem.Trim : GComandos_LCAccion.Text = GComandos_TAccion.Text : HTexto.Focus() : e.Handled = True
    End Sub

#End Region

#End Region

#Region " Comandos "

    Private Sub GComandos_LCComandos_TextChanged(sender As Object, e As EventArgs) Handles GComandos_LCComandos.TextChanged
        For Cuenta = 0 To Comandos.Length - 1
            If Comandos(Cuenta).ID = GComandos_TComandos.Tag Then GComandos_LCComandos.Text = GComandos_TComandos.Text : GoTo Sigue
        Next : GComandos_TComandos.Tag = "" : GComandos_LCComandos.Text = "Seleccione un comando"
Sigue:  Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(GComandos_LCComandos.Text, New Font(GComandos_LCComandos.Font.Name, TextSize, FontStyle.Regular)).Width < GComandos_LCComandos.Width Or TextSize < 4 : TextSize -= 1 : Loop : GComandos_LCComandos.Font = New Font(GComandos_LCComandos.Font.Name, TextSize, FontStyle.Regular)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GComandos_TComandos_GotFocus(sender As Object, e As EventArgs) Handles GComandos_TComandos.GotFocus
        HTexto.Focus()
    End Sub

    Private Sub GComandos_TComandos_Click(sender As Object, e As MouseEventArgs) Handles GComandos_LCComandos.Click, GComandos_TComandos.Click, GComandos_LCComandos.DoubleClick, GComandos_TComandos.DoubleClick
        If e.Button = MouseButtons.Left Then
            GComandos_PComandos_Click(GComandos_PComandos, e)
        Else : HTexto.Focus() : End If
    End Sub

    Private Sub GComandos_PComandos_Click(sender As Object, e As MouseEventArgs) Handles GComandos_PComandos.Click, GComandos_PComandos.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If Comandos.Length < 31 Then
            GComandos_Comandos_Menu.Show(Left + PanelComandos.Left + GComandos.Left + sender.Left + sender.Width + 3, Top + PanelComandos.Top + GComandos.Top + sender.Top)
        Else
            GComandos_Comandos_Menu.Show(Left + PanelComandos.Left + GComandos.Left + sender.Left - 80, Top + PanelComandos.Top + GComandos.Top + sender.Top + sender.Height + 3)
        End If
    End Sub

    Private Sub GComandos_PComandos_MouseEnter(sender As Object, e As EventArgs) Handles GComandos_PComandos.MouseEnter
        If Comandos.Length = 0 AndAlso (Comandos.Length < 2 AndAlso ComandoActualID <> "Negativo") Then Exit Sub
        GComandos_PComandos.Image = My.Resources.CComandos_On
    End Sub

    Private Sub GComandos_PComandos_MouseLeave(sender As Object, e As EventArgs) Handles GComandos_PComandos.MouseLeave
        GComandos_PComandos.Image = My.Resources.CComandos_Off
    End Sub

#Region " Menu Comandos "

    Private Sub GComandos_Comandos_Menu_Opening(sender As Object, e As System.ComponentModel.CancelEventArgs)
        GComandos_Comandos_Menu.Items.Clear()
        If Comandos Is Nothing OrElse Comandos.Length = 0 Then Exit Sub
        SLista.Clear() : SLista.Sorting = SortOrder.None : SLista.BeginUpdate() : SLista.Columns.Add("A")
        For Cuenta = 0 To Comandos.Length - 1
            If Comandos IsNot Nothing AndAlso Comandos(Cuenta).Nombre.Trim <> "" Then
                If ComandoActualID = "Negativo" Or (ComandoActualID <> "Negativo" AndAlso Comandos(Cuenta).ID <> ComandoActualID) Then SLista.Items.Add(Comandos(Cuenta).Nombre).Tag = Comandos(Cuenta).ID
            End If
        Next : SLista.EndUpdate() : SLista.Sorting = SortOrder.Ascending : SLista.Sort()
        If SLista.Items.Count = 0 Then e.Cancel = True : Exit Sub

        If SLista.Items.Count < 31 Then
            For Cuenta = 0 To SLista.Items.Count - 1
                Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = SLista.Items(Cuenta).Text, .ForeColor = QuickMenu_Editor.ForeColor, .Tag = SLista.Items(Cuenta).Tag}
                NewItem.Image = Iconos.DefaultIcon(NewItem.Tag, 0)
                AddHandler NewItem.MouseDown, AddressOf GComandos_Comandos_Menu_ComandoExistente_MouseDown
                AddHandler NewItem.MouseEnter, AddressOf GComandos_Comandos_Menu_MouseEnter
                AddHandler NewItem.MouseLeave, AddressOf GComandos_Comandos_Menu_MouseLeave
                GComandos_Comandos_Menu.Items.Add(NewItem)
            Next : HTexto.Focus() : Exit Sub
        End If

        Dim NewMainItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Image = QuickMenu_Menu_ComandoExistente.Image, .ForeColor = QuickMenu_Editor.ForeColor}
        AddHandler NewMainItem.MouseEnter, AddressOf QuickMenu_Menu_MouseEnter
        AddHandler NewMainItem.MouseLeave, AddressOf QuickMenu_Menu_MouseLeave

        Dim Contador As Integer : For Cuenta = 0 To SLista.Items.Count - 1
            Contador += 1
            Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = SLista.Items(Cuenta).Text, .ForeColor = QuickMenu_Editor.ForeColor, .Tag = SLista.Items(Cuenta).Tag}
            NewItem.Image = Iconos.DefaultIcon(NewItem.Tag, 0)
            AddHandler NewItem.MouseDown, AddressOf GComandos_Comandos_Menu_ComandoExistente_MouseDown
            AddHandler NewItem.MouseEnter, AddressOf GComandos_Comandos_Menu_MouseEnter
            AddHandler NewItem.MouseLeave, AddressOf GComandos_Comandos_Menu_MouseLeave
            NewMainItem.DropDownItems.Add(NewItem)


            If Contador > 29 Or Cuenta = SLista.Items.Count - 1 Then
                If NewMainItem.DropDownItems(NewMainItem.DropDownItems.Count - 1).Text.ToLower.StartsWith(SLista.Items(Math.Min(Cuenta + 1, SLista.Items.Count - 1)).Text.ToLower.Substring(0, 1)) = False Or Cuenta = SLista.Items.Count - 1 Then
                    If (SLista.Items.Count - 1) - Cuenta < 6 AndAlso Cuenta <> SLista.Items.Count - 1 Then Continue For
                    NewMainItem.Text = NewMainItem.DropDownItems(0).Text.ToUpper.Substring(0, 1) + " - " + NewMainItem.DropDownItems(NewMainItem.DropDownItems.Count - 1).Text.ToUpper.Substring(0, 1)
                    AddHandler NewMainItem.DropDownItems(0).Owner.PreviewKeyDown, AddressOf GComandos_Comandos_Menu_KeyDown
                    GComandos_Comandos_Menu.Items.Add(NewMainItem)
                    If Cuenta = SLista.Items.Count - 1 Then Exit For
                    NewMainItem = New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Image = QuickMenu_Menu_ComandoExistente.Image, .ForeColor = QuickMenu_Editor.ForeColor}
                    AddHandler NewMainItem.MouseEnter, AddressOf GComandos_Comandos_Menu_MouseEnter
                    AddHandler NewMainItem.MouseLeave, AddressOf GComandos_Comandos_Menu_MouseLeave
                    Contador = 0
                End If
            End If
        Next : HTexto.Focus()
    End Sub

    Private Sub GComandos_Comandos_Menu_ComandoExistente_MouseDown(sender As Object, e As MouseEventArgs)
        GComandos_TComandos.Text = sender.Text
        GComandos_TComandos.Tag = sender.Tag
        GComandos_LCComandos.Text = sender.Text
    End Sub

    Private Sub GComandos_Comandos_Menu_KeyDown(sender As Object, e As PreviewKeyDownEventArgs)
        'Try
        If e.KeyCode = Keys.Enter Then
            For Each cItem As Object In sender.Items
                If cItem.Selected = True Then
                    If cItem.Tag = "" Then Exit Sub
                    GComandos_TComandos.Text = cItem.Text
                    GComandos_TComandos.Tag = cItem.Tag
                    GComandos_LCComandos.Text = cItem.Text
                    Exit For
                End If
            Next : Exit Sub
        End If
        If e.KeyCode <> Keys.Up And e.KeyCode <> Keys.Down And e.KeyCode <> Keys.Left And e.KeyCode <> Keys.Right And e.KeyCode <> Keys.Home And e.KeyCode <> Keys.End And e.KeyCode <> Keys.Escape Then Exit Sub
        QuickMenu_ForeColor_Off(GComandos_Comandos_Menu) : Dim Selected As Boolean
        If e.KeyCode = Keys.Up Or e.KeyCode = Keys.Down Then
            For Cuenta = 0 To sender.Items.Count - 1
                If sender.Items(Cuenta).Selected = True Then
                    If e.KeyCode = Keys.Up Then
                        If Cuenta = 0 Then
                            sender.Items(GetNextItem_ForSelect(sender, sender.Items.Count - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
                        Else
                            sender.Items(GetNextItem_ForSelect(sender, Cuenta - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
                        End If
                    End If
                    If e.KeyCode = Keys.Down Then
                        If Cuenta = sender.Items.Count - 1 Then
                            sender.Items(GetNextItem_ForSelect(sender, 0, False)).ForeColor = Color.FromArgb(205, 150, 0)
                        Else
                            sender.Items(GetNextItem_ForSelect(sender, Cuenta + 1, False)).ForeColor = Color.FromArgb(205, 150, 0)
                        End If
                    End If : Selected = True : Exit For
                End If
            Next
            If Selected = False Then
                If e.KeyCode = Keys.Up AndAlso sender.Items.Count > 0 Then
                    sender.Items(GetNextItem_ForSelect(sender, sender.Items.Count - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
                End If
                If e.KeyCode = Keys.Down AndAlso sender.Items.Count > 0 Then
                    sender.Items(GetNextItem_ForSelect(sender, 0, False)).ForeColor = Color.FromArgb(205, 150, 0)
                End If
            End If
        End If
        If e.KeyCode = Keys.Right Then
            For Each cItem As Object In sender.Items
                If cItem.Selected = True Then
                    If cItem.DropDownItems.Count > 0 Then
                        cItem.DropDownItems(0).ForeColor = Color.FromArgb(205, 150, 0) : Exit For
                    Else
                        For Each nItem As Object In GComandos_Comandos_Menu.Items
                            If nItem.Selected = True Then nItem.ForeColor = Color.FromArgb(205, 150, 0) : Exit For
                        Next : Exit For
                    End If
                End If
            Next
        End If
        If e.KeyCode = Keys.Left Or e.KeyCode = Keys.Escape Then
            If TypeOf sender IsNot NSContextMenu Then
                sender.OwnerItem.ForeColor = Color.FromArgb(205, 150, 0)
            Else
                For Each nItem As Object In QuickMenu_Editor.Items
                    If nItem.Selected = True Then nItem.ForeColor = Color.FromArgb(205, 150, 0) : Exit For
                Next
            End If
        End If
        If e.KeyCode = Keys.Home Then sender.Items(0).ForeColor = Color.FromArgb(205, 150, 0)
        If e.KeyCode = Keys.End Then sender.Items(sender.Items.Count - 1).ForeColor = Color.FromArgb(205, 150, 0)
        'Catch : End Try
    End Sub

    Private Sub GComandos_Comandos_Menu_MouseEnter(sender As Object, e As EventArgs)
        sender.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GComandos_Comandos_Menu_MouseLeave(sender As Object, e As EventArgs)
        sender.ForeColor = Color.FromArgb(130, 130, 130)
    End Sub

#End Region

#End Region

#Region " Help "

    Private Sub GComandos_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GComandos_LHelp.Click, GComandos_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Accion Comandos" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GComandos_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GComandos_LHelp.MouseEnter
        GComandos_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GComandos_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GComandos_LHelp.MouseLeave
        GComandos_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_Comandos_Tooltips(sender As Object, e As EventArgs) Handles GComandos_LAccion.MouseEnter, GComandos_LCAccion.MouseEnter, GComandos_LComandos.MouseEnter, GComandos_LCComandos.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GComandos_Accion", "GComandos_CAccion"
                Select Case GComandos_LCAccion.Text
                    Case "Ejecutar Comando" : Show_Tooltip(sender, "Ejecuta el comando seleccionado")
                    Case "Habilitar Comando" : Show_Tooltip(sender, "Habilita el comando seleccionado")
                    Case "Deshabilitar Comando" : Show_Tooltip(sender, "Deshabilita el comando seleccionado impidiendo su ejecución desde un 'Hotkey'")
                    Case "Comando (On/Off)" : Show_Tooltip(sender, "Habilita o deshabilita el comando seleccionado")
                End Select
            Case "GComandos_Comandos" : Show_Tooltip(sender, "Comando que se va ha ejecutar")
            Case "GComandos_CComandos"
                If GComandos_LCComandos.Text = "No hay comandos" Then Show_Tooltip(sender, "No se ha creado ningún comando")
                If GComandos_LCComandos.Text = "Seleccione un comando" Then Show_Tooltip(sender, "Selecciona un comandos de la lista")
        End Select
    End Sub

#End Region

#End Region

#Region " Esperar "

#Region " Textos "

    Private Sub GEsperar_TEsperar_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEsperar_TEsperar.KeyPress
        If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar) Then e.Handled = True
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GEsperar_TEsperar_GotFocus(sender As Object, e As EventArgs) Handles GEsperar_TEsperar.GotFocus
        GEsperar_TEsperar.Text = GEsperar_TEsperar.Text.Trim : GEsperar_TEsperar.SelectionLength = 0
    End Sub

    Private Sub GEsperar_TEsperar_LostFocus(sender As Object, e As EventArgs) Handles GEsperar_TEsperar.LostFocus
        GEsperar_TEsperar.Text = GEsperar_TEsperar.Text.Trim : GEsperar_TEsperar.SelectionLength = 0 : If GEsperar_TEsperar.Text = "" Then GEsperar_TEsperar.Text = "0"
        GEsperar_TEsperar.Text = CInt(GEsperar_TEsperar.Text)
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

    Private Sub GEsperar_LFormato_Click(sender As Object, e As MouseEventArgs) Handles GEsperar_LFormato.Click, GEsperar_LFormato.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If GEsperar_LFormato.Value2 = "ms" Then GEsperar_LFormato.Value2 = "sec" : GEsperar_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GEsperar_LFormato.Value2 = "sec" Then GEsperar_LFormato.Value2 = "min" : GEsperar_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
        If GEsperar_LFormato.Value2 = "min" Then GEsperar_LFormato.Value2 = "ms" : GEsperar_LFormato.Invalidate() : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
    End Sub

#End Region

#Region " OSD "

    Private Sub GEsperar_OSD_Click(sender As Object, e As MouseEventArgs) Handles GEsperar_LOSD.Click, GEsperar_LOSD.DoubleClick, GEsperar_COSD.Click, GEsperar_COSD.DoubleClick
        If e.Button = MouseButtons.Left Then
            If TypeOf sender Is NSLabel Then If GEsperar_COSD.Checked = True Then GEsperar_COSD.Checked = False Else GEsperar_COSD.Checked = True
            GEsperar_BOSD.Enabled = GEsperar_COSD.Checked : GEsperar_OSD_TTexto.Enabled = GEsperar_COSD.Checked
            If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
            If GEsperar_BOSD.Enabled = False Then
                GEsperar_OSD_TTexto.Text = "" : GEsperar_OSD_TTexto.ForeColor1 = Color.FromArgb(72, 72, 72)
            Else
                GEsperar_OSD_TTexto.ForeColor1 = Color.FromArgb(72, 72, 72)
                GEsperar_OSD_TTexto.Text = GEsperar_OSD_TTexto.Tag
                If GEsperar_OSD_TTexto.Text = "" Then GEsperar_OSD_TTexto.Text = "Mensaje a mostrar" Else GEsperar_OSD_TTexto.ForeColor1 = Color.FromArgb(102, 102, 102)
            End If
            GEsperar_CCuentaAtras.Enabled = GEsperar_COSD.Checked : GEsperar_LCuentaAtras.Enabled = GEsperar_COSD.Checked
        ElseIf e.Button = MouseButtons.Right Then
            If GEsperar_COSD.Checked = True And TypeOf sender Is NSLabel Then
                Dim Mensaje As String : If GEsperar_OSD_TTexto.ForeColor1 = Color.FromArgb(102, 102, 102) Then Mensaje = GEsperar_OSD_TTexto.Text Else Mensaje = "Mensaje de prueba"
                Opciones_OSD_Color = GEsperar_OSD_Color : Opciones_OSD_Font = GEsperar_OSD_Fuente : ShowOSD(Mensaje)
            End If
        End If
    End Sub

    Private Sub GEsperar_BOSD_Click(sender As Object, e As MouseEventArgs) Handles GEsperar_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = GEsperar_OSD_Fuente : Opciones_FontDialog.Color = GEsperar_OSD_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then GEsperar_OSD_Fuente = Opciones_FontDialog.Font : GEsperar_OSD_Color = Opciones_FontDialog.Color : GEsperar_BOSD.ForeColor1 = GEsperar_OSD_Color : GEsperar_BOSD.ForeColor3 = GEsperar_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = GEsperar_OSD_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then GEsperar_OSD_Color = Opciones_ColorDialog.Color : GEsperar_BOSD.ForeColor1 = GEsperar_OSD_Color : GEsperar_BOSD.ForeColor3 = GEsperar_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            GEsperar_OSD_Fuente = OSD_Default_Font : GEsperar_OSD_Color = Color.FromArgb(205, 150, 0) : GEsperar_BOSD.ForeColor1 = GEsperar_OSD_Color : GEsperar_BOSD.ForeColor3 = GEsperar_OSD_Color : If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
        End If : HTexto.Focus()
        Dim Mensaje As String : If GEsperar_OSD_TTexto.ForeColor1 = Color.FromArgb(102, 102, 102) Then Mensaje = GEsperar_OSD_TTexto.Text Else Mensaje = "Mensaje de prueba"
        Opciones_OSD_Color = GEsperar_OSD_Color : Opciones_OSD_Font = GEsperar_OSD_Fuente : ShowOSD(Mensaje)
    End Sub

    Private Sub GEsperar_OSD_TTexto_KeyPress(sender As Object, e As KeyPressEventArgs) Handles GEsperar_OSD_TTexto.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub GEsperar_OSD_TTexto_GotFocus(sender As Object, e As EventArgs) Handles GEsperar_OSD_TTexto.GotFocus
        If GEsperar_OSD_TTexto.ForeColor1 = Color.FromArgb(72, 72, 72) Then GEsperar_OSD_TTexto.Text = "" : GEsperar_OSD_TTexto.ForeColor1 = Color.FromArgb(102, 102, 102)
        GEsperar_OSD_TTexto.Text = GEsperar_OSD_TTexto.Text.Trim : GEsperar_OSD_TTexto.SelectionLength = 0
    End Sub

    Private Sub GEsperar_OSD_TTexto_LostFocus(sender As Object, e As EventArgs) Handles GEsperar_OSD_TTexto.LostFocus
        If GEsperar_OSD_TTexto.Text = "" Or GEsperar_OSD_TTexto.Text = "Mensaje a mostrar" Then
            GEsperar_OSD_TTexto.Tag = "" : GEsperar_OSD_TTexto.Text = "Mensaje a mostrar" : GEsperar_OSD_TTexto.ForeColor1 = Color.FromArgb(72, 72, 72)
        Else
            GEsperar_OSD_TTexto.Text = GEsperar_OSD_TTexto.Text.Trim : GEsperar_OSD_TTexto.SelectionLength = 0 : GEsperar_OSD_TTexto.Tag = GEsperar_OSD_TTexto.Text
        End If
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Checks "

    Private Sub GEsperar_CuentaAtras_Click(sender As Object, e As MouseEventArgs) Handles GEsperar_LCuentaAtras.Click, GEsperar_LCuentaAtras.DoubleClick, GEsperar_CCuentaAtras.Click, GEsperar_CCuentaAtras.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If GEsperar_CCuentaAtras.Checked = True Then GEsperar_CCuentaAtras.Checked = False Else GEsperar_CCuentaAtras.Checked = True
        If Comandos_Accion_ListaAccion.SelectedItems.Count > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag)
    End Sub

#End Region

#Region " Help "

    Private Sub GEsperar_LHelp_Click(sender As Object, e As MouseEventArgs) Handles GEsperar_LHelp.Click, GEsperar_LHelp.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Current_Help = "Esperar" : If FAyuda.Visible = False Then FAyuda.Show() Else FAyuda.Show_Help(FAyuda.Current_Help, True) : FAyuda.BringToFront()
    End Sub

    Private Sub GEsperar_LHelp_MouseEnter(sender As Object, e As EventArgs) Handles GEsperar_LHelp.MouseEnter
        GEsperar_LHelp.ForeColor1 = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub GEsperar_LHelp_MouseLeave(sender As Object, e As EventArgs) Handles GEsperar_LHelp.MouseLeave
        GEsperar_LHelp.ForeColor1 = Color.FromArgb(85, 85, 85)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Acciones_Esperar_Tooltips(sender As Object, e As EventArgs) Handles GEsperar_COSD.MouseEnter, GEsperar_LOSD.MouseEnter, GEsperar_BOSD.MouseEnter, GEsperar_LFormato.MouseEnter, GEsperar_CCuentaAtras.MouseEnter, GEsperar_LCuentaAtras.MouseEnter, GEsperar_LEsperar.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "GEsperar_OSD"
                If sender.Name = "GEsperar_COSD" Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
                If sender.Name = "GEsperar_LOSD" Then If GEsperar_COSD.Checked = True Then Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción" + vbCrLf + "Nota: Click Derecho para previsualizar") Else Show_Tooltip(sender, "Muestra un mensaje OSD al ejecutar la acción")
            Case "GEsperar_BOSD" : Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "GEsperar_Esperar" : Show_Tooltip(sender, "Tiempo que se esperará antes de continuar con la siguiente acción")
            Case "GEsperar_Formato" : Show_Tooltip(sender, "Click Izquierdo: Cambiar el modo de tiempo (min, sec, o ms)")
            Case "GEsperar_CuentaAtras" : Show_Tooltip(sender, "Muestra una cuenta atras en el OSD")
        End Select
    End Sub

#End Region

#End Region

#End Region

#End Region

#Region " Panel K-Board "

#Region " Funciones "

#Region " Resetear "

    Private Sub KBoard_Reset(Optional Guardar As Boolean = False)
        Dim Tecla As NSButton
        For Each cntrl As Control In KBoard_GKeyboard.Controls
            If TypeOf cntrl Is NSButton Then
                Tecla = cntrl : Tecla.Tag2 = "" : Tecla.Text = TagToKey(Tecla.Tag, Tecla.Tag) : Rutas.SetFontSize(Tecla, 7, 5)
                Tecla.CTRL = False : Tecla.SHIFT = False : Tecla.ALT = False : Tecla.WIN = False
                Tecla.Marked = False : Tecla.Marked_Set = False : Tecla.Invalidate() : Tecla.Refresh()
            End If
        Next
        BEnter4.BackColor = Color.FromArgb(65, 65, 65) : BEnter4.Invalidate()
        BEnter5.BackColor = Color.FromArgb(65, 65, 65) : BEnter5.Invalidate()
        KBoard_CLCtrl.Checked = False : KBoard_CRCtrl.Checked = False
        KBoard_CLShift.Checked = False : KBoard_CRShift.Checked = False
        KBoard_CLAlt.Checked = False : KBoard_CRAlt.Checked = False
        KBoard_CLWin.Checked = False : KBoard_CRWin.Checked = False
        For Each cntrl As Control In KBoard_GNumerico.Controls
            If TypeOf cntrl Is NSButton Then
                Tecla = cntrl : Tecla.Tag2 = "" : Tecla.Text = TagToKey(Tecla.Tag, Tecla.Tag) : Rutas.SetFontSize(Tecla, 7, 5)
                Tecla.CTRL = False : Tecla.SHIFT = False : Tecla.ALT = False : Tecla.WIN = False
                Tecla.Marked = False : Tecla.Marked_Set = False : Tecla.Invalidate() : Tecla.Refresh()
            End If
        Next
        For Each cntrl As Control In KBoard_GRaton.Controls
            If TypeOf cntrl Is NSButton Then
                Tecla = cntrl : Tecla.Tag2 = "" : Tecla.Text = TagToKey(Tecla.Tag, Tecla.Tag) : Rutas.SetFontSize(Tecla, 7, 5)
                Tecla.CTRL = False : Tecla.SHIFT = False : Tecla.ALT = False : Tecla.WIN = False
                Tecla.Marked = False : Tecla.Marked_Set = False : Tecla.Invalidate() : Tecla.Refresh()
            End If
        Next

        If Guardar = True Then
            Dim Indice As Integer = -1
            For Cuenta = 0 To KBoards.Length - 1
                If KBoards(Cuenta).Nombre.ToLower = KBoard_Nombre_TNombre.Tag.ToString.ToLower Then Indice = Cuenta : Exit For
            Next : If Indice = -1 Then Exit Sub

            KBoards(Indice).Keys = Nothing
            KBoard_CLCtrl.Checked = False : KBoard_CRCtrl.Checked = False
            KBoard_CLShift.Checked = False : KBoard_CRShift.Checked = False
            KBoard_CLAlt.Checked = False : KBoard_CRAlt.Checked = False
            KBoard_CLWin.Checked = False : KBoard_CRWin.Checked = False

            KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
        End If
    End Sub

    Private Sub PResetear_Click(sender As Object, e As MouseEventArgs) Handles PResetear.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If ShowMessageBox("¿Resetear todas las asignaciones?", Version, MsgBoxStyle.YesNo, "YesNo") <> DialogResult.Cancel Then KBoard_Reset(True)
    End Sub

    Private Sub PResetear_MouseEnter(sender As Object, e As EventArgs) Handles PResetear.MouseEnter
        If PResetear.Enabled = True Then PResetear.Image = My.Resources.KBoard_Reset_On
    End Sub

    Private Sub PResetear_MouseLeave(sender As Object, e As EventArgs) Handles PResetear.MouseLeave
        If PResetear.Enabled = True Then PResetear.Image = My.Resources.KBoard_Reset_Off
    End Sub

#End Region

#Region " KBoard Enable "

    Private Sub KBoard_Enable()
        For Each cntrl As Control In KBoard_GKeyboard.Controls
            If TypeOf cntrl Is NSButton Then cntrl.Enabled = True
        Next
        PResetear.Enabled = True
        BEnter3.Enabled = True
        BEnter4.BackColor = Color.FromArgb(65, 65, 65) : BEnter4.Invalidate()
        BEnter5.BackColor = Color.FromArgb(65, 65, 65) : BEnter5.Invalidate()
        KBoard_CLCtrl.Checked = False : KBoard_CRCtrl.Checked = False : KBoard_CLCtrl.Enabled = True : KBoard_CRCtrl.Enabled = True
        KBoard_CLShift.Checked = False : KBoard_CRShift.Checked = False : KBoard_CLShift.Enabled = True : KBoard_CRShift.Enabled = True
        KBoard_CLAlt.Checked = False : KBoard_CRAlt.Checked = False : KBoard_CLAlt.Enabled = True : KBoard_CRAlt.Enabled = True
        KBoard_CLWin.Checked = False : KBoard_CRWin.Checked = False : KBoard_CLWin.Enabled = True : KBoard_CRWin.Enabled = True
        For Each cntrl As Control In KBoard_GNumerico.Controls
            If TypeOf cntrl Is NSButton Then cntrl.Enabled = True
        Next
        For Each cntrl As Control In KBoard_GRaton.Controls
            If TypeOf cntrl Is NSButton Then cntrl.Enabled = True
        Next
    End Sub

#End Region

#Region " KBoard Disable "

    Private Sub KBoard_Disable()
        For Each cntrl As Control In KBoard_GKeyboard.Controls
            If TypeOf cntrl Is NSButton Then cntrl.Enabled = False
        Next
        PResetear.Enabled = False
        BEnter3.Enabled = False
        BEnter4.BackColor = Color.FromArgb(65, 65, 65) : BEnter4.Invalidate()
        BEnter5.BackColor = Color.FromArgb(65, 65, 65) : BEnter5.Invalidate()
        KBoard_CLCtrl.Checked = False : KBoard_CRCtrl.Checked = False : KBoard_CLCtrl.Enabled = False : KBoard_CRCtrl.Enabled = False
        KBoard_CLShift.Checked = False : KBoard_CRShift.Checked = False : KBoard_CLShift.Enabled = False : KBoard_CRShift.Enabled = False
        KBoard_CLAlt.Checked = False : KBoard_CRAlt.Checked = False : KBoard_CLAlt.Enabled = False : KBoard_CRAlt.Enabled = False
        KBoard_CLWin.Checked = False : KBoard_CRWin.Checked = False : KBoard_CLWin.Enabled = False : KBoard_CRWin.Enabled = False
        For Each cntrl As Control In KBoard_GNumerico.Controls
            If TypeOf cntrl Is NSButton Then cntrl.Enabled = False
        Next
        For Each cntrl As Control In KBoard_GRaton.Controls
            If TypeOf cntrl Is NSButton Then cntrl.Enabled = False
        Next
    End Sub

#End Region

#Region " KBoard Mostrar "

    Private Sub KBoard_Mostrar(Nombre As String)
        If KBoards Is Nothing Then Exit Sub
        Dim Indice As Integer = -1
        For Cuenta = 0 To KBoards.Length - 1
            If KBoards(Cuenta).Nombre.ToLower = Nombre.ToLower Then Indice = Cuenta : Exit For
        Next
        KBoard_Updating = True

        KBoard_CDeshabilitado.Checked = False
        KBoard_CAutoActivar.Checked = False
        KBoard_CProceso.Items.Clear()
        KBoard_LCProceso.Text = "" : KBoard_LCProceso_TextChanged(Nothing, Nothing)
        If Indice = -1 Then KBoard_Updating = False : Exit Sub

        KBoard_CDeshabilitado.Checked = KBoards(Indice).Deshabilitado
        KBoard_CAutoActivar.Checked = KBoards(Indice).AutoActivar

        KBoard_CProceso.Items.Clear()
        If KBoards(Indice).Procesos IsNot Nothing Then
            For Cuenta = 0 To KBoards(Indice).Procesos.Length - 1
                If KBoards(Indice).Procesos(Cuenta) <> "" Then KBoard_CProceso.Items.Add(KBoards(Indice).Procesos(Cuenta))
            Next
        End If
        If KBoard_CProceso.Items.Count > 0 Then
            KBoard_CProceso.SelectedItem = 0
            KBoard_TProceso.Text = KBoard_CProceso.Items(0)
            KBoard_LCProceso.Text = KBoard_TProceso.Text
        Else
            KBoard_TProceso.Text = ""
            KBoard_LCProceso.Text = "" : KBoard_LCProceso.Text = KBoard_TProceso.Text
        End If : KBoard_LCProceso_TextChanged(Nothing, Nothing)

        KBoard_Teclas_Update()

        KBoard_Updating = False
    End Sub

#End Region

#Region " KBoard SetKey "

    Private Sub KBoard_SetKey(cKey As String, nKey As String)
        If cKey = "Nombre" Or cKey = "" Or nKey = "" Then Exit Sub

        Dim Keyboard_Modificadores As String = ""
        If KBoard_CLCtrl.Checked = True Or KBoard_CRCtrl.Checked = True Then Keyboard_Modificadores += "CTRL + "
        If KBoard_CLAlt.Checked = True Then Keyboard_Modificadores += "ALT + "
        If KBoard_CLShift.Checked = True Or KBoard_CRShift.Checked = True Then Keyboard_Modificadores += "SHIFT + "
        If KBoard_CLWin.Checked = True Or KBoard_CRWin.Checked = True Then Keyboard_Modificadores += "WIN + "

        Dim Tecla As NSButton
        For Each cntrl As Control In KBoard_GKeyboard.Controls
            If TypeOf cntrl Is NSButton Then
                Tecla = cntrl : If Tecla.Name = "BEnter2" Then Tecla = BEnter
                If (Keyboard_Modificadores + Tecla.Tag).ToString.ToLower = cKey.ToLower Then
                    If cKey.ToLower = nKey.ToLower Then
                        Tecla.Marked = False
                        If Tecla.Name = "BEnter" Then
                            BEnter2.Marked = False
                            BEnter4.BackColor = Color.FromArgb(205, 150, 0) : BEnter4.Invalidate()
                            BEnter5.BackColor = Color.FromArgb(205, 150, 0) : BEnter5.Invalidate()
                        End If
                    Else
                        Tecla.Marked = True
                        If Tecla.Name = "BEnter" Then
                            BEnter2.Marked = True
                            BEnter4.BackColor = Color.Green : BEnter4.Invalidate()
                            BEnter5.BackColor = Color.Green : BEnter5.Invalidate()
                        End If
                    End If
                    Tecla.Tag2 = nKey : Tecla.Text = TagToKey(cKey, nKey)
                    If Tecla.Tag2.ToLower.Contains("ctrl + ") Then Tecla.CTRL = True Else Tecla.CTRL = False
                    If Tecla.Tag2.ToLower.Contains("shift + ") Then Tecla.SHIFT = True Else Tecla.SHIFT = False
                    If Tecla.Tag2.ToLower.Contains("alt + ") Then Tecla.ALT = True Else Tecla.ALT = False
                    If Tecla.Tag2.ToLower.Contains("win + ") Then Tecla.WIN = True Else Tecla.WIN = False
                    Tecla.Text = Tecla.Text.Replace("CTRL + ", "").Replace("SHIFT + ", "").Replace("ALT + ", "").Replace("WIN", "") : Rutas.SetFontSize(Tecla, 7, 5)
                    Tecla.Invalidate() : BEnter2.Invalidate()
                End If
            End If
        Next

        For Each cntrl As Control In KBoard_GNumerico.Controls
            If TypeOf cntrl Is NSButton Then
                Tecla = cntrl
                If Tecla.Tag.ToString.ToLower = cKey.ToLower Then
                    If cKey.ToLower = nKey.ToLower Then Tecla.Marked = False Else Tecla.Marked = True
                    Tecla.Tag2 = nKey : Tecla.Text = TagToKey(cKey, nKey)
                    If Tecla.Tag2.ToLower.Contains("ctrl + ") Then Tecla.CTRL = True Else Tecla.CTRL = False
                    If Tecla.Tag2.ToLower.Contains("shift + ") Then Tecla.SHIFT = True Else Tecla.SHIFT = False
                    If Tecla.Tag2.ToLower.Contains("alt + ") Then Tecla.ALT = True Else Tecla.ALT = False
                    If Tecla.Tag2.ToLower.Contains("win + ") Then Tecla.WIN = True Else Tecla.WIN = False
                    Tecla.Text = Tecla.Text.Replace("CTRL + ", "").Replace("SHIFT + ", "").Replace("ALT + ", "").Replace("WIN", "") : Rutas.SetFontSize(Tecla, 7, 5)
                    Tecla.Invalidate()
                End If
            End If
        Next

        For Each cntrl As Control In KBoard_GRaton.Controls
            If TypeOf cntrl Is NSButton Then
                Tecla = cntrl
                If Tecla.Tag.ToString.ToLower = cKey.ToLower Then
                    If cKey.ToLower = nKey.ToLower Then Tecla.Marked = False Else Tecla.Marked = True
                    Tecla.Tag2 = nKey : Tecla.Text = TagToKey(cKey, nKey)
                    If Tecla.Tag2.ToLower.Contains("ctrl + ") Then Tecla.CTRL = True Else Tecla.CTRL = False
                    If Tecla.Tag2.ToLower.Contains("shift + ") Then Tecla.SHIFT = True Else Tecla.SHIFT = False
                    If Tecla.Tag2.ToLower.Contains("alt + ") Then Tecla.ALT = True Else Tecla.ALT = False
                    If Tecla.Tag2.ToLower.Contains("win + ") Then Tecla.WIN = True Else Tecla.WIN = False
                    Tecla.Text = Tecla.Text.Replace("CTRL + ", "").Replace("SHIFT + ", "").Replace("ALT + ", "").Replace("WIN", "") : Rutas.SetFontSize(Tecla, 7, 5)
                    Tecla.Invalidate()
                End If
            End If
        Next
    End Sub

#End Region

#Region " Tecla Añadir "

    Private Sub KBoard_Tecla_Añadir(CambiarTecla As String, PorTecla As String)
        If KBoard_Updating = True Or KBoards Is Nothing Then Exit Sub
        Dim Indice As Integer = -1
        For Cuenta = 0 To KBoards.Length - 1
            If KBoards(Cuenta).Nombre.ToLower = KBoard_Nombre_TNombre.Tag.ToString.ToLower Then Indice = Cuenta : Exit For
        Next : If Indice = -1 Then Exit Sub

        Dim Contador As Integer : Dim Tecla1, Tecla2 As String
        If KBoards(Indice).Keys Is Nothing Then ReDim KBoards(Indice).Keys(Contador) : Contador += 1 Else Contador = KBoards(Indice).Keys.Length
        For Cuenta = 0 To KBoards(Indice).Keys.Length - 1
            If KBoards(Indice).Keys(Cuenta) IsNot Nothing Then
                Tecla1 = Split(KBoards(Indice).Keys(Cuenta), "|-|", , CompareMethod.Text)(0)
                Tecla2 = Split(KBoards(Indice).Keys(Cuenta), "|-|", , CompareMethod.Text)(1)
                If Tecla1.ToLower = CambiarTecla.ToLower Then KBoards(Indice).Keys(Cuenta) = CambiarTecla + "|-|" + PorTecla : Exit Sub
            End If
        Next
        ReDim Preserve KBoards(Indice).Keys(Contador)
        KBoards(Indice).Keys(Contador) = CambiarTecla + "|-|" + PorTecla
    End Sub

#End Region

#Region " Tecla Eliminar "

    Private Sub KBoard_Tecla_Eliminar(CambiarTecla As String)
        If KBoard_Updating = True Or KBoards Is Nothing Then Exit Sub
        Dim Indice As Integer = -1
        For Cuenta = 0 To KBoards.Length - 1
            If KBoards(Cuenta).Nombre.ToLower = KBoard_Nombre_TNombre.Tag.ToString.ToLower Then Indice = Cuenta : Exit For
        Next : If Indice = -1 Or KBoards(Indice).Keys Is Nothing Then Exit Sub

        Dim Tecla1, Tecla2 As String
        For Cuenta = 0 To KBoards(Indice).Keys.Length - 1
            If KBoards(Indice).Keys(Cuenta) IsNot Nothing Then
                Tecla1 = Split(KBoards(Indice).Keys(Cuenta), "|-|", , CompareMethod.Text)(0)
                Tecla2 = Split(KBoards(Indice).Keys(Cuenta), "|-|", , CompareMethod.Text)(1)
                If Tecla1.ToLower = CambiarTecla.ToLower Then KBoard_Tecla_Eliminar(Indice, Cuenta) : Exit Sub
            End If
        Next
    End Sub

    Private Sub KBoard_Tecla_Eliminar(Indice As Integer, IndiceTecla As Integer)
        Array.Copy(KBoards(Indice).Keys, IndiceTecla + 1, KBoards(Indice).Keys, IndiceTecla, UBound(KBoards(Indice).Keys) - IndiceTecla)
        ReDim Preserve KBoards(Indice).Keys(UBound(KBoards(Indice).Keys) - 1)
    End Sub

#End Region

#Region " Teclas Update "

    Private Sub KBoard_Teclas_Update()
        If KBoards Is Nothing Then Exit Sub

        Dim Indice As Integer = -1
        For Cuenta = 0 To KBoards.Length - 1
            If KBoards(Cuenta).Nombre.ToLower = KBoard_Nombre_TNombre.Tag.ToString.ToLower Then Indice = Cuenta : Exit For
        Next : If Indice = -1 Then Exit Sub

        Dim Tecla As NSButton
        For Each cntrl As Control In KBoard_GKeyboard.Controls
            If TypeOf cntrl Is NSButton Then
                Tecla = cntrl : Tecla.Tag2 = "" : Tecla.Text = TagToKey(Tecla.Tag, Tecla.Tag) : Rutas.SetFontSize(Tecla, 7, 5)
                Tecla.CTRL = False : Tecla.SHIFT = False : Tecla.ALT = False : Tecla.WIN = False
                Tecla.Marked = False : Tecla.Marked_Set = False : Tecla.Invalidate() : Tecla.Refresh()
                BEnter4.BackColor = Color.FromArgb(65, 65, 65) : BEnter4.Invalidate()
                BEnter5.BackColor = Color.FromArgb(65, 65, 65) : BEnter5.Invalidate()
            End If
        Next
        For Each cntrl As Control In KBoard_GNumerico.Controls
            If TypeOf cntrl Is NSButton Then
                Tecla = cntrl : Tecla.Tag2 = "" : Tecla.Text = TagToKey(Tecla.Tag, Tecla.Tag) : Rutas.SetFontSize(Tecla, 7, 5)
                Tecla.CTRL = False : Tecla.SHIFT = False : Tecla.ALT = False : Tecla.WIN = False
                Tecla.Marked = False : Tecla.Marked_Set = False : Tecla.Invalidate() : Tecla.Refresh()
            End If
        Next
        For Each cntrl As Control In KBoard_GRaton.Controls
            If TypeOf cntrl Is NSButton Then
                Tecla = cntrl : Tecla.Tag2 = "" : Tecla.Text = TagToKey(Tecla.Tag, Tecla.Tag) : Rutas.SetFontSize(Tecla, 7, 5)
                Tecla.CTRL = False : Tecla.SHIFT = False : Tecla.ALT = False : Tecla.WIN = False
                Tecla.Marked = False : Tecla.Marked_Set = False : Tecla.Invalidate() : Tecla.Refresh()
            End If
        Next

        Dim cModificadores As String = ""
        If KBoard_CLCtrl.Checked = True Or KBoard_CRCtrl.Checked = True Then cModificadores += "CTRL + "
        If KBoard_CLAlt.Checked = True Then cModificadores += "ALT + "
        If KBoard_CLShift.Checked = True Or KBoard_CRShift.Checked = True Then cModificadores += "SHIFT + "
        If KBoard_CLWin.Checked = True Or KBoard_CRWin.Checked = True Then cModificadores += "WIN + "

        If KBoards(Indice).Keys IsNot Nothing Then
            Dim Tecla1, Tecla2 As String
            For Cuenta = 0 To KBoards(Indice).Keys.Length - 1
                If KBoards(Indice).Keys(Cuenta) IsNot Nothing Then
                    Tecla1 = Split(KBoards(Indice).Keys(Cuenta), "|-|", , CompareMethod.Text)(0)
                    Tecla2 = Split(KBoards(Indice).Keys(Cuenta), "|-|", , CompareMethod.Text)(1)
                    If Tecla1 = cModificadores + Tecla1.Replace("CTRL + ", "").Replace("ALT + ", "").Replace("SHIFT + ", "").Replace("WIN + ", "") Then KBoard_SetKey(cModificadores + Tecla1.Replace("CTRL + ", "").Replace("ALT + ", "").Replace("SHIFT + ", "").Replace("WIN + ", ""), Tecla2)
                End If
            Next
        End If
    End Sub

#End Region

#End Region

#Region " Controles "

#Region " Nombre "

#Region " TNombre "

    Private Sub KBoard_Nombre_LCNombre_TextChanged(sender As Object, e As EventArgs) Handles KBoard_Nombre_LCNombre.TextChanged
        KBoard_Nombre_TNombre.Enabled = False
        KBoard_Nombre_LCNombre.Text = KBoard_Nombre_TNombre.Text
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(KBoard_Nombre_LCNombre.Text, New Font(KBoard_Nombre_LCNombre.Font.Name, TextSize, FontStyle.Regular)).Width < KBoard_Nombre_LCNombre.Width Or TextSize < 4 : TextSize -= 1 : Loop : KBoard_Nombre_LCNombre.Font = New Font(KBoard_Nombre_LCNombre.Font.Name, TextSize, FontStyle.Regular)
    End Sub

    Private Sub KBoard_Nombre_LCNombre_Click(sender As Object, e As MouseEventArgs) Handles KBoard_Nombre_LCNombre.Click, KBoard_Nombre_TNombre.Click
        If e.Button = MouseButtons.Left Then
            If KBoard_Nombre_CNombre.Items.Count > 0 AndAlso KBoard_Nombre_CNombre.Enabled = True Then KBoard_Nombre_CNombre.DroppedDown = True : KBoard_Nombre_CNombre.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            KBoard_Nombre_LCNombre.Visible = False : Combo_IgnoreOne = True : KBoard_Nombre_TNombre.ReadOnly = False : KBoard_Nombre_TNombre.Enabled = True : KBoard_Nombre_TNombre.Cursor = Cursors.IBeam : KBoard_Nombre_TNombre.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub KBoard_Nombre_TNombre_KeyPress(sender As Object, e As KeyPressEventArgs) Handles KBoard_Nombre_TNombre.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub KBoard_Nombre_TNombre_TextChanged(sender As Object, e As EventArgs) Handles KBoard_Nombre_TNombre.TextChanged
        If TextRenderer.MeasureText(KBoard_Nombre_TNombre.Text, KBoard_Nombre_TNombre.Font).Width >= KBoard_Nombre_TNombre.Width + 30 Then KBoard_Nombre_TNombre.MaxLength = 25 Else KBoard_Nombre_TNombre.MaxLength = 40
    End Sub

    Private Sub KBoard_Nombre_TNombre_GotFocus(sender As Object, e As EventArgs) Handles KBoard_Nombre_TNombre.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub KBoard_Nombre_TNombre_LostFocus(sender As Object, e As EventArgs) Handles KBoard_Nombre_TNombre.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If KBoard_Nombre_TNombre.Text.ToLower <> KBoard_Nombre_TNombre.Tag.ToString.ToLower Then
            For Cuenta = 0 To KBoard_Nombre_CNombre.Items.Count - 1
                If KBoard_Nombre_CNombre.Items(Cuenta).ToString.ToLower = KBoard_Nombre_TNombre.Text.ToLower Then
                    ShowMessageBox("Ya existe un K-Board con el nombre '" + KBoard_Nombre_TNombre.Text + "'", Version)
                    KBoard_Nombre_TNombre.Text = KBoard_Nombre_TNombre.Tag : KBoard_Nombre_TNombre.SelectionStart = 0 : KBoard_Nombre_TNombre.SelectionLength = 0 : Combo_IgnoreOne = True : Focus_KBoard_Name = True : Exit Sub
                End If
            Next
        End If
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If KBoard_Nombre_LCNombre.Visible = False Then KBoard_Nombre_LCNombre.Visible = True : KBoard_Nombre_TNombre.ReadOnly = True : KBoard_Nombre_TNombre.Enabled = False : KBoard_Nombre_TNombre.Cursor = Cursors.Hand
        If KBoard_Nombre_TNombre.Text.Trim = "" Then KBoard_Nombre_TNombre.Text = KBoard_Nombre_TNombre.Tag : Exit Sub
        If KBoard_Nombre_TNombre.Text = KBoard_Nombre_TNombre.Tag Then Exit Sub
        For Cuenta = 0 To KBoard_Nombre_CNombre.Items.Count - 1
            If KBoard_Nombre_TNombre.Tag.ToLower = KBoard_Nombre_CNombre.Items(Cuenta).ToLower Then
                Dim OldName As String = KBoard_Nombre_TNombre.Tag

                KBoard_Nombre_TNombre.Tag = KBoard_Nombre_TNombre.Text
                KBoard_Nombre_CNombre.Items(Cuenta) = KBoard_Nombre_TNombre.Tag
                If KBoards Is Nothing OrElse KBoards.Length = 0 Then GoTo CrearNuevo
                For Cuenta2 = 0 To KBoards.Length - 1
                    If KBoards(Cuenta2).Nombre.ToLower = OldName.ToLower Then
                        KBoards(Cuenta2).Nombre = KBoard_Nombre_TNombre.Tag
                        Registro.DelReg(RegPath + "\KBoard\" + OldName.Replace("\", "|/|"))
                        KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
                    End If
                Next
            End If
        Next : KBoard_Nombre_TNombre.SelectionLength = 0 : KBoard_Nombre_LCNombre.Text = KBoard_Nombre_TNombre.Tag : Exit Sub

CrearNuevo: Estadisticas.Estadisticas.KBoard_Creados += 1 : Estadisticas.Guardar()
        KBoard_Nombre_TNombre.SelectionLength = 0 : KBoard_Nombre_LCNombre.Text = KBoard_Nombre_TNombre.Text
        If KBoards IsNot Nothing Then ReDim Preserve KBoards(KBoards.Length) Else ReDim KBoards(0)
        KBoards(KBoards.Length - 1).Nombre = KBoard_Nombre_TNombre.Text
        KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
    End Sub

#End Region

#Region " CNombre "

    Private Sub KBoard_Nombre_CNombre_DropDown(sender As Object, e As EventArgs) Handles KBoard_Nombre_CNombre.DropDown
        KBoard_Nombre_TNombre.Enabled = True
        If KBoard_Nombre_CNombre.Items.Count > 0 Then KBoard_Nombre_CNombre.MaxDropDownItems = 10
        Combo_Dropped = True : Combo_TempValue = KBoard_Nombre_TNombre.Text
        If KBoard_Nombre_CNombre.Items.Contains(KBoard_Nombre_TNombre.Text) = True Then KBoard_Nombre_CNombre.SelectedItem = KBoard_Nombre_TNombre.Text Else KBoard_Nombre_CNombre.SelectedIndex = 0
    End Sub

    Private Sub KBoard_Nombre_CNombre_DropDownClosed(sender As Object, e As EventArgs) Handles KBoard_Nombre_CNombre.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub KBoard_Nombre_CNombre_LostFocus(sender As Object, e As EventArgs) Handles KBoard_Nombre_CNombre.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub KBoard_Nombre_CNombre_SelectedIndexChanged(sender As Object, e As EventArgs) Handles KBoard_Nombre_CNombre.SelectedIndexChanged
        If Combo_TempValue = "" Then KBoard_Nombre_TNombre.Text = KBoard_Nombre_CNombre.SelectedItem.Trim : KBoard_Nombre_LCNombre.Text = KBoard_Nombre_TNombre.Text : KBoard_Nombre_TNombre.Tag = KBoard_Nombre_TNombre.Text : HTexto.Focus() : KBoard_Mostrar(KBoard_Nombre_TNombre.Tag)
    End Sub

    Private Sub KBoard_Nombre_CNombre_KeyPress(sender As Object, e As KeyPressEventArgs) Handles KBoard_Nombre_CNombre.KeyPress
        If Asc(e.KeyChar) = 13 Then KBoard_Nombre_TNombre.Text = KBoard_Nombre_CNombre.SelectedItem.Trim : KBoard_Nombre_LCNombre.Text = KBoard_Nombre_TNombre.Text : HTexto.Focus() : e.Handled = True
    End Sub

#End Region

#Region " Botones "

    Private Sub KBoard_Nombre_BAdd_Click(sender As Object, e As MouseEventArgs) Handles KBoard_Nombre_BAdd.Click
        HTexto.Focus() : If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Contador As Integer
        For Cuenta = 0 To KBoard_Nombre_CNombre.Items.Count - 1
            If KBoard_Nombre_CNombre.Items(Cuenta).ToString.ToLower = "nuevo_" + Contador.ToString Then Contador += 1 : Cuenta = 0
        Next
        If KBoards IsNot Nothing Then ReDim Preserve KBoards(KBoards.Length) Else ReDim KBoards(0)
        Dim NewTitulo As String = "Nuevo_" + Contador.ToString
        KBoard_Nombre_TNombre.Tag = NewTitulo
        KBoards(KBoards.Length - 1).Nombre = NewTitulo
        KBoard_Nombre_CNombre.Enabled = True
        KBoard_Nombre_CNombre.Items.Add(NewTitulo)
        KBoard_Nombre_LCNombre.Cursor = Cursors.Hand
        KBoard_Nombre_TNombre.Cursor = Cursors.Hand
        KBoard_Nombre_BDelete.Enabled = True
        KBoard_CProceso.Items.Clear()
        KBoard_LProceso.Enabled = True
        KBoard_TProceso.Cursor = Cursors.Hand
        KBoard_LCProceso.Cursor = Cursors.Hand
        KBoard_TProceso.Enabled = True
        KBoard_LCProceso.Enabled = True
        KBoard_BProcesoAdd.Enabled = True
        KBoard_BProcesoEliminar.Enabled = True
        KBoard_BProcesoExaminar.Enabled = True
        KBoard_TProceso.Cursor = Cursors.Hand
        KBoard_LCambiar.Enabled = True
        KBoard_LCCambiar.Cursor = Cursors.Hand
        KBoard_TCambiar.Cursor = Cursors.Hand
        KBoard_LPor.Enabled = True
        KBoard_LCPor.Cursor = Cursors.Hand
        KBoard_TPor.Cursor = Cursors.Hand
        KBoard_LDeshabilitado.Enabled = True
        KBoard_CDeshabilitado.Enabled = True
        KBoard_CDeshabilitado.Checked = False
        KBoard_LAutoActivar.Enabled = True
        KBoard_CAutoActivar.Enabled = True
        KBoard_CAutoActivar.Checked = False
        PResetear.Enabled = True
        KBoard_Enable()
        KBoard_TEstado.Text = "desactivado" : KBoard_TEstado.ForeColor = Color.DarkRed
        KBoard_LEstado.Visible = True
        KBoard_TEstado.Visible = True
        KBoard_LNumerico.Enabled = True
        KBoard_LRaton.Enabled = True
        KBoard_LTeclado.Enabled = True
        KBoard_Guardar(NewTitulo.ToLower)
        KBoard_Nombre_CNombre.SelectedItem = NewTitulo
        Estadisticas.Estadisticas.KBoard_Creados += 1 : Estadisticas.Guardar()
    End Sub

    Private Sub KBoard_Nombre_BDelete_Click(sender As Object, e As MouseEventArgs) Handles KBoard_Nombre_BDelete.Click
        HTexto.Focus() : If e.Button <> MouseButtons.Left Then Exit Sub
        For Cuenta = 0 To KBoard_Nombre_CNombre.Items.Count - 1
            If KBoard_Nombre_CNombre.Items(Cuenta).ToString.ToLower = KBoard_Nombre_TNombre.Tag.ToString.ToLower Then
                If ShowMessageBox("¿Eliminar '" + KBoard_Nombre_TNombre.Tag.ToString + "'?", Version, MsgBoxStyle.YesNo) <> DialogResult.OK Then Exit Sub
                Registro.DelReg(RegPath + "\KBoard\" + KBoard_Nombre_CNombre.Items(Cuenta).Replace("\", "|/|"))
                KBoard_Nombre_CNombre.Items.RemoveAt(Cuenta)
                KBoard_Eliminar(Cuenta)
                If KBoard_Nombre_CNombre.Items.Count = 0 Then
                    KBoard_Nombre_TNombre.Text = ""
                    KBoard_Nombre_TNombre.Tag = ""
                    KBoard_Nombre_LCNombre.Text = ""
                    KBoard_Nombre_LCNombre.Cursor = Cursors.Default
                    KBoard_Nombre_TNombre.Cursor = Cursors.Default
                    KBoard_Nombre_BDelete.Enabled = False
                    KBoard_LProceso.Enabled = False
                    KBoard_LCProceso.Enabled = False
                    KBoard_BProcesoAdd.Enabled = False
                    KBoard_BProcesoEliminar.Enabled = False
                    KBoard_BProcesoExaminar.Enabled = False
                    KBoard_TProceso.Cursor = Cursors.Default
                    KBoard_LCambiar.Enabled = False
                    KBoard_LCCambiar.Cursor = Cursors.Default
                    KBoard_TCambiar.Cursor = Cursors.Default
                    KBoard_LPor.Enabled = False
                    KBoard_LCPor.Cursor = Cursors.Default
                    KBoard_TPor.Cursor = Cursors.Default
                    KBoard_LDeshabilitado.Enabled = False
                    KBoard_CDeshabilitado.Enabled = False
                    KBoard_CDeshabilitado.Checked = False
                    KBoard_LAutoActivar.Enabled = False
                    KBoard_CAutoActivar.Enabled = False
                    KBoard_CAutoActivar.Checked = False
                    PResetear.Enabled = False
                    KBoard_LEstado.Visible = False
                    KBoard_TEstado.Visible = False
                    KBoard_LNumerico.Enabled = False
                    KBoard_LRaton.Enabled = False
                    KBoard_LTeclado.Enabled = False
                    KBoard_CProceso.Items.Clear()
                    KBoard_LCProceso.Text = "Seleccione una aplicación"
                    KBoard_LCProceso_TextChanged(Nothing, Nothing)
                    KBoard_Reset()
                    KBoard_Disable()
                Else
                    KBoard_Nombre_CNombre.SelectedIndex = 0
                End If
                Estadisticas.Estadisticas.KBoard_Eliminados += 1 : Estadisticas.Guardar()
                Exit Sub
            End If
        Next
    End Sub

    Private Sub KBoard_Eliminar(Indice As Integer)
        Array.Copy(KBoards, Indice + 1, KBoards, Indice, UBound(KBoards) - Indice)
        ReDim Preserve KBoards(UBound(KBoards) - 1)
    End Sub

#End Region

#End Region

#Region " Procesos "

#Region " LCProceso "

    Private Sub KBoard_LCProceso_TextChanged(sender As Object, e As EventArgs) Handles KBoard_LCProceso.TextChanged
        Rutas.SetFontSize(KBoard_LCProceso, 8)
        KBoard_TProceso.Enabled = False
        If KBoard_TProceso.Text.Trim = "" AndAlso KBoard_CProceso.Items.Count = 0 Then KBoard_LCProceso.Text = "Seleccione una aplicación" : KBoard_TProceso.ForeColor1 = Color.FromArgb(72, 72, 72)
    End Sub

    Private Sub KBoard_LCProceso_Click(sender As Object, e As MouseEventArgs) Handles KBoard_LCProceso.Click, KBoard_LCProceso.DoubleClick, KBoard_TProceso.Click, KBoard_TProceso.DoubleClick
        If KBoard_LCProceso.Enabled = False Then Exit Sub
        If e.Button = MouseButtons.Left Then
            If KBoard_CProceso.Items.Count > 0 Then KBoard_Procesos_ShowCombo() Else KBoard_BProcesoAdd_Click(Nothing, e)
        ElseIf e.Button = MouseButtons.Right Then
            KBoard_TProceso.Text = "" : KBoard_LCProceso.Visible = False : Combo_IgnoreOne = True : KBoard_TProceso.ReadOnly = False : KBoard_TProceso.Enabled = True : KBoard_TProceso.Cursor = Cursors.IBeam : KBoard_TProceso.Focus()
        Else : HTexto.Focus() : End If
    End Sub

#End Region

#Region " TProceso "

    Private Sub KBoard_TProceso_GotFocus(sender As Object, e As EventArgs) Handles KBoard_TProceso.GotFocus
        If KBoard_LCProceso.Visible = True Then HTexto.Focus()
        If KBoard_TProceso.ForeColor1 = Color.FromArgb(72, 72, 72) Then KBoard_TProceso.Text = "" : KBoard_TProceso.ForeColor1 = Color.FromArgb(102, 102, 102)
        Texto_Focused = True
    End Sub

    Private Sub KBoard_TProceso_LostFocus(sender As Object, e As EventArgs) Handles KBoard_TProceso.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If KBoard_LCProceso.Visible = False Then KBoard_LCProceso.Visible = True : KBoard_TProceso.ReadOnly = True : KBoard_TProceso.Enabled = False : KBoard_TProceso.Cursor = Cursors.Hand
        If KBoard_TProceso.Text.Length > 1 Then KBoard_TProceso.Text = KBoard_TProceso.Text.Trim.Substring(0, 1).ToUpper + KBoard_TProceso.Text.Trim.Substring(1) : KBoard_TProceso.SelectionLength = 0
        If KBoard_CProceso.Items.Count > 0 Then
            For Cuenta = 0 To KBoard_CProceso.Items.Count - 1
                If KBoard_CProceso.Items(Cuenta).ToLower = KBoard_TProceso.Text.ToLower Then GoTo Sigue
            Next
            KBoard_CProceso.SelectedItem = 0
            KBoard_TProceso.Text = KBoard_CProceso.Items(0)
Sigue:      KBoard_LCProceso.Text = KBoard_TProceso.Text
        Else
            KBoard_TProceso.Text = ""
            KBoard_LCProceso.Text = KBoard_TProceso.Text
        End If
    End Sub

    Private Sub KBoard_TProceso_KeyDown(sender As Object, e As KeyEventArgs) Handles KBoard_TProceso.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : KBoard_Procesos_ShowCombo()
    End Sub

    Private Sub KBoard_TProceso_KeyPress(sender As Object, e As KeyPressEventArgs) Handles KBoard_TProceso.KeyPress
        If Asc(e.KeyChar) = 13 Then
            Try : Dim Cuenta As Integer : e.Handled = True : KBoard_TProceso.Text = KBoard_TProceso.Text.Trim
                If KBoard_TProceso.Text <> "" Then
                    If KBoard_CProceso.Items.Count > 0 Then
                        For Cuenta = 0 To KBoard_CProceso.Items.Count - 1
                            If KBoard_CProceso.Items(Cuenta).ToLower = KBoard_TProceso.Text.ToLower Then KBoard_LCProceso.Text = KBoard_TProceso.Text : HTexto.Focus() : Exit Sub
                        Next
                    End If
                    If KBoard_CheckProcesos(KBoard_TProceso.Text) = False Then HTexto.Focus() : Exit Sub
                    KBoard_CProceso.Items.Add(KBoard_TProceso.Text.Substring(0, 1).ToUpper + KBoard_TProceso.Text.Substring(1))
                    KBoard_LCProceso.Text = KBoard_TProceso.Text.Substring(0, 1).ToUpper + KBoard_TProceso.Text.Substring(1)
                    KBoard_CProceso.Enabled = True
                    KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
                Else
                    If KBoard_CProceso.Items.Count > 0 Then
                        KBoard_LCProceso.Text = KBoard_TProceso.Text
                    Else
                        KBoard_TProceso.Text = ""
                        KBoard_LCProceso.Text = KBoard_TProceso.Text
                    End If
                End If
            Catch : End Try : HTexto.Focus()
        End If
    End Sub

#End Region

#Region " CProcesos "

    Private Sub KBoard_Procesos_ShowCombo()
        If KBoard_CProceso.Items.Count = 0 Then HTexto.Focus() : Exit Sub
        KBoard_CProceso.Sorted = True : KBoard_CProceso.Sorted = False
        KBoard_CProceso.MaxDropDownItems = 10
        If KBoard_CProceso.Items.Contains(KBoard_TProceso.Text) = True Then KBoard_CProceso.SelectedItem = KBoard_TProceso.Text Else KBoard_CProceso.SelectedIndex = 0
        KBoard_CProceso.DroppedDown = True : Combo_Dropped = True : KBoard_CProceso.Focus()
    End Sub

    Private Sub KBoard_CProceso_SelectionChangeCommitted(sender As Object, e As EventArgs) Handles KBoard_CProceso.SelectionChangeCommitted
        KBoard_TProceso.Text = KBoard_CProceso.SelectedItem.Trim
        KBoard_LCProceso.Text = KBoard_TProceso.Text
        HTexto.Focus()
    End Sub

    Private Sub KBoard_CProceso_KeyPress(sender As Object, e As KeyPressEventArgs) Handles KBoard_CProceso.KeyPress
        If Asc(e.KeyChar) = 13 Then KBoard_TProceso.Text = KBoard_CProceso.SelectedItem.Trim : KBoard_LCProceso.Text = KBoard_TProceso.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub KBoard_CProceso_LostFocus(sender As Object, e As EventArgs) Handles KBoard_CProceso.LostFocus
        Combo_Dropped = False
    End Sub

#End Region

#Region " Añadir "

    Private Sub KBoard_BProcesoAdd_Click(sender As Object, e As MouseEventArgs) Handles KBoard_BProcesoAdd.Click
        If e IsNot Nothing AndAlso e.Button <> MouseButtons.Left Then Exit Sub
        KBoard_CCurrentProceso.Items.Clear()
        For Each P As Process In Process.GetProcesses
            If NoAñadir.ToLower.Contains(P.ProcessName.ToLower + ",") = True Then GoTo Salta
            If P.ProcessName <> "" Then
                For Cuenta = 0 To KBoard_CProceso.Items.Count - 1
                    If KBoard_CProceso.Items(Cuenta).ToLower = P.ProcessName.ToLower Then GoTo Salta
                Next
                For Cuenta = 0 To KBoard_CCurrentProceso.Items.Count - 1
                    If P.ProcessName.ToLower = KBoard_CCurrentProceso.Items(Cuenta).ToString.ToLower Then GoTo Salta
                Next : KBoard_CCurrentProceso.Items.Add(P.ProcessName.Substring(0, 1).ToUpper + P.ProcessName.Substring(1))
Salta:      End If
        Next
        If KBoard_CCurrentProceso.Items.Count = 0 Then HTexto.Focus() : Exit Sub
        KBoard_CCurrentProceso.Sorted = True : KBoard_CCurrentProceso.Sorted = False
        KBoard_CCurrentProceso.MaxDropDownItems = 10
        If KBoard_CCurrentProceso.Items.Contains(KBoard_TProceso.Text) = True Then KBoard_CCurrentProceso.SelectedItem = KBoard_TProceso.Text Else KBoard_CCurrentProceso.SelectedIndex = 0
        KBoard_CCurrentProceso.DroppedDown = True : Combo_Dropped = True : KBoard_CCurrentProceso.Focus()
    End Sub

#Region " Combo "

    Private Sub KBoard_CCurrentProceso_SelectionChangeCommitted(sender As Object, e As EventArgs) Handles KBoard_CCurrentProceso.SelectionChangeCommitted
        For Cuenta = 0 To KBoard_CProceso.Items.Count - 1
            If KBoard_CProceso.Items(Cuenta).ToLower = KBoard_CCurrentProceso.SelectedItem.ToString.ToLower.Trim Then HTexto.Focus() : Exit Sub
        Next
        If KBoard_CheckProcesos(KBoard_CCurrentProceso.SelectedItem.Trim) = False Then Exit Sub
        KBoard_CProceso.Items.Add(KBoard_CCurrentProceso.SelectedItem.Trim)
        KBoard_TProceso.Text = KBoard_CCurrentProceso.SelectedItem.Trim
        KBoard_LCProceso.Text = KBoard_TProceso.Text
        KBoard_CProceso.Enabled = True
        KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
        HTexto.Focus()
    End Sub

    Private Sub KBoard_CCurrentProceso_KeyPress(sender As Object, e As KeyPressEventArgs) Handles KBoard_CCurrentProceso.KeyPress
        If Asc(e.KeyChar) = 13 Then KBoard_TProceso.Text = KBoard_CCurrentProceso.SelectedItem.Trim : KBoard_LCProceso.Text = KBoard_TProceso.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub KBoard_CCurrentProceso_LostFocus(sender As Object, e As EventArgs) Handles KBoard_CCurrentProceso.LostFocus
        Combo_Dropped = False
    End Sub

#End Region

#End Region

#Region " Eliminar "

    Private Sub KBoard_BProcesoEliminar_Click(sender As Object, e As MouseEventArgs) Handles KBoard_BProcesoEliminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        KBoard_CProceso.Items.Remove(KBoard_TProceso.Text)
        KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
        If KBoard_CProceso.Items.Count > 0 Then
            KBoard_CProceso.SelectedItem = 0
            KBoard_TProceso.Text = KBoard_CProceso.Items(0)
            KBoard_LCProceso.Text = KBoard_TProceso.Text
        Else
            KBoard_CProceso.Enabled = False
            KBoard_TProceso.Text = ""
            KBoard_LCProceso.Text = KBoard_TProceso.Text
        End If
    End Sub

#End Region

#Region " Examinar "

    Private Sub KBoard_BProcesoExaminar_Click(sender As Object, e As MouseEventArgs) Handles KBoard_BProcesoExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar aplicacion..." : Abrir.Filter = "Aplicaciones|*.exe|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then
            KBoard_TProceso.Text = IO.Path.GetFileNameWithoutExtension(Abrir.FileName).Substring(0, 1).ToUpper + IO.Path.GetFileNameWithoutExtension(Abrir.FileName).Substring(1)
            KBoard_LCProceso.Text = KBoard_TProceso.Text
            Dim Cuenta As Integer : KBoard_TProceso.Text = KBoard_TProceso.Text.Trim : If KBoard_TProceso.Text <> "" Then
                For Cuenta = 0 To KBoard_CProceso.Items.Count - 1
                    If KBoard_CProceso.Items(Cuenta).ToLower = KBoard_TProceso.Text.ToLower Then Exit Sub
                Next : KBoard_CProceso.Items.Add(KBoard_TProceso.Text.Substring(0, 1).ToUpper + KBoard_TProceso.Text.Substring(1))
                KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
                KBoard_TProceso.Text = KBoard_TProceso.Text.Substring(0, 1).ToUpper + KBoard_TProceso.Text.Substring(1)
                KBoard_LCProceso.Text = KBoard_TProceso.Text
                KBoard_CProceso.Enabled = True
            End If
        End If
        KBoard_BProcesoExaminar.State = NSButton.MouseState.None : KBoard_BProcesoExaminar.Invalidate() : HTexto.Focus()
    End Sub

#End Region

#Region " Check Procesos "

    Private Function KBoard_CheckProcesos(Proceso As String, Optional Reemplazar As Boolean = False) As Boolean
        If Proceso.Length > 1 Then Proceso = Proceso.Substring(0, 1).ToUpper + Proceso.Substring(1)
        If KBoards IsNot Nothing Then
            For Cuenta = 0 To KBoards.Length - 1
                If KBoards(Cuenta).Nombre = KBoard_Nombre_TNombre.Tag AndAlso (KBoards(Cuenta).Deshabilitado = True Or KBoards(Cuenta).AutoActivar = False) Then Return True
            Next
            For Cuenta = 0 To KBoards.Length - 1
                If KBoards(Cuenta).Nombre <> KBoard_Nombre_TNombre.Tag AndAlso KBoards(Cuenta).AutoActivar = True AndAlso KBoards(Cuenta).Deshabilitado = False AndAlso KBoards(Cuenta).Procesos IsNot Nothing Then
Repite:             For Cuenta2 = 0 To KBoards(Cuenta).Procesos.Length - 1
                        If KBoards(Cuenta).Procesos(Cuenta2).ToLower = Proceso.ToLower Then
                            If Reemplazar = False Then
                                Dim Respuesta As Boolean
                                If ShowMessageBox("El proceso '" + Proceso + "' ya se encuentra en otro K-Board", Version, MsgBoxStyle.YesNo, "Establecer", "¿Desea establecer el proceso a este K-Board?") = DialogResult.OK Then Respuesta = True
                                If Respuesta = True Then KBoard_TProceso.Text = Proceso : KBoard_CheckProcesos(Proceso, True)
                                Return Respuesta
                            Else
                                KBoard_Proceso_Eliminar(Cuenta, Cuenta2) : GoTo Repite
                            End If
                        End If
                    Next
                End If
            Next
        End If : Return True
    End Function

    Private Sub KBoard_Proceso_Eliminar(KBoard_Indice As Integer, Indice As Integer)
        If Indice = -1 Then Exit Sub
        Array.Copy(KBoards(KBoard_Indice).Procesos, Indice + 1, KBoards(KBoard_Indice).Procesos, Indice, UBound(KBoards(KBoard_Indice).Procesos) - Indice)
        ReDim Preserve KBoards(KBoard_Indice).Procesos(UBound(KBoards(KBoard_Indice).Procesos) - 1)
        KBoard_Guardar(KBoard_Indice)
    End Sub

#End Region

#End Region

#Region " Checks "

    Private Function KBoard_CheckProcesos_Full(Optional Avisar As Boolean = False) As String
        Dim Indice As Integer = -1
        If KBoards IsNot Nothing Then
            For Cuenta = 0 To KBoards.Length - 1
                If KBoards(Cuenta).Nombre = KBoard_Nombre_TNombre.Tag Then
                    If KBoards(Cuenta).Procesos IsNot Nothing Then Indice = Cuenta
                    Exit For
                End If
            Next
            If Indice = -1 Then Return "Limpio"
Repite:     For cProcesos = 0 To KBoards(Indice).Procesos.Length - 1
                For Cuenta = 0 To KBoards.Length - 1
                    If Cuenta <> Indice AndAlso KBoards(Cuenta).Nombre <> KBoard_Nombre_TNombre.Tag AndAlso KBoards(Cuenta).AutoActivar = True AndAlso KBoards(Cuenta).Deshabilitado = False AndAlso KBoards(Cuenta).Procesos IsNot Nothing Then
                        For Cuenta2 = 0 To KBoards(Cuenta).Procesos.Length - 1
                            If KBoards(Indice).Procesos(cProcesos) <> "" AndAlso KBoards(Cuenta).Procesos(Cuenta2).ToLower = KBoards(Indice).Procesos(cProcesos).ToLower Then
                                If Avisar = True Then
                                    Dim Respuesta As MsgBoxResult
                                    Respuesta = ShowMessageBox("Hay un conflicto de procesos en K-Boards auto-activados", Version, MsgBoxStyle.YesNoCancel, "KBoard_Proceso", "¿Desea establecerlo a este K-Board? Pulse 'No' para eliminar los procesos conflictivos")
                                    Select Case Respuesta
                                        Case MsgBoxResult.Ok : KBoard_CheckProcesos_Full() : Return "Limpio"
                                        Case MsgBoxResult.No : KBoard_CheckProcesos_No() : Return "Limpio"
                                        Case MsgBoxResult.Cancel : Return "Cancelar"
                                    End Select
                                Else
                                    KBoard_CheckProcesos(KBoards(Indice).Procesos(cProcesos), True) : GoTo Repite
                                End If
                            End If
                        Next
                    End If
                Next
            Next
        End If : Return "Limpio"
    End Function

    Private Sub KBoard_CheckProcesos_No()
        Dim Indice As Integer = -1
        If KBoards IsNot Nothing Then
            For Cuenta = 0 To KBoards.Length - 1
                If KBoards(Cuenta).Nombre = KBoard_Nombre_TNombre.Tag Then
                    If KBoards(Cuenta).Procesos IsNot Nothing Then Indice = Cuenta
                    Exit For
                End If
            Next
            If Indice = -1 Then Exit Sub

Repite:     For cProcesos = 0 To KBoards(Indice).Procesos.Length - 1
                For Cuenta = 0 To KBoards.Length - 1
                    If KBoards(Cuenta).Nombre <> KBoard_Nombre_TNombre.Tag AndAlso KBoards(Cuenta).AutoActivar = True AndAlso KBoards(Cuenta).Deshabilitado = False AndAlso KBoards(Cuenta).Procesos IsNot Nothing Then
                        For Cuenta2 = 0 To KBoards(Cuenta).Procesos.Length - 1
                            If KBoards(Cuenta).Procesos(Cuenta2).ToLower = KBoards(Indice).Procesos(cProcesos).ToLower Then KBoard_Proceso_Eliminar(Indice, cProcesos) : GoTo Repite
                        Next
                    End If
                Next
            Next

            KBoard_CProceso.Items.Clear()
            If KBoards(Indice).Procesos IsNot Nothing Then
                For Cuenta = 0 To KBoards(Indice).Procesos.Length - 1
                    If KBoards(Indice).Procesos(Cuenta) <> "" Then KBoard_CProceso.Items.Add(KBoards(Indice).Procesos(Cuenta))
                Next
            End If
            If KBoard_CProceso.Items.Count > 0 Then
                KBoard_CProceso.SelectedItem = 0
                KBoard_TProceso.Text = KBoard_CProceso.Items(0)
                KBoard_LCProceso.Text = KBoard_TProceso.Text
            Else
                KBoard_TProceso.Text = ""
                KBoard_LCProceso.Text = "" : KBoard_LCProceso.Text = KBoard_TProceso.Text
            End If : KBoard_LCProceso_TextChanged(Nothing, Nothing)
        End If
    End Sub

    Private Sub KBoard_AutoActivar_Click(sender As Object, e As MouseEventArgs) Handles KBoard_CAutoActivar.Click, KBoard_CAutoActivar.DoubleClick, KBoard_LAutoActivar.Click, KBoard_LAutoActivar.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If KBoard_CAutoActivar.Checked = True Then KBoard_CAutoActivar.Checked = False Else KBoard_CAutoActivar.Checked = True
        If KBoard_CAutoActivar.Checked = True AndAlso KBoard_CheckProcesos_Full(True) = "Cancelar" Then KBoard_CAutoActivar.Checked = Not KBoard_CAutoActivar.Checked : Exit Sub
        If KBoard_CAutoActivar.Checked = False Then
            If KBoards IsNot Nothing Then
                For Cuenta = 0 To KBoards.Length - 1
                    If KBoards(Cuenta).Nombre = KBoard_Nombre_TNombre.Tag Then
                        KBoards(Cuenta).Activo = False
                        KBoard_TEstado.Text = "desactivado" : KBoard_TEstado.ForeColor = Color.DarkRed
                    End If
                Next
            End If
        End If
        KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
    End Sub

    Private Sub KBoard_Deshabilitado_Click(sender As Object, e As MouseEventArgs) Handles KBoard_CDeshabilitado.Click, KBoard_CDeshabilitado.DoubleClick, KBoard_LDeshabilitado.Click, KBoard_LDeshabilitado.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If KBoard_CDeshabilitado.Checked = True Then KBoard_CDeshabilitado.Checked = False Else KBoard_CDeshabilitado.Checked = True
        If KBoard_CDeshabilitado.Checked = True AndAlso KBoard_CheckProcesos_Full(True) = "Cancelar" Then KBoard_CDeshabilitado.Checked = Not KBoard_CDeshabilitado.Checked : Exit Sub
        If KBoard_CDeshabilitado.Checked = False Then
            For Cuenta = 0 To KBoards.Length - 1
                If KBoards(Cuenta).Nombre.ToLower = KBoard_Nombre_TNombre.Tag.ToString.ToLower Then KBoards(Cuenta).Activo = False : KBoard_TEstado.Text = "desactivado" : KBoard_TEstado.ForeColor = Color.DarkRed : Exit For
            Next
        End If
        KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
    End Sub

    Private Sub KBoard_TEstado_Click(sender As Object, e As MouseEventArgs) Handles KBoard_TEstado.Click, KBoard_TEstado.DoubleClick
        If e.Button <> MouseButtons.Left Or KBoard_CDeshabilitado.Checked = True Then Exit Sub
        For Cuenta = 0 To KBoards.Length - 1
            If KBoards(Cuenta).Nombre.ToLower = KBoard_Nombre_TNombre.Tag.ToString.ToLower Then
                If KBoards(Cuenta).Activo = True Then KBoards(Cuenta).Activo = False Else KBoards(Cuenta).Activo = True : Estadisticas.Estadisticas.KBoard_Ejecutados += 1 : Estadisticas.Guardar()
                If KBoards(Cuenta).Activo = True Then KBoard_TEstado.Text = "activado" : KBoard_TEstado.ForeColor = Color.DarkGreen Else KBoard_TEstado.Text = "desactivado" : KBoard_TEstado.ForeColor = Color.DarkRed
            Else
                KBoards(Cuenta).Activo = False
            End If
        Next
    End Sub

    Private Sub KBoard_Shift_Click(sender As Object, e As MouseEventArgs) Handles KBoard_CLShift.Click, KBoard_CLShift.DoubleClick, KBoard_CRShift.Click, KBoard_CRShift.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If sender.name = "KBoard_CLShift" Then KBoard_CRShift.Checked = KBoard_CLShift.Checked
        If sender.name = "KBoard_CRShift" Then KBoard_CLShift.Checked = KBoard_CRShift.Checked
        KBoard_Teclas_Update()
    End Sub

    Private Sub KBoard_Ctrl_Click(sender As Object, e As MouseEventArgs) Handles KBoard_CLCtrl.Click, KBoard_CLCtrl.DoubleClick, KBoard_CRCtrl.Click, KBoard_CRCtrl.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If sender.name = "KBoard_CLCtrl" Then KBoard_CRCtrl.Checked = KBoard_CLCtrl.Checked
        If sender.name = "KBoard_CRCtrl" Then KBoard_CLCtrl.Checked = KBoard_CRCtrl.Checked
        If KBoard_CLAlt.Checked = True Then If sender.Checked = True Then KBoard_CRAlt.Checked = True Else KBoard_CRAlt.Checked = False
        KBoard_Teclas_Update()
    End Sub

    Private Sub KBoard_LAlt_Click(sender As Object, e As MouseEventArgs) Handles KBoard_CLAlt.Click, KBoard_CLAlt.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If KBoard_CLAlt.Checked = True And KBoard_CLCtrl.Checked = True Then KBoard_CRAlt.Checked = True Else KBoard_CRAlt.Checked = False
        KBoard_Teclas_Update()
    End Sub

    Private Sub KBoard_RAlt_Click(sender As Object, e As MouseEventArgs) Handles KBoard_CRAlt.Click, KBoard_CRAlt.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If KBoard_CRAlt.Checked = True Then
            KBoard_CLCtrl.Checked = True
            KBoard_CRCtrl.Checked = True
            KBoard_CLAlt.Checked = True
        Else
            KBoard_CLCtrl.Checked = False
            KBoard_CRCtrl.Checked = False
            KBoard_CLAlt.Checked = False
        End If
        KBoard_Teclas_Update()
    End Sub

    Private Sub KBoard_Win_Click(sender As Object, e As MouseEventArgs) Handles KBoard_CLWin.Click, KBoard_CLWin.DoubleClick, KBoard_CRWin.Click, KBoard_CRWin.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If sender.name = "KBoard_CLWin" Then KBoard_CRWin.Checked = KBoard_CLWin.Checked
        If sender.name = "KBoard_CRWin" Then KBoard_CLWin.Checked = KBoard_CRWin.Checked
        KBoard_Teclas_Update()
    End Sub

#End Region

#Region " HotKeys "

#Region " Cambiar "

    Private Sub KBoard_LCCambiar_TextChanged(sender As Object, e As EventArgs) Handles KBoard_LCCambiar.TextChanged
        Rutas.SetFontSize(KBoard_LCCambiar, 6.75, 5.25)
    End Sub

    Private Sub KBoard_Cambiar_DoubleClick(sender As Object, e As EventArgs) Handles KBoard_TCambiar.DoubleClick, KBoard_LCCambiar.DoubleClick
        KBoard_TCambiar.Text = "" : KBoard_TPor.Text = ""
        Dim KTecla As NSButton
        For Each cntrl As Control In KBoard_GKeyboard.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton)
                If KTecla.ClientRectangle.Contains(KTecla.PointToClient(MousePosition)) = False Then
                    KTecla.State = NSButton.MouseState.None
                    If cntrl.Name = "BEnter" Then
                        BEnter2.State = NSButton.MouseState.None : BEnter2.Invalidate()
                        BEnter4.BackColor = Color.FromArgb(65, 65, 65) : BEnter4.Invalidate()
                        BEnter5.BackColor = Color.FromArgb(65, 65, 65) : BEnter5.Invalidate()
                    End If
                End If : KTecla.Marked_Set = False : KTecla.Invalidate()
            End If
        Next
        For Each cntrl As Control In KBoard_GNumerico.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton)
                If KTecla.ClientRectangle.Contains(KTecla.PointToClient(MousePosition)) = False Then KTecla.State = NSButton.MouseState.None
                KTecla.Marked_Set = False : KTecla.Invalidate()
            End If
        Next
        For Each cntrl As Control In KBoard_GRaton.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton)
                If KTecla.ClientRectangle.Contains(KTecla.PointToClient(MousePosition)) = False Then KTecla.State = NSButton.MouseState.None
                KTecla.Marked_Set = False : KTecla.Invalidate()
            End If
        Next : ComandoScript = "" : TVTecla.Enabled = False : IniciaContador = False : Contador = 0
    End Sub

    Private Sub KBoard_TCambiar_TextChanged(sender As Object, e As EventArgs) Handles KBoard_TCambiar.TextChanged
        KBoard_LCCambiar.Text = KBoard_TCambiar.Text
    End Sub

    Private Sub KBoard_TCambiar_KeyPress(sender As Object, e As KeyPressEventArgs) Handles KBoard_TCambiar.KeyPress
        e.Handled = True : If Asc(e.KeyChar) = 13 Then HTexto.Focus()
    End Sub

    Private Sub KBoard_Cambiar_GotFocus(sender As Object, e As EventArgs) Handles KBoard_TCambiar.GotFocus, KBoard_LCCambiar.Click
        If KBoard_TEstado.Visible = False Then Exit Sub
        KBoard_TCambiar.isKeyLog = True : KBoard_TCambiar.Invalidate()
        KBoard_Cambiar_Mouse_HotKey = True : KBoard_Cambiar_HotKey = True : HotkeyM = True
    End Sub

    Private Sub KBoard_LCCambiar_Click(sender As Object, e As EventArgs) Handles KBoard_LCCambiar.Click
        If KBoard_TEstado.Visible = False Then Exit Sub
        KBoard_TCambiar.isKeyLog = True : KBoard_TCambiar.Invalidate()
        KBoard_Cambiar_Mouse_HotKey = True : KBoard_Cambiar_HotKey = True : HotkeyM = True : HTexto.Focus()
    End Sub

#End Region

#Region " Por "

    Private Sub KBoard_LCPor_TextChanged(sender As Object, e As EventArgs) Handles KBoard_LCPor.TextChanged
        Rutas.SetFontSize(KBoard_LCPor, 6.75, 5.25)
    End Sub

    Private Sub KBoard_Por_DoubleClick(sender As Object, e As EventArgs) Handles KBoard_TPor.DoubleClick, KBoard_LCPor.DoubleClick
        If KBoard_LCCambiar.Text = "" Then Exit Sub
        KBoard_TPor.Text = ""
        If CTecla IsNot Nothing Then
            If CTecla.Name = "BEnter" Or CTecla.Name = "BEnter2" Then
                BEnter.Tag2 = "" : CTecla.CTRL = False : CTecla.SHIFT = False : CTecla.ALT = False : CTecla.WIN = False
                BEnter.Text = TagToKey(BEnter.Tag, BEnter.Tag)
                Rutas.SetFontSize(CTecla, 7, 5)
                If BEnter.Tag.ToString.ToLower = BEnter.Tag2.ToString.ToLower Then
                    BEnter.Marked = False : BEnter2.Marked = False
                    BEnter4.BackColor = Color.FromArgb(205, 150, 0) : BEnter4.Invalidate()
                    BEnter5.BackColor = Color.FromArgb(205, 150, 0) : BEnter5.Invalidate()
                End If
                BEnter.Marked_Set = False : BEnter.Invalidate()
                BEnter2.Marked_Set = False : BEnter2.Invalidate()
            Else
                CTecla.Tag2 = "" : CTecla.CTRL = False : CTecla.SHIFT = False : CTecla.ALT = False : CTecla.WIN = False
                CTecla.Text = TagToKey(CTecla.Tag, CTecla.Tag)
                CTecla.Marked = False : CTecla.Marked_Set = False : CTecla.Invalidate()
                Rutas.SetFontSize(CTecla, 7, 5)
            End If
        End If
        ComandoScript = "" : TVTecla.Enabled = False : IniciaContador = False : Contador = 0
        Dim cModificadores As String = ""
        If KBoard_CLCtrl.Checked = True Or KBoard_CRCtrl.Checked = True Then cModificadores += "CTRL + "
        If KBoard_CLAlt.Checked = True Then cModificadores += "ALT + "
        If KBoard_CLShift.Checked = True Or KBoard_CRShift.Checked = True Then cModificadores += "SHIFT + "
        If KBoard_CLWin.Checked = True Or KBoard_CRWin.Checked = True Then cModificadores += "WIN + "
        KBoard_Tecla_Eliminar(KBoard_Nombre_TNombre.Tag.ToString.ToLower, cModificadores + CTecla.Tag)
        KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
    End Sub

    Private Sub KBoard_TPor_TextChanged(sender As Object, e As EventArgs) Handles KBoard_TPor.TextChanged
        KBoard_LCPor.Text = KBoard_TPor.Text
    End Sub

    Private Sub KBoard_TPor_KeyPress(sender As Object, e As KeyPressEventArgs) Handles KBoard_TPor.KeyPress
        e.Handled = True : If Asc(e.KeyChar) = 13 Then HTexto.Focus()
    End Sub

    Private Sub KBoard_Por_GotFocus(sender As Object, e As EventArgs) Handles KBoard_TPor.GotFocus, KBoard_LCPor.Click
        If KBoard_TEstado.Visible = False Or KBoard_LCCambiar.Text = "" Then Exit Sub
        KBoard_TPor.isKeyLog = True : KBoard_TPor.Invalidate()
        KBoard_Por_Mouse_HotKey = True : KBoard_Por_HotKey = True : HotkeyM = True
    End Sub

    Private Sub KBoard_LCPor_Click(sender As Object, e As EventArgs) Handles KBoard_LCPor.Click
        If KBoard_TEstado.Visible = False Or KBoard_LCCambiar.Text = "" Then Exit Sub
        KBoard_TPor.isKeyLog = True : KBoard_TPor.Invalidate()
        KBoard_Por_Mouse_HotKey = True : KBoard_Por_HotKey = True : HotkeyM = True : HTexto.Focus()
    End Sub

#End Region

#Region " TagToHotKey "

    Private Function TagToHotKey(Tecla As String) As String
        Dim cKModificadores As String = ""
        If Tecla.Contains("CTRL + ") Then cKModificadores += "CTRL + "
        If Tecla.Contains("ALT + ") Then cKModificadores += "ALT + "
        If Tecla.Contains("SHIFT + ") Then cKModificadores += "SHIFT + "
        If Tecla.Contains("WIN + ") Then cKModificadores += "WIN + "
        Tecla = Tecla.Replace("CTRL + ", "").Replace("ALT + ", "").Replace("SHIFT + ", "").Replace("WIN + ", "")

        Select Case Tecla.ToLower
            Case "escape" : Return cKModificadores + "ESC"
            Case "lctrl" : Return cKModificadores + "CTRL"
            Case "rctrl" : Return cKModificadores + "CTRL"
            Case "lshift" : Return cKModificadores + "SHIFT"
            Case "rshift" : Return cKModificadores + "SHIFT"
            Case "lalt" : Return cKModificadores + "ALT"
            Case "<^>!" : Return cKModificadores + "ALT GR"
            Case "lwin" : Return cKModificadores + "WIN"
            Case "rwin" : Return cKModificadores + "WIN"
            Case "appskey" : Return cKModificadores + "MENU"
            Case "capslock" : Return cKModificadores + "Caps"
           'Scroll
            Case "printscreen" : Return cKModificadores + "Impr"
            Case "scrolllock" : Return cKModificadores + "Scroll"
            Case "pause" : Return cKModificadores + "Pause"
            Case "insert" : Return cKModificadores + "Ins"
            Case "delete" : Return cKModificadores + "Del"
            Case "home" : Return cKModificadores + "Home"
            Case "end" : Return cKModificadores + "End"
            Case "pgup" : Return cKModificadores + "PgUp"
            Case "pgdn" : Return cKModificadores + "PgDn"
            Case "up" : Return cKModificadores + "↑"
            Case "down" : Return cKModificadores + "↓"
            Case "left" : Return cKModificadores + "←"
            Case "right" : Return cKModificadores + "→"
           'NumericPad
            Case "numlock" : Return cKModificadores + "Num Lock"
            Case "numpaddiv" : Return cKModificadores + "Num /"
            Case "numpadmult" : Return cKModificadores + "Num *"
            Case "numpadsub" : Return cKModificadores + "Num -"
            Case "numpadadd" : Return cKModificadores + "Num +"
            Case "numpadenter" : Return cKModificadores + "Num ENT"
            Case "numpad1" : Return cKModificadores + "Num 1"
            Case "numpad2" : Return cKModificadores + "Num 2"
            Case "numpad3" : Return cKModificadores + "Num 3"
            Case "numpad4" : Return cKModificadores + "Num 4"
            Case "numpad5" : Return cKModificadores + "Num 5"
            Case "numpad6" : Return cKModificadores + "Num 6"
            Case "numpad7" : Return cKModificadores + "Num 7"
            Case "numpad8" : Return cKModificadores + "Num 8"
            Case "numpad9" : Return cKModificadores + "Num 9"
            Case "numpad0" : Return cKModificadores + "Num 0"
            Case "numpaddot" : Return cKModificadores + "Num ."
            Case "numpadup" : Return cKModificadores + "Num ↑"
            Case "numpaddown" : Return cKModificadores + "Num ↓"
            Case "numpadleft" : Return cKModificadores + "Num ←"
            Case "numpadright" : Return cKModificadores + "Num →"
            Case "numpadhome" : Return cKModificadores + "Num Home"
            Case "numpadend" : Return cKModificadores + "Num End"
            Case "numpadpgup" : Return cKModificadores + "Num PgUp"
            Case "numpadpgdn" : Return cKModificadores + "Num PgDn"
            Case "numpadclear" : Return cKModificadores + "Num Clear"
            Case "numpadinsert" : Return cKModificadores + "Num Ins"
            Case "numpaddelete" : Return cKModificadores + "Num Del"
            'Multimedia
            Case "mediastop" : Return cKModificadores + "⏹"
            Case "mediaplay", "mediaplaypause" : Return cKModificadores + "⏯"
            Case "mediarewind", "mediaprevioustrack" : Return cKModificadores + "⏮"
            Case "mediafoward", "medianexttrack" : Return cKModificadores + "⏭"

            Case "launchapplication1" : Return cKModificadores + "App 1"
            Case "launchapplication2" : Return cKModificadores + "App 2"

            Case "volumeup" : Return cKModificadores + "Vol Up"
            Case "volumedown" : Return cKModificadores + "Vol Down"
            Case "volumemute" : Return cKModificadores + "Vol Mute"
            Case "selectmedia" : Return cKModificadores + "Media"

            Case "browserhome" : Return cKModificadores + "B. Home"
            Case "launchmail" : Return cKModificadores + "Mail"
            Case "browsersearch" : Return cKModificadores + "B. Search"
            Case "browserfavorites" : Return cKModificadores + "B. Fav"
            Case "browserrefresh" : Return cKModificadores + "B. Refresh"
            Case "browserstop" : Return cKModificadores + "B. Stop"
            Case "browserforward" : Return cKModificadores + "B. Forward"
            Case "browserback" : Return cKModificadores + "B. Back"

            Case "wheel up" : Return cKModificadores + "Wheel ↑"
            Case "wheel down" : Return cKModificadores + "Wheel ↓"
            Case "hwheel up" : Return cKModificadores + "Wheel ←"
            Case "hwheel down" : Return cKModificadores + "Wheel →"
        End Select : Return cKModificadores + Globalization.CultureInfo.CurrentCulture.TextInfo.ToTitleCase(Tecla)
    End Function

#End Region

#Region " HotKeyToTag "

    Private Function HotKeyToTag(Tecla As String) As String
        Dim cKModificadores As String = ""
        If Tecla.Contains("CTRL + ") Then cKModificadores += "CTRL + "
        If Tecla.Contains("ALT + ") Then cKModificadores += "ALT + "
        If Tecla.Contains("SHIFT + ") Then cKModificadores += "SHIFT + "
        If Tecla.Contains("WIN + ") Then cKModificadores += "WIN + "
        Tecla = Tecla.Replace("CTRL + ", "").Replace("ALT + ", "").Replace("SHIFT + ", "").Replace("WIN + ", "")

        Select Case Tecla.ToLower
            Case "app 1" : Return cKModificadores + "launchapplication1"
            Case "prtscrn" : Return cKModificadores + "printscreen"
        End Select : Return cKModificadores + Tecla.ToLower
    End Function

#End Region

#Region " MainKeyChanged "

    Private Function MainKeyChanged(Tecla As String) As String
        Dim Indice As Integer = -1
        For Cuenta = 0 To KBoards.Length - 1
            If KBoards(Cuenta).Nombre.ToLower = KBoard_Nombre_TNombre.Tag.ToString.ToLower Then Indice = Cuenta : Exit For
        Next : If Indice = -1 Then Return Tecla

        If KBoards(Indice).Keys IsNot Nothing Then
            Dim Tecla1, Tecla2 As String
            For Cuenta2 = 0 To KBoards(Indice).Keys.Length - 1
                If KBoards(Indice).Keys(Cuenta2) IsNot Nothing Then
                    Tecla1 = Split(KBoards(Indice).Keys(Cuenta2), "|-|", , CompareMethod.Text)(0)
                    Tecla2 = Split(KBoards(Indice).Keys(Cuenta2), "|-|", , CompareMethod.Text)(1)
                    If Tecla1.ToLower = Tecla.ToLower Then Return Tecla2
                End If
            Next
        End If : Return Tecla
    End Function

#End Region

#End Region

#Region " Keyboard "

#Region " Mouse Move "

    Private Sub KBoard_PRaton_MouseMove(sender As Object, e As MouseEventArgs) Handles KBoard_PRaton.MouseMove
        If KBoard_LCProceso.Enabled = False Then
            If KBoard_PRaton.Tag <> "None" Then KBoard_PRaton.Image = My.Resources.KBoard_None : KBoard_PRaton.Tag = "None" : KBoard_PRaton.Invalidate()
            Exit Sub
        End If
        Dim Boton As String = "None"
        If KBoard_LButton.IsVisible(e.Location) Then Boton = "LClick"
        If KBoard_MButton.IsVisible(e.Location) Then Boton = "MClick"
        If KBoard_RButton.IsVisible(e.Location) Then Boton = "RClick"
        If KBoard_Button4.IsVisible(e.Location) Then Boton = "Button4"
        If KBoard_Button5.IsVisible(e.Location) Then Boton = "Button5"
        Select Case Boton
            Case "None" : If KBoard_PRaton.Tag <> "None" Then
                    KBoard_PRaton.Image = My.Resources.KBoard_None : KBoard_PRaton.Tag = "None" : KBoard_PRaton.Invalidate()
                    BLClick.State = NSButton.MouseState.None : BLClick.Invalidate()
                    BMClick.State = NSButton.MouseState.None : BMClick.Invalidate()
                    BRClick.State = NSButton.MouseState.None : BRClick.Invalidate()
                    BButton4.State = NSButton.MouseState.None : BButton4.Invalidate()
                    BButton5.State = NSButton.MouseState.None : BButton5.Invalidate()
                End If
            Case "LClick" : If KBoard_PRaton.Tag <> "LClick" Then KBoard_PRaton.Image = My.Resources.KBoard_LButton : KBoard_PRaton.Tag = "LClick" : KBoard_PRaton.Invalidate() : BLClick.State = NSButton.MouseState.Hover : BLClick.Invalidate()
            Case "MClick" : If KBoard_PRaton.Tag <> "MClick" Then KBoard_PRaton.Image = My.Resources.KBoard_MButton : KBoard_PRaton.Tag = "MClick" : KBoard_PRaton.Invalidate() : BMClick.State = NSButton.MouseState.Hover : BMClick.Invalidate()
            Case "RClick" : If KBoard_PRaton.Tag <> "RClick" Then KBoard_PRaton.Image = My.Resources.KBoard_RButton : KBoard_PRaton.Tag = "RClick" : KBoard_PRaton.Invalidate() : BRClick.State = NSButton.MouseState.Hover : BRClick.Invalidate()
            Case "Button4" : If KBoard_PRaton.Tag <> "Button4" Then KBoard_PRaton.Image = My.Resources.KBoard_Button4 : KBoard_PRaton.Tag = "Button4" : KBoard_PRaton.Invalidate() : BButton4.State = NSButton.MouseState.Hover : BButton4.Invalidate()
            Case "Button5" : If KBoard_PRaton.Tag <> "Button5" Then KBoard_PRaton.Image = My.Resources.KBoard_Button5 : KBoard_PRaton.Tag = "Button5" : KBoard_PRaton.Invalidate() : BButton5.State = NSButton.MouseState.Hover : BButton5.Invalidate()
        End Select
    End Sub

    Private Sub Keyboard_MouseMove(sender As Object, e As MouseEventArgs) Handles BEsc.MouseMove, BF1.MouseMove, BF2.MouseMove, BF3.MouseMove, BF4.MouseMove, BF5.MouseMove, BF6.MouseMove, BF7.MouseMove, BF8.MouseMove, BF9.MouseMove, BF10.MouseMove, BF11.MouseMove, BF12.MouseMove, Bº.MouseMove, B1.MouseMove, B2.MouseMove, B3.MouseMove, B4.MouseMove, B5.MouseMove, B6.MouseMove, B7.MouseMove, B8.MouseMove, B9.MouseMove, B0.MouseMove, BTilde1.MouseMove, BExclama.MouseMove, BRetroceso.MouseMove, BTab.MouseMove, BQ.MouseMove, BW.MouseMove, BE.MouseMove, BR.MouseMove, BT.MouseMove, BY.MouseMove, BU.MouseMove, BI.MouseMove, BO.MouseMove, BP.MouseMove, BTilde2.MouseMove, BMas.MouseMove, BBloqMayus.MouseMove, BA.MouseMove, BS.MouseMove, BD.MouseMove, BF.MouseMove, BG.MouseMove, BH.MouseMove, BJ.MouseMove, BK.MouseMove, BL.MouseMove, BÑ.MouseMove, BTilde3.MouseMove, BÇ.MouseMove, BLShift.MouseMove, BMenor.MouseMove, BZ.MouseMove, BX.MouseMove, BC.MouseMove, BV.MouseMove, BB.MouseMove, BN.MouseMove, BM.MouseMove, BComa.MouseMove, BPunto.MouseMove, BMenos.MouseMove, BLCtrl.MouseMove, BLWin.MouseMove, BAlt.MouseMove, BEspacio.MouseMove, BAltGr.MouseMove, BRWin.MouseMove, BMenu.MouseMove, BRCtrl.MouseMove, BLeft.MouseMove, BRight.MouseMove, BUp.MouseMove, BDown.MouseMove, BImpr.MouseMove, BScroll.MouseMove, BPause.MouseMove, BInst.MouseMove, BHome.MouseMove, BRePag.MouseMove, BSupr.MouseMove, BEnd.MouseMove, BAvPag.MouseMove, BBloqNum.MouseMove, BNumDiv.MouseMove, BNumPor.MouseMove, BNumMenos.MouseMove, BNumMas.MouseMove, BNum1.MouseMove, BNum2.MouseMove, BNum3.MouseMove, BNum4.MouseMove, BNum5.MouseMove, BNum6.MouseMove, BNum7.MouseMove, BNum8.MouseMove, BNum9.MouseMove, BNum0.MouseMove, BNumPunto.MouseMove, BNumEnter.MouseMove, BRShift.MouseMove, BStop.MouseMove, BPlay.MouseMove, BRewind.MouseMove, BFoward.MouseMove, BEnter.MouseMove, BEnter2.MouseMove, BApp1.MouseMove, BApp2.MouseMove, BVolUp.MouseMove, BVolDown.MouseMove, BVolMute.MouseMove, BBrowserHome.MouseMove, BMail.MouseMove, BBrowserSearch.MouseMove, BBrowserRefresh.MouseMove, BBrowserStop.MouseMove, BBrowserBack.MouseMove, BBrowserForward.MouseMove, BLClick.MouseMove, BMClick.MouseMove, BRClick.MouseMove, BButton4.MouseMove, BButton5.MouseMove, BWheelUp.MouseMove, BWheelDown.MouseMove
        Dim Tecla As NSButton = CType(sender, NSButton)
        If (Tecla.CTRL = True Or Tecla.ALT = True Or Tecla.SHIFT = True Or Tecla.WIN = True) AndAlso e.Location.Y < 12 AndAlso K_Tooltip.Tag <> Tecla.Name Then
            Dim cTexto As String = ""
            If Tecla.CTRL = True Then cTexto += "CTRL + "
            If Tecla.ALT = True Then cTexto += "ALT + "
            If Tecla.SHIFT = True Then cTexto += "SHIFT + "
            If Tecla.WIN = True Then cTexto += "WIN"
            If cTexto.EndsWith(" + ") Then cTexto = cTexto.Substring(0, cTexto.Length - 3)
            K_Show_Tooltip(sender, New Point(Tecla.Width, 2), cTexto)
        ElseIf (Tecla.CTRL = True Or Tecla.ALT = True Or Tecla.SHIFT = True Or Tecla.WIN = True) AndAlso e.Location.Y > 12 Then : K_Hide_Tooltip()
        ElseIf (Tecla.CTRL = False And Tecla.ALT = False And Tecla.SHIFT = False And Tecla.WIN = False) Then : K_Hide_Tooltip()
        End If
    End Sub

#End Region

#Region " Mouse Enter "

    'Private Sub Raton_MouseEnter(sender As Object, e As EventArgs) Handles BLClick.MouseEnter, BMClick.MouseEnter, BRClick.MouseEnter, BButton4.MouseEnter, BButton5.MouseEnter, BWheelUp.MouseEnter, BWheelDown.MouseEnter
    '    Dim Tecla As NSButton = CType(sender, NSButton)
    '    If Tecla.Text = TagToKey(Tecla.Tag, Tecla.Tag) Then KBoard_LCCambiar.Text = Tecla.Tag : KBoard_LCPor.Text = Tecla.Tag2
    '    Select Case sender.Name
    '        Case "BLClick" : KBoard_PRaton.Image = My.Resources.KBoard_LButton : KBoard_PRaton.Tag = "LClick" : KBoard_PRaton.Invalidate()
    '        Case "BMClick" : KBoard_PRaton.Image = My.Resources.KBoard_MButton : KBoard_PRaton.Tag = "MClick" : KBoard_PRaton.Invalidate()
    '        Case "BRClick" : KBoard_PRaton.Image = My.Resources.KBoard_RButton : KBoard_PRaton.Tag = "RClick" : KBoard_PRaton.Invalidate()
    '        Case "BButton4" : KBoard_PRaton.Image = My.Resources.KBoard_Button4 : KBoard_PRaton.Tag = "Button4" : KBoard_PRaton.Invalidate()
    '        Case "BButton5" : KBoard_PRaton.Image = My.Resources.KBoard_Button5 : KBoard_PRaton.Tag = "Button5" : KBoard_PRaton.Invalidate()
    '    End Select
    'End Sub

    'Private Sub Raton_MouseLeave(sender As Object, e As EventArgs) Handles BLClick.MouseLeave, BMClick.MouseLeave, BRClick.MouseLeave, BButton4.MouseLeave, BButton5.MouseLeave
    '    KBoard_LCCambiar.Text = "" : KBoard_LCPor.Text = ""
    '    KBoard_PRaton.Image = My.Resources.KBoard_None : KBoard_PRaton.Tag = "None" : KBoard_PRaton.Invalidate()
    'End Sub

    Private Sub Keyboard_MouseEnter(sender As Object, e As EventArgs) Handles BEsc.MouseEnter, BF1.MouseEnter, BF2.MouseEnter, BF3.MouseEnter, BF4.MouseEnter, BF5.MouseEnter, BF6.MouseEnter, BF7.MouseEnter, BF8.MouseEnter, BF9.MouseEnter, BF10.MouseEnter, BF11.MouseEnter, BF12.MouseEnter, Bº.MouseEnter, B1.MouseEnter, B2.MouseEnter, B3.MouseEnter, B4.MouseEnter, B5.MouseEnter, B6.MouseEnter, B7.MouseEnter, B8.MouseEnter, B9.MouseEnter, B0.MouseEnter, BTilde1.MouseEnter, BExclama.MouseEnter, BRetroceso.MouseEnter, BTab.MouseEnter, BQ.MouseEnter, BW.MouseEnter, BE.MouseEnter, BR.MouseEnter, BT.MouseEnter, BY.MouseEnter, BU.MouseEnter, BI.MouseEnter, BO.MouseEnter, BP.MouseEnter, BTilde2.MouseEnter, BMas.MouseEnter, BBloqMayus.MouseEnter, BA.MouseEnter, BS.MouseEnter, BD.MouseEnter, BF.MouseEnter, BG.MouseEnter, BH.MouseEnter, BJ.MouseEnter, BK.MouseEnter, BL.MouseEnter, BÑ.MouseEnter, BTilde3.MouseEnter, BÇ.MouseEnter, BLShift.MouseEnter, BMenor.MouseEnter, BZ.MouseEnter, BX.MouseEnter, BC.MouseEnter, BV.MouseEnter, BB.MouseEnter, BN.MouseEnter, BM.MouseEnter, BComa.MouseEnter, BPunto.MouseEnter, BMenos.MouseEnter, BLCtrl.MouseEnter, BLWin.MouseEnter, BAlt.MouseEnter, BEspacio.MouseEnter, BAltGr.MouseEnter, BRWin.MouseEnter, BMenu.MouseEnter, BRCtrl.MouseEnter, BLeft.MouseEnter, BRight.MouseEnter, BUp.MouseEnter, BDown.MouseEnter, BImpr.MouseEnter, BScroll.MouseEnter, BPause.MouseEnter, BInst.MouseEnter, BHome.MouseEnter, BRePag.MouseEnter, BSupr.MouseEnter, BEnd.MouseEnter, BAvPag.MouseEnter, BBloqNum.MouseEnter, BNumDiv.MouseEnter, BNumPor.MouseEnter, BNumMenos.MouseEnter, BNumMas.MouseEnter, BNum1.MouseEnter, BNum2.MouseEnter, BNum3.MouseEnter, BNum4.MouseEnter, BNum5.MouseEnter, BNum6.MouseEnter, BNum7.MouseEnter, BNum8.MouseEnter, BNum9.MouseEnter, BNum0.MouseEnter, BNumPunto.MouseEnter, BNumEnter.MouseEnter, BRShift.MouseEnter, BStop.MouseEnter, BPlay.MouseEnter, BRewind.MouseEnter, BFoward.MouseEnter, BEnter.MouseEnter, BEnter2.MouseEnter, BApp1.MouseEnter, BApp2.MouseEnter, BVolUp.MouseEnter, BVolDown.MouseEnter, BVolMute.MouseEnter, BBrowserHome.MouseEnter, BMail.MouseEnter, BBrowserSearch.MouseEnter, BBrowserRefresh.MouseEnter, BBrowserStop.MouseEnter, BBrowserBack.MouseEnter, BBrowserForward.MouseEnter, BLClick.MouseEnter, BMClick.MouseEnter, BRClick.MouseEnter, BButton4.MouseEnter, BButton5.MouseEnter, BWheelUp.MouseEnter, BWheelDown.MouseEnter
        If sender.Name = "BEnter2" Or sender.Name = "BEnter3" Then sender = BEnter
        Dim Tecla As NSButton = CType(sender, NSButton)

        Dim CambiarPor As Boolean
        Dim cModificadores As String = ""
        If KBoard_CLCtrl.Checked = True Or KBoard_CRCtrl.Checked = True Then cModificadores += "CTRL + "
        If KBoard_CLAlt.Checked = True Then cModificadores += "ALT + "
        If KBoard_CLShift.Checked = True Or KBoard_CRShift.Checked = True Then cModificadores += "SHIFT + "
        If KBoard_CLWin.Checked = True Or KBoard_CRWin.Checked = True Then cModificadores += "WIN + "

        If TVTecla.Enabled = False AndAlso KBoards IsNot Nothing Then
            Dim Indice As Integer = -1
            For Cuenta = 0 To KBoards.Length - 1
                If KBoards(Cuenta).Nombre.ToLower = KBoard_Nombre_TNombre.Tag.ToString.ToLower Then Indice = Cuenta : Exit For
            Next : If Indice = -1 Then Exit Sub

            If KBoards(Indice).Keys IsNot Nothing Then
                Dim Tecla1, Tecla2 As String
                For Cuenta2 = 0 To KBoards(Indice).Keys.Length - 1
                    If KBoards(Indice).Keys(Cuenta2) IsNot Nothing Then
                        Tecla1 = Split(KBoards(Indice).Keys(Cuenta2), "|-|", , CompareMethod.Text)(0)
                        Tecla2 = Split(KBoards(Indice).Keys(Cuenta2), "|-|", , CompareMethod.Text)(1)
                        If Tecla1.Replace("CTRL + ", "").Replace("ALT + ", "").Replace("SHIFT + ", "").Replace("WIN + ", "").ToLower = Tecla.Tag Then
                            Dim cKModificadores As String = ""
                            If Tecla1.Contains("CTRL + ") Then cKModificadores += "CTRL + "
                            If Tecla1.Contains("ALT + ") Then cKModificadores += "ALT + "
                            If Tecla1.Contains("SHIFT + ") Then cKModificadores += "SHIFT + "
                            If Tecla1.Contains("WIN + ") Then cKModificadores += "WIN + "
                            If cModificadores = cKModificadores Then KBoard_LCCambiar.Text = TagToHotKey(Tecla1) : KBoard_LCPor.Text = TagToHotKey(Tecla2) : CambiarPor = True : Exit For
                        End If
                    End If
                Next
            End If
            If CambiarPor = False Then KBoard_LCCambiar.Text = TagToHotKey(cModificadores + Tecla.Tag) : KBoard_LCPor.Text = TagToHotKey(cModificadores + MainKeyChanged(Tecla.Tag))
        End If

        Select Case sender.Name
            Case "BEnter"
                If e IsNot Nothing Then BEnter.State = NSButton.MouseState.Hover : BEnter2.State = NSButton.MouseState.Hover
                BEnter.Invalidate() : BEnter2.Invalidate()
                If BEnter.Marked = False And BEnter.Marked_Set = False Then
                    BEnter4.BackColor = Color.FromArgb(205, 150, 0) : BEnter4.Invalidate()
                    BEnter5.BackColor = Color.FromArgb(205, 150, 0) : BEnter5.Invalidate()
                End If
            Case "BLClick" : KBoard_PRaton.Image = My.Resources.KBoard_LButton : KBoard_PRaton.Tag = "LClick" : KBoard_PRaton.Invalidate()
            Case "BMClick" : KBoard_PRaton.Image = My.Resources.KBoard_MButton : KBoard_PRaton.Tag = "MClick" : KBoard_PRaton.Invalidate()
            Case "BRClick" : KBoard_PRaton.Image = My.Resources.KBoard_RButton : KBoard_PRaton.Tag = "RClick" : KBoard_PRaton.Invalidate()
            Case "BButton4" : KBoard_PRaton.Image = My.Resources.KBoard_Button4 : KBoard_PRaton.Tag = "Button4" : KBoard_PRaton.Invalidate()
            Case "BButton5" : KBoard_PRaton.Image = My.Resources.KBoard_Button5 : KBoard_PRaton.Tag = "Button5" : KBoard_PRaton.Invalidate()
        End Select
    End Sub

#End Region

#Region " Mouse Leave "

    Private Sub Keyboard_MouseLeave(sender As Object, e As EventArgs) Handles BEsc.MouseLeave, BF1.MouseLeave, BF2.MouseLeave, BF3.MouseLeave, BF4.MouseLeave, BF5.MouseLeave, BF6.MouseLeave, BF7.MouseLeave, BF8.MouseLeave, BF9.MouseLeave, BF10.MouseLeave, BF11.MouseLeave, BF12.MouseLeave, Bº.MouseLeave, B1.MouseLeave, B2.MouseLeave, B3.MouseLeave, B4.MouseLeave, B5.MouseLeave, B6.MouseLeave, B7.MouseLeave, B8.MouseLeave, B9.MouseLeave, B0.MouseLeave, BTilde1.MouseLeave, BExclama.MouseLeave, BRetroceso.MouseLeave, BTab.MouseLeave, BQ.MouseLeave, BW.MouseLeave, BE.MouseLeave, BR.MouseLeave, BT.MouseLeave, BY.MouseLeave, BU.MouseLeave, BI.MouseLeave, BO.MouseLeave, BP.MouseLeave, BTilde2.MouseLeave, BMas.MouseLeave, BBloqMayus.MouseLeave, BA.MouseLeave, BS.MouseLeave, BD.MouseLeave, BF.MouseLeave, BG.MouseLeave, BH.MouseLeave, BJ.MouseLeave, BK.MouseLeave, BL.MouseLeave, BÑ.MouseLeave, BTilde3.MouseLeave, BÇ.MouseLeave, BLShift.MouseLeave, BMenor.MouseLeave, BZ.MouseLeave, BX.MouseLeave, BC.MouseLeave, BV.MouseLeave, BB.MouseLeave, BN.MouseLeave, BM.MouseLeave, BComa.MouseLeave, BPunto.MouseLeave, BMenos.MouseLeave, BLCtrl.MouseLeave, BLWin.MouseLeave, BAlt.MouseLeave, BEspacio.MouseLeave, BAltGr.MouseLeave, BRWin.MouseLeave, BMenu.MouseLeave, BRCtrl.MouseLeave, BLeft.MouseLeave, BRight.MouseLeave, BUp.MouseLeave, BDown.MouseLeave, BImpr.MouseLeave, BScroll.MouseLeave, BPause.MouseLeave, BInst.MouseLeave, BHome.MouseLeave, BRePag.MouseLeave, BSupr.MouseLeave, BEnd.MouseLeave, BAvPag.MouseLeave, BBloqNum.MouseLeave, BNumDiv.MouseLeave, BNumPor.MouseLeave, BNumMenos.MouseLeave, BNumMas.MouseLeave, BNum1.MouseLeave, BNum2.MouseLeave, BNum3.MouseLeave, BNum4.MouseLeave, BNum5.MouseLeave, BNum6.MouseLeave, BNum7.MouseLeave, BNum8.MouseLeave, BNum9.MouseLeave, BNum0.MouseLeave, BNumPunto.MouseLeave, BNumEnter.MouseLeave, BRShift.MouseLeave, BStop.MouseLeave, BPlay.MouseLeave, BRewind.MouseLeave, BFoward.MouseLeave, BEnter.MouseLeave, BEnter2.MouseLeave, BApp1.MouseLeave, BApp2.MouseLeave, BVolUp.MouseLeave, BVolDown.MouseLeave, BVolMute.MouseLeave, BBrowserHome.MouseLeave, BMail.MouseLeave, BBrowserSearch.MouseLeave, BBrowserRefresh.MouseLeave, BBrowserStop.MouseLeave, BBrowserBack.MouseLeave, BBrowserForward.MouseLeave, BLClick.MouseLeave, BMClick.MouseLeave, BRClick.MouseLeave, BButton4.MouseLeave, BButton5.MouseLeave, BWheelUp.MouseLeave, BWheelDown.MouseLeave
        If sender.Name = "BEnter2" Or sender.Name = "BEnter3" Then sender = BEnter
        If CTecla IsNot Nothing AndAlso CTecla.HoverMenu = True Then Exit Sub
        If TVTecla.Enabled = False Then KBoard_LCCambiar.Text = "" : KBoard_LCPor.Text = ""
        Select Case sender.Name
            Case "BEnter"
                BEnter.State = NSButton.MouseState.None : BEnter.Invalidate()
                BEnter2.State = NSButton.MouseState.None : BEnter2.Invalidate()
                If BEnter.Marked = False And BEnter.Marked_Set = False Then
                    BEnter4.BackColor = Color.FromArgb(65, 65, 65) : BEnter4.Invalidate()
                    BEnter5.BackColor = Color.FromArgb(65, 65, 65) : BEnter5.Invalidate()
                End If
            Case "BLClick", "BMClick", "BRClick", "BButton4", "BButton5"
                KBoard_PRaton.Image = My.Resources.KBoard_None : KBoard_PRaton.Tag = "None" : KBoard_PRaton.Invalidate()
        End Select
    End Sub

#End Region

#Region " Mouse Down "

    Private Sub KBoard_PRaton_MouseDown(sender As Object, e As MouseEventArgs) Handles KBoard_PRaton.MouseDown
        If KBoard_LCProceso.Enabled = False Then Exit Sub
        If e.Button = MouseButtons.Left Then
            Select Case KBoard_PRaton.Tag
                Case "LClick" : Keyboard_MouseDown(BLClick, e)
                Case "MClick" : Keyboard_MouseDown(BMClick, e)
                Case "RClick" : Keyboard_MouseDown(BRClick, e)
                Case "Button4" : Keyboard_MouseDown(BButton4, e)
                Case "Button5" : Keyboard_MouseDown(BButton5, e)
            End Select
        ElseIf e.Button = MouseButtons.Right Then
            Select Case KBoard_PRaton.Tag
                Case "LClick" : Keyboard_MouseDown(BLClick, e)
                Case "MClick" : Keyboard_MouseDown(BMClick, e)
                Case "RClick" : Keyboard_MouseDown(BRClick, e)
                Case "Button4" : Keyboard_MouseDown(BButton4, e)
                Case "Button5" : Keyboard_MouseDown(BButton5, e)
            End Select
        ElseIf e.Button = MouseButtons.Middle Then
            Select Case KBoard_PRaton.Tag
                Case "LClick" : Keyboard_MouseDown(BLClick, e)
                Case "MClick" : Keyboard_MouseDown(BMClick, e)
                Case "RClick" : Keyboard_MouseDown(BRClick, e)
                Case "Button4" : Keyboard_MouseDown(BButton4, e)
                Case "Button5" : Keyboard_MouseDown(BButton5, e)
            End Select
        End If
    End Sub

    Private Sub Keyboard_MouseDown(sender As Object, e As MouseEventArgs) Handles BEsc.MouseDown, BF1.MouseDown, BF2.MouseDown, BF3.MouseDown, BF4.MouseDown, BF5.MouseDown, BF6.MouseDown, BF7.MouseDown, BF8.MouseDown, BF9.MouseDown, BF10.MouseDown, BF11.MouseDown, BF12.MouseDown, Bº.MouseDown, B1.MouseDown, B2.MouseDown, B3.MouseDown, B4.MouseDown, B5.MouseDown, B6.MouseDown, B7.MouseDown, B8.MouseDown, B9.MouseDown, B0.MouseDown, BTilde1.MouseDown, BExclama.MouseDown, BRetroceso.MouseDown, BTab.MouseDown, BQ.MouseDown, BW.MouseDown, BE.MouseDown, BR.MouseDown, BT.MouseDown, BY.MouseDown, BU.MouseDown, BI.MouseDown, BO.MouseDown, BP.MouseDown, BTilde2.MouseDown, BMas.MouseDown, BBloqMayus.MouseDown, BA.MouseDown, BS.MouseDown, BD.MouseDown, BF.MouseDown, BG.MouseDown, BH.MouseDown, BJ.MouseDown, BK.MouseDown, BL.MouseDown, BÑ.MouseDown, BTilde3.MouseDown, BÇ.MouseDown, BLShift.MouseDown, BMenor.MouseDown, BZ.MouseDown, BX.MouseDown, BC.MouseDown, BV.MouseDown, BB.MouseDown, BN.MouseDown, BM.MouseDown, BComa.MouseDown, BPunto.MouseDown, BMenos.MouseDown, BLCtrl.MouseDown, BLWin.MouseDown, BAlt.MouseDown, BEspacio.MouseDown, BAltGr.MouseDown, BRWin.MouseDown, BMenu.MouseDown, BRCtrl.MouseDown, BLeft.MouseDown, BRight.MouseDown, BUp.MouseDown, BDown.MouseDown, BImpr.MouseDown, BScroll.MouseDown, BPause.MouseDown, BInst.MouseDown, BHome.MouseDown, BRePag.MouseDown, BSupr.MouseDown, BEnd.MouseDown, BAvPag.MouseDown, BBloqNum.MouseDown, BNumDiv.MouseDown, BNumPor.MouseDown, BNumMenos.MouseDown, BNumMas.MouseDown, BNum1.MouseDown, BNum2.MouseDown, BNum3.MouseDown, BNum4.MouseDown, BNum5.MouseDown, BNum6.MouseDown, BNum7.MouseDown, BNum8.MouseDown, BNum9.MouseDown, BNum0.MouseDown, BNumPunto.MouseDown, BNumEnter.MouseDown, BRShift.MouseDown, BStop.MouseDown, BPlay.MouseDown, BRewind.MouseDown, BFoward.MouseDown, BEnter.MouseDown, BEnter2.MouseDown, BApp1.MouseDown, BApp2.MouseDown, BVolUp.MouseDown, BVolDown.MouseDown, BVolMute.MouseDown, BBrowserHome.MouseDown, BMail.MouseDown, BBrowserSearch.MouseDown, BBrowserRefresh.MouseDown, BBrowserStop.MouseDown, BBrowserBack.MouseDown, BBrowserForward.MouseDown, BLClick.MouseDown, BMClick.MouseDown, BRClick.MouseDown, BButton4.MouseDown, BButton5.MouseDown, BWheelUp.MouseDown, BWheelDown.MouseDown
        HTexto.Focus() : ExitHotKey() : If KBoard_Nombre_CNombre.Items.Count = 0 Then Exit Sub

        For Each cntrl As Control In KBoard_GKeyboard.Controls
            If TypeOf cntrl Is NSButton Then CTecla = cntrl : CTecla.Marked_Set = False : CTecla.Invalidate()
        Next
        For Each cntrl As Control In KBoard_GNumerico.Controls
            If TypeOf cntrl Is NSButton Then CTecla = cntrl : CTecla.Marked_Set = False : CTecla.Invalidate()
        Next
        For Each cntrl As Control In KBoard_GRaton.Controls
            If TypeOf cntrl Is NSButton Then CTecla = cntrl : CTecla.Marked_Set = False : CTecla.Invalidate()
        Next

        CTecla = CType(sender, NSButton) : If CTecla.Name = "BEnter2" Then CTecla = BEnter

        'If BEnter.Marked = True Then
        '    BEnter4.BackColor = Color.Green : BEnter4.Invalidate()
        '    BEnter5.BackColor = Color.Green : BEnter5.Invalidate()
        'Else
        '    BEnter4.BackColor = Color.FromArgb(65, 65, 65) : BEnter4.Invalidate()
        '    BEnter5.BackColor = Color.FromArgb(65, 65, 65) : BEnter5.Invalidate()
        'End If

        If e.Button = MouseButtons.Left Then
            Get_KBoard_Key = True : CTecla.Marked_Set = True : CTecla.Invalidate()
            If CTecla.Name = "BEnter" Then
                BEnter2.Marked_Set = True : BEnter2.Invalidate()
                BEnter4.BackColor = Color.Blue : BEnter4.Invalidate()
                BEnter5.BackColor = Color.Blue : BEnter5.Invalidate()
            End If
            Get_KBoard_Key = True : ComandoScript = "" : Contador = 0 : IniciaContador = True : TVTecla.Enabled = True

        ElseIf e.Button = MouseButtons.Middle Then
            CTecla.Tag2 = "" : CTecla.Text = TagToKey(CTecla.Tag, CTecla.Tag) : Rutas.SetFontSize(CTecla, 7, 5)
            CTecla.CTRL = False : CTecla.SHIFT = False : CTecla.ALT = False : CTecla.WIN = False
            CTecla.Marked = False : CTecla.Marked_Set = False : CTecla.Invalidate()
            If CTecla.Name = "BEnter" Then
                BEnter2.Marked = False : BEnter2.Marked_Set = False : BEnter2.Invalidate()
                BEnter4.BackColor = Color.FromArgb(205, 150, 0) : BEnter4.Invalidate()
                BEnter5.BackColor = Color.FromArgb(205, 150, 0) : BEnter5.Invalidate()
            End If

            Dim cModificadores As String = ""
            If KBoard_CLCtrl.Checked = True Or KBoard_CRCtrl.Checked = True Then cModificadores += "CTRL + "
            If KBoard_CLAlt.Checked = True Then cModificadores += "ALT + "
            If KBoard_CLShift.Checked = True Or KBoard_CRShift.Checked = True Then cModificadores += "SHIFT + "
            If KBoard_CLWin.Checked = True Or KBoard_CRWin.Checked = True Then cModificadores += "WIN + "
            Get_KBoard_Key = False : ComandoScript = "" : Contador = 0 : IniciaContador = False : TVTecla.Enabled = False
            KBoard_LCCambiar.Text = TagToHotKey(cModificadores + CTecla.Tag) : KBoard_LCPor.Text = TagToHotKey(cModificadores + CTecla.Tag)
            KBoard_Tecla_Eliminar(cModificadores + CTecla.Tag)
            KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)

        ElseIf e.Button = MouseButtons.Right Then
            Get_KBoard_Key = False : ComandoScript = "" : Contador = 0 : IniciaContador = False : TVTecla.Enabled = False
            CTecla.HoverMenu = True : If CTecla.Name = "BEnter" Then BEnter2.HoverMenu = True
            KBoard_MenuTecla.Show(CTecla, New Point(CTecla.Width - 1, 0))
        End If
    End Sub

#End Region

#Region " TVTecla "

    Private Sub TVTecla_Tick(sender As Object, e As EventArgs)
        If CTecla.Name = "BEnter2" Then CTecla = BEnter
        If IniciaContador = True Then Contador += 1

        Dim cModificadores As String = ""
        If KBoard_CLCtrl.Checked = True Or KBoard_CRCtrl.Checked = True Then cModificadores += "CTRL + "
        If KBoard_CLAlt.Checked = True Then cModificadores += "ALT + "
        If KBoard_CLShift.Checked = True Or KBoard_CRShift.Checked = True Then cModificadores += "SHIFT + "
        If KBoard_CLWin.Checked = True Or KBoard_CRWin.Checked = True Then cModificadores += "WIN + "

        If Contador >= 1000 Then
            ComandoScript = "" : TVTecla.Enabled = False : IniciaContador = False : Contador = 0 : GoTo Sigue
        End If

        Dim Eliminar As Boolean
        If ComandoScript <> "" Then

            If (ComandoScript.ToLower.Contains("mouse") = True Or ComandoScript.ToLower.Contains("wheel") = True) AndAlso (CTecla.Tag.ToString.ToLower.Contains("mouse") = False And CTecla.Tag.ToString.ToLower.Contains("wheel") = False) Then ComandoScript = "" : Exit Sub

            If ComandoScript.EndsWith(" + LShift") Then ComandoScript = ComandoScript.Replace(" + LShift", "")
            If ComandoScript.EndsWith(" + RShift") Then ComandoScript = ComandoScript.Replace(" + RShift", "")
            If ComandoScript.EndsWith(" + LCtrl") Then ComandoScript = ComandoScript.Replace(" + LCtrl", "")
            If ComandoScript.EndsWith(" + RCtrl") Then ComandoScript = ComandoScript.Replace(" + RCtrl", "")
            If ComandoScript.EndsWith(" + LAlt") Then ComandoScript = ComandoScript.Replace(" + LAlt", "")
            If ComandoScript.EndsWith(" + RAlt") Then ComandoScript = ComandoScript.Replace(" + RAlt", "")
            If ComandoScript.EndsWith(" + LWin") Then ComandoScript = ComandoScript.Replace(" + LWin", "")
            If ComandoScript.EndsWith(" + RWin") Then ComandoScript = ComandoScript.Replace(" + RWin", "")

            If ComandoScript.ToLower.Contains("ctrl + ") Then CTecla.CTRL = True Else CTecla.CTRL = False
            If ComandoScript.ToLower.Contains("shift + ") Then CTecla.SHIFT = True Else CTecla.SHIFT = False
            If ComandoScript.ToLower.Contains("alt + ") Then CTecla.ALT = True Else CTecla.ALT = False
            If ComandoScript.ToLower.Contains("win + ") Then CTecla.WIN = True Else CTecla.WIN = False

            CTecla.Tag2 = ComandoScript : ComandoScript = "" : TVTecla.Enabled = False : IniciaContador = False : Contador = 0
            CTecla.Text = TagToKey(CTecla.Tag, CTecla.Tag2).Replace("CTRL + ", "").Replace("SHIFT + ", "").Replace("ALT + ", "").Replace("WIN + ", "")

Sigue:      Rutas.SetFontSize(CTecla, 7, 5)
            CTecla.Marked_Set = False : CTecla.Invalidate()
            BEnter2.Marked_Set = False : BEnter2.Invalidate()

            If (cModificadores + CTecla.Tag).ToString.ToLower = CTecla.Tag2.ToString.ToLower Or CTecla.Tag2 = "" Then
                If CTecla.Name = "BEnter" Then
                    BEnter2.Marked = False
                    BEnter4.BackColor = Color.FromArgb(205, 150, 0) : BEnter4.Invalidate()
                    BEnter5.BackColor = Color.FromArgb(205, 150, 0) : BEnter5.Invalidate()
                End If : CTecla.Marked = False : Eliminar = True
                CTecla.CTRL = False : CTecla.SHIFT = False : CTecla.ALT = False : CTecla.WIN = False
            Else
                If CTecla.Name = "BEnter" Then
                    BEnter2.Marked = True
                    BEnter4.BackColor = Color.Green : BEnter4.Invalidate()
                    BEnter5.BackColor = Color.Green : BEnter5.Invalidate()
                End If : CTecla.Marked = True
            End If

            If Eliminar = True Then KBoard_Tecla_Eliminar(cModificadores + CTecla.Tag) Else KBoard_Tecla_Añadir(cModificadores + CTecla.Tag, CTecla.Tag2)
            Keyboard_MouseEnter(CTecla, Nothing) : KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
        End If
    End Sub

#End Region

#Region " TagToKey "

    Private Function TagToKey(Tecla As String, Tag As String) As String
        If Tag.ToLower.Contains("ctrl + ") Then Tag = Tag.ToLower.Replace("ctrl + ", "")
        If Tag.ToLower.Contains("shift + ") Then Tag = Tag.ToLower.Replace("shift + ", "")
        If Tag.ToLower.Contains("alt + ") Then Tag = Tag.ToLower.Replace("alt + ", "")
        If Tag.ToLower.Contains("win + ") Then Tag = Tag.ToLower.Replace("win + ", "")

        Select Case Tag.ToLower
            Case "escape" : Return "ESC"
            Case "enter" : Return "↲"
            Case "backspace" : Return "←"
            Case "space"
                Select Case Tecla.ToLower
                    Case "space" : Return "__________"
                    Case Else : Return "____"
                End Select
            Case "lctrl" : Return "CTRL"
            Case "rctrl" : Return "CTRL"
            Case "lshift" : Return "SHIFT"
            Case "rshift" : Return "SHIFT"
            Case "lalt" : Return "ALT"
            Case "<^>!" : Return "ALT GR"
            Case "lwin" : Return "WIN"
            Case "rwin" : Return "WIN"
            Case "appskey" : Return "MENU"
            Case "tab" : Return "↹"
            Case "capslock" : Return "Caps Locks"
           'Scroll
            Case "printscreen" : Return "Impr"
            Case "scrolllock" : Return "Scroll"
            Case "pause" : Return "Pause"
            Case "insert" : Return "Ins"
            Case "delete" : Return "Del"
            Case "home" : Return "Home"
            Case "end" : Return "End"
            Case "pgup" : Return "PgUp"
            Case "pgdn" : Return "PgDn"
            Case "up" : Return "↑"
            Case "down" : Return "↓"
            Case "left" : Return "←"
            Case "right" : Return "→"
           'NumericPad
            Case "numlock" : Return "Lock"
            Case "numpaddiv" : Return "/"
            Case "numpadmult" : Return "*"
            Case "numpadsub" : Return "-"
            Case "numpadadd" : Return "+"
            Case "numpadenter" : Return "ENT"
            Case "numpad1" : Return "1"
            Case "numpad2" : Return "2"
            Case "numpad3" : Return "3"
            Case "numpad4" : Return "4"
            Case "numpad5" : Return "5"
            Case "numpad6" : Return "6"
            Case "numpad7" : Return "7"
            Case "numpad8" : Return "8"
            Case "numpad9" : Return "9"
            Case "numpad0" : Return "0"
            Case "numpaddot" : Return "."
            Case "numpadup" : Return "↑"
            Case "numpaddown" : Return "↓"
            Case "numpadleft" : Return "←"
            Case "numpadright" : Return "→"
            Case "numpadhome" : Return "Home"
            Case "numpadend" : Return "End"
            Case "numpadpgup" : Return "PgUp"
            Case "numpadpgdn" : Return "PgDn"
            Case "numpadclear" : Return "Clear"
            Case "numpadinsert" : Return "Ins"
            Case "numpaddelete" : Return "Del"
            'Multimedia
            Case "mediastop" : Return "⏹"
            Case "mediaplay", "mediaplaypause" : Return "⏯"
            Case "mediarewind", "mediaprevioustrack" : Return "⏮"
            Case "mediafoward", "medianexttrack" : Return "⏭"

            Case "launchapplication1" : Return "App 1"
            Case "launchapplication2" : Return "App 2"

            Case "volumeup" : Return "Vol Up"
            Case "volumedown" : Return "Vol Down"
            Case "volumemute" : Return "Vol Mute"
            Case "selectmedia" : Return "Media"

            Case "browserhome" : Return "B. Home"
            Case "launchmail" : Return "Mail"
            Case "browsersearch" : Return "B. Search"
            Case "browserfavorites" : Return "B. Fav"
            Case "browserrefresh" : Return "B. Refresh"
            Case "browserstop" : Return "B. Stop"
            Case "browserforward" : Return "B. Forward"
            Case "browserback" : Return "B. Back"
            'Raton
            Case "mouse 1" : Return "Left Click"
            Case "mouse 3" : Return "Middle Click"
            Case "mouse 2" : Return "Right Click"
            Case "mouse 4" : Return "Button 4"
            Case "mouse 5" : Return "Button 5"

            Case "wheel up" : Return "Wheel Up"
            Case "wheel down" : Return "Wheel Down"
            Case "hwheel up" : Return "Wheel Left"
            Case "hwheel down" : Return "Wheel Right"
        End Select
        Return Tag.ToUpper
    End Function

#End Region

#Region " ToKey "

    Private Function ToKey(Tecla As String, Tag As String) As String
        Select Case Tecla.ToLower
            Case "enter"
                Return "ENT"
            Case "backspace"
                Return "<-"
            Case " lctrl"
                If Tag = " lctrl" Then Return " CTR" Else Return " LCTR"
            Case " rctrl"
                If Tag = " rctrl" Then Return " CTR" Else Return " RCTR"
            Case " lshift"
                If Tag = " lshift" Then Return " SHF" Else Return " LSHF"
            Case " rshift"
                If Tag = " rshift" Then Return " SHIFT" Else Return " RSHF"
            Case " latl"
                If Tag = " lalt" Then Return " ALT" Else Return " LALT"
            Case "<^>!"
                If Tag = "<^>!" Then Return "ALT GR" Else Return "RALT"
            Case "lwin"
                If Tag = "lwin" Then Return "WIN" Else Return "LWIN"
            Case "rwin"
                If Tag = "rwin" Then Return "WIN" Else Return "RWIN"
            Case "appskey"
                Return "MENU"
            Case "numlock"
                If Tag = "numlock" Then Return "Lock" Else Return "NLock"
            Case "numpaddiv"
                If Tag = "numpaddiv" Then Return "/" Else Return "N/"
            Case "numpadmult"
                If Tag = "numpadmult" Then Return "*" Else Return "N*"
            Case "numpadsub"
                If Tag = "numpadsub" Then Return "-" Else Return "N-"
            Case "numpadadd"
                If Tag = "numpadadd" Then Return "+" Else Return "N+"
            Case "numpadenter"
                Return "ENT"
            Case "numpad1"
                If Tag = "numpad1" Then Return "1" Else Return "N1"
            Case "numpad2"
                If Tag = "numpad2" Then Return "2" Else Return "N2"
            Case "numpad3"
                If Tag = "numpad3" Then Return "3" Else Return "N3"
            Case "numpad4"
                If Tag = "numpad4" Then Return "4" Else Return "N4"
            Case "numpad5"
                If Tag = "numpad5" Then Return "5" Else Return "N5"
            Case "numpad6"
                If Tag = "numpad6" Then Return "6" Else Return "N6"
            Case "numpad7"
                If Tag = "numpad7" Then Return "7" Else Return "N7"
            Case "numpad8"
                If Tag = "numpad8" Then Return "8" Else Return "N8"
            Case "numpad9"
                If Tag = "numpad9" Then Return "9" Else Return "N9"
            Case "numpad0"
                If Tag = "numpad0" Then Return "0" Else Return "N0"
            Case "numpaddot"
                If Tag = "numpaddot" Then Return "." Else Return "N."
            Case "numpadend"
                If Tag = "numpadend" Then Return "END" Else Return "NEND"
            Case "numpaddown"
                If Tag = "numpaddown" Then Return "Down" Else Return "NDown"
            Case "numpadpgdn"
                If Tag = "numpadpgdn" Then Return "PgDn" Else Return "NPgDn"
            Case "numpadleft"
                If Tag = "numpadleft" Then Return "Left" Else Return "NLeft"
            Case "numpadclear"
                Return "Clear"
            Case "numpadright"
                If Tag = "numpadright" Then Return "Right" Else Return "NRight"
            Case "numpadhome"
                If Tag = "numpadhome" Then Return "HOME" Else Return "NHOME"
            Case "numpadup"
                If Tag = "numpadup" Then Return "Up" Else Return "NUp"
            Case "numpadpgup"
                If Tag = "numpadpgup" Then Return "PgUp" Else Return "NPgUp"
            Case "numpadinsert"
                If Tag = "numpadinsert" Then Return "INS" Else Return "NINS"
            Case "numpaddelete"
                If Tag = "numpaddelete" Then Return "DEL" Else Return "NDEL"
            Case "mediaplaypause"
                Return "⏯"

            Case "launchapplication1" : Return "App 1"
            Case "launchapplication2" : Return "App 2"

            Case "volumeup" : Return "Vol Up"
            Case "volumedown" : Return "Vol Down"
            Case "volumemute" : Return "Vol Mute"
            Case "selectmedia" : Return "Media"

            Case "browserhome" : Return "B. Home"
            Case "launchmail" : Return "Mail"
            Case "browsersearch" : Return "B. Search"
            Case "browserfavorites" : Return "B. Fav"
            Case "browserrefresh" : Return "B. Refresh"
            Case "browserstop" : Return "B. Stop"
            Case "browserforward" : Return "B. Forward"
            Case "browserback" : Return "B. Back"

            Case "mouse 1" : Return "Left Click"
            Case "mouse 3" : Return "Middle Click"
            Case "mouse 2" : Return "Right Click"
            Case "mouse 4" : Return "Button 4"
            Case "mouse 5" : Return "Button 5"

            Case "wheel up" : Return "Wheel Up"
            Case "wheel down" : Return "Wheel Down"
            Case "hwheel up" : Return "Wheel Left"
            Case "hwheel down" : Return "Wheel Right"
        End Select
        Return Tecla.ToUpper
    End Function

    'Private Function IsMarked(Tecla) As Boolean
    '    Dim UKey As NSButton
    '    For Each cntrl As Control In FTheme.Controls
    '        If TypeOf cntrl Is NSButton Then
    '            If cntrl.Tag = Tecla Then
    '                UKey = cntrl
    '                Return UKey.Marked
    '            End If
    '        End If
    '    Next
    '    Return False
    'End Function

    'Private Sub UpdateKeyboard(Tecla As String, VTecla As String)
    '    Dim UKey As NSButton
    '    For Each cntrl As Control In FTheme.Controls
    '        If TypeOf cntrl Is NSButton Then
    '            If cntrl.Tag = Tecla Then
    '                UKey = cntrl
    '                UKey.Text = ToKey(VTecla, UKey.Tag)
    '                UKey.Marked = True
    '                UKey.Invalidate()
    '            End If
    '        End If
    '    Next
    'End Sub

#End Region

#Region " Menu Teclas "

    Private Sub KBoard_MenuTecla_Opening(sender As Object, e As System.ComponentModel.CancelEventArgs)
        For Each i As Object In KBoard_MenuTecla.Items
            If TypeOf i Is ToolStripMenuItem Then
                If i.Name = "MTecla0" Then i.Checked = False : i.Image = My.Resources.Teclas_UnChecked
                If i.Name = "MTecla1" Then i.Checked = False : i.Image = My.Resources.Teclas_UnChecked
                If i.Name = "MTecla2" Then i.Checked = False : i.Image = My.Resources.Teclas_UnChecked
                If i.Name = "MTecla3" Then i.Checked = False : i.Image = My.Resources.Teclas_UnChecked
            End If
        Next

        Dim Keyboard_Modificadores As String = ""
        If KBoard_CLCtrl.Checked = True Or KBoard_CRCtrl.Checked = True Then Keyboard_Modificadores += "CTRL + "
        If KBoard_CLAlt.Checked = True Then Keyboard_Modificadores += "ALT + "
        If KBoard_CLShift.Checked = True Or KBoard_CRShift.Checked = True Then Keyboard_Modificadores += "SHIFT + "
        If KBoard_CLWin.Checked = True Or KBoard_CRWin.Checked = True Then Keyboard_Modificadores += "WIN + "
        Dim Tecla As String = CTecla.Tag2.ToString.Replace("CTRL + ", "").Replace("SHIFT + ", "").Replace("ALT + ", "").Replace("WIN + ", "") : If Tecla = "" Then Tecla = CTecla.Tag

        Dim Tag_Modificadores As String = ""
        If CTecla.Tag2.ToLower.Contains("ctrl + ") Then Tag_Modificadores += "CTRL + "
        If CTecla.Tag2.ToLower.Contains("shift + ") Then Tag_Modificadores += "SHIFT + "
        If CTecla.Tag2.ToLower.Contains("alt + ") Then Tag_Modificadores += "ALT + "
        If CTecla.Tag2.ToLower.Contains("win + ") Then Tag_Modificadores += "WIN + "

        For Each i As Object In KBoard_MenuTecla.Items
            If TypeOf i Is ToolStripMenuItem Then
                If CTecla.Tag2 = "" Or Tag_Modificadores.ToLower = Keyboard_Modificadores.ToLower Then
                    If i.Name = "MTecla0" AndAlso (KBoard_CLCtrl.Checked = True Or KBoard_CRCtrl.Checked = True) Then i.Checked = True : i.Image = My.Resources.Teclas_Checked
                    If i.Name = "MTecla1" AndAlso (KBoard_CLShift.Checked = True Or KBoard_CRShift.Checked = True) Then i.Checked = True : i.Image = My.Resources.Teclas_Checked
                    If i.Name = "MTecla2" AndAlso (KBoard_CLAlt.Checked = True) Then i.Checked = True : i.Image = My.Resources.Teclas_Checked
                    If i.Name = "MTecla3" AndAlso (KBoard_CLWin.Checked = True Or KBoard_CRWin.Checked = True) Then i.Checked = True : i.Image = My.Resources.Teclas_Checked
                Else
                    If i.Name = "MTecla0" AndAlso CTecla.Tag2.ToString.ToLower.Contains("ctrl") = True Then i.Checked = True : i.Image = My.Resources.Teclas_Checked
                    If i.Name = "MTecla1" AndAlso CTecla.Tag2.ToString.ToLower.Contains("shift") = True Then i.Checked = True : i.Image = My.Resources.Teclas_Checked
                    If i.Name = "MTecla2" AndAlso CTecla.Tag2.ToString.ToLower.Contains("alt") = True Then i.Checked = True : i.Image = My.Resources.Teclas_Checked
                    If i.Name = "MTecla3" AndAlso CTecla.Tag2.ToString.ToLower.Contains("win") = True Then i.Checked = True : i.Image = My.Resources.Teclas_Checked
                End If
            End If
        Next
    End Sub

    Private Sub KBoard_MenuTecla_Closing(sender As Object, e As ToolStripDropDownClosingEventArgs)
        CTecla.HoverMenu = False : BEnter2.HoverMenu = False
        If CTecla.ClientRectangle.Contains(CTecla.PointToClient(MousePosition)) = True Then
            CTecla.State = NSButton.MouseState.Hover : CTecla.Invalidate()
            If CTecla.Name = "BEnter" Then
                BEnter2.State = NSButton.MouseState.Hover : BEnter2.Invalidate()
                If BEnter.Marked = False And BEnter.Marked_Set = False Then
                    BEnter4.BackColor = Color.FromArgb(205, 150, 0) : BEnter4.Invalidate()
                    BEnter5.BackColor = Color.FromArgb(205, 150, 0) : BEnter5.Invalidate()
                End If
            End If
        Else
            CTecla.State = NSButton.MouseState.None : CTecla.Invalidate()
            If CTecla.Name = "BEnter" Then
                BEnter2.State = NSButton.MouseState.None : BEnter2.Invalidate()
                If BEnter.Marked = False And BEnter.Marked_Set = False Then
                    BEnter4.BackColor = Color.FromArgb(65, 65, 65) : BEnter4.Invalidate()
                    BEnter5.BackColor = Color.FromArgb(65, 65, 65) : BEnter5.Invalidate()
                End If
            End If
        End If
    End Sub

    Private Sub KBoard_MenuTecla_MouseDown(sender As Object, e As MouseEventArgs)
        Dim Eliminar As Boolean : ComandoScript = sender.Tag : If CTecla.Name = "BEnter2" Then CTecla = BEnter

        If ComandoScript <> "" Then

            If "mctrl mshift malt mwin".Contains(ComandoScript.ToLower) = True Then If sender.Checked = False Then sender.Checked = True : sender.Image = My.Resources.Teclas_Checked Else sender.Checked = False : sender.Image = My.Resources.Teclas_UnChecked
            Dim Menu_Modificadores As String = ""
            For Each i As Object In KBoard_MenuTecla.Items
                If TypeOf i Is ToolStripMenuItem Then
                    If i.Name = "MTecla0" AndAlso i.Checked = True Then Menu_Modificadores += "CTRL + "
                    If i.Name = "MTecla1" AndAlso i.Checked = True Then Menu_Modificadores += "SHIFT + "
                    If i.Name = "MTecla2" AndAlso i.Checked = True Then Menu_Modificadores += "ALT + "
                    If i.Name = "MTecla3" AndAlso i.Checked = True Then Menu_Modificadores += "WIN + "
                End If
            Next

            Dim Keyboard_Modificadores As String = ""
            If KBoard_CLCtrl.Checked = True Or KBoard_CRCtrl.Checked = True Then Keyboard_Modificadores += "CTRL + "
            If KBoard_CLAlt.Checked = True Then Keyboard_Modificadores += "ALT + "
            If KBoard_CLShift.Checked = True Or KBoard_CRShift.Checked = True Then Keyboard_Modificadores += "SHIFT + "
            If KBoard_CLWin.Checked = True Or KBoard_CRWin.Checked = True Then Keyboard_Modificadores += "WIN + "

            If "mctrl mshift malt mwin".Contains(ComandoScript.ToLower) = False Then
                ComandoScript = Menu_Modificadores + ComandoScript
            Else
                Dim Tecla As String = CTecla.Tag2 : If Tecla = "" Then Tecla = CTecla.Tag
                If Tecla.ToLower.Contains("ctrl + ") Then Tecla = Tecla.Replace("CTRL + ", "")
                If Tecla.ToLower.Contains("shift + ") Then Tecla = Tecla.Replace("SHIFT + ", "")
                If Tecla.ToLower.Contains("alt + ") Then Tecla = Tecla.Replace("ALT + ", "")
                If Tecla.ToLower.Contains("win + ") Then Tecla = Tecla.Replace("WIN + ", "")
                ComandoScript = Menu_Modificadores + Tecla
            End If

            CTecla.Tag2 = ComandoScript : CTecla.Text = TagToKey(CTecla.Tag, ComandoScript).Replace("CTRL + ", "").Replace("SHIFT + ", "").Replace("ALT + ", "").Replace("WIN + ", "") : ComandoScript = ""

            If Keyboard_Modificadores.ToLower = Menu_Modificadores.ToLower Then
                CTecla.CTRL = False : CTecla.SHIFT = False : CTecla.ALT = False : CTecla.WIN = False
            Else
                If CTecla.Tag2.ToLower.Contains("ctrl + ") Then CTecla.CTRL = True Else CTecla.CTRL = False
                If CTecla.Tag2.ToLower.Contains("shift + ") Then CTecla.SHIFT = True Else CTecla.SHIFT = False
                If CTecla.Tag2.ToLower.Contains("alt + ") Then CTecla.ALT = True Else CTecla.ALT = False
                If CTecla.Tag2.ToLower.Contains("win + ") Then CTecla.WIN = True Else CTecla.WIN = False
            End If

            Rutas.SetFontSize(CTecla, 7, 5)
            CTecla.Marked_Set = False : CTecla.Invalidate()
            BEnter2.Marked_Set = False : BEnter2.Invalidate()

            If (Keyboard_Modificadores + CTecla.Tag).ToString.ToLower = CTecla.Tag2.ToString.ToLower Then
                If CTecla.Name = "BEnter" Then
                    BEnter2.Marked = False
                    BEnter4.BackColor = Color.FromArgb(205, 150, 0) : BEnter4.Invalidate()
                    BEnter5.BackColor = Color.FromArgb(205, 150, 0) : BEnter5.Invalidate()
                End If : CTecla.Marked = False : Eliminar = True
                CTecla.CTRL = False : CTecla.SHIFT = False : CTecla.ALT = False : CTecla.WIN = False
            Else
                If CTecla.Name = "BEnter" Then
                    BEnter2.Marked = True
                    BEnter4.BackColor = Color.Green : BEnter4.Invalidate()
                    BEnter5.BackColor = Color.Green : BEnter5.Invalidate()
                End If : CTecla.Marked = True
            End If

            If Eliminar = True Then KBoard_Tecla_Eliminar(Keyboard_Modificadores + CTecla.Tag) Else KBoard_Tecla_Añadir(Keyboard_Modificadores + CTecla.Tag, CTecla.Tag2)
            KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
        End If
    End Sub

    Private Sub KBoard_MenuTecla_KeyDown(sender As Object, e As PreviewKeyDownEventArgs)

    End Sub

    Private Sub KBoard_MenuTecla_MouseEnter(sender As Object, e As EventArgs)
        sender.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub KBoard_MenuTecla_MouseLeave(sender As Object, e As EventArgs)
        sender.ForeColor = Color.FromArgb(130, 130, 130)
    End Sub

#End Region

#End Region

#Region " Tooltips "

    Private Sub KBoard_Tooltips(sender As Object, e As EventArgs) Handles KBoard_Nombre_LNombre.MouseEnter, KBoard_Nombre_BAdd.MouseEnter, KBoard_Nombre_BDelete.MouseEnter, KBoard_LProceso.MouseEnter, KBoard_BProcesoAdd.MouseEnter, KBoard_BProcesoEliminar.MouseEnter, KBoard_BProcesoExaminar.MouseEnter, KBoard_LEstado.MouseEnter, KBoard_TEstado.MouseEnter, KBoard_CDeshabilitado.MouseEnter, KBoard_LDeshabilitado.MouseEnter, KBoard_CAutoActivar.MouseEnter, KBoard_LAutoActivar.MouseEnter, KBoard_LCambiar.MouseEnter, KBoard_LPor.MouseEnter, KBoard_CLCtrl.MouseEnter, KBoard_CRCtrl.MouseEnter, KBoard_CLShift.MouseEnter, KBoard_CRShift.MouseEnter, KBoard_CLAlt.MouseEnter, KBoard_CRAlt.MouseEnter, KBoard_CLWin.MouseEnter, KBoard_CRWin.MouseEnter, KBoard_LCProceso.MouseEnter, PResetear.MouseEnter, KBoard_Nombre_LCNombre.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "KBoard_Nombre_Nombre" : Show_Tooltip(sender, "Nombre del 'K-Board'")
            Case "KBoard_Nombre_CNombre" : Show_Tooltip(sender, "Nombre del 'K-Board'" + vbCrLf + vbCrLf + "Click Derecho: Editar el nombre del 'K-Board'")
            Case "KBoard_Nombre_BAdd" : Show_Tooltip(sender, "Crean un nuevo 'K-Board'")
            Case "KBoard_Nombre_BDelete" : Show_Tooltip(sender, "Elimina el 'K-Board' seleccionado")

            Case "KBoard_Proceso", "KBoard_CProceso" : If KBoard_LCProceso.Text = "Seleccione una aplicación" Then Show_Tooltip(sender, "Añade un proceso que esté en ejecución a la lista de procesos" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente" + vbCrLf + "CTRL + Click: Selecciona un proceso con el ratón" + vbCrLf + vbCrLf + "Cuando se añade algun proceso a la lista" + vbCrLf + "el 'K-Board' solo se ejecutará en esos procesos") Else Show_Tooltip(sender, "Procesos en los que se activará el 'K-Board'" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente" + vbCrLf + "CTRL + Click: Selecciona un proceso con el ratón" + vbCrLf + vbCrLf + "Cuando se añade algun proceso a la lista" + vbCrLf + "el 'K-Board' solo se ejecutará en esos procesos")
            Case "KBoard_BProcesoAdd" : Show_Tooltip(sender, "Añade un proceso que esté en ejecución a la lista de procesos")
            Case "KBoard_BProcesoEliminar" : Show_Tooltip(sender, "Elimina el proceso seleccionado de la lista de procesos")
            Case "KBoard_BProcesoExaminar" : Show_Tooltip(sender, "Añade un archivo ejecutable a la lista de procesos")

            Case "KBoard_Estado" : Show_Tooltip(sender, "Estado del 'K-Board' seleccionado")
            Case "KBoard_TEstado" : Show_Tooltip(sender, "Estado del 'K-Board' seleccionado" + vbCrLf + vbCrLf + "Click Izquierdo: Activar o desactivar manualmente")
            Case "KBoard_Deshabilitado" : Show_Tooltip(sender, "Deshabilita el 'K-Board' seleccionado")
            Case "KBoard_AutoActivar" : Show_Tooltip(sender, "Activa automáticamente el 'K-Board' en los procesos de la lista")
            Case "KBoard_Cambiar" : Show_Tooltip(sender, "Combinación de teclas o ratón que se ha pulsado")
            Case "KBoard_Por" : Show_Tooltip(sender, "Combinación de teclas o ratón que sustituirá a la combinación pulsada")
            Case "PResetear" : Show_Tooltip(sender, "Restaura todas las teclas a sus valores predeterminados")

            Case "KBoard_LCtrl", "KBoard_RCtrl", "KBoard_LShift", "KBoard_RShift", "KBoard_LAlt", "KBoard_RAlt", "KBoard_LWin", "KBoard_RWin" : Show_Tooltip(sender, "Aplica un modificador de teclado")
        End Select
    End Sub

#End Region

#End Region

#End Region

#Region " Panel QuickMenu "

#Region " Edicion "

#Region " Nombre "

#Region " TNombre "

    Private Sub QuickMenu_Editor_Load(Nombre As String)
        If NoLoadQuickMenu = True Then NoLoadQuickMenu = False : Exit Sub
        If PanelQuickMenu.Visible = False Then Exit Sub
        If QuickMenu_Nombre_CNombre.Items.Count = 0 Then QuickMenu_TQuickMenuSize.Enabled = False : QuickMenu_TQuickMenuSize.Value = 0 : Exit Sub
        QuickMenu_Loading = True : CancelClose = False
        Application.DoEvents()
        For Each cItem As Object In QuickMenu_Editor.Items
            If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then cItem.HideDropDown()
        Next : QuickMenu_Editor.Close()
        For Cuenta = 0 To QuickMenus.Length - 1
            If QuickMenus(Cuenta).Nombre.ToLower = Nombre.ToLower Then
                QuickMenu_Editor = New NSContextMenu With {.Name = "QuickMenu", .AutoClose = False, .AllowDrop = True}
                QuickMenu_Editor = QuickMenus(Cuenta)
                QuickMenu_Editor.Nombre = Nombre
                QuickMenu_TQuickMenuSize.Enabled = True
                If QuickMenu_Tamaño_Ignorar = False Then
                    QuickMenu_TQuickMenuSize.Value = Registro.GetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|"), "Tamaño", "0")
                    QuickMenu_TQuickMenuSize_Scroll(QuickMenu_TQuickMenuSize)
                End If
                If QuickMenu_Editor.Items.Count = 0 Then
                    Dim cItem As New ToolStripTextBox With {.Text = "", .BackColor = Color.FromArgb(55, 55, 55), .ForeColor = Color.FromArgb(205, 150, 0), .Name = "Añadir", .Tag = 0, .ShortcutsEnabled = False}
                    AddHandler cItem.MouseDown, AddressOf QuickMenu_Añadir_MouseDown
                    AddHandler cItem.MouseEnter, AddressOf QuickMenu_Añadir_MouseEnterLeave
                    AddHandler cItem.KeyPress, AddressOf QuickMenu_Añadir_KeyPress
                    AddHandler cItem.GotFocus, AddressOf QuickMenu_Añadir_GotFocus
                    AddHandler cItem.LostFocus, AddressOf QuickMenu_Añadir_LostFocus
                    QuickMenu_Editor.Items.Add(cItem)
                End If
                Update_QuickMenu(QuickMenu_Editor)
                QuickMenu_Editor.Show(Left + 240, Top + 110) : QuickMenu_Editor_ZOrder = False
                Exit For
            End If
        Next
        QuickMenu_Loading = False
    End Sub

    Private Sub QuickMenu_Editor_Nuevo(Nombre As String)
        If PanelQuickMenu.Visible = False Or QuickMenu_Nombre_CNombre.Items.Count = 0 Then Exit Sub
        QuickMenu_Editor.Close() : QuickMenu_Editor = New NSContextMenu With {.Name = "QuickMenu", .AutoClose = False, .AllowDrop = True, .Nombre = Nombre, .Font = New Font("Calibri", 8, FontStyle.Regular), .ImageScalingSize = New Size(18, 18)}
        QuickMenu_Añadir(QuickMenu_Editor)
        QuickMenu_Editor.Show(Left + 240, Top + 110)
        If QuickMenu_Editor.Items.Count > 0 AndAlso TypeOf QuickMenu_Editor.Items(0) Is ToolStripTextBox Then
            Dim cItem As Object = QuickMenu_Editor.Items(0)
            cItem.Select() : cItem.Focus()
        End If : QuickMenu_Editor_ZOrder = False
    End Sub

    Private Sub QuickMenu_Nombre_LCNombre_TextChanged(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_LCNombre.TextChanged
        QuickMenu_Nombre_TNombre.Enabled = False
        QuickMenu_Nombre_LCNombre.Text = QuickMenu_Nombre_TNombre.Text
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(QuickMenu_Nombre_LCNombre.Text, New Font(QuickMenu_Nombre_LCNombre.Font.Name, TextSize, FontStyle.Regular)).Width < QuickMenu_Nombre_LCNombre.Width Or TextSize < 4 : TextSize -= 1 : Loop : QuickMenu_Nombre_LCNombre.Font = New Font(QuickMenu_Nombre_LCNombre.Font.Name, TextSize, FontStyle.Regular)
    End Sub

    Private Sub QuickMenu_Nombre_LCNombre_Click(sender As Object, e As MouseEventArgs) Handles QuickMenu_Nombre_LCNombre.Click, QuickMenu_Nombre_TNombre.Click
        If e.Button = MouseButtons.Left Then
            If QuickMenu_Nombre_CNombre.Enabled = True Then QuickMenu_Nombre_CNombre.DroppedDown = True : QuickMenu_Nombre_CNombre.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            If QuickMenu_Nombre_CNombre.Items.Count = 0 Then Exit Sub
            QuickMenu_Nombre_LCNombre.Visible = False : Combo_IgnoreOne = True : QuickMenu_Nombre_TNombre.ReadOnly = False : QuickMenu_Nombre_TNombre.Enabled = True : QuickMenu_Nombre_TNombre.Cursor = Cursors.IBeam : QuickMenu_Nombre_TNombre.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub QuickMenu_Nombre_TNombre_KeyPress(sender As Object, e As KeyPressEventArgs) Handles QuickMenu_Nombre_TNombre.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub QuickMenu_Nombre_TNombre_TextChanged(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_TNombre.TextChanged
        If TextRenderer.MeasureText(QuickMenu_Nombre_TNombre.Text, QuickMenu_Nombre_TNombre.Font).Width >= QuickMenu_Nombre_TNombre.Width + 30 Then QuickMenu_Nombre_TNombre.MaxLength = 25 Else QuickMenu_Nombre_TNombre.MaxLength = 40
    End Sub

    Private Sub QuickMenu_Nombre_TNombre_GotFocus(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_TNombre.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub QuickMenu_Nombre_TNombre_LostFocus(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_TNombre.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If QuickMenu_Nombre_TNombre.Text.ToLower <> QuickMenu_Nombre_TNombre.Tag.ToString.ToLower Then
            For Cuenta = 0 To QuickMenu_Nombre_CNombre.Items.Count - 1
                If QuickMenu_Nombre_CNombre.Items(Cuenta).ToString.ToLower = QuickMenu_Nombre_TNombre.Text.ToLower Then
                    ShowMessageBox("Ya existe un QuickMenu con el nombre '" + QuickMenu_Nombre_TNombre.Text + "'", Version)
                    QuickMenu_Nombre_TNombre.Text = QuickMenu_Nombre_TNombre.Tag : QuickMenu_Nombre_TNombre.SelectionStart = 0 : QuickMenu_Nombre_TNombre.SelectionLength = 0 : Combo_IgnoreOne = True : Focus_QuickMenu_Name = True : Exit Sub
                End If
            Next
        End If
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If QuickMenu_Nombre_LCNombre.Visible = False Then QuickMenu_Nombre_LCNombre.Visible = True : QuickMenu_Nombre_TNombre.ReadOnly = True : QuickMenu_Nombre_TNombre.Enabled = False : QuickMenu_Nombre_TNombre.Cursor = Cursors.Hand
        If QuickMenu_Nombre_TNombre.Text.Trim = "" Then QuickMenu_Nombre_TNombre.Text = QuickMenu_Nombre_TNombre.Tag : Exit Sub
        If QuickMenu_Nombre_TNombre.Text = QuickMenu_Nombre_TNombre.Tag Then Exit Sub
        For Cuenta = 0 To QuickMenu_Nombre_CNombre.Items.Count - 1
            If QuickMenu_Nombre_TNombre.Tag.ToLower = QuickMenu_Nombre_CNombre.Items(Cuenta).ToLower Then
                Dim OldName As String = QuickMenu_Nombre_CNombre.Items(Cuenta)
                NoLoadQuickMenu = True
                QuickMenu_Nombre_CNombre.Items(Cuenta) = QuickMenu_Nombre_TNombre.Text
                QuickMenu_Nombre_TNombre.Tag = QuickMenu_Nombre_TNombre.Text
                If QuickMenus Is Nothing OrElse QuickMenus.Length = 0 Then GoTo CrearNuevo
                For Cuenta2 = 0 To QuickMenus.Length - 1
                    If QuickMenus(Cuenta2).Nombre.ToLower = OldName.ToLower Then
                        QuickMenus(Cuenta2).Nombre = QuickMenu_Nombre_TNombre.Tag
                        QuickMenu_Editor.Nombre = QuickMenu_Nombre_TNombre.Tag
                        QuickMenu_Nombre_CNombre.Items.Remove(OldName)
                        Registro.DelReg(RegPath + "\QuickMenus\" + OldName.Replace("\", "|/|"))
                        OldName = QuickMenu_Nombre_TNombre.Tag
                        QuickMenus_Guardar()
                        QuickMenus_Cargar(True)
                        QuickMenu_Nombre_CNombre.SelectedItem = OldName
                    End If
                Next
            End If
        Next : QuickMenu_Nombre_TNombre.SelectionLength = 0 : QuickMenu_Nombre_LCNombre.Text = QuickMenu_Nombre_TNombre.Text : Exit Sub

CrearNuevo: Estadisticas.Estadisticas.QuickMenus_Creados += 1 : Estadisticas.Guardar()
        QuickMenu_Nombre_TNombre.SelectionLength = 0 : QuickMenu_Nombre_LCNombre.Text = QuickMenu_Nombre_TNombre.Text
        If QuickMenus IsNot Nothing Then ReDim Preserve QuickMenus(QuickMenus.Length) Else ReDim QuickMenus(0)
        QuickMenus(QuickMenus.Length - 1).Nombre = QuickMenu_Nombre_TNombre.Text
        QuickMenus_Guardar()
        QuickMenus_Cargar()
    End Sub

    Private Sub QuickMenu_Nombre_TNombre_MouseEnter(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_TNombre.MouseEnter, QuickMenu_Nombre_CNombre.MouseEnter
        QuickMenu_Nombre_CNombre.State = NSComboBox.MouseState.None
    End Sub

#End Region

#Region " CNombre "

    Private Sub QuickMenu_Nombre_CNombre_DropDown(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_CNombre.DropDown
        QuickMenu_Nombre_TNombre.Enabled = True
        If QuickMenu_Nombre_CNombre.Items.Count > 0 Then QuickMenu_Nombre_CNombre.MaxDropDownItems = 10
        Combo_Dropped = True : Combo_TempValue = QuickMenu_Nombre_TNombre.Text
        If QuickMenu_Nombre_CNombre.Items.Contains(QuickMenu_Nombre_TNombre.Text) = True Then QuickMenu_Nombre_CNombre.SelectedItem = QuickMenu_Nombre_TNombre.Text Else QuickMenu_Nombre_CNombre.SelectedIndex = 0
    End Sub

    Private Sub QuickMenu_Nombre_CNombre_DropDownClosed(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_CNombre.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub QuickMenu_Nombre_CNombre_LostFocus(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_CNombre.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub QuickMenu_Nombre_CNombre_SelectedIndexChanged(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_CNombre.SelectedIndexChanged
        If Combo_TempValue = "" Then QuickMenu_Nombre_TNombre.Text = QuickMenu_Nombre_CNombre.SelectedItem.Trim : QuickMenu_Nombre_LCNombre.Text = QuickMenu_Nombre_TNombre.Text : QuickMenu_Nombre_TNombre.Tag = QuickMenu_Nombre_TNombre.Text : HTexto.Focus() : QuickMenu_Editor_Load(QuickMenu_Nombre_TNombre.Tag)
    End Sub

    Private Sub QuickMenu_Nombre_CNombre_KeyPress(sender As Object, e As KeyPressEventArgs) Handles QuickMenu_Nombre_CNombre.KeyPress
        If Asc(e.KeyChar) = 13 Then QuickMenu_Nombre_TNombre.Text = QuickMenu_Nombre_CNombre.SelectedItem.Trim : QuickMenu_Nombre_LCNombre.Text = QuickMenu_Nombre_TNombre.Text : HTexto.Focus() : e.Handled = True
    End Sub

#End Region

#Region " Botones "

    Private Sub QuickMenu_Nombre_BAdd_Click(sender As Object, e As MouseEventArgs) Handles QuickMenu_Nombre_BAdd.Click
        HTexto.Focus() : If e.Button <> MouseButtons.Left Then Exit Sub
        QuickMenu_Tamaño_Ignorar = True
        QuickMenu_TQuickMenuSize.Value = 0
        Dim Contador As Integer
        For Cuenta = 0 To QuickMenu_Nombre_CNombre.Items.Count - 1
            If QuickMenu_Nombre_CNombre.Items(Cuenta).ToString.ToLower = "nuevo_" + Contador.ToString Then Contador += 1 : Cuenta = 0
        Next
        If QuickMenus IsNot Nothing Then ReDim Preserve QuickMenus(QuickMenus.Length) : QuickMenus(QuickMenus.Length - 1) = New NSContextMenu Else ReDim QuickMenus(0) : QuickMenus(0) = New NSContextMenu
        Dim NewTitulo As String = "Nuevo_" + Contador.ToString
        QuickMenu_Nombre_TNombre.Tag = NewTitulo
        QuickMenus(QuickMenus.Length - 1).Nombre = NewTitulo
        QuickMenu_Nombre_CNombre.Enabled = True
        QuickMenu_Nombre_CNombre.Items.Add(NewTitulo)
        QuickMenu_Editor_Nuevo(NewTitulo)
        QuickMenus_Guardar()
        QuickMenus_Cargar()
        QuickMenu_Editor_Inicializar()
        QuickMenu_Nombre_CNombre.SelectedItem = NewTitulo
        QuickMenu_Nombre_TNombre.Text = NewTitulo
        QuickMenu_Tamaño_Ignorar = False
        Estadisticas.Estadisticas.QuickMenus_Creados += 1 : Estadisticas.Guardar()
        GC.Collect()
    End Sub

    Private Sub QuickMenu_Nombre_BDelete_Click(sender As Object, e As MouseEventArgs) Handles QuickMenu_Nombre_BDelete.Click
        HTexto.Focus() : If e.Button <> MouseButtons.Left Then Exit Sub
        For Cuenta = 0 To QuickMenu_Nombre_CNombre.Items.Count - 1
            If QuickMenu_Nombre_CNombre.Items(Cuenta).ToString.ToLower = QuickMenu_Nombre_TNombre.Tag.ToString.ToLower Then
                If ShowMessageBox("¿Eliminar '" + QuickMenu_Nombre_TNombre.Tag.ToString + "'?", Version, MsgBoxStyle.YesNo) <> DialogResult.OK Then Exit Sub
                Registro.DelReg(RegPath + "\QuickMenus\" + QuickMenu_Nombre_CNombre.Items(Cuenta).Replace("\", "|/|"))
                If Lista.Columns(0).Text.ToLower = QuickMenu_Nombre_LCNombre.Text.ToLower Then Lista_CComandos.SelectedIndex = 0
                QuickMenu_Nombre_CNombre.Items.RemoveAt(Cuenta)
                QuickMenus_Cargar()
                If QuickMenu_Nombre_CNombre.Items.Count = 0 Then
                    QuickMenu_TQuickMenuSize.Enabled = False
                    QuickMenu_TQuickMenuSize.Value = 0
                    QuickMenu_Nombre_LCNombre.Text = ""
                    QuickMenu_Nombre_TNombre.Text = ""
                    QuickMenu_Nombre_TNombre.Tag = ""
                    CancelClose = False
                    QuickMenu_Editor.Close()
                Else
                    QuickMenu_Nombre_CNombre.SelectedIndex = 0
                End If
                Lista_Update()
                Estadisticas.Estadisticas.QuickMenus_Eliminados += 1 : Estadisticas.Guardar()
                Exit Sub
            End If
        Next
        GC.Collect()
    End Sub

    Private Sub QuickMenu_Nombre_BDelete_MouseEnter(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_BDelete.MouseEnter
        QuickMenu_Nombre_CNombre.State = NSComboBox.MouseState.None
    End Sub

#End Region

#Region " Tamaño "

    Private Sub QuickMenu_TQuickMenuSize_Scroll(sender As Object) Handles QuickMenu_TQuickMenuSize.Scroll
        If QuickMenu_Tamaño_Ignorar = True Then Exit Sub
        Select Case QuickMenu_TQuickMenuSize.Value
            Case 0 : QuickMenu_Editor.Font = New Font("Calibri", 8, FontStyle.Regular) : QuickMenu_Editor.ImageScalingSize = New Size(18, 18)
            Case 1 : QuickMenu_Editor.Font = New Font("Calibri", 9, FontStyle.Regular) : QuickMenu_Editor.ImageScalingSize = New Size(18, 18)
            Case 2 : QuickMenu_Editor.Font = New Font("Calibri", 10, FontStyle.Regular) : QuickMenu_Editor.ImageScalingSize = New Size(20, 20)
            Case 3 : QuickMenu_Editor.Font = New Font("Calibri", 11, FontStyle.Regular) : QuickMenu_Editor.ImageScalingSize = New Size(22, 22)
            Case 4 : QuickMenu_Editor.Font = New Font("Calibri", 12, FontStyle.Regular) : QuickMenu_Editor.ImageScalingSize = New Size(24, 24)
            Case 5 : QuickMenu_Editor.Font = New Font("Calibri", 13, FontStyle.Regular) : QuickMenu_Editor.ImageScalingSize = New Size(26, 26)
        End Select
        'QuickMenu_Editor.Font = New Font("Calibri", Convert.ToSingle(8 + (QuickMenu_TQuickMenuSize.Value / 10)), FontStyle.Regular) : QuickMenu_Editor.ImageScalingSize = New Size(16 + QuickMenu_TQuickMenuSize.Value, 16 + QuickMenu_TQuickMenuSize.Value)
    End Sub

    Private Sub QuickMenu_TQuickMenuSize_MouseMove(sender As Object, e As MouseEventArgs) Handles QuickMenu_TQuickMenuSize.MouseMove
        If QuickMenu_Tamaño_Ignorar = True Then Exit Sub
        'General_Tooltip.InitialDelay = 1000 : General_Tooltip.ReshowDelay = 250 : General_Tooltip.AutoPopDelay = 10000 : General_Tooltip.ShowAlways = True
        'General_Tooltip.Tag = "Tamaño: " + Convert.ToInt32(Math.Max(Math.Min(e.Location.X / (QuickMenu_TQuickMenuSize.Width / QuickMenu_TQuickMenuSize.Maximum), 14), 0) + 1).ToString
        'General_Tooltip.Show(General_Tooltip.Tag, QuickMenu_TQuickMenuSize, e.Location.X, e.Location.Y + 15)
    End Sub

    Private Sub QuickMenu_TQuickMenuSize_MouseLeave(sender As Object, e As EventArgs) Handles QuickMenu_TQuickMenuSize.MouseLeave
        'If QuickMenu_Tamaño_Ignorar = True Then Exit Sub
        'General_Tooltip.Hide(QuickMenu_TQuickMenuSize)
    End Sub

    'Dim QuickMenu_Tamaño_Down As Boolean
    Private Sub QuickMenu_TQuickMenuSize_MouseDown(sender As Object, e As EventArgs) Handles QuickMenu_TQuickMenuSize.MouseDown
        'QuickMenu_Tamaño_Down = True
    End Sub

    Private Sub QuickMenu_TQuickMenuSize_MouseUp(sender As Object, e As EventArgs) Handles QuickMenu_TQuickMenuSize.MouseUp
        'QuickMenu_Tamaño_Down = False
        Show_Tooltip(sender, "Tamaño del 'QuickMenu': " + QuickMenu_TQuickMenuSize.Value.ToString)
        If QuickMenu_Tamaño_Ignorar = False Then QuickMenus_Guardar()
    End Sub

#End Region

#End Region

#Region " SubMenus "

#Region " Open / Close "

    Private Sub QuickMenu_SubMenu_Opening(sender As Object, e As ComponentModel.CancelEventArgs)
        If QuickMenu_Menu.Visible = True Or QuickMenu_MenuNuevo.Visible = True Then e.Cancel = True
    End Sub

    Private Sub QuickMenu_SubMenu_Closing(sender As Object, e As ToolStripDropDownClosingEventArgs)
        If ForceClose = True Then ForceClose = False : Exit Sub
        If e.CloseReason = ToolStripDropDownCloseReason.ItemClicked Then e.Cancel = True
        If CancelClose = True Then e.Cancel = True
    End Sub

    Private Sub QuickMenu_SubMenu_Closed(sender As Object, e As ToolStripDropDownClosedEventArgs)
        For Each cItem As Object In sender.Items
            cItem.ForeColor = Color.FromArgb(130, 130, 130)
        Next
    End Sub

#End Region

#Region " KeyDown / KeyUp "

    Private Sub QuickMenu_SubMenu_KeyDown(sender As Object, e As PreviewKeyDownEventArgs)
        'Try
        If e.KeyCode <> Keys.Up And e.KeyCode <> Keys.Down And e.KeyCode <> Keys.Left And e.KeyCode <> Keys.Right And e.KeyCode <> Keys.Home And e.KeyCode <> Keys.End And e.KeyCode <> Keys.Escape Then Exit Sub
        QuickMenu_ForeColor_Off() : CancelClose = False : IgnoreOne = False : Dim Selected As Boolean
        If e.KeyCode = Keys.Up Or e.KeyCode = Keys.Down Then
            For Cuenta = 0 To sender.Items.Count - 1
                If sender.Items(Cuenta).Selected = True Then
                    If e.KeyCode = Keys.Up Then
                        If Cuenta = 0 Then
                            sender.Items(GetNextItem_ForSelect(sender, sender.Items.Count - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
                        Else
                            sender.Items(GetNextItem_ForSelect(sender, Cuenta - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
                        End If
                    End If
                    If e.KeyCode = Keys.Down Then
                        If Cuenta = sender.Items.Count - 1 Then
                            sender.Items(GetNextItem_ForSelect(sender, 0, False)).ForeColor = Color.FromArgb(205, 150, 0)
                        Else
                            sender.Items(GetNextItem_ForSelect(sender, Cuenta + 1, False)).ForeColor = Color.FromArgb(205, 150, 0)
                        End If
                    End If : Selected = True : Exit For
                End If
            Next
            If Selected = False Then
                If e.KeyCode = Keys.Up AndAlso sender.Items.Count > 0 Then
                    sender.Items(GetNextItem_ForSelect(sender, sender.Items.Count - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
                End If
                If e.KeyCode = Keys.Down AndAlso sender.Items.Count > 0 Then
                    sender.Items(GetNextItem_ForSelect(sender, 0, False)).ForeColor = Color.FromArgb(205, 150, 0)
                End If
            End If
        End If
        If e.KeyCode = Keys.Right Then
            For Each cItem As Object In sender.Items
                If cItem.Selected = True Then
                    If cItem.DropDownItems.Count > 0 Then
                        cItem.DropDownItems(0).ForeColor = Color.FromArgb(205, 150, 0) : Exit For
                    Else
                        For Each nItem As Object In QuickMenu_Editor.Items
                            If nItem.Selected = True Then nItem.ForeColor = Color.FromArgb(205, 150, 0) : Exit For
                        Next : Exit For
                    End If
                End If
            Next
        End If
        If e.KeyCode = Keys.Left Or e.KeyCode = Keys.Escape Then
            If TypeOf sender IsNot NSContextMenu Then
                sender.OwnerItem.ForeColor = Color.FromArgb(205, 150, 0)
            Else
                For Each nItem As Object In QuickMenu_Editor.Items
                    If nItem.Selected = True Then nItem.ForeColor = Color.FromArgb(205, 150, 0) : Exit For
                Next
            End If
        End If
        If e.KeyCode = Keys.Home Then sender.Items(0).ForeColor = Color.FromArgb(205, 150, 0)
        If e.KeyCode = Keys.End Then sender.Items(sender.Items.Count - 1).ForeColor = Color.FromArgb(205, 150, 0)
        'Catch : End Try
    End Sub

    Private Sub QuickMenu_SubMenu_KeyUp(sender As Object, e As KeyEventArgs)
        If e.KeyCode = Keys.Apps Then
            For Each cItem As Object In sender.Items
                If cItem.Selected = True Then
                    If TypeOf cItem Is ToolStripMenuItem Then ItemOnMouse = cItem : SeparatorOnMouse = Nothing : QuickMenu_Menu.Tag = ItemOnMouse
                    If TypeOf cItem Is ToolStripSeparator Then ItemOnMouse = Nothing : SeparatorOnMouse = cItem : QuickMenu_Menu.Tag = SeparatorOnMouse
                    QuickMenu_Menu.Show(sender.left + (cItem.Bounds.Left + cItem.Bounds.Width), sender.top + cItem.Bounds.Top) : Exit For
                End If
            Next
        End If
        If e.KeyCode = Keys.Delete Then
            For Each cItem As Object In sender.Items
                If cItem.Selected = True Then
                    If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.IsOnDropDown = True Then cItem.HideDropDown() : cItem.DropDownItems.Clear()
                    Dim Strip As ToolStrip = cItem.Owner
                    If Strip.Items.Count = 1 Then Strip.Hide()
                    cItem.Owner.Items.Remove(cItem)
                    QuickMenus_Guardar()
                    If QuickMenu_Editor.Items.Count = 0 Then QuickMenu_Añadir(QuickMenu_Editor)
                    Exit For
                End If
            Next
        End If
    End Sub

#End Region

#Region " Drag & Drop "

    Private Sub QuickMenu_SubMenu_DragEnter(sender As Object, e As DragEventArgs)
        MoveStrip = sender
        If Keyboard.Get_KeyState(Keys.LControlKey) Or Keyboard.Get_KeyState(Keys.RControlKey) Then
            If TypeOf MoveStrip Is NSContextMenu AndAlso MoveStrip.Items.Count = 1 AndAlso ((TypeOf MoveStrip.Items(0) Is ToolStripMenuItem AndAlso MoveStrip.Items(0).DropDownItems.Count = 0) Or TypeOf MoveStrip.Items(0) Is ToolStripSeparator) Then Exit Sub
            e.Effect = DragDropEffects.Copy
        Else
            If TypeOf MoveStrip Is NSContextMenu AndAlso MoveStrip.Items.Count = 1 Then Exit Sub
            e.Effect = DragDropEffects.Move
            MovingItem = True
        End If
    End Sub

    Private Sub QuickMenu_SubMenu_DragLeave(sender As Object, e As DragEventArgs)
        MovingItem = False
    End Sub

    Private Sub QuickMenu_SubMenu_DragDrop(sender As Object, e As DragEventArgs)
        'Try
        If AlreadyCopied = False Then AlreadyCopied = True Else Exit Sub
        Dim Strip As Object = sender : Dim cItem As Object = Strip.GetItemAt(e.X - Strip.Left, e.Y - Strip.Top)
        If TypeOf MoveItem IsNot ToolStripSeparator AndAlso MoveItem.DropDownItems.Count > 0 AndAlso e.Effect = DragDropEffects.Move Then If QuickMenu_SubMenu_CheckItemInside(MoveItem, cItem) = True Then Exit Sub
        Dim Texto As String = e.Data.GetData(DataFormats.Text)
        MovingItem = False
        Dim Position As Integer = Strip.Items.IndexOf(Strip.GetItemAt(e.X - Strip.Left, e.Y - Strip.Top))
        If Position = -1 OrElse Strip.Items(Position) Is MoveItem Then Exit Sub
        If Position > -1 AndAlso Position < Strip.Items.Count Then
            If e.Effect = DragDropEffects.Copy Then
                If TypeOf MoveItem Is ToolStripMenuItem Then
                    Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString("ddMMyyyyHHmmss"), .Text = MoveItem.Text, .ForeColor = MoveItem.ForeColor, .Tag = Generate_ID() + "|-|" + MoveItem.Tag.ToString.Substring(Split(MoveItem.Tag, "|-|",, CompareMethod.Text)(0).Length + 3), .Image = MoveItem.Image, .AllowDrop = MoveItem.AllowDrop}
                    AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
                    AddHandler NewItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
                    AddHandler NewItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
                    AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
                    AddHandler NewItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
                    If MoveItem.DropDownItems.Count > 0 Then QuickMenu_DragCopy_SubItems(MoveItem, NewItem)
                    Strip.Items.Insert(Position, NewItem)
                ElseIf TypeOf MoveItem Is ToolStripSeparator Then
                    Dim NewItem As New ToolStripSeparator With {.Name = "-" + Now.ToString("ddMMyyyyHHmmss"), .Text = MoveItem.Text, .ForeColor = MoveItem.ForeColor, .Tag = Generate_ID() + "|-|" + MoveItem.Tag.ToString.Substring(Split(MoveItem.Tag, "|-|",, CompareMethod.Text)(0).Length + 3)}
                    AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
                    AddHandler NewItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
                    AddHandler NewItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
                    AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
                    AddHandler NewItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
                    Strip.Items.Insert(Position, NewItem)
                End If
            ElseIf e.Effect = DragDropEffects.Move Then
                Strip.Items.Insert(Position, MoveItem)
            End If : QuickMenus_Guardar()
        End If
        'Catch : End Try
    End Sub

    Private Sub QuickMenu_DragCopy_SubItems(Strip, nStrip)
        For Each nItem As Object In Strip.DropDownItems
            If TypeOf nItem Is ToolStripSeparator Then
                Dim cItem As New ToolStripSeparator With {.Name = "-" + Now.ToString("ddMMyyyyHHmmss"), .Text = nItem.Text, .ForeColor = nItem.ForeColor, .Tag = Generate_ID() + "|-|" + nItem.Tag.ToString.Substring(Split(nItem.Tag, "|-|",, CompareMethod.Text)(0).Length + 3)}
                AddHandler cItem.Paint, AddressOf QuickMenu_Titulo_Paint
                AddHandler cItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
                AddHandler cItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
                AddHandler cItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
                AddHandler cItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
                nStrip.DropDownItems.Add(cItem)
            Else
                Dim cItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString("ddMMyyyyHHmmss"), .Text = nItem.Text, .Tag = Generate_ID() + "|-|" + nItem.Tag.ToString.Substring(Split(nItem.Tag, "|-|",, CompareMethod.Text)(0).Length + 3), .Image = nItem.Image, .ForeColor = nItem.ForeColor, .AllowDrop = nItem.AllowDrop}
                AddHandler cItem.Paint, AddressOf QuickMenu_Titulo_Paint
                AddHandler cItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
                AddHandler cItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
                AddHandler cItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
                AddHandler cItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
                If nItem.DropDownItems.Count > 0 Then QuickMenu_DragCopy_SubItems(nItem, cItem)
                nStrip.DropDownItems.Add(cItem)
                If nStrip.DropDownItems.Count = 1 Then
                    Dim NewStrip As ToolStripDropDownMenu = cItem.Owner : NewStrip.AllowDrop = True
                    AddHandler NewStrip.DragDrop, AddressOf QuickMenu_SubMenu_DragDrop
                    AddHandler NewStrip.DragEnter, AddressOf QuickMenu_SubMenu_DragEnter
                    AddHandler NewStrip.DragLeave, AddressOf QuickMenu_SubMenu_DragLeave
                    AddHandler NewStrip.Opening, AddressOf QuickMenu_SubMenu_Opening
                    AddHandler NewStrip.Closing, AddressOf QuickMenu_SubMenu_Closing
                    AddHandler NewStrip.Closed, AddressOf QuickMenu_SubMenu_Closed
                    AddHandler NewStrip.PreviewKeyDown, AddressOf QuickMenu_SubMenu_KeyDown
                    AddHandler NewStrip.KeyUp, AddressOf QuickMenu_SubMenu_KeyUp
                End If
            End If
        Next
    End Sub

#End Region

#End Region

#Region " Items "

    Private Sub QuickMenu_Item_MouseDown(sender As Object, e As MouseEventArgs)
        If e.Button = MouseButtons.Left Then
            QuickMenu_SubMenu_Remove_TextBoxes()
            If IgnoreOne = True Then IgnoreOne = False : QuickMenu_Item_MouseEnter(sender, Nothing) : Exit Sub
            StartMovingItem = True
        ElseIf e.Button = MouseButtons.Right Then
            IgnoreOne = True
            CancelClose = False
            If TypeOf sender Is ToolStripMenuItem Then ItemOnMouse = sender : SeparatorOnMouse = Nothing : QuickMenu_Menu.Tag = ItemOnMouse
            If TypeOf sender Is ToolStripSeparator Then ItemOnMouse = Nothing : SeparatorOnMouse = sender : QuickMenu_Menu.Tag = SeparatorOnMouse
            QuickMenu_SubMenu_Remove_TextBoxes() : QuickMenu_ForeColor_Off() : sender.ForeColor = Color.FromArgb(205, 150, 0)
            For Cuenta = 0 To sender.Owner.Items.Count - 1
                If TypeOf sender.Owner.Items(Cuenta) Is ToolStripMenuItem Then SetForegroundWindow(New Runtime.InteropServices.HandleRef(QuickMenu_Editor, QuickMenu_Editor.Handle)) : sender.Owner.Items(Cuenta).HideDropDown()
            Next : If TypeOf sender Is ToolStripMenuItem AndAlso sender.DropDownItems.Count > 0 Then sender.ShowDropDown()
            CancelClose = True : QuickMenu_Menu.Show(MousePosition.X, MousePosition.Y)
        ElseIf e.Button = MouseButtons.Middle Then

        End If
    End Sub

    Private Sub QuickMenu_Item_MouseUp(sender As Object, e As MouseEventArgs)
        If StartMovingItem = True AndAlso e.Button = MouseButtons.Left Then
            StartMovingItem = False
            If ItemOnMouse Is Nothing Then Exit Sub
            For Cuenta = 0 To Comandos.Length - 1
                If Comandos(Cuenta).ID = Split(sender.Tag, "|-|",, CompareMethod.Text)(1) Then
                    Dim cEjecutarComando As EjecutarComandoST
                    cEjecutarComando.Indice_Comando = Cuenta
                    cEjecutarComando.ID_Comando = Comandos(Cuenta).ID
                    cEjecutarComando.Sonido = Comandos(Cuenta).Sonido
                    Proceso.Get_Process_Name(True)
                    cEjecutarComando.Proceso = Proceso.CurrentProcess
                    cEjecutarComando.Logger = "Keyboard"
                    cEjecutarComando.Notas = "QuickMenu"
                    Comandos(Cuenta).EnEjecucion = True
                    EjecutarComando(cEjecutarComando)
                    Exit For
                End If
            Next
        ElseIf e.Button = MouseButtons.Middle Then
            QuickMenu_Menu_EditarComando_Click(sender, e)
        End If
    End Sub

    Private Sub QuickMenu_Item_MouseEnter(sender As Object, e As EventArgs)
        If QuickMenu_IgnoreMouse = True Then Exit Sub
        If QuickMenu_Menu.Visible = True Or QuickMenu_MenuNuevo.Visible = True Then Exit Sub
        CancelClose = False : IgnoreOne = False : MoveStrip = sender.Owner
        If TypeOf sender Is ToolStripMenuItem Then ItemOnMouse = sender : SeparatorOnMouse = Nothing
        If TypeOf sender Is ToolStripSeparator Then ItemOnMouse = Nothing : SeparatorOnMouse = sender
        If IgnoreMouseEnter = True Then Exit Sub
        QuickMenu_ForeColor_Off() : sender.ForeColor = Color.FromArgb(205, 150, 0) : sender.Select()
        For Cuenta = 0 To sender.Owner.Items.Count - 1
            If TypeOf sender.Owner.Items(Cuenta) Is ToolStripMenuItem Then SetForegroundWindow(New Runtime.InteropServices.HandleRef(QuickMenu_Editor, QuickMenu_Editor.Handle)) : sender.Owner.Items(Cuenta).HideDropDown()
        Next : If TypeOf sender Is ToolStripMenuItem AndAlso sender.DropDownItems.Count > 0 Then sender.ShowDropDown()
    End Sub

    Private Sub QuickMenu_Item_MouseMove(sender As Object, e As MouseEventArgs)
        If QuickMenu_IgnoreMouse = True Then Exit Sub
        If StartMovingItem = True Then
            StartMovingItem = False
            MovingData = sender.Tag
            MoveStrip = sender.Owner
            MoveItem = sender
            MovePosition = sender.Owner.Items.IndexOf(sender)
            If Keyboard.Get_KeyState(Keys.LControlKey) Or Keyboard.Get_KeyState(Keys.RControlKey) Then sender.DoDragDrop(sender.Tag, DragDropEffects.Copy) : AlreadyCopied = False Else sender.DoDragDrop(sender.Tag, DragDropEffects.Move) : AlreadyCopied = False
        Else
            If IgnoreMouseEnter = False AndAlso sender.ForeColor = Color.FromArgb(130, 130, 130) Then QuickMenu_ForeColor_Off() : sender.ForeColor = Color.FromArgb(205, 150, 0)
        End If
    End Sub

    Private Sub QuickMenu_Titulo_Paint(sender As Object, e As PaintEventArgs)
        If Split(sender.Tag, "|-|",, CompareMethod.Text)(1) <> "[TITULO]" Then Exit Sub
        Dim cFont As Font = sender.Font
        Dim nFont As New Font(cFont.FontFamily, cFont.Size + 1)

        Dim Header As New Drawing2D.LinearGradientBrush(New Rectangle(sender.ContentRectangle.X, sender.ContentRectangle.Y - 1, sender.ContentRectangle.Width, sender.ContentRectangle.Height), Color.FromArgb(25, 25, 25), Color.FromArgb(42, 42, 42), 270)
        e.Graphics.FillRectangle(Header, New Rectangle(sender.ContentRectangle.X, sender.ContentRectangle.Y - 1, sender.ContentRectangle.Width, sender.ContentRectangle.Height))
        Dim HeaderHatch As New Drawing2D.HatchBrush(Drawing2D.HatchStyle.Trellis, Color.FromArgb(35, Color.Black), Color.Transparent)
        e.Graphics.FillRectangle(HeaderHatch, New Rectangle(sender.ContentRectangle.X, sender.ContentRectangle.Y - 1, sender.ContentRectangle.Width, sender.ContentRectangle.Height))
        e.Graphics.DrawString(sender.Text, nFont, New SolidBrush(sender.ForeColor), (sender.ContentRectangle.Width / 2 - (MeasureString(sender.Text, nFont).Width / 2)) + 4, sender.ContentRectangle.Height / 2 - (MeasureString(sender.Text, nFont).Height / 2))
        e.Graphics.DrawRectangle(New Pen(Color.Black), sender.ContentRectangle.X, sender.ContentRectangle.Y - 1, sender.ContentRectangle.Width, sender.ContentRectangle.Height)
        If sender.DropDownItems.Count > 0 Then e.Graphics.FillPolygon(New SolidBrush(Color.Black), {New Point(sender.ContentRectangle.width - 11, (sender.ContentRectangle.Height / 2) - 4), New Point(sender.ContentRectangle.width - 7, (sender.ContentRectangle.Height / 2)), New Point(sender.ContentRectangle.width - 11, (sender.ContentRectangle.Height / 2) + 4)})

        If Split(sender.Tag, "|-|",, CompareMethod.Text)(3) = "[DEFAULT]" Then
            sender.Image = Nothing
        ElseIf Split(sender.Tag, "|-|",, CompareMethod.Text)(3) <> "[ELIMINADOICON]" Then
            If IO.File.Exists(Split(sender.Tag, "|-|",, CompareMethod.Text)(3)) = True Then e.Graphics.DrawImage(Iconos.Cargar(Split(sender.Tag, "|-|",, CompareMethod.Text)(3)).ToBitmap, New Rectangle(5, (sender.ContentRectangle.Height / 2) - 8, 18, (sender.ContentRectangle.Height / 2) + 6))
        End If
    End Sub

#End Region

#Region " TextBox "

    Private Sub QuickMenu_Añadir(Strip As Object, Optional Position As Integer = -1)
        CancelClose = True
        Dim cItem As New ToolStripTextBox With {.Text = "", .BackColor = Color.FromArgb(55, 55, 55), .ForeColor = Color.FromArgb(205, 150, 0), .Name = "Añadir", .Tag = Position, .ShortcutsEnabled = False, .Owner = Strip}
        AddHandler cItem.MouseDown, AddressOf QuickMenu_Añadir_MouseDown
        AddHandler cItem.MouseEnter, AddressOf QuickMenu_Añadir_MouseEnterLeave
        AddHandler cItem.KeyPress, AddressOf QuickMenu_Añadir_KeyPress
        AddHandler cItem.GotFocus, AddressOf QuickMenu_Añadir_GotFocus
        AddHandler cItem.LostFocus, AddressOf QuickMenu_Añadir_LostFocus

        For Each nItem As Object In Strip.Items
            nItem.ForeColor = Color.FromArgb(130, 130, 130)
        Next
        If Position = -1 Then Strip.Items.Add(cItem) : cItem = Strip.Items(Strip.Items.Count - 1) Else Strip.Items.Insert(Position, cItem)
        cItem.Tag = Strip.Items.IndexOf(cItem)
        Strip.Select : cItem.Select() : cItem.Focus()
    End Sub

    Private Sub QuickMenu_Añadir_KeyPress(sender As Object, e As KeyPressEventArgs)
        Dim Strip As Object = CType(sender, ToolStripTextBox).Owner
        If Asc(e.KeyChar) = 13 Then
            e.Handled = True : If sender.Text.Trim = "" Then Exit Sub
            If sender.Text = "-" Then
                Dim NewSeparator As New ToolStripSeparator With {.Name = "-" + Now.ToString, .Text = "-" + Now.ToString, .Tag = Generate_ID() + "|-|[SEPARADOR]|-||-|"}
                AddHandler NewSeparator.Paint, AddressOf QuickMenu_Titulo_Paint
                AddHandler NewSeparator.MouseDown, AddressOf QuickMenu_Item_MouseDown
                AddHandler NewSeparator.MouseUp, AddressOf QuickMenu_Item_MouseUp
                AddHandler NewSeparator.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
                AddHandler NewSeparator.MouseMove, AddressOf QuickMenu_Item_MouseMove
                If sender.Tag = -1 Then Strip.Items.Add(NewSeparator) Else Strip.Items.Insert(sender.Tag, NewSeparator)
            ElseIf sender.Text.ToString.StartsWith("""") AndAlso sender.Text.ToString.EndsWith("""") Then
                Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = sender.Text.ToString.Substring(1, sender.Text.ToString.Length - 2), .BackColor = Color.FromArgb(50, 50, 50), .ForeColor = Color.FromArgb(205, 150, 0), .TextAlign = ContentAlignment.MiddleCenter, .Tag = Generate_ID() + "|-|[TITULO]|-|" + sender.Text.ToString.Substring(1, sender.Text.ToString.Length - 2) + "|-|[ELIMINADOICON]"}
                AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
                AddHandler NewItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
                AddHandler NewItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
                AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
                AddHandler NewItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
                If sender.Tag = -1 Then Strip.Items.Add(NewItem) Else Strip.Items.Insert(sender.Tag, NewItem)
            Else
                Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = sender.Text, .ForeColor = QuickMenu_Editor.ForeColor, .Tag = Generate_ID() + "|-||-|" + sender.Text + "|-|", .Image = My.Resources.Accion_Comandos.ToBitmap}
                AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
                AddHandler NewItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
                AddHandler NewItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
                AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
                AddHandler NewItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
                If sender.Tag = -1 Then Strip.Items.Add(NewItem) Else Strip.Items.Insert(sender.Tag, NewItem)
            End If
            CancelClose2 = True
            sender.Owner.Items.Remove(sender)
            QuickMenus_Guardar()
            QuickMenu_Editor.Focus()
            CancelClose2 = False
        End If
    End Sub

    Private Sub QuickMenu_Añadir_MouseDown(sender As Object, e As MouseEventArgs)
        If e.Button = MouseButtons.Right Then
            CancelClose = True
            SeparatorOnMouse = Nothing : ItemOnMouse = Nothing
            QuickMenu_MenuNuevo.Tag = sender
            NuevoStrip = sender.Owner : NuevoItem = sender
            NuevoPosicion = sender.Owner.Items.IndexOf(sender)
            QuickMenu_MenuNuevo.Show(MousePosition.X, MousePosition.Y)
        End If
    End Sub

    Private Sub QuickMenu_Añadir_MouseEnterLeave(sender As Object, e As EventArgs)
        sender.Focus()
    End Sub

    Private Sub QuickMenu_Añadir_GotFocus(sender As Object, e As EventArgs)
        IgnoreMouseEnter = True : CancelClose = False
    End Sub

    Private Sub QuickMenu_Añadir_LostFocus(sender As Object, e As EventArgs)
        IgnoreMouseEnter = False : If QuickMenu_Editor.Items.Count = 1 AndAlso TypeOf QuickMenu_Editor.Items(0) Is ToolStripTextBox Then Exit Sub Else QuickMenu_SubMenu_Remove_TextBoxes()
    End Sub

#End Region

#Region " Menus "

#Region " Menu Item "

#Region " Añadir "

    Private Sub QuickMenu_Menu_Añadir_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_Añadir.Click
        Dim Strip As Object = Nothing
        If SeparatorOnMouse IsNot Nothing Then Strip = SeparatorOnMouse.Owner
        If ItemOnMouse IsNot Nothing Then Strip = ItemOnMouse.Owner
        QuickMenu_SubMenu_Remove_TextBoxes() : QuickMenu_Añadir(Strip)
    End Sub

    Private Sub QuickMenu_Menu_AñadirAqui_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_AñadirAqui.Click
        Dim Strip As Object = Nothing : Dim Position As Integer = -1
        If SeparatorOnMouse IsNot Nothing Then Strip = SeparatorOnMouse.Owner : Position = SeparatorOnMouse.Owner.Items.IndexOf(SeparatorOnMouse)
        If ItemOnMouse IsNot Nothing Then Strip = ItemOnMouse.Owner : Position = ItemOnMouse.Owner.Items.IndexOf(ItemOnMouse)
        QuickMenu_SubMenu_Remove_TextBoxes() : QuickMenu_Añadir(Strip, Position + 1)
    End Sub

    Private Sub QuickMenu_Menu_InsertarAqui_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_InsertarAqui.Click
        Dim Strip As Object = Nothing : Dim Position As Integer = -1
        If SeparatorOnMouse IsNot Nothing Then Strip = SeparatorOnMouse.Owner : Position = SeparatorOnMouse.Owner.Items.IndexOf(SeparatorOnMouse)
        If ItemOnMouse IsNot Nothing Then Strip = ItemOnMouse.Owner : Position = ItemOnMouse.Owner.Items.IndexOf(ItemOnMouse)
        QuickMenu_SubMenu_Remove_TextBoxes() : QuickMenu_Añadir(Strip, Position)
    End Sub

    Private Sub QuickMenu_Menu_AñadirSubmenu_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_AñadirSubmenu.Click
        'Try
        Dim sItem As Object = Nothing : Dim Strip As Object = Nothing : Dim Position As Integer = -1
        If SeparatorOnMouse IsNot Nothing Then Strip = SeparatorOnMouse.Owner : sItem = SeparatorOnMouse : Position = SeparatorOnMouse.Owner.Items.IndexOf(SeparatorOnMouse)
        If ItemOnMouse IsNot Nothing Then Strip = ItemOnMouse.Owner : sItem = ItemOnMouse : Position = ItemOnMouse.Owner.Items.IndexOf(ItemOnMouse)
        If sItem.DropDownItems.count > 0 Then
            SeparatorOnMouse = Nothing : ItemOnMouse = sItem.DropDownItems(0)
            QuickMenu_Menu_Añadir_Click(sItem.DropDownItems(0), e)
            Exit Sub
        End If : QuickMenu_SubMenu_Remove_TextBoxes()
        For Each nItem As Object In Strip.Items
            nItem.ForeColor = Color.FromArgb(130, 130, 130)
        Next
        Dim cItem As New ToolStripTextBox With {.Text = "", .Image = Icon.ToBitmap, .BackColor = Color.FromArgb(55, 55, 55), .ForeColor = Color.FromArgb(205, 150, 0), .Name = "Añadir", .ShortcutsEnabled = False}
        AddHandler cItem.MouseDown, AddressOf QuickMenu_Añadir_MouseDown
        AddHandler cItem.MouseEnter, AddressOf QuickMenu_Añadir_MouseEnterLeave
        AddHandler cItem.KeyPress, AddressOf QuickMenu_Añadir_KeyPress
        AddHandler cItem.GotFocus, AddressOf QuickMenu_Añadir_GotFocus
        AddHandler cItem.LostFocus, AddressOf QuickMenu_Añadir_LostFocus
        cItem.Select() : cItem.Focus() : sItem.DropDownItems.Add(cItem) : sItem.ShowDropDown : cItem.Focus()
        Dim NewStrip As ToolStripDropDownMenu = cItem.Owner : NewStrip.AllowDrop = True
        AddHandler NewStrip.DragDrop, AddressOf QuickMenu_SubMenu_DragDrop
        AddHandler NewStrip.DragEnter, AddressOf QuickMenu_SubMenu_DragEnter
        AddHandler NewStrip.DragLeave, AddressOf QuickMenu_SubMenu_DragLeave
        AddHandler NewStrip.Opening, AddressOf QuickMenu_SubMenu_Opening
        AddHandler NewStrip.Closing, AddressOf QuickMenu_SubMenu_Closing
        AddHandler NewStrip.Closed, AddressOf QuickMenu_SubMenu_Closed
        AddHandler NewStrip.PreviewKeyDown, AddressOf QuickMenu_SubMenu_KeyDown
        AddHandler NewStrip.KeyUp, AddressOf QuickMenu_SubMenu_KeyUp
        'Catch : End Try
    End Sub

#End Region

#Region " Comandos "

    Private Sub QuickMenu_Menu_ComandoRapido_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_ComandoRapido.Click
        If ItemOnMouse Is Nothing And SeparatorOnMouse Is Nothing Then Exit Sub
        If ItemOnMouse IsNot Nothing Then
            If ItemOnMouse.Text <> "[ELIMINADO]" Then FComandoRapido.Nombre = ItemOnMouse.Text Else FComandoRapido.Nombre = ""
        Else
            FComandoRapido.Nombre = ""
        End If
        FComandoRapido.Cancelado = True
        FComandoRapido.isDefault = True
        FComandoRapido.ShowDialog()
        If FComandoRapido.Cancelado = False Then
            Estadisticas.Estadisticas.Comandos_Creados += 1 : Estadisticas.Guardar()
            Dim NuevoComando As ComandosST = Nothing : ReDim NuevoComando.Accion(0) : ReDim NuevoComando.Hotkey(0) : ReDim NuevoComando.Procesos(0)
            NuevoComando.ID = Generate_ID()
            NuevoComando.Nombre = FComandoRapido.TNombre.Text
            NuevoComando.Sonido = FComandoRapido.TSonido.Text
            NuevoComando.Hotkey(0) = ""
            NuevoComando.Procesos(0) = ""
            NuevoComando.Accion(0).Indice = 0
            NuevoComando.Accion(0).ID = Generate_ID()
            NuevoComando.Accion(0).ParentID = NuevoComando.ID
            NuevoComando.Accion(0).Tipo = FComandoRapido.Tipo
            Select Case NuevoComando.Accion(0).Tipo
                Case "Ejecutar Aplicacion"
                    NuevoComando.Accion(0).Settings += FComandoRapido.TRuta.Tag + "|-|"
                    NuevoComando.Accion(0).Settings += FComandoRapido.TParametros.Text + "|-||-|"
                    NuevoComando.Accion(0).Settings += FComandoRapido.TModo.Text + "|-|"
                    NuevoComando.Accion(0).Settings += FComandoRapido.TPrioridad.Text + "|-|False|-|"
                    NuevoComando.Accion(0).Settings += FComandoRapido.CAdministrador.Checked.ToString
                Case "Pagina Web"
                    NuevoComando.Accion(0).Settings += FComandoRapido.TRuta.Tag + "|-|"
                    NuevoComando.Accion(0).Settings += GetDefaultBrowser() + "|-|False|-|False|-|"
                    NuevoComando.Accion(0).Settings += FComandoRapido.CAdministrador.Checked.ToString
                Case "Abrir Carpeta"
                    NuevoComando.Accion(0).Settings += FComandoRapido.TRuta.Tag
            End Select
            Dim Strip As Object : Dim Indice As Integer
            If ItemOnMouse IsNot Nothing Then
                Strip = ItemOnMouse.Owner
                Indice = Strip.Items.IndexOf(ItemOnMouse)
            Else
                Strip = SeparatorOnMouse.Owner
                Indice = Strip.Items.IndexOf(SeparatorOnMouse)
                SeparatorOnMouse.Owner.Items.Remove(SeparatorOnMouse)
                QuickMenu_MenuNuevo_Añadir(Strip, Indice)
            End If
            Strip.Items(Indice).Text = FComandoRapido.TNombre.Text
            Strip.Items(Indice).Image = FComandoRapido.PIcono.Image
            Dim Icono As String = "[DEFAULT]"
            If FComandoRapido.isDefault = False Or FComandoRapido.isURL = True Then
                If FComandoRapido.PIcono.Image IsNot Nothing Then
                    If FComandoRapido.isDefault = False Then Estadisticas.Estadisticas.Iconos_Modificados += 1 : Estadisticas.Guardar()
                    Iconos.Guardar(FComandoRapido.PIcono.Image, KobaPath + "Iconos\Comandos\" + NuevoComando.ID + ".ico") : NuevoComando.CustomIcono = "[CUSTOM]"

                    Iconos.Guardar(FComandoRapido.PIcono.Image, KobaPath + "Iconos\QuickMenu\" + Split(Strip.Items(Indice).Tag, "|-|",, CompareMethod.Text)(0) + ".ico")
                    Icono = KobaPath + "Iconos\QuickMenu\" + Split(Strip.Items(Indice).Tag, "|-|",, CompareMethod.Text)(0) + ".ico"
                Else : Estadisticas.Estadisticas.Iconos_Modificados += 1 : Estadisticas.Guardar() : Icono = "[ELIMINADOICON]" : NuevoComando.CustomIcono = "[ELIMINADO]" : End If
            End If
            Strip.Items(Indice).Tag = Split(Strip.Items(Indice).Tag, "|-|", , CompareMethod.Text)(0) + "|-|" + NuevoComando.ID + "|-|" + "[COMANDO]|-|" + Icono
            If Comandos IsNot Nothing Then ReDim Preserve Comandos(Comandos.Length) Else ReDim Comandos(0)
            Comandos(Comandos.Length - 1) = NuevoComando
            Iconos.DefaultIcon(Comandos(Comandos.Length - 1).ID, 0)
            CancelClose2 = True
            QuickMenus_Guardar()
            QuickMenu_Editor.Focus()
            CancelClose2 = False
            Comando_GuardarTodo(Comandos.Length - 1)
            Lista_Update()
        End If
    End Sub

    Private Sub QuickMenu_Menu_ComandoNuevo_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_ComandoNuevo.Click
        If ItemOnMouse Is Nothing And SeparatorOnMouse Is Nothing Then Exit Sub
        QuickMenu_Editor_ZOrder = False : CancelClose = False
        For Each cItem As Object In QuickMenu_Editor.Items
            If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then cItem.HideDropDown()
        Next : QuickMenu_Editor.Close()
        Comando_Nuevo()
        Dim Strip As Object : Dim Indice As Integer
        If ItemOnMouse IsNot Nothing Then
            Strip = ItemOnMouse.Owner
            Indice = Strip.Items.IndexOf(ItemOnMouse)
        Else
            Strip = SeparatorOnMouse.Owner
            Indice = Strip.Items.IndexOf(SeparatorOnMouse)
            SeparatorOnMouse.Owner.Items.Remove(SeparatorOnMouse)
            QuickMenu_MenuNuevo_Añadir(Strip, Indice)
        End If
        Dim Comando_Indice As Integer = Comandos_GetByID(ComandoActualID)
        Strip.Items(Indice).Text = Comandos(Comando_Indice).Nombre
        Strip.Items(Indice).Image = Iconos.DefaultIcon(Comandos(Comando_Indice).ID, 0)
        Strip.Items(Indice).Tag = Split(Strip.Items(Indice).Tag, "|-|", , CompareMethod.Text)(0) + "|-|" + Comandos(Comando_Indice).ID + "|-|" + "[COMANDO]|-|[DEFAULT]"
        CancelClose2 = True
        QuickMenus_Guardar()
        QuickMenu_Editor.Focus()
        CancelClose2 = False
    End Sub

    Private Sub QuickMenu_Menu_ComandoExistente_MouseDown(sender As Object, e As MouseEventArgs)
        If ItemOnMouse Is Nothing And SeparatorOnMouse Is Nothing Then Exit Sub
        Dim Strip As Object : Dim Indice As Integer
        If ItemOnMouse IsNot Nothing Then
            Strip = ItemOnMouse.Owner
            Indice = Strip.Items.IndexOf(ItemOnMouse)
        Else
            Strip = SeparatorOnMouse.Owner
            Indice = Strip.Items.IndexOf(SeparatorOnMouse)
            SeparatorOnMouse.Owner.Items.Remove(SeparatorOnMouse)
            QuickMenu_MenuNuevo_Añadir(Strip, Indice)
        End If
        Strip.Items(Indice).Text = sender.Text
        Strip.Items(Indice).Image = sender.Image
        Strip.Items(Indice).Tag = Split(Strip.Items(Indice).Tag, "|-|", , CompareMethod.Text)(0) + "|-|" + sender.Tag + "|-|" + "[COMANDO]|-|[DEFAULT]"
        CancelClose2 = True
        QuickMenus_Guardar()
        QuickMenu_Editor.Focus()
        CancelClose2 = False
        Lista_Update()
    End Sub

    Private Sub QuickMenu_Menu_Separador_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_Separador.Click
        If ItemOnMouse Is Nothing Then Exit Sub
        Dim Strip As Object : Dim Indice As Integer
        If ItemOnMouse IsNot Nothing Then
            Strip = ItemOnMouse.Owner
            Indice = Strip.Items.IndexOf(ItemOnMouse)
            ItemOnMouse.Owner.Items.Remove(ItemOnMouse)
            Dim NewSeparator As New ToolStripSeparator With {.Name = "-" + Now.ToString, .Text = "-" + Now.ToString, .Tag = Generate_ID() + "|-|[SEPARADOR]|-||-|"}
            AddHandler NewSeparator.Paint, AddressOf QuickMenu_Titulo_Paint
            AddHandler NewSeparator.MouseDown, AddressOf QuickMenu_Item_MouseDown
            AddHandler NewSeparator.MouseUp, AddressOf QuickMenu_Item_MouseUp
            AddHandler NewSeparator.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
            AddHandler NewSeparator.MouseMove, AddressOf QuickMenu_Item_MouseMove
            Strip.Items.Insert(Indice, NewSeparator)
            CancelClose2 = True
            QuickMenus_Guardar()
            QuickMenu_Editor.Focus()
            CancelClose2 = False
        End If
    End Sub

    Private Sub QuickMenu_Menu_Titulo_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_Titulo.Click
        If ItemOnMouse Is Nothing And SeparatorOnMouse Is Nothing Then Exit Sub
        FNombreIcono.Cancelado = True : FNombreIcono.Nombre = "" : FNombreIcono.Comando_ID = "" : FNombreIcono.cItem = Nothing
        FNombreIcono.Nombre = "" : FNombreIcono.Comando_ID = "" : FNombreIcono.PIcono.Image = Nothing : FNombreIcono.PIcono.Visible = False : FNombreIcono.Text = "Nombre" : FNombreIcono.FTheme.Text = "Nombre"
        If ItemOnMouse IsNot Nothing Then
            If Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(2) <> "[COMANDO]" AndAlso Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(2) <> "" Then FNombreIcono.TNombre.Text = Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(2) : GoTo Salta
            FNombreIcono.cItem = ItemOnMouse
        Else
            FNombreIcono.cItem = SeparatorOnMouse
        End If
        FNombreIcono.ShowDialog() : If FNombreIcono.Cancelado = True Then Exit Sub
Salta:  Dim Strip As Object : Dim Indice As Integer
        If ItemOnMouse IsNot Nothing Then
            Strip = ItemOnMouse.Owner
            Indice = Strip.Items.IndexOf(ItemOnMouse)
        Else
            Strip = SeparatorOnMouse.Owner
            Indice = Strip.Items.IndexOf(SeparatorOnMouse)
            SeparatorOnMouse.Owner.Items.Remove(SeparatorOnMouse)
            QuickMenu_MenuNuevo_Añadir(Strip, Indice)
        End If
        Strip.Items(Indice).Text = FNombreIcono.TNombre.Text
        Strip.Items(Indice).Image = Nothing
        Strip.Items(Indice).Tag = Split(Strip.Items(Indice).Tag, "|-|", , CompareMethod.Text)(0) + "|-|[TITULO]|-|" + FNombreIcono.TNombre.Text + "|-|[ELIMINADOICON]"
        CancelClose2 = True
        QuickMenus_Guardar()
        QuickMenu_Editor.Focus()
        CancelClose2 = False
    End Sub

    Private Sub QuickMenu_Menu_Texto_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_Texto.Click
        If ItemOnMouse Is Nothing And SeparatorOnMouse Is Nothing Then Exit Sub
        FNombreIcono.Cancelado = True : FNombreIcono.Nombre = "" : FNombreIcono.Comando_ID = "" : FNombreIcono.cItem = Nothing
        FNombreIcono.Nombre = "" : FNombreIcono.Comando_ID = "" : FNombreIcono.PIcono.Image = Nothing : FNombreIcono.PIcono.Visible = False : FNombreIcono.Text = "Nombre" : FNombreIcono.FTheme.Text = "Nombre"
        If ItemOnMouse IsNot Nothing Then
            If Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(2) <> "[COMANDO]" AndAlso Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(2) <> "" Then FNombreIcono.TNombre.Text = Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(2) : GoTo Salta
            FNombreIcono.cItem = ItemOnMouse
        Else
            FNombreIcono.cItem = SeparatorOnMouse
        End If
        FNombreIcono.ShowDialog() : If FNombreIcono.Cancelado = True Then Exit Sub
Salta:  Dim Strip As Object : Dim Indice As Integer
        If ItemOnMouse IsNot Nothing Then
            Strip = ItemOnMouse.Owner
            Indice = Strip.Items.IndexOf(ItemOnMouse)
        Else
            Strip = SeparatorOnMouse.Owner
            Indice = Strip.Items.IndexOf(SeparatorOnMouse)
            SeparatorOnMouse.Owner.Items.Remove(SeparatorOnMouse)
            QuickMenu_MenuNuevo_Añadir(Strip, Indice)
        End If
        Strip.Items(Indice).Text = FNombreIcono.TNombre.Text
        Strip.Items(Indice).Image = Nothing
        Strip.Items(Indice).Tag = Split(Strip.Items(Indice).Tag, "|-|", , CompareMethod.Text)(0) + "|-|[TEXTO]|-|" + FNombreIcono.TNombre.Text + "|-|[ELIMINADOICON]"
        CancelClose2 = True
        QuickMenus_Guardar()
        QuickMenu_Editor.Focus()
        CancelClose2 = False
    End Sub

#End Region

#Region " Editar "

    Private Sub QuickMenu_Menu_EditarNombreIcono_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_EditarNombreIcono.Click
        If ItemOnMouse Is Nothing Then Exit Sub
        Dim Strip As Object = ItemOnMouse.Owner : Dim Indice As Integer = Strip.Items.IndexOf(ItemOnMouse) : Dim Nombre As String = Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(2) : Dim Icono As String = Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(3)
        FNombreIcono.Cancelado = True : FNombreIcono.Nombre = "" : FNombreIcono.Comando_ID = "" : FNombreIcono.cItem = Nothing
        FNombreIcono.Nombre = ItemOnMouse.Text : If FNombreIcono.Nombre = "[ELIMINADO]" Then FNombreIcono.Nombre = ""
        FNombreIcono.PIcono.Image = ItemOnMouse.Image : FNombreIcono.PIcono.Visible = True
        FNombreIcono.Comando_ID = Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1)
        FNombreIcono.cItem = ItemOnMouse
        FNombreIcono.ShowDialog()
        If FNombreIcono.Cancelado = False Then
            If FNombreIcono.TNombre.Text <> ItemOnMouse.Text Then
                If FNombreIcono.TNombre.Text.Trim = "" Then
                    If Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1) <> "[TITULO]" Then
                        For Cuenta = 0 To Comandos.Length - 1
                            If Comandos(Cuenta).ID = Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1) Then Strip.Items(Indice).Text = Comandos(Cuenta).Nombre : Nombre = "[COMANDO]" : GoTo Encontrado
                        Next : Strip.Items(Indice).Text = "[ELIMINADO]" : Nombre = "[COMANDO]"
Encontrado:         Else : Nombre = FNombreIcono.TNombre.Text : End If
                Else : Nombre = FNombreIcono.TNombre.Text : End If
                If Nombre = "[COMANDO]" Then Strip.Items(Indice).Text = Comando_Get(Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1)).Nombre Else Strip.Items(Indice).Text = Nombre
            End If
            If FNombreIcono.PIcono.Image IsNot Nothing Then
                If FNombreIcono.isDefault = True Then
                    Icono = "[DEFAULT]" : Strip.Items(Indice).Image = FNombreIcono.PIcono.Image
                ElseIf ItemOnMouse.Image Is Nothing Or (ItemOnMouse.Image IsNot Nothing AndAlso Imagen.AreSameImage(FNombreIcono.PIcono.Image, ItemOnMouse.Image) = False) Then
                    Estadisticas.Estadisticas.Iconos_Modificados += 1 : Estadisticas.Guardar()
                    Iconos.Guardar(FNombreIcono.PIcono.Image, KobaPath + "Iconos\QuickMenu\" + Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(0) + ".ico")
                    Icono = KobaPath + "Iconos\QuickMenu\" + Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(0) + ".ico"
                    Strip.Items(Indice).Image = FNombreIcono.PIcono.Image
                End If
            Else
                If IO.File.Exists(Icono) = True Then IO.File.Delete(Icono)
                Estadisticas.Estadisticas.Iconos_Modificados += 1 : Estadisticas.Guardar()
                Icono = "[ELIMINADOICON]" : Strip.Items(Indice).Image = Nothing
            End If
            Strip.Items(Indice).Tag = Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(0) + "|-|" + Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1) + "|-|" + Nombre + "|-|" + Icono
        End If : QuickMenus_Guardar()
    End Sub

    Private Sub QuickMenu_Menu_EditarComando_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_EditarComando.Click
        If ItemOnMouse Is Nothing Then Exit Sub
        If Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1) = "" Or Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1) = "[TITULO]" Then Exit Sub
        QuickMenu_Editor_ZOrder = False : CancelClose = False
        For Each cItem As Object In QuickMenu_Editor.Items
            If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then cItem.HideDropDown()
        Next : QuickMenu_Editor.Close()
        For Cuenta = 0 To Comandos.Length - 1
            If Comandos(Cuenta).ID = Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1) Then
                PanelComandos.Visible = True : PanelKBoard1.Visible = False : PanelKBoard2.Visible = False : PanelQuickMenu.Visible = False : PanelOpciones.Visible = False : Lista.Height = 590
                BPanelComandos.ForeColor1 = Color.FromArgb(205, 150, 0) : BPanelKBoard.ForeColor1 = Color.FromArgb(102, 102, 102) : BPanelQuickMenu.ForeColor1 = Color.FromArgb(102, 102, 102) : BPanelOpciones.ForeColor1 = Color.FromArgb(102, 102, 102)
                For Cuenta2 = 0 To Lista.Items.Count - 1
                    If Lista.Items(Cuenta2).Tag = Cuenta Then Lista.SelectItem(Cuenta2) : Lista.EnsureVisibleAt(Cuenta2) : Comando_Mostrar(Comandos(Cuenta).ID, 0, True) : Exit Sub
                Next
                Lista.SelectItem(-1) : Comando_Mostrar(Comandos(Cuenta).ID, 0, True)
                Exit Sub
            End If
        Next
    End Sub

    Private Sub QuickMenu_Menu_Copiar_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_Copiar.Click
        If SeparatorOnMouse IsNot Nothing Then
            CopiedItem = SeparatorOnMouse
        ElseIf ItemOnMouse IsNot Nothing Then
            CopiedItem = ItemOnMouse
        End If
    End Sub

    Private Sub QuickMenu_Menu_Cortar_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_Cortar.Click
        If SeparatorOnMouse IsNot Nothing Then
            CopiedItem = SeparatorOnMouse
            SeparatorOnMouse.Owner.Items.Remove(SeparatorOnMouse)
        ElseIf ItemOnMouse IsNot Nothing Then
            If ItemOnMouse.DropDownItems.Count > 0 Then CancelClose = False : ItemOnMouse.HideDropDown() : CancelClose = True
            CopiedItem = ItemOnMouse
            ItemOnMouse.Owner.Items.Remove(ItemOnMouse)
        End If
        If QuickMenu_Editor.Items.Count = 0 Then QuickMenu_Añadir(QuickMenu_Editor)
        QuickMenus_Guardar()
        Lista_Update()
    End Sub

    Private Sub QuickMenu_Menu_Pegar_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_Pegar.Click
        If CopiedItem Is Nothing Then Exit Sub
        If TypeOf CopiedItem Is ToolStripMenuItem Then
            Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString("ddMMyyyyHHmmss"), .Text = CopiedItem.Text, .ForeColor = Color.FromArgb(130, 130, 130), .Tag = Generate_ID() + "|-|" + CopiedItem.Tag.ToString.Substring(Split(CopiedItem.Tag, "|-|",, CompareMethod.Text)(0).Length + 3), .Image = CopiedItem.Image, .AllowDrop = CopiedItem.AllowDrop}
            AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
            AddHandler NewItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
            AddHandler NewItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
            AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
            AddHandler NewItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
            If CopiedItem.DropDownItems.Count > 0 Then QuickMenu_DragCopy_SubItems(CopiedItem, NewItem)
            If SeparatorOnMouse IsNot Nothing Then
                SeparatorOnMouse.Owner.Items.Insert(SeparatorOnMouse.Owner.Items.IndexOf(SeparatorOnMouse), NewItem)
            ElseIf ItemOnMouse IsNot Nothing Then
                ItemOnMouse.Owner.Items.Insert(ItemOnMouse.Owner.Items.IndexOf(ItemOnMouse), NewItem)
            End If
        ElseIf TypeOf CopiedItem Is ToolStripSeparator Then
            Dim NewItem As New ToolStripSeparator With {.Name = "-" + Now.ToString("ddMMyyyyHHmmss"), .Text = CopiedItem.Text, .ForeColor = Color.FromArgb(130, 130, 130), .Tag = Generate_ID() + "|-|" + CopiedItem.Tag.ToString.Substring(Split(CopiedItem.Tag, "|-|",, CompareMethod.Text)(0).Length + 3)}
            AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
            AddHandler NewItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
            AddHandler NewItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
            AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
            AddHandler NewItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
            If SeparatorOnMouse IsNot Nothing Then
                SeparatorOnMouse.Owner.Items.Insert(SeparatorOnMouse.Owner.Items.IndexOf(SeparatorOnMouse), NewItem)
            ElseIf ItemOnMouse IsNot Nothing Then
                ItemOnMouse.Owner.Items.Insert(ItemOnMouse.Owner.Items.IndexOf(ItemOnMouse), NewItem)
            End If
        End If : QuickMenus_Guardar() : Lista_Update()
    End Sub

    Private Sub QuickMenu_Menu_Eliminar_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_Eliminar.Click
        If SeparatorOnMouse IsNot Nothing Then
            Dim Strip As Object = SeparatorOnMouse.Owner
            If TypeOf Strip IsNot NSContextMenu AndAlso Strip.Items.Count < 2 Then CancelClose = False : Strip.Hide()
            SeparatorOnMouse.Owner.Items.Remove(SeparatorOnMouse)
        End If
        If ItemOnMouse IsNot Nothing Then
            If ItemOnMouse.IsOnDropDown = True Then ForceClose = True : ItemOnMouse.HideDropDown() : ItemOnMouse.DropDownItems.Clear()
            Dim Strip As Object = ItemOnMouse.Owner
            If TypeOf Strip IsNot NSContextMenu AndAlso Strip.Items.Count < 2 Then CancelClose = False : Strip.Hide()
            ItemOnMouse.Owner.Items.Remove(ItemOnMouse)
            If IO.File.Exists(KobaPath + "Iconos\QuickMenu\" + Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(0) + ".ico") = True Then IO.File.Delete(KobaPath + "Iconos\QuickMenu\" + Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(0) + ".ico")
        End If
        If QuickMenu_Editor.Items.Count = 0 Then QuickMenu_Añadir(QuickMenu_Editor)
        QuickMenus_Guardar()
        Lista_Update()
    End Sub

    Private Sub QuickMenu_Menu_EliminarComando_Click(sender As Object, e As EventArgs) Handles QuickMenu_Menu_EliminarComando.Click
        If ItemOnMouse Is Nothing Then Exit Sub
        Dim Nombre_Comando As String = ""
        For Cuenta = 0 To Comandos.Length - 1
            If Comandos(Cuenta).ID = Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1) Then Nombre_Comando = Comandos(Cuenta).Nombre : Exit For
        Next
        HTexto.Focus()
        If ShowMessageBox("¿Eliminar '" + ItemOnMouse.Text + "'", Version, MsgBoxStyle.YesNo, "Eliminar", "y el comando '" + Nombre_Comando + "'?") = DialogResult.Cancel Then Exit Sub
        If ItemOnMouse.IsOnDropDown = True Then ForceClose = True : ItemOnMouse.HideDropDown() : ItemOnMouse.DropDownItems.Clear()
        Dim Strip As Object = ItemOnMouse.Owner
        If TypeOf Strip IsNot NSContextMenu AndAlso Strip.Items.Count < 2 Then CancelClose = False : Strip.Hide()
        ItemOnMouse.Owner.Items.Remove(ItemOnMouse)
        If IO.File.Exists(KobaPath + "Iconos\QuickMenu\" + Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(0) + ".ico") = True Then IO.File.Delete(KobaPath + "Iconos\QuickMenu\" + Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(0) + ".ico")
        If QuickMenu_Editor.Items.Count = 0 Then QuickMenu_Añadir(QuickMenu_Editor)
        QuickMenus_Guardar()
        For Cuenta = 0 To Comandos.Length - 1
            If Cuenta >= Comandos.Length Then Exit For
            If Comandos(Cuenta).ID = Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1) Then Eliminar_Comando_QuickMenu(Cuenta)
        Next
        Lista_Update()
    End Sub

    Private Sub Eliminar_Comando_QuickMenu(Indice As Integer)
        Registro.DelReg(RegPath + "\Comandos\" + Comandos(Indice).Nombre.Replace("\", "|/|") + "|-|" + Comandos(Indice).ID)
        Comandos(Indice).Nombre = ""
        If IO.File.Exists(KobaPath + "Iconos\Comandos\" + Comandos(Indice).ID + ".ico") = True Then IO.File.Delete(KobaPath + "Iconos\Comandos\" + Comandos(Indice).ID + ".ico")
        For Cuenta = 0 To Comandos(Indice).Accion.Length - 1
            If Comandos(Indice).Accion(Cuenta).Tipo = "Macros" AndAlso IO.File.Exists(KobaPath + "MACROs\" + Comandos(Indice).Accion(Cuenta).ID + ".mcr") = True Then IO.File.Delete(KobaPath + "MACROs\" + Comandos(Indice).Accion(Cuenta).ID + ".mcr")
            If Comandos(Indice).Accion(Cuenta).Tipo = "Ejecutar BAT" AndAlso IO.File.Exists(KobaPath + "BATs\" + Comandos(Indice).Accion(Cuenta).ID + ".bat") = True Then IO.File.Delete(KobaPath + "BATs\" + Comandos(Indice).Accion(Cuenta).ID + ".bat")
        Next
        Estadisticas.Estadisticas.Comandos_Eliminados += 1 : Estadisticas.Guardar()
        Dim cItem As Integer = Lista.SelectedIndex(0) : Comandos_Cargar()
        If Lista.Items.Count > 0 Then
            If cItem < Lista.Items.Count Then
                Lista.SelectItem(cItem)
                Lista.EnsureVisibleAt(cItem)
            Else
                Lista.SelectItem(Lista.Items.Count - 1)
                Lista.EnsureVisibleAt(Lista.Items.Count - 1)
            End If
        Else
            Lista.SelectItem(-1) : Comando_Mostrar("-1")
        End If
    End Sub

#End Region

#Region " Eventos "

    Private Sub QuickMenu_Menu_Opening(sender As Object, e As System.ComponentModel.CancelEventArgs) Handles QuickMenu_Menu.Opening
        If SeparatorOnMouse IsNot Nothing Then
            QuickMenu_Menu_AñadirSubmenu.Visible = False
            QuickMenu_Menu_EditarNombreIcono.Visible = False
            QuickMenu_Menu_EditarComando.Visible = False
            QuickMenu_Menu_Separador5.Visible = False
            QuickMenu_Menu_Separador6.Visible = False
            QuickMenu_Menu_EliminarComando.Visible = False
            QuickMenu_Menu_Separador.Visible = False
            QuickMenu_Menu_Separador8.Visible = False
            QuickMenu_Menu_Titulo.Visible = True
            QuickMenu_Menu_Separador9.Visible = True
            QuickMenu_Menu_Texto.Visible = True
            QuickMenu_Menu_Separador10.Visible = True
            Exit Sub
        ElseIf ItemOnMouse IsNot Nothing Then
            QuickMenu_Menu_AñadirSubmenu.Visible = True
            QuickMenu_Menu_Comando.Visible = True
            QuickMenu_Menu_Separador1.Visible = True
            QuickMenu_Menu_EditarNombreIcono.Visible = True
            QuickMenu_Menu_EditarComando.Visible = True
            QuickMenu_Menu_Separador5.Visible = True
            QuickMenu_Menu_Separador6.Visible = True
            QuickMenu_Menu_EliminarComando.Visible = True
            QuickMenu_Menu_Separador.Visible = True
            QuickMenu_Menu_Separador8.Visible = True
            QuickMenu_Menu_Titulo.Visible = True
            QuickMenu_Menu_Separador9.Visible = True
            QuickMenu_Menu_Texto.Visible = True
            QuickMenu_Menu_Separador10.Visible = True
            QuickMenu_SubMenu_CloseItemInside()
        End If
        For Cuenta = 0 To Comandos.Length - 1
            If Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1).Length > 0 AndAlso Comandos(Cuenta).ID = Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1) Then
                QuickMenu_Menu_EditarComando.Visible = True
                QuickMenu_Menu_Separador6.Visible = True
                QuickMenu_Menu_EliminarComando.Visible = True
                GoTo Salta
            End If
        Next
        If Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1).Length > 0 AndAlso Split(ItemOnMouse.Tag, "|-|",, CompareMethod.Text)(1) = "[TITULO]" Then
            QuickMenu_Menu_EditarNombreIcono.Text = "Nombre e Icono"
            QuickMenu_Menu_Titulo.Visible = False
            QuickMenu_Menu_Separador9.Visible = False
        Else
            QuickMenu_Menu_EditarNombreIcono.Text = "Nombre e Icono"
            QuickMenu_Menu_Texto.Visible = False
            QuickMenu_Menu_Separador10.Visible = False
        End If
        QuickMenu_Menu_EditarComando.Visible = False
        QuickMenu_Menu_Separador6.Visible = False
        QuickMenu_Menu_EliminarComando.Visible = False

Salta:  QuickMenu_Menu_ComandoExistente.DropDownItems.Clear()
        SLista.Clear() : SLista.Sorting = SortOrder.None : SLista.BeginUpdate() : SLista.Columns.Add("A")
        For Cuenta = 0 To Comandos.Length - 1
            If Comandos IsNot Nothing AndAlso Comandos(Cuenta).Nombre.Trim <> "" Then SLista.Items.Add(Comandos(Cuenta).Nombre).Tag = Comandos(Cuenta).ID
        Next : SLista.EndUpdate() : SLista.Sorting = SortOrder.Ascending : SLista.Sort()
        If SLista.Items.Count = 0 Then QuickMenu_Menu_ComandoExistente.Visible = False : QuickMenu_Menu_Separador8.Visible = False : Exit Sub

        If SLista.Items.Count < 31 Then
            For Cuenta = 0 To SLista.Items.Count - 1
                Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = SLista.Items(Cuenta).Text, .ForeColor = QuickMenu_Editor.ForeColor, .Tag = SLista.Items(Cuenta).Tag}
                NewItem.Image = Iconos.DefaultIcon(NewItem.Tag, 0)
                AddHandler NewItem.MouseDown, AddressOf QuickMenu_Menu_ComandoExistente_MouseDown
                AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Menu_MouseEnter
                AddHandler NewItem.MouseLeave, AddressOf QuickMenu_Menu_MouseLeave
                QuickMenu_Menu_ComandoExistente.DropDownItems.Add(NewItem)
            Next : Exit Sub
        End If

        Dim NewMainItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Image = QuickMenu_Menu_ComandoExistente.Image, .ForeColor = QuickMenu_Editor.ForeColor}
        AddHandler NewMainItem.MouseEnter, AddressOf QuickMenu_Menu_MouseEnter
        AddHandler NewMainItem.MouseLeave, AddressOf QuickMenu_Menu_MouseLeave

        Dim Contador As Integer : For Cuenta = 0 To SLista.Items.Count - 1
            Contador += 1
            Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = SLista.Items(Cuenta).Text, .ForeColor = QuickMenu_Editor.ForeColor, .Tag = SLista.Items(Cuenta).Tag}
            NewItem.Image = Iconos.DefaultIcon(NewItem.Tag, 0)
            AddHandler NewItem.MouseDown, AddressOf QuickMenu_Menu_ComandoExistente_MouseDown
            AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Menu_MouseEnter
            AddHandler NewItem.MouseLeave, AddressOf QuickMenu_Menu_MouseLeave
            NewMainItem.DropDownItems.Add(NewItem)

            If Contador > 29 Or Cuenta = SLista.Items.Count - 1 Then
                If NewMainItem.DropDownItems(NewMainItem.DropDownItems.Count - 1).Text.ToLower.StartsWith(SLista.Items(Math.Min(Cuenta + 1, SLista.Items.Count - 1)).Text.ToLower.Substring(0, 1)) = False Or Cuenta = SLista.Items.Count - 1 Then
                    If (SLista.Items.Count - 1) - Cuenta < 6 AndAlso Cuenta <> SLista.Items.Count - 1 Then Continue For
                    NewMainItem.Text = NewMainItem.DropDownItems(0).Text.ToUpper.Substring(0, 1) + " - " + NewMainItem.DropDownItems(NewMainItem.DropDownItems.Count - 1).Text.ToUpper.Substring(0, 1)
                    QuickMenu_Menu_ComandoExistente.DropDownItems.Add(NewMainItem)
                    If Cuenta = SLista.Items.Count - 1 Then Exit For
                    NewMainItem = New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Image = QuickMenu_Menu_ComandoExistente.Image, .ForeColor = QuickMenu_Editor.ForeColor}
                    AddHandler NewMainItem.MouseEnter, AddressOf QuickMenu_Menu_MouseEnter
                    AddHandler NewMainItem.MouseLeave, AddressOf QuickMenu_Menu_MouseLeave
                    Contador = 0
                End If
            End If
        Next
    End Sub

    Private Sub QuickMenu_Menu_Editar_DropDownOpening(sender As Object, e As EventArgs) Handles QuickMenu_Menu_Editar.DropDownOpening
        If CopiedItem IsNot Nothing Then
            QuickMenu_Menu_Separador7.Visible = True
            QuickMenu_Menu_Pegar.Visible = True
        Else
            QuickMenu_Menu_Separador7.Visible = False
            QuickMenu_Menu_Pegar.Visible = False
        End If
    End Sub

    Private Sub QuickMenu_Menu_MouseEnter(sender As Object, e As EventArgs) Handles QuickMenu_Menu_Añadir.MouseEnter, QuickMenu_Menu_AñadirAqui.MouseEnter, QuickMenu_Menu_AñadirSubmenu.MouseEnter, QuickMenu_Menu_Comando.MouseEnter, QuickMenu_Menu_ComandoRapido.MouseEnter, QuickMenu_Menu_ComandoNuevo.MouseEnter, QuickMenu_Menu_ComandoExistente.MouseEnter, QuickMenu_Menu_Editar.MouseEnter, QuickMenu_Menu_EditarNombreIcono.MouseEnter, QuickMenu_Menu_EditarComando.MouseEnter, QuickMenu_Menu_Eliminar.MouseEnter, QuickMenu_Menu_Copiar.MouseEnter, QuickMenu_Menu_Cortar.MouseEnter, QuickMenu_Menu_Pegar.MouseEnter, QuickMenu_Menu_InsertarAqui.MouseEnter, QuickMenu_Menu_EliminarComando.MouseEnter, QuickMenu_Menu_Titulo.MouseEnter, QuickMenu_Menu_Texto.MouseEnter, QuickMenu_Menu_Separador.MouseEnter
        sender.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub QuickMenu_Menu_MouseLeave(sender As Object, e As EventArgs) Handles QuickMenu_Menu_Añadir.MouseLeave, QuickMenu_Menu_AñadirAqui.MouseLeave, QuickMenu_Menu_AñadirSubmenu.MouseLeave, QuickMenu_Menu_Comando.MouseLeave, QuickMenu_Menu_ComandoRapido.MouseLeave, QuickMenu_Menu_ComandoNuevo.MouseLeave, QuickMenu_Menu_ComandoExistente.MouseLeave, QuickMenu_Menu_Editar.MouseLeave, QuickMenu_Menu_EditarNombreIcono.MouseLeave, QuickMenu_Menu_EditarComando.MouseLeave, QuickMenu_Menu_Eliminar.MouseLeave, QuickMenu_Menu_Copiar.MouseLeave, QuickMenu_Menu_Cortar.MouseLeave, QuickMenu_Menu_Pegar.MouseLeave, QuickMenu_Menu_InsertarAqui.MouseLeave, QuickMenu_Menu_EliminarComando.MouseLeave, QuickMenu_Menu_Titulo.MouseLeave, QuickMenu_Menu_Texto.MouseLeave, QuickMenu_Menu_Separador.MouseLeave
        sender.ForeColor = Color.FromArgb(130, 130, 130)
    End Sub

#End Region

#End Region

#Region " Menu TextoBox "

#Region " Comandos "

    Private Sub QuickMenu_MenuNuevo_ComandoRapido_Click(sender As Object, e As EventArgs) Handles QuickMenu_MenuNuevo_ComandoRapido.Click
        If NuevoPosicion = NuevoStrip.Items.Count Then Exit Sub
        FComandoRapido.TNombre.Text = NuevoStrip.Items(NuevoPosicion).Text
        FComandoRapido.Nombre = FComandoRapido.TNombre.Text
        FComandoRapido.Tipo = ""
        FComandoRapido.PIcono.Image = Nothing
        FComandoRapido.isURL = False
        FComandoRapido.Cancelado = True
        FComandoRapido.ShowDialog()
        If FComandoRapido.Cancelado = False Then
            Estadisticas.Estadisticas.Comandos_Creados += 1 : Estadisticas.Guardar()
            Dim NuevoComando As ComandosST = Nothing : ReDim NuevoComando.Accion(0) : ReDim NuevoComando.Hotkey(0) : ReDim NuevoComando.Procesos(0)
            NuevoComando.ID = Generate_ID()
            NuevoComando.Nombre = FComandoRapido.TNombre.Text
            NuevoComando.Sonido = FComandoRapido.TSonido.Text
            NuevoComando.Hotkey(0) = ""
            NuevoComando.Procesos(0) = ""
            NuevoComando.Accion(0).Indice = 0
            NuevoComando.Accion(0).ID = Generate_ID()
            NuevoComando.Accion(0).ParentID = NuevoComando.ID
            NuevoComando.Accion(0).Tipo = FComandoRapido.Tipo
            Select Case NuevoComando.Accion(0).Tipo
                Case "Ejecutar Aplicacion"
                    NuevoComando.Accion(0).Settings += FComandoRapido.TRuta.Tag + "|-|"
                    NuevoComando.Accion(0).Settings += FComandoRapido.TParametros.Text + "|-||-|"
                    NuevoComando.Accion(0).Settings += FComandoRapido.TModo.Text + "|-|"
                    NuevoComando.Accion(0).Settings += FComandoRapido.TPrioridad.Text + "|-|False|-|"
                    NuevoComando.Accion(0).Settings += FComandoRapido.CAdministrador.Checked.ToString
                Case "Pagina Web"
                    NuevoComando.Accion(0).Settings += FComandoRapido.TRuta.Tag + "|-|"
                    NuevoComando.Accion(0).Settings += GetDefaultBrowser() + "|-|False|-|False|-|"
                    NuevoComando.Accion(0).Settings += FComandoRapido.CAdministrador.Checked.ToString
                Case "Abrir Carpeta"
                    NuevoComando.Accion(0).Settings += FComandoRapido.TRuta.Tag
            End Select
            Dim NewItem As ToolStripMenuItem = QuickMenu_MenuNuevo_Añadir(NuevoStrip, NuevoPosicion)
            NewItem.Text = FComandoRapido.TNombre.Text
            NewItem.Image = FComandoRapido.PIcono.Image
            Dim Icono As String = "[DEFAULT]"
            If FComandoRapido.isDefault = False Then
                If FComandoRapido.PIcono.Image IsNot Nothing Then
                    If FComandoRapido.isDefault = False Then Estadisticas.Estadisticas.Iconos_Modificados += 1 : Estadisticas.Guardar()
                    Iconos.Guardar(FComandoRapido.PIcono.Image, KobaPath + "Iconos\Comandos\" + NuevoComando.ID + ".ico") : NuevoComando.CustomIcono = "[CUSTOM]"

                    Iconos.Guardar(FComandoRapido.PIcono.Image, KobaPath + "Iconos\QuickMenu\" + Split(NewItem.Tag, "|-|",, CompareMethod.Text)(0) + ".ico")
                    Icono = KobaPath + "Iconos\QuickMenu\" + Split(NewItem.Tag, "|-|",, CompareMethod.Text)(0) + ".ico"
                Else : Estadisticas.Estadisticas.Iconos_Modificados += 1 : Estadisticas.Guardar() : Icono = "[ELIMINADOICON]" : NuevoComando.CustomIcono = "[ELIMINADO]" : End If
            End If
            NewItem.Tag = Split(NewItem.Tag, "|-|", , CompareMethod.Text)(0) + "|-|" + NuevoComando.ID + "|-|" + "[COMANDO]|-|" + Icono
            If Comandos IsNot Nothing Then ReDim Preserve Comandos(Comandos.Length) Else ReDim Comandos(0)
            Comandos(Comandos.Length - 1) = NuevoComando
            Comando_GuardarTodo(Comandos.Length - 1)
            Iconos.DefaultIcon(Comandos(Comandos.Length - 1).ID, 0)
            CancelClose2 = True
            QuickMenu_SubMenu_Remove_TextBoxes()
            QuickMenus_Guardar()
            QuickMenu_Editor.Focus()
            Dim OpenMenu As Object = NewItem.OwnerItem : If OpenMenu IsNot Nothing Then OpenMenu.ShowDropDown()
            CancelClose2 = False
            Lista_Update()
        End If
    End Sub

    Private Sub QuickMenu_MenuNuevo_ComandoNuevo_Click(sender As Object, e As EventArgs) Handles QuickMenu_MenuNuevo_ComandoNuevo.Click
        If NuevoItem Is Nothing Then Exit Sub
        If NuevoPosicion = NuevoStrip.Items.Count Then Exit Sub
        QuickMenu_Editor_ZOrder = False : CancelClose = False
        For Each cItem As Object In QuickMenu_Editor.Items
            If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then cItem.HideDropDown()
        Next : QuickMenu_Editor.Close()
        Comando_Nuevo()
        Dim NewItem As ToolStripMenuItem = QuickMenu_MenuNuevo_Añadir(NuevoStrip, NuevoPosicion)
        Dim Comandos_Indice As Integer = Comandos_GetByID(ComandoActualID)
        NewItem.Text = Comandos(Comandos_Indice).Nombre
        NewItem.Tag = Split(NewItem.Tag, "|-|", , CompareMethod.Text)(0) + "|-|" + Comandos(Comandos_Indice).ID + "|-|" + "[COMANDO]|-|[DEFAULT]"
        NewItem.Image = Iconos.DefaultIcon(Comandos(Comandos_Indice).ID, 0)
        QuickMenu_SubMenu_Remove_TextBoxes()
        QuickMenus_Guardar()
    End Sub

    Private Sub QuickMenu_MenuNuevo_ComandoExistente_MouseDown(sender As Object, e As MouseEventArgs)
        If NuevoItem Is Nothing Then Exit Sub
        If NuevoPosicion = NuevoStrip.Items.Count Then Exit Sub
        Dim NewItem As ToolStripMenuItem = QuickMenu_MenuNuevo_Añadir(NuevoStrip, NuevoPosicion)
        NewItem.Text = sender.Text
        NewItem.Tag = Split(NewItem.Tag, "|-|", , CompareMethod.Text)(0) + "|-|" + sender.Tag + "|-|" + "[COMANDO]|-|[DEFAULT]"
        NewItem.Image = Iconos.DefaultIcon(NewItem.Tag)
        CancelClose2 = True
        QuickMenu_SubMenu_Remove_TextBoxes()
        QuickMenus_Guardar()
        QuickMenu_Editor.Focus()
        CancelClose2 = False
        Lista_Update()
    End Sub

    Private Function QuickMenu_MenuNuevo_Añadir(Strip As Object, Posicion As Integer) As Object
        Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Image = Icon.ToBitmap, .ForeColor = QuickMenu_Editor.ForeColor, .Tag = Generate_ID() + "|-|"}
        AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
        AddHandler NewItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
        AddHandler NewItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
        AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
        AddHandler NewItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
        Strip.Items.Insert(Posicion, NewItem)
        Return NewItem
    End Function

    Private Sub QuickMenu_MenuNuevo_Separador_Click(sender As Object, e As EventArgs) Handles QuickMenu_MenuNuevo_Separador.Click
        If NuevoPosicion = NuevoStrip.Items.Count Then Exit Sub
        Dim NewSeparator As New ToolStripSeparator With {.Name = "-" + Now.ToString, .Text = "-" + Now.ToString, .Tag = Generate_ID() + "|-|[SEPARADOR]|-||-|"}
        AddHandler NewSeparator.Paint, AddressOf QuickMenu_Titulo_Paint
        AddHandler NewSeparator.MouseDown, AddressOf QuickMenu_Item_MouseDown
        AddHandler NewSeparator.MouseUp, AddressOf QuickMenu_Item_MouseUp
        AddHandler NewSeparator.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
        AddHandler NewSeparator.MouseMove, AddressOf QuickMenu_Item_MouseMove
        NuevoStrip.Items.Insert(NuevoPosicion, NewSeparator)
        QuickMenu_SubMenu_Remove_TextBoxes()
        CancelClose2 = True
        QuickMenus_Guardar()
        QuickMenu_Editor.Focus()
        CancelClose2 = False
    End Sub

    Private Sub QuickMenu_MenuNuevo_Titulo_Click(sender As Object, e As EventArgs) Handles QuickMenu_MenuNuevo_Titulo.Click
        If NuevoPosicion = NuevoStrip.Items.Count Then Exit Sub
        Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = NuevoStrip.Items(NuevoPosicion).Text.Trim, .BackColor = Color.FromArgb(50, 50, 50), .ForeColor = Color.FromArgb(205, 150, 0), .TextAlign = ContentAlignment.MiddleCenter, .Tag = Generate_ID() + "|-|[TITULO]|-|" + NuevoStrip.Items(NuevoPosicion).Text.Trim + "|-|[ELIMINADOICON]"}
        AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
        AddHandler NewItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
        AddHandler NewItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
        AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
        AddHandler NewItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
        If NuevoStrip.Items(NuevoPosicion).Text.Trim = "" Then
            FNombreIcono.Cancelado = True : FNombreIcono.Nombre = "" : FNombreIcono.Comando_ID = "" : FNombreIcono.cItem = Nothing
            FNombreIcono.Nombre = "" : FNombreIcono.Comando_ID = "" : FNombreIcono.PIcono.Image = Nothing : FNombreIcono.PIcono.Visible = False : FNombreIcono.Text = "Nombre" : FNombreIcono.FTheme.Text = "Nombre"
            FNombreIcono.cItem = NewItem
            FNombreIcono.ShowDialog() : If FNombreIcono.Cancelado = True Then Exit Sub
            NewItem.Text = FNombreIcono.TNombre.Text
            NewItem.Tag = Split(NewItem.Tag, "|-|", , CompareMethod.Text)(0) + "|-|[TITULO]|-|" + FNombreIcono.TNombre.Text + "|-|[ELIMINADOICON]"
        End If
        NuevoStrip.Items.Insert(NuevoPosicion, NewItem)
        QuickMenu_SubMenu_Remove_TextBoxes()
        CancelClose2 = True
        QuickMenus_Guardar()
        QuickMenu_Editor.Focus()
        CancelClose2 = False
    End Sub

    Private Sub QuickMenu_MenuNuevo_Texto_Click(sender As Object, e As EventArgs) Handles QuickMenu_MenuNuevo_Texto.Click
        If NuevoPosicion = NuevoStrip.Items.Count Then Exit Sub
        Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = NuevoStrip.Items(NuevoPosicion).Text.Trim, .ForeColor = QuickMenu_Editor.ForeColor, .Tag = Generate_ID() + "|-|[TEXTO]|-|" + NuevoStrip.Items(NuevoPosicion).Text.Trim + "|-|[ELIMINADOICON]"}
        AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
        AddHandler NewItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
        AddHandler NewItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
        AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
        AddHandler NewItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
        If NuevoStrip.Items(NuevoPosicion).Text.Trim = "" Then
            FNombreIcono.Cancelado = True : FNombreIcono.Nombre = "" : FNombreIcono.Comando_ID = "" : FNombreIcono.cItem = Nothing
            FNombreIcono.Nombre = "" : FNombreIcono.Comando_ID = "" : FNombreIcono.PIcono.Image = Nothing : FNombreIcono.PIcono.Visible = False : FNombreIcono.Text = "Nombre" : FNombreIcono.FTheme.Text = "Nombre"
            FNombreIcono.cItem = NewItem
            FNombreIcono.ShowDialog() : If FNombreIcono.Cancelado = True Then Exit Sub
            NewItem.Text = FNombreIcono.TNombre.Text
            NewItem.Tag = Split(NewItem.Tag, "|-|", , CompareMethod.Text)(0) + "|-|[TEXTO]|-|" + FNombreIcono.TNombre.Text + "|-|[ELIMINADOICON]"
        End If
        NuevoStrip.Items.Insert(NuevoPosicion, NewItem)
        QuickMenu_SubMenu_Remove_TextBoxes()
        CancelClose2 = True
        QuickMenus_Guardar()
        QuickMenu_Editor.Focus()
        CancelClose2 = False
    End Sub

    Private Sub QuickMenu_MenuNuevo_Pegar_Click(sender As Object, e As EventArgs) Handles QuickMenu_MenuNuevo_Pegar.Click
        If NuevoPosicion = NuevoStrip.Items.Count Then Exit Sub
        If CopiedItem IsNot Nothing Then
            If TypeOf CopiedItem Is ToolStripMenuItem Then
                Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString("ddMMyyyyHHmmss"), .Text = CopiedItem.Text, .ForeColor = Color.FromArgb(130, 130, 130), .Tag = Generate_ID() + "|-|" + CopiedItem.Tag.ToString.Substring(Split(CopiedItem.Tag, "|-|",, CompareMethod.Text)(0).Length + 3), .Image = CopiedItem.Image, .AllowDrop = CopiedItem.AllowDrop}
                AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
                AddHandler NewItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
                AddHandler NewItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
                AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
                AddHandler NewItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
                If CopiedItem.DropDownItems.Count > 0 Then QuickMenu_DragCopy_SubItems(CopiedItem, NewItem)
                NuevoStrip.Items.Insert(NuevoPosicion, NewItem)
            ElseIf TypeOf CopiedItem Is ToolStripSeparator Then
                Dim NewItem As New ToolStripSeparator With {.Name = "-" + Now.ToString("ddMMyyyyHHmmss"), .Text = CopiedItem.Text, .ForeColor = Color.FromArgb(130, 130, 130), .Tag = Generate_ID() + "|-|" + CopiedItem.Tag.ToString.Substring(Split(CopiedItem.Tag, "|-|",, CompareMethod.Text)(0).Length + 3)}
                AddHandler NewItem.Paint, AddressOf QuickMenu_Titulo_Paint
                AddHandler NewItem.MouseDown, AddressOf QuickMenu_Item_MouseDown
                AddHandler NewItem.MouseUp, AddressOf QuickMenu_Item_MouseUp
                AddHandler NewItem.MouseEnter, AddressOf QuickMenu_Item_MouseEnter
                AddHandler NewItem.MouseMove, AddressOf QuickMenu_Item_MouseMove
                NuevoStrip.Items.Insert(NuevoPosicion, NewItem)
            End If
            QuickMenus_Guardar()
            Lista_Update()
        End If
    End Sub

#End Region

#Region " Eventos "

    Private Sub QuickMenu_MenuNuevo_Opening(sender As Object, e As System.ComponentModel.CancelEventArgs) Handles QuickMenu_MenuNuevo.Opening
        If Comandos.Count = 0 Then
            QuickMenu_MenuNuevo_ComandoExistente.Visible = False
            QuickMenu_MenuNuevo_Separador1.Visible = False
            If CopiedItem IsNot Nothing Then
                QuickMenu_MenuNuevo_Separador5.Visible = True
                QuickMenu_MenuNuevo_Pegar.Visible = True
                QuickMenu_MenuNuevo.Height = 166 '138
            Else
                QuickMenu_MenuNuevo_Separador5.Visible = False
                QuickMenu_MenuNuevo_Pegar.Visible = False
                QuickMenu_MenuNuevo.Height = 138 '110
            End If
        Else
            QuickMenu_MenuNuevo_ComandoExistente.Visible = True
            QuickMenu_MenuNuevo_Separador1.Visible = True
            If CopiedItem IsNot Nothing Then
                QuickMenu_MenuNuevo_Separador5.Visible = True
                QuickMenu_MenuNuevo_Pegar.Visible = True
                QuickMenu_MenuNuevo.Height = 194 '166
            Else
                QuickMenu_MenuNuevo_Separador5.Visible = False
                QuickMenu_MenuNuevo_Pegar.Visible = False
                QuickMenu_MenuNuevo.Height = 166 '138
            End If
        End If
Salta:  QuickMenu_MenuNuevo_ComandoExistente.DropDownItems.Clear()
        SLista.Clear() : SLista.Sorting = SortOrder.None : SLista.BeginUpdate() : SLista.Columns.Add("A")
        For Cuenta = 0 To Comandos.Length - 1
            If Comandos IsNot Nothing AndAlso Comandos(Cuenta).Nombre.Trim <> "" Then SLista.Items.Add(Comandos(Cuenta).Nombre).Tag = Comandos(Cuenta).ID
        Next : SLista.EndUpdate() : SLista.Sorting = SortOrder.Ascending : SLista.Sort()
        If SLista.Items.Count = 0 Then QuickMenu_MenuNuevo_ComandoExistente.Visible = False : QuickMenu_Menu_Separador8.Visible = False : Exit Sub

        If SLista.Items.Count < 31 Then
            For Cuenta = 0 To SLista.Items.Count - 1
                Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = SLista.Items(Cuenta).Text, .ForeColor = QuickMenu_Editor.ForeColor, .Tag = SLista.Items(Cuenta).Tag}
                NewItem.Image = Iconos.DefaultIcon(NewItem.Tag, 0)
                AddHandler NewItem.MouseDown, AddressOf QuickMenu_MenuNuevo_ComandoExistente_MouseDown
                AddHandler NewItem.MouseEnter, AddressOf QuickMenu_MenuNuevo_MouseEnter
                AddHandler NewItem.MouseLeave, AddressOf QuickMenu_MenuNuevo_MouseLeave
                QuickMenu_MenuNuevo_ComandoExistente.DropDownItems.Add(NewItem)
            Next : Exit Sub
        End If

        Dim NewMainItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Image = QuickMenu_MenuNuevo_ComandoExistente.Image, .ForeColor = QuickMenu_Editor.ForeColor}
        AddHandler NewMainItem.MouseEnter, AddressOf QuickMenu_MenuNuevo_MouseEnter
        AddHandler NewMainItem.MouseLeave, AddressOf QuickMenu_MenuNuevo_MouseLeave

        Dim Contador As Integer : For Cuenta = 0 To SLista.Items.Count - 1
            Contador += 1
            Dim NewItem As New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Text = SLista.Items(Cuenta).Text, .ForeColor = QuickMenu_Editor.ForeColor, .Tag = SLista.Items(Cuenta).Tag}
            NewItem.Image = Iconos.DefaultIcon(NewItem.Tag, 0)
            AddHandler NewItem.MouseDown, AddressOf QuickMenu_MenuNuevo_ComandoExistente_MouseDown
            AddHandler NewItem.MouseEnter, AddressOf QuickMenu_MenuNuevo_MouseEnter
            AddHandler NewItem.MouseLeave, AddressOf QuickMenu_MenuNuevo_MouseLeave
            NewMainItem.DropDownItems.Add(NewItem)

            If Contador > 29 Or Cuenta = SLista.Items.Count - 1 Then
                If NewMainItem.DropDownItems(NewMainItem.DropDownItems.Count - 1).Text.ToLower.StartsWith(SLista.Items(Math.Min(Cuenta + 1, SLista.Items.Count - 1)).Text.ToLower.Substring(0, 1)) = False Or Cuenta = SLista.Items.Count - 1 Then
                    If (SLista.Items.Count - 1) - Cuenta < 6 AndAlso Cuenta <> SLista.Items.Count - 1 Then Continue For
                    NewMainItem.Text = NewMainItem.DropDownItems(0).Text.ToUpper.Substring(0, 1) + " - " + NewMainItem.DropDownItems(NewMainItem.DropDownItems.Count - 1).Text.ToUpper.Substring(0, 1)
                    QuickMenu_MenuNuevo_ComandoExistente.DropDownItems.Add(NewMainItem)
                    If Cuenta = SLista.Items.Count - 1 Then Exit For
                    NewMainItem = New ToolStripMenuItem With {.Name = "i" + Now.ToString, .Image = QuickMenu_MenuNuevo_ComandoExistente.Image, .ForeColor = QuickMenu_Editor.ForeColor}
                    AddHandler NewMainItem.MouseEnter, AddressOf QuickMenu_MenuNuevo_MouseEnter
                    AddHandler NewMainItem.MouseLeave, AddressOf QuickMenu_MenuNuevo_MouseLeave
                    Contador = 0
                End If
            End If
        Next
    End Sub

    Private Sub QuickMenu_MenuNuevo_MouseEnter(sender As Object, e As EventArgs) Handles QuickMenu_MenuNuevo_ComandoRapido.MouseEnter, QuickMenu_MenuNuevo_ComandoNuevo.MouseEnter, QuickMenu_MenuNuevo_ComandoExistente.MouseEnter, QuickMenu_MenuNuevo_Pegar.MouseEnter, QuickMenu_MenuNuevo_Texto.MouseEnter, QuickMenu_MenuNuevo_Titulo.MouseEnter, QuickMenu_MenuNuevo_Separador.MouseEnter
        sender.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub QuickMenu_MenuNuevo_MouseLeave(sender As Object, e As EventArgs) Handles QuickMenu_MenuNuevo_ComandoRapido.MouseLeave, QuickMenu_MenuNuevo_ComandoNuevo.MouseLeave, QuickMenu_MenuNuevo_ComandoExistente.MouseLeave, QuickMenu_MenuNuevo_Pegar.MouseLeave, QuickMenu_MenuNuevo_Texto.MouseLeave, QuickMenu_MenuNuevo_Titulo.MouseLeave, QuickMenu_MenuNuevo_Separador.MouseLeave
        sender.ForeColor = Color.FromArgb(130, 130, 130)
    End Sub

#End Region

#End Region

#End Region

#Region " Funciones "

#Region " Inicializar "

    Private Sub QuickMenu_Editor_Inicializar()
        AddHandler QuickMenu_Editor.DragDrop, AddressOf QuickMenu_SubMenu_DragDrop
        AddHandler QuickMenu_Editor.DragEnter, AddressOf QuickMenu_SubMenu_DragEnter
        AddHandler QuickMenu_Editor.DragLeave, AddressOf QuickMenu_SubMenu_DragLeave
        AddHandler QuickMenu_Editor.Opening, AddressOf QuickMenu_Editor_Opening
        AddHandler QuickMenu_Editor.Opened, AddressOf QuickMenu_Editor_Opened
        AddHandler QuickMenu_Editor.Closed, AddressOf QuickMenu_SubMenu_Closed
        AddHandler QuickMenu_Editor.PreviewKeyDown, AddressOf QuickMenu_SubMenu_KeyDown
        AddHandler QuickMenu_Editor.KeyUp, AddressOf QuickMenu_SubMenu_KeyUp
    End Sub

#End Region

#Region " Guardar "

    Private Sub QuickMenus_Guardar(Optional Strip As Object = Nothing, Optional Ruta As String = "")
        If Strip Is Nothing Then
            If QuickMenus IsNot Nothing Then
                For Cuenta = 0 To QuickMenus.Length - 1
                    If QuickMenus(Cuenta).Nombre = QuickMenu_Editor.Nombre Then QuickMenus(Cuenta) = QuickMenu_Editor
                Next
            End If
            If QuickMenu_Editor.Nombre Is Nothing Then Exit Sub
            Registro.DelReg(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|"))
            Registro.SetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|"), "Nombre", QuickMenu_Editor.Nombre)
            Registro.SetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|"), "Tamaño", QuickMenu_TQuickMenuSize.Value.ToString)
            Dim Contador As Integer
            For Each cItem As Object In QuickMenu_Editor.Items
                If TypeOf cItem Is ToolStripSeparator Then
                    Registro.SetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|") + "\" + "[SEPARADOR]" + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "ID", Split(cItem.Tag, "|-|",, CompareMethod.Text)(0))
                    Registro.SetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|") + "\" + "[SEPARADOR]" + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Comando", Split(cItem.Tag, "|-|",, CompareMethod.Text)(1))
                    Registro.SetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|") + "\" + "[SEPARADOR]" + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Nombre", Split(cItem.Tag, "|-|",, CompareMethod.Text)(2))
                    Registro.SetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|") + "\" + "[SEPARADOR]" + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Icono", Split(cItem.Tag, "|-|",, CompareMethod.Text)(3))
                    Registro.SetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|") + "\" + "[SEPARADOR]" + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Indice", Contador.ToString)
                ElseIf TypeOf cItem Is ToolStripMenuItem Then
                    Registro.SetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|") + "\" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "ID", Split(cItem.Tag, "|-|",, CompareMethod.Text)(0))
                    Registro.SetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|") + "\" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Comando", Split(cItem.Tag, "|-|",, CompareMethod.Text)(1))
                    Registro.SetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|") + "\" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Nombre", Split(cItem.Tag, "|-|",, CompareMethod.Text)(2))
                    Registro.SetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|") + "\" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Icono", Split(cItem.Tag, "|-|",, CompareMethod.Text)(3))
                    Registro.SetRegKey(RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|") + "\" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Indice", Contador.ToString)
                    If cItem.DropDownItems.Count > 0 Then
                        QuickMenus_Guardar(cItem, RegPath + "\QuickMenus\" + QuickMenu_Editor.Nombre.Replace("\", "|/|") + "\" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0))
                    End If
                End If : Contador += 1
            Next
        Else
            Dim Contador As Integer
            For Each cItem As Object In Strip.DropDownItems
                If TypeOf cItem Is ToolStripSeparator Then
                    Registro.SetRegKey(Ruta + "\" + "[SEPARADOR]" + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "ID", Split(cItem.Tag, "|-|",, CompareMethod.Text)(0))
                    Registro.SetRegKey(Ruta + "\" + "[SEPARADOR]" + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Comando", Split(cItem.Tag, "|-|",, CompareMethod.Text)(1))
                    Registro.SetRegKey(Ruta + "\" + "[SEPARADOR]" + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Nombre", Split(cItem.Tag, "|-|",, CompareMethod.Text)(2))
                    Registro.SetRegKey(Ruta + "\" + "[SEPARADOR]" + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Icono", Split(cItem.Tag, "|-|",, CompareMethod.Text)(3))
                    Registro.SetRegKey(Ruta + "\" + "[SEPARADOR]" + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Indice", Contador.ToString)
                ElseIf TypeOf cItem Is ToolStripMenuItem Then
                    Registro.SetRegKey(Ruta + "\" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "ID", Split(cItem.Tag, "|-|",, CompareMethod.Text)(0))
                    Registro.SetRegKey(Ruta + "\" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Comando", Split(cItem.Tag, "|-|",, CompareMethod.Text)(1))
                    Registro.SetRegKey(Ruta + "\" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Nombre", Split(cItem.Tag, "|-|",, CompareMethod.Text)(2))
                    Registro.SetRegKey(Ruta + "\" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Icono", Split(cItem.Tag, "|-|",, CompareMethod.Text)(3))
                    Registro.SetRegKey(Ruta + "\" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0), "Indice", Contador.ToString)
                    If Contador = 0 Then
                        cItem.Text = cItem.Text
                        Contador = Contador
                    End If
                    If cItem.DropDownItems.Count > 0 Then
                        QuickMenus_Guardar(cItem, Ruta + "\" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) + "|-|" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(0))
                    End If
                End If : Contador += 1
            Next
        End If
        If Ruta = "" Then QuickMenus_F_Cargar()
    End Sub

#End Region

#Region " Update "

    Private Sub Update_QuickMenu(Optional Strip As Object = Nothing)
        Dim Existe As Boolean
        If Strip Is Nothing OrElse TypeOf Strip Is NSContextMenu Then
            For Cuenta = 0 To QuickMenus_F.Count
                If Cuenta = QuickMenus_F.Count Then
                    For Each cItem As Object In QuickMenu_Editor.Items
                        If TypeOf cItem Is ToolStripMenuItem Then
                            If cItem.DropDownItems.Count > 0 Then Update_QuickMenu(cItem)
                            If Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) = "[COMANDO]" Then
                                For Cuenta2 = 0 To Comandos.Length - 1
                                    If Comandos(Cuenta2).ID = Split(cItem.Tag, "|-|",, CompareMethod.Text)(1) Then cItem.Text = Comandos(Cuenta2).Nombre : Existe = True : Exit For
                                Next
                                If Existe = False Then
                                    cItem.Tag = Split(cItem.Tag, "|-|",, CompareMethod.Text)(0) + "|-||-|[COMANDO]|-|[DEFAULT]" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(3)
                                    cItem.Text = "[ELIMINADO]" : cItem.Image = My.Resources.QuickMenu_Eliminado.ToBitmap
                                End If
                            End If
                            If Split(cItem.Tag, "|-|",, CompareMethod.Text)(3) = "[DEFAULT]" AndAlso cItem.Text <> "[ELIMINADO]" Then
                                For Cuenta2 = 0 To Comandos.Length - 1
                                    If Comandos(Cuenta2).ID = Split(cItem.Tag, "|-|",, CompareMethod.Text)(1) Then cItem.Image = Iconos.DefaultIcon(cItem.Tag) : Exit For
                                Next
                            End If
                        End If
                        Existe = False
                    Next
                    For Cuenta2 = 0 To QuickMenus.Count - 1
                        For Each cItem As Object In QuickMenus(Cuenta2).Items
                            If TypeOf cItem Is ToolStripMenuItem Then
                                If cItem.DropDownItems.Count > 0 Then Update_QuickMenu(cItem)
                                If Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) = "[COMANDO]" Then
                                    For Cuenta3 = 0 To Comandos.Length - 1
                                        If Comandos(Cuenta3).ID = Split(cItem.Tag, "|-|",, CompareMethod.Text)(1) Then cItem.Text = Comandos(Cuenta3).Nombre : Existe = True : Exit For
                                    Next
                                    If Existe = False Then
                                        cItem.Tag = Split(cItem.Tag, "|-|",, CompareMethod.Text)(0) + "|-||-|[COMANDO]|-|[DEFAULT]" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(3)
                                        cItem.Text = "[ELIMINADO]" : cItem.Image = My.Resources.QuickMenu_Eliminado.ToBitmap
                                    End If
                                End If
                                If Split(cItem.Tag, "|-|",, CompareMethod.Text)(3) = "[DEFAULT]" AndAlso cItem.Text <> "[ELIMINADO]" Then
                                    For Cuenta3 = 0 To Comandos.Length - 1
                                        If Comandos(Cuenta3).ID = Split(cItem.Tag, "|-|",, CompareMethod.Text)(1) Then cItem.Image = Iconos.DefaultIcon(cItem.Tag) : Exit For
                                    Next
                                End If
                            End If
                            Existe = False
                        Next
                    Next
                Else
                    For Each cItem As Object In QuickMenus_F(Cuenta).Items
                        If TypeOf cItem Is ToolStripMenuItem Then
                            If cItem.DropDownItems.Count > 0 Then Update_QuickMenu(cItem)
                            If Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) = "[COMANDO]" Then
                                For Cuenta2 = 0 To Comandos.Length - 1
                                    If Comandos(Cuenta2).ID = Split(cItem.Tag, "|-|",, CompareMethod.Text)(1) Then cItem.Text = Comandos(Cuenta2).Nombre : Existe = True : Exit For
                                Next
                                If Existe = False Then
                                    cItem.Tag = Split(cItem.Tag, "|-|",, CompareMethod.Text)(0) + "|-||-|[COMANDO]|-|[DEFAULT]" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(3)
                                    cItem.Text = "[ELIMINADO]" : cItem.Image = My.Resources.QuickMenu_Eliminado.ToBitmap
                                End If
                            End If
                            If Split(cItem.Tag, "|-|",, CompareMethod.Text)(3) = "[DEFAULT]" AndAlso cItem.Text <> "[ELIMINADO]" Then
                                For Cuenta2 = 0 To Comandos.Length - 1
                                    If Comandos(Cuenta2).ID = Split(cItem.Tag, "|-|",, CompareMethod.Text)(1) Then cItem.Image = Iconos.DefaultIcon(cItem.Tag) : Exit For
                                Next
                            End If
                        End If
                        Existe = False
                    Next
                End If
            Next
        Else
            For Each cItem As Object In Strip.DropDownItems
                If TypeOf cItem Is ToolStripMenuItem Then
                    If cItem.DropDownItems.Count > 0 Then Update_QuickMenu(cItem)
                    If Split(cItem.Tag, "|-|",, CompareMethod.Text)(2) = "[COMANDO]" Then
                        For Cuenta = 0 To Comandos.Length - 1
                            If Comandos(Cuenta).ID = Split(cItem.Tag, "|-|",, CompareMethod.Text)(1) Then cItem.Text = Comandos(Cuenta).Nombre : Existe = True : Exit For
                        Next
                        If Existe = False Then
                            cItem.Tag = Split(cItem.Tag, "|-|",, CompareMethod.Text)(0) + "|-||-|[COMANDO]|-|[DEFAULT]" + Split(cItem.Tag, "|-|",, CompareMethod.Text)(3)
                            cItem.Text = "[ELIMINADO]" : cItem.Image = My.Resources.QuickMenu_Eliminado.ToBitmap
                        End If
                    End If
                    If Split(cItem.Tag, "|-|",, CompareMethod.Text)(3) = "[DEFAULT]" AndAlso cItem.Text <> "[ELIMINADO]" Then
                        For Cuenta = 0 To Comandos.Length - 1
                            If Comandos(Cuenta).ID = Split(cItem.Tag, "|-|",, CompareMethod.Text)(1) Then cItem.Image = Iconos.DefaultIcon(cItem.Tag) : Exit For
                        Next
                    End If
                End If
                Existe = False
            Next
        End If
    End Sub

#End Region

#Region " Open / Close "

    Private Sub QuickMenu_Editor_Opening(sender As Object, e As System.ComponentModel.CancelEventArgs)
        For Each cItem As Object In QuickMenu_Editor.Items
            If TypeOf cItem Is ToolStripMenuItem Then
                Dim nItem As ToolStripMenuItem = CType(cItem, ToolStripMenuItem)
                If nItem.Tag.ToString.Contains("[COMANDO]") Then
                    For Cuenta = 0 To Comandos.Length - 1
                        If Comandos(Cuenta).ID = Split(nItem.Tag, "|-|", , CompareMethod.Text)(1) Then nItem.Text = Comandos(Cuenta).Nombre : Exit For
                    Next
                End If
            End If
        Next
    End Sub

    Private Sub QuickMenu_Editor_Opened(sender As Object, e As EventArgs)
        If QuickMenu_Editor.Items.Count = 1 AndAlso TypeOf QuickMenu_Editor.Items(0) Is ToolStripTextBox Then
            Dim nItem As ToolStripTextBox = CType(QuickMenu_Editor.Items(0), ToolStripTextBox) : QuickMenu_Editor.Focus() : nItem.Select() : nItem.Focus()
        End If
    End Sub


#End Region

#Region " TextBoxes "

    Private Function QuickMenu_SubMenu_Check_TextBoxes(Optional sender As Object = Nothing) As Boolean
        'Try
        If sender Is Nothing OrElse TypeOf sender Is NSContextMenu Then
            For Cuenta = QuickMenu_Editor.Items.Count - 1 To 0 Step -1
                If QuickMenu_Editor.Items.Count > Cuenta AndAlso TypeOf QuickMenu_Editor.Items(Cuenta) Is ToolStripTextBox Then Return True
                If QuickMenu_Editor.Items.Count > Cuenta AndAlso TypeOf QuickMenu_Editor.Items(Cuenta) Is ToolStripMenuItem AndAlso QuickMenu_Editor.Items(Cuenta).IsOnDropDown Then
                    If QuickMenu_SubMenu_Check_TextBoxes(QuickMenu_Editor.Items(Cuenta)) = True Then Return True
                End If
            Next
        Else
            If sender.DropDownItems.Count = 0 Then Return False
            Dim Strip As Object = sender.DropDownItems(0).Owner
            For Cuenta = Strip.Items.Count - 1 To 0 Step -1
                If Strip.Items.Count > Cuenta AndAlso TypeOf Strip.Items(Cuenta) Is ToolStripTextBox Then Return True
                If Strip.Items.Count > Cuenta AndAlso TypeOf Strip.Items(Cuenta) Is ToolStripMenuItem AndAlso Strip.Items(Cuenta).IsOnDropDown Then
                    If QuickMenu_SubMenu_Check_TextBoxes(Strip.Items(Cuenta)) = True Then Return True
                End If
            Next
        End If
        'Catch : End Try
        Return False
    End Function

    Private Sub QuickMenu_SubMenu_Remove_TextBoxes(Optional sender As Object = Nothing)
        'Try
        If sender Is Nothing OrElse TypeOf sender Is NSContextMenu Then
            For Cuenta = QuickMenu_Editor.Items.Count - 1 To 0 Step -1
                If QuickMenu_Editor.Items.Count > Cuenta AndAlso TypeOf QuickMenu_Editor.Items(Cuenta) Is ToolStripTextBox Then QuickMenu_Editor.Items.RemoveAt(Cuenta)
                If QuickMenu_Editor.Items.Count > Cuenta AndAlso TypeOf QuickMenu_Editor.Items(Cuenta) Is ToolStripMenuItem AndAlso QuickMenu_Editor.Items(Cuenta).IsOnDropDown Then QuickMenu_SubMenu_Remove_TextBoxes(QuickMenu_Editor.Items(Cuenta))
            Next
            If QuickMenu_Editor.Items.Count = 0 Then QuickMenu_Añadir(QuickMenu_Editor)
        Else
            If sender.DropDownItems.Count = 0 Then Exit Sub
            Dim Strip As Object = sender.DropDownItems(0).Owner
            For Cuenta = Strip.Items.Count - 1 To 0 Step -1
                If Strip.Items.Count > Cuenta AndAlso TypeOf Strip.Items(Cuenta) Is ToolStripTextBox Then Strip.Items.RemoveAt(Cuenta)
                If Strip.Items.Count > Cuenta AndAlso TypeOf Strip.Items(Cuenta) Is ToolStripMenuItem AndAlso Strip.Items(Cuenta).IsOnDropDown Then QuickMenu_SubMenu_Remove_TextBoxes(Strip.Items(Cuenta))
            Next
            If Strip.Items.Count = 0 Then CancelClose = False : Strip.Close()
        End If
        'Catch : End Try
    End Sub

#End Region

#Region " Item Inside "

    Private Function QuickMenu_SubMenu_CheckItemInside(Strip As Object, cItem As Object) As Boolean
        'Try
        For Each nItem As Object In Strip.DropDownItems
            If TypeOf nItem Is ToolStripMenuItem Then
                If nItem Is cItem Then
                    Return True
                ElseIf nItem.DropDownItems.Count > 0 Then
                    If QuickMenu_SubMenu_CheckItemInside(nItem, cItem) = True Then Return True
                End If
            End If
        Next
        'Catch : End Try
        Return False
    End Function

    Private Sub QuickMenu_SubMenu_CloseItemInside(Optional Strip As Object = Nothing, Optional cItem As Object = Nothing)
        ' Try
        CancelClose = False
        If Strip Is Nothing OrElse TypeOf Strip Is NSContextMenu Then
            For Each nItem As Object In QuickMenu_Editor.Items
                If TypeOf nItem Is ToolStripMenuItem AndAlso nItem IsNot ItemOnMouse AndAlso nItem.DropDownItems.Count > 0 AndAlso QuickMenu_SubMenu_CheckItemInside(nItem, ItemOnMouse) = True Then QuickMenu_SubMenu_CloseItemInside(nItem, ItemOnMouse) Else If TypeOf nItem Is ToolStripMenuItem Then nItem.HideDropDown()
            Next
        Else
            For Each nItem As Object In Strip.DropDownItems
                If TypeOf nItem Is ToolStripMenuItem AndAlso nItem IsNot cItem AndAlso QuickMenu_SubMenu_CheckItemInside(nItem, ItemOnMouse) = True Then QuickMenu_SubMenu_CloseItemInside(nItem, ItemOnMouse) Else If TypeOf nItem Is ToolStripMenuItem Then nItem.HideDropDown()
            Next
        End If
        'Catch : End Try
        CancelClose = True
    End Sub

#End Region

#Region " ForeColor "

    Private Sub QuickMenu_PanelQuickMenu_MouseEnter(sender As Object, e As EventArgs) Handles PanelQuickMenu.MouseEnter
        QuickMenu_ForeColor_Off()
    End Sub

    Private Sub QuickMenu_ForeColor_Off(Optional Strip As Object = Nothing)
        'Try
        If Strip Is Nothing OrElse TypeOf Strip Is NSContextMenu Then
            If Strip Is Nothing Then Strip = QuickMenu_Editor
            For Each cItem As Object In Strip.Items
                If TypeOf cItem Is ToolStripMenuItem Then
                    If cItem.DropDownItems.Count > 0 Then QuickMenu_ForeColor_Off(cItem)
                    cItem.ForeColor = Color.FromArgb(130, 130, 130)
                End If
            Next
        Else
            For Each cItem As Object In Strip.DropDownItems
                If TypeOf cItem Is ToolStripMenuItem Then
                    If cItem.DropDownItems.Count > 0 Then QuickMenu_ForeColor_Off(cItem)
                    cItem.ForeColor = Color.FromArgb(130, 130, 130)
                End If
            Next
        End If
        'Catch : End Try
    End Sub

#End Region

#Region " Existe Comando "

    Private Function QuickMenu_ExisteComando(Strip As Object, ComandoID As String) As Boolean
        'Try
        If Strip Is Nothing OrElse TypeOf Strip Is NSContextMenu Then
            For Each cItem As Object In Strip.Items
                If TypeOf cItem Is ToolStripMenuItem Then
                    If cItem.DropDownItems.Count > 0 Then If QuickMenu_ExisteComando(cItem, ComandoID) = True Then Return True
                    If CType(cItem, ToolStripMenuItem).Tag.ToString.Contains(ComandoID) Then Return True
                End If
            Next
        Else
            For Each cItem As Object In Strip.DropDownItems
                If TypeOf cItem Is ToolStripMenuItem Then
                    If cItem.DropDownItems.Count > 0 Then If QuickMenu_ExisteComando(cItem, ComandoID) = True Then Return True
                    If CType(cItem, ToolStripMenuItem).Tag.ToString.Contains(ComandoID) Then Return True
                End If
            Next
        End If
        'Catch : End Try
        Return False
    End Function

#End Region

#Region " Controles "

    Private Sub QuickMenu_Controles_MouseDown(sender As Object, e As EventArgs) Handles QuickMenu_LQuickMenu.MouseDown, QuickMenu_Nombre_LNombre.MouseDown, QuickMenu_GQuickMenu.MouseDown, QuickMenu_TQuickMenuSize.MouseDown, BPanelQuickMenu.MouseDown, PanelQuickMenu.MouseDown, Lista.MouseDown
        If PanelQuickMenu.Visible = True AndAlso QuickMenu_Editor.Items.Count > 0 AndAlso TypeOf QuickMenu_Editor.Items(0) Is ToolStripTextBox Then
            Dim cItem As ToolStripTextBox = CType(QuickMenu_Editor.Items(0), ToolStripTextBox) : cItem.Select() : cItem.Focus()
        Else
            CancelClose = False
            For Each cItem As Object In QuickMenu_Editor.Items
                If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then
                    cItem.HideDropDown()
                End If
            Next
            If sender.Name <> "Lista" Then HTexto.Focus()
        End If
    End Sub

    Private Sub QuickMenu_Controles_MouseUp(sender As Object, e As EventArgs) Handles QuickMenu_LQuickMenu.MouseUp, QuickMenu_Nombre_LNombre.MouseUp, QuickMenu_GQuickMenu.MouseUp, QuickMenu_TQuickMenuSize.MouseUp, BPanelQuickMenu.MouseUp, PanelQuickMenu.MouseUp, FTheme.MouseUp
        If PanelQuickMenu.Visible = True AndAlso QuickMenu_Editor.Items.Count > 0 AndAlso TypeOf QuickMenu_Editor.Items(0) Is ToolStripTextBox Then
            Dim cItem As ToolStripTextBox = CType(QuickMenu_Editor.Items(0), ToolStripTextBox) : cItem.Select() : cItem.Focus()
        Else
            HTexto.Focus()
        End If
    End Sub

#End Region

#End Region

#Region " Tooltips "

    Private Sub QuickMenu_Tooltips(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_LNombre.MouseEnter, QuickMenu_Nombre_BAdd.MouseEnter, QuickMenu_Nombre_BDelete.MouseEnter, QuickMenu_TQuickMenuSize.MouseEnter, QuickMenu_Nombre_LCNombre.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "QuickMenu_Nombre_Nombre" : Show_Tooltip(sender, "Nombre del 'QuickMenu'")
            Case "QuickMenu_Nombre_CNombre" : Show_Tooltip(sender, "Nombre del 'QuickMenu'" + vbCrLf + vbCrLf + "Click Derecho: Editar el nombre del 'QuickMenu'")
            Case "QuickMenu_Nombre_BAdd" : Show_Tooltip(sender, "Crean un nuevo 'QuickMenu'")
            Case "QuickMenu_Nombre_BDelete" : Show_Tooltip(sender, "Elimina el 'QuickMenu' seleccionado")
            Case "QuickMenu_TQuickMenuSize" : Show_Tooltip(sender, "Tamaño del 'QuickMenu': " + QuickMenu_TQuickMenuSize.Value.ToString)
        End Select
    End Sub

#End Region

#End Region

#Region " Ejecucion "

#Region " SubMenus "

#Region " Open / Close "

    Private Sub QuickMenu_F_Opening(sender As Object, e As ComponentModel.CancelEventArgs)
        Proceso.Get_Process_Name(True) : QuickMenu_Proceso = Proceso.CurrentProcess
        If TypeOf sender Is NSContextMenu Then QuickMenu_F_SetAutoClose(sender, False)
        QuickMenu_F_ForeColor_Off(sender)
    End Sub

    Private Sub QuickMenu_F_SubMenu_Closing(sender As Object, e As ToolStripDropDownClosingEventArgs)
        If QuickMenuRightClick = True Then
            For Cuenta = 0 To QuickMenus_F.Length - 1
                If QuickMenus_F(Cuenta).Visible = True Then QuickMenu_F_SetAutoClose(QuickMenus_F(Cuenta), False) : Exit For
            Next : e.Cancel = True
        End If
    End Sub

#End Region

#Region " KeyDown / KeyUp "

    Private Sub QuickMenu_F_SubMenu_KeyDown(sender As Object, e As PreviewKeyDownEventArgs)
        'Try
        If e.KeyCode = Keys.Escape Then
            QuickMenu_OnMenu = False
            QuickMenuRightClick = False
            For Cuenta = 0 To QuickMenus_F.Length - 1
                If QuickMenus_F(Cuenta).Visible = True Then QuickMenu_F_SetAutoClose(QuickMenus_F(Cuenta), True) : QuickMenus_F(Cuenta).Close() : Exit For
            Next
        End If
        If e.KeyCode = Keys.Enter Then
            For Each cItem As Object In sender.Items
                If cItem.Selected = True Then
                    For Cuenta = 0 To Comandos.Length - 1
                        If Comandos(Cuenta).ID = Split(cItem.Tag, "|-|",, CompareMethod.Text)(1) Then
                            If cItem.DropDownItems.Count > 0 Then
                                For Cuenta2 = 0 To QuickMenus_F.Length - 1
                                    If QuickMenus_F(Cuenta2).Visible = True Then QuickMenus_F(Cuenta2).Close() : Exit For
                                Next
                            End If
                            Dim cEjecutarComando As EjecutarComandoST
                            cEjecutarComando.Indice_Comando = Cuenta
                            cEjecutarComando.ID_Comando = Comandos(Cuenta).ID
                            cEjecutarComando.Sonido = Comandos(Cuenta).Sonido
                            cEjecutarComando.Proceso = QuickMenu_Proceso : Proceso.CurrentProcess = QuickMenu_Proceso
                            cEjecutarComando.Logger = "Keyboard"
                            cEjecutarComando.Notas = "QuickMenu"
                            Comandos(Cuenta).EnEjecucion = True
                            EjecutarComando(cEjecutarComando)
                            Exit For
                        End If
                    Next
                    Exit Sub
                End If
            Next
        End If
        'If e.KeyCode <> Keys.Up And e.KeyCode <> Keys.Down And e.KeyCode <> Keys.Left And e.KeyCode <> Keys.Right And e.KeyCode <> Keys.Home And e.KeyCode <> Keys.End And e.KeyCode <> Keys.Escape Then Exit Sub
        'QuickMenu_F_ForeColor_Off() : CancelClose = False : IgnoreOne = False : Dim Selected As Boolean
        'If e.KeyCode = Keys.Up Or e.KeyCode = Keys.Down Then
        '    For Cuenta = 0 To sender.Items.Count - 1
        '        If sender.Items(Cuenta).Selected = True Then
        '            If e.KeyCode = Keys.Up Then
        '                If Cuenta = 0 Then
        '                    sender.Items(GetNextItem_ForSelect(sender, sender.Items.Count - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
        '                Else
        '                    sender.Items(GetNextItem_ForSelect(sender, Cuenta - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
        '                End If
        '            End If
        '            If e.KeyCode = Keys.Down Then
        '                If Cuenta = sender.Items.Count - 1 Then
        '                    sender.Items(GetNextItem_ForSelect(sender, 0, False)).ForeColor = Color.FromArgb(205, 150, 0)
        '                Else
        '                    sender.Items(GetNextItem_ForSelect(sender, Cuenta + 1, False)).ForeColor = Color.FromArgb(205, 150, 0)
        '                End If
        '            End If : Selected = True : Exit For
        '        End If
        '    Next
        '    If Selected = False Then
        '        If e.KeyCode = Keys.Up AndAlso sender.Items.Count > 0 Then
        '            sender.Items(GetNextItem_ForSelect(sender, sender.Items.Count - 1, True)).ForeColor = Color.FromArgb(205, 150, 0)
        '        End If
        '        If e.KeyCode = Keys.Down AndAlso sender.Items.Count > 0 Then
        '            sender.Items(GetNextItem_ForSelect(sender, 0, False)).ForeColor = Color.FromArgb(205, 150, 0)
        '        End If
        '    End If
        'End If
        'If e.KeyCode = Keys.Right Then
        '    For Each cItem As Object In sender.Items
        '        If cItem.Selected = True Then
        '            If cItem.DropDownItems.Count > 0 Then
        '                cItem.DropDownItems(0).ForeColor = Color.FromArgb(205, 150, 0) : Exit For
        '            Else
        '                For Each nItem As Object In QuickMenu_Editor.Items
        '                    If nItem.Selected = True Then nItem.ForeColor = Color.FromArgb(205, 150, 0) : Exit For
        '                Next : Exit For
        '            End If
        '        End If
        '    Next
        'End If
        'If e.KeyCode = Keys.Left Or e.KeyCode = Keys.Escape Then
        '    If TypeOf sender IsNot NSContextMenu Then
        '        sender.OwnerItem.ForeColor = Color.FromArgb(205, 150, 0)
        '    Else
        '        For Each nItem As Object In QuickMenu_Editor.Items
        '            If nItem.Selected = True Then nItem.ForeColor = Color.FromArgb(205, 150, 0) : Exit For
        '        Next
        '    End If
        'End If
        'If e.KeyCode = Keys.Home Then
        '    sender.Items(0).ForeColor = Color.FromArgb(205, 150, 0)
        'End If
        'If e.KeyCode = Keys.End Then
        '    sender.Items(sender.Items.Count - 1).ForeColor = Color.FromArgb(205, 150, 0)
        'End If
        'Catch : End Try
    End Sub

    Private Function GetNextItem_ForSelect(sender As Object, Indice As Integer, OrdenInverso As Boolean) As Integer
        If Indice = 0 Then Return 0
        'Try
        Dim Cuenta As Integer = Indice
        Select Case OrdenInverso
            Case True
                Do Until TypeOf sender.Items(Cuenta) IsNot ToolStripSeparator Or Cuenta = 0
                    Cuenta -= 1
                Loop
            Case False
                Do Until TypeOf sender.Items(Cuenta) IsNot ToolStripSeparator Or Cuenta = sender.Items.Count - 1
                    Cuenta += 1
                Loop
        End Select : Return Cuenta
        'Catch : End Try
        Return 0
    End Function

#End Region

#End Region

#Region " Items "

#Region " MouseDown / MouseUp "

    Private Sub QuickMenu_F_Item_MouseDown(sender As Object, e As MouseEventArgs)
        If e.Button = MouseButtons.Left Then
            QuickMenuRightClick = False
            For Cuenta = 0 To QuickMenus_F.Length - 1
                QuickMenu_F_SetAutoClose(QuickMenus_F(Cuenta), True)
            Next
        ElseIf e.Button = MouseButtons.Right Then
            QuickMenuRightClick = True
            'For Cuenta = 0 To QuickMenus_F.Length - 1
            '    QuickMenu_F_SetAutoClose(QuickMenus_F(Cuenta), True)
            'Next
        End If
    End Sub

    Private Sub QuickMenu_F_Item_MouseUp(sender As Object, e As MouseEventArgs)
        If e.Button = MouseButtons.Left Then
            For Cuenta = 0 To Comandos.Length - 1
                If Comandos(Cuenta).ID = Split(sender.Tag, "|-|",, CompareMethod.Text)(1) Then
                    If sender.DropDownItems.Count > 0 Then
                        For Cuenta2 = 0 To QuickMenus_F.Length - 1
                            If QuickMenus_F(Cuenta2).Visible = True Then QuickMenus_F(Cuenta2).Close() : Exit For
                        Next
                    End If
                    Dim cEjecutarComando As EjecutarComandoST
                    cEjecutarComando.Indice_Comando = Cuenta
                    cEjecutarComando.ID_Comando = Comandos(Cuenta).ID
                    cEjecutarComando.Sonido = Comandos(Cuenta).Sonido
                    cEjecutarComando.Proceso = QuickMenu_Proceso : Proceso.CurrentProcess = QuickMenu_Proceso
                    cEjecutarComando.Logger = "Keyboard"
                    cEjecutarComando.Notas = "QuickMenu"
                    Comandos(Cuenta).EnEjecucion = True
                    EjecutarComando(cEjecutarComando)
                    Exit For
                End If
            Next
        ElseIf e.Button = MouseButtons.Right Then
            For Cuenta = 0 To Comandos.Length - 1
                If Comandos(Cuenta).ID = Split(sender.Tag, "|-|",, CompareMethod.Text)(1) Then
                    Dim cEjecutarComando As EjecutarComandoST
                    cEjecutarComando.Indice_Comando = Cuenta
                    cEjecutarComando.ID_Comando = Comandos(Cuenta).ID
                    cEjecutarComando.Sonido = Comandos(Cuenta).Sonido
                    cEjecutarComando.Proceso = QuickMenu_Proceso : Proceso.CurrentProcess = QuickMenu_Proceso
                    cEjecutarComando.Logger = "Keyboard"
                    cEjecutarComando.Notas = "QuickMenu"
                    Comandos(Cuenta).EnEjecucion = True
                    EjecutarComando(cEjecutarComando)
                    Exit For
                End If
            Next
        ElseIf e.Button = MouseButtons.Middle Then
            If ModifierKeys = Keys.Control Then
                QuickMenu_IgnoreMouse = True : QuickMenuRightClick = False : Paneles_Click(BPanelQuickMenu, Nothing) : Application.DoEvents()
                For Cuenta = 0 To QuickMenus_F.Length - 1
                    If QuickMenus_F(Cuenta).Visible = True Then QuickMenu_F_SetAutoClose(QuickMenus_F(Cuenta), True) : QuickMenus_F(Cuenta).Close() : QuickMenu_Nombre_CNombre.SelectedItem = QuickMenus_F(Cuenta).Nombre : ShowF() : Focus() : Activate() : QuickMenu_Editor_Load(QuickMenus_F(Cuenta).Nombre) : Exit For
                Next : QuickMenu_IgnoreMouse = False
            Else
                QuickMenu_IgnoreMouse = True : QuickMenuRightClick = False : Paneles_Click(BPanelComandos, Nothing) : Application.DoEvents()
                For Cuenta = 0 To QuickMenus_F.Length - 1
                    If QuickMenus_F(Cuenta).Visible = True Then QuickMenu_F_SetAutoClose(QuickMenus_F(Cuenta), True) : QuickMenus_F(Cuenta).Close() : QuickMenu_Nombre_CNombre.SelectedItem = QuickMenus_F(Cuenta).Nombre : ShowF() : Focus() : Activate() : QuickMenu_Editor_Load(QuickMenus_F(Cuenta).Nombre) : Exit For
                Next : QuickMenu_IgnoreMouse = False
                If TypeOf sender Is ToolStripMenuItem Then ItemOnMouse = sender : SeparatorOnMouse = Nothing ': QuickMenu_Menu.Tag = ItemOnMouse
                If TypeOf sender Is ToolStripSeparator Then ItemOnMouse = Nothing : SeparatorOnMouse = sender ': QuickMenu_Menu.Tag = SeparatorOnMouse
                QuickMenu_Menu_EditarComando_Click(sender, e)
            End If
            Logros.Desbloquear("Quick-Opener")
        End If
    End Sub

#End Region

#Region " MouseEnter / MouseLeave / MouseMove "

    Private Sub QuickMenu_F_Item_MouseEnter(sender As Object, e As EventArgs)
        QuickMenu_OnMenu = True
        If TypeOf sender Is ToolStripSeparator Then Exit Sub
        Dim RootStrip As Object = Nothing
        For Cuenta = 0 To QuickMenus_F.Length - 1
            If QuickMenus_F(Cuenta).Visible = True Then RootStrip = QuickMenus_F(Cuenta) : Exit For
        Next : QuickMenu_F_SetAutoClose(RootStrip, True)
        For Cuenta = 0 To sender.Owner.Items.Count - 1
            If TypeOf sender.Owner.Items(Cuenta) Is ToolStripMenuItem Then
                If RootStrip.Handle IsNot Nothing Then SetForegroundWindow(New Runtime.InteropServices.HandleRef(RootStrip, RootStrip.Handle))
                QuickMenuRightClick = False
                sender.Owner.Items(Cuenta).HideDropDown()
                QuickMenuRightClick = True
            End If
        Next
        If sender.DropDownItems.Count > 0 Then sender.ShowDropDown()
        QuickMenu_F_SetAutoClose(RootStrip, False)
        QuickMenu_F_ForeColor_Off() : sender.ForeColor = Color.FromArgb(205, 150, 0) : sender.Select()
    End Sub

    Private Sub QuickMenu_F_Item_MouseLeave(sender As Object, e As EventArgs)
        QuickMenu_OnMenu = False
    End Sub

    Private Sub QuickMenu_F_Item_MouseMove(sender As Object, e As MouseEventArgs)
        If sender.ForeColor = Color.FromArgb(130, 130, 130) Then QuickMenu_F_ForeColor_Off() : sender.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

#End Region

#End Region

#Region " Funciones "

#Region " Auto Close "

    Private Sub QuickMenu_F_SetAutoClose(Strip As Object, Estado As Boolean, Optional Cerrar As Boolean = False)
        If Strip Is Nothing Then Exit Sub
        If TypeOf Strip Is NSContextMenu Or TypeOf Strip Is ToolStripDropDownMenu Then
            For Each cItem As Object In Strip.Items
                If TypeOf cItem Is ToolStripMenuItem Then
                    If cItem.DropDownItems.Count > 0 Then QuickMenu_F_SetAutoClose(cItem, Estado)
                End If
            Next : Strip.AutoClose = Estado : If Cerrar = True Then Strip.Close
        Else
            For Each cItem As Object In Strip.DropDownItems
                If TypeOf cItem Is ToolStripMenuItem AndAlso cItem.DropDownItems.Count > 0 Then QuickMenu_F_SetAutoClose(cItem, Estado)
            Next : Strip.DropDown.AutoClose = Estado : If Cerrar = True Then Strip.DropDown.Close
        End If
    End Sub

#End Region

#Region " ForeColor Off "

    Private Sub QuickMenu_F_ForeColor_Off(Optional Strip As Object = Nothing)
        'Try
        If Strip Is Nothing Then
            For Cuenta = 0 To QuickMenus_F.Length - 1
                If QuickMenus_F(Cuenta).Visible = True Then QuickMenu_F_ForeColor_Off(QuickMenus_F(Cuenta)) : Exit For
            Next
        ElseIf TypeOf Strip Is NSContextMenu Then
            For Each cItem As Object In Strip.Items
                If TypeOf cItem Is ToolStripMenuItem Then
                    If cItem.DropDownItems.Count > 0 Then QuickMenu_F_ForeColor_Off(cItem)
                    cItem.ForeColor = Color.FromArgb(130, 130, 130)
                End If
            Next
        Else
            For Each cItem As Object In Strip.DropDownItems
                If TypeOf cItem Is ToolStripMenuItem Then
                    If cItem.DropDownItems.Count > 0 Then QuickMenu_F_ForeColor_Off(cItem)
                    cItem.ForeColor = Color.FromArgb(130, 130, 130)
                End If
            Next
        End If
        'Catch : End Try
    End Sub

#End Region

#Region " Titulo Paint "

    Private Sub QuickMenu_F_Titulo_Paint(sender As Object, e As PaintEventArgs)
        If Split(sender.Tag, "|-|",, CompareMethod.Text)(1) <> "[TITULO]" Then Exit Sub
        Dim cFont As Font = sender.Font
        Dim nFont As New Font(cFont.FontFamily, cFont.Size + 1)

        Dim Header As New Drawing2D.LinearGradientBrush(New Rectangle(sender.ContentRectangle.X, sender.ContentRectangle.Y - 1, sender.ContentRectangle.Width, sender.ContentRectangle.Height), Color.FromArgb(25, 25, 25), Color.FromArgb(42, 42, 42), 270)
        e.Graphics.FillRectangle(Header, New Rectangle(sender.ContentRectangle.X, sender.ContentRectangle.Y - 1, sender.ContentRectangle.Width, sender.ContentRectangle.Height))
        Dim HeaderHatch As New Drawing2D.HatchBrush(Drawing2D.HatchStyle.Trellis, Color.FromArgb(35, Color.Black), Color.Transparent)
        e.Graphics.FillRectangle(HeaderHatch, New Rectangle(sender.ContentRectangle.X, sender.ContentRectangle.Y - 1, sender.ContentRectangle.Width, sender.ContentRectangle.Height))
        e.Graphics.DrawString(sender.Text, nFont, New SolidBrush(sender.ForeColor), (sender.ContentRectangle.Width / 2 - (MeasureString(sender.Text, nFont).Width / 2)) + 4, sender.ContentRectangle.Height / 2 - (MeasureString(sender.Text, nFont).Height / 2))
        e.Graphics.DrawRectangle(New Pen(Color.Black), sender.ContentRectangle.X, sender.ContentRectangle.Y - 1, sender.ContentRectangle.Width, sender.ContentRectangle.Height)
        If sender.DropDownItems.Count > 0 Then e.Graphics.FillPolygon(New SolidBrush(Color.Black), {New Point(sender.ContentRectangle.width - 11, (sender.ContentRectangle.Height / 2) - 4), New Point(sender.ContentRectangle.width - 7, (sender.ContentRectangle.Height / 2)), New Point(sender.ContentRectangle.width - 11, (sender.ContentRectangle.Height / 2) + 4)})

        If Split(sender.Tag, "|-|",, CompareMethod.Text)(3) = "[DEFAULT]" Then
            sender.Image = Nothing
        ElseIf Split(sender.Tag, "|-|",, CompareMethod.Text)(3) <> "[ELIMINADOICON]" Then
            If IO.File.Exists(Split(sender.Tag, "|-|",, CompareMethod.Text)(3)) = True Then e.Graphics.DrawImage(Iconos.Cargar(Split(sender.Tag, "|-|",, CompareMethod.Text)(3)).ToBitmap, New Rectangle(5, (sender.ContentRectangle.Height / 2) - 8, 18, (sender.ContentRectangle.Height / 2) + 6))
        End If
    End Sub

#End Region

#End Region

#End Region

#End Region

#Region " Panel Opciones "

#Region " Mostrar Opciones "

    Private Sub Opciones_Mostrar()
        Opciones_Update = True
        'Iniciar Windows
        Opciones_IniciarWindows_CIniciarWindows.Checked = Opciones_IniciarWindows
        Opciones_IniciarWindows_TModo.Text = Opciones_IniciarWindows_Modo
        'Icono Sistema
        Opciones_IconoSistema_CIconoSistema.Checked = Opciones_IconoSistema
        'Deshabilitar Back / Foward
        Opciones_DisableXButton_CDisableXButton.Checked = Opciones_DisableXButton
        'MensajeIniciar
        Opciones_MensajeIniciar_TMensaje.Text = Opciones_MensajeIniciar_Texto
        Opciones_MensajeIniciar_BOSD.ForeColor1 = Opciones_MensajeIniciar_Color : Opciones_MensajeIniciar_BOSD.ForeColor3 = Opciones_MensajeIniciar_Color
        Opciones_MensajeIniciar_TSonido.Text = Opciones_MensajeIniciar_Sonido : Opciones_MensajeIniciar_LCSonido.Text = Opciones_MensajeIniciar_TSonido.Text : Opciones_MensajeIniciar_TSonido.Focus()
        'UDP
        Opciones_UDP_CUDP.Checked = Opciones_UDP
        Opciones_UDP_TPuerto.Text = Opciones_UDP_Puerto.ToString : ValidarPort() : Opciones_UDP_TPuerto.Focus()
        'Desactivar
        Opciones_Desactivar_TProceso.Enabled = False
        Opciones_Desactivar_LCProceso.Text = "Seleccione una aplicación" : Opciones_Desactivar_TProceso.ForeColor1 = Color.FromArgb(72, 72, 72)
        Opciones_Desactivar_CCProcesos.Items.Clear() : If Desactivar.Length > 0 Then
            For Cuenta = 0 To Desactivar.Length - 1
                If Desactivar(Cuenta).Trim <> "" Then Opciones_Desactivar_CCProcesos.Items.Add(Desactivar(Cuenta))
            Next
        End If : Opciones_Desactivar_TProceso.Focus()
        If Opciones_Desactivar_CCProcesos.Items.Count > 0 Then Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_CCProcesos.Items(0)
        'Deshabilitar
        Opciones_Deshabilitar_TProceso.Enabled = False
        Opciones_Deshabilitar_LCProceso.Text = "Seleccione una aplicación" : Opciones_Deshabilitar_TProceso.ForeColor1 = Color.FromArgb(72, 72, 72)
        Opciones_Deshabilitar_CCProcesos.Items.Clear() : If DeshabilitarBackForward.Length > 0 Then
            For Cuenta = 0 To DeshabilitarBackForward.Length - 1
                If DeshabilitarBackForward(Cuenta).Trim <> "" Then Opciones_Deshabilitar_CCProcesos.Items.Add(DeshabilitarBackForward(Cuenta))
            Next
        End If : Opciones_Deshabilitar_TProceso.Focus()
        If Opciones_Deshabilitar_CCProcesos.Items.Count > 0 Then Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_CCProcesos.Items(0)
        'Version
        Opciones_Version_LCorreo.Text = Opciones_Version_Registro : Opciones_Version_LCorreo.ForeColor1 = Color.Gray
        If Opciones_Version_LCorreo.Text = "" Then Opciones_Version_LCorreo.Text = "Sin Datos"
        Opciones_Version_LFecha.Text = Opciones_Version_Validez.ToShortDateString
        If Opciones_Version_LFecha.Text = "31/12/2099" Then Opciones_Version_LFecha.Text = "Sin Límite" : Opciones_Version_LCorreo.Text = "Serial Oro" : Opciones_Version_LCorreo.ForeColor1 = Color.FromArgb(205, 150, 0)
        If Opciones_Version_LFecha.Text = "01/01/0001" Then Opciones_Version_LFecha.Text = "Sin Datos"
        If Opciones_Version_LCorreo.Text = "trial" Or Opciones_Version_LCorreo.Text = "Sin Datos" Then Opciones_Version_BRegistrar.Visible = True Else Opciones_Version_BRegistrar.Visible = False
        If Opciones_Version_LCorreo.Text <> "trial" And Opciones_Version_LCorreo.Text <> "Sin Datos" Then Opciones_Version_PSerial.Visible = True Else Opciones_Version_PSerial.Visible = False
        If Opciones_Version_LCorreo.Text = "trial" Then Opciones_Version_LCorreo.Text = "Periodo de Prueba"
        Opciones_Version_LCorreo.Invalidate() : Opciones_Version_LFecha.Invalidate()
        Opciones_Version_LCVersion.Text = Version
        Opciones_Update = False
    End Sub

#End Region

#Region " Guardar Opciones "

    Private Sub Opciones_GuardarValor(Nombre As String)
        If Opciones_Update = True Then Exit Sub
        Select Case Nombre
            Case "IniciarWindows"
                Registro.SetRegKey(RegPath + "\Opciones", "IniciarWindows", Opciones_IniciarWindows.ToString)
                Registro.SetRegKey(RegPath + "\Opciones", "IniciarWindowsModo", Opciones_IniciarWindows_Modo)
            Case "IconoSistema"
                Registro.SetRegKey(RegPath + "\Opciones", "IconoSistema", Opciones_IconoSistema.ToString)
            Case "DisableXButton"
                Registro.SetRegKey(RegPath + "\Opciones", "DisableXButton", Opciones_DisableXButton.ToString)
            Case "MensajeIniciar"
                Registro.SetRegKey(RegPath + "\Opciones", "MensajeIniciar_Texto", Opciones_MensajeIniciar_Texto)
                Registro.SetRegKey(RegPath + "\Opciones", "MensajeIniciar_Fuente", Font_to_String(Opciones_MensajeIniciar_Fuente))
                Registro.SetRegKey(RegPath + "\Opciones", "MensajeIniciar_Color", Color_to_String(Opciones_MensajeIniciar_Color))
                Registro.SetRegKey(RegPath + "\Opciones", "MensajeIniciar_Sonido", Opciones_MensajeIniciar_Sonido)
            Case "UDP"
                Registro.SetRegKey(RegPath + "\Opciones", "UDP", Opciones_UDP.ToString)
                Registro.SetRegKey(RegPath + "\Opciones", "UDPPort", Opciones_UDP_Puerto.ToString)
            Case "Desactivar"
                Registro.DelReg(RegPath + "\Opciones\Desactivar") : For Cuenta = 0 To Opciones_Desactivar_CCProcesos.Items.Count - 1
                    Registro.SetRegKey(RegPath + "\Opciones\Desactivar", Opciones_Desactivar_CCProcesos.Items(Cuenta), "")
                Next : Desactivar = Registro.GetRegValueNames(RegPath + "\Opciones\Desactivar")
            Case "Deshabilitar"
                Registro.DelReg(RegPath + "\Opciones\DeshabilitarBackFoward") : For Cuenta = 0 To Opciones_Deshabilitar_CCProcesos.Items.Count - 1
                    Registro.SetRegKey(RegPath + "\Opciones\DeshabilitarBackFoward", Opciones_Deshabilitar_CCProcesos.Items(Cuenta), "")
                Next : DeshabilitarBackForward = Registro.GetRegValueNames(RegPath + "\Opciones\DeshabilitarBackFoward")
            Case "Serial"
                Registro.SetRegKey(RegPath + "\Opciones", "Serial", Opciones_Version_Serial)
        End Select
    End Sub

    Private Sub Opciones_GuardarTodo()
        If Opciones_Update = True Then Exit Sub
        Registro.SetRegKey(RegPath + "\Opciones", "IniciarWindows", Opciones_IniciarWindows.ToString)
        Registro.SetRegKey(RegPath + "\Opciones", "IniciarWindowsModo", Opciones_IniciarWindows_Modo)
        Registro.SetRegKey(RegPath + "\Opciones", "IconoSistema", Opciones_IconoSistema.ToString)
        Registro.SetRegKey(RegPath + "\Opciones", "DisableXButton", Opciones_DisableXButton.ToString)
        Registro.SetRegKey(RegPath + "\Opciones", "MensajeIniciar_Texto", Opciones_MensajeIniciar_Texto)
        Registro.SetRegKey(RegPath + "\Opciones", "MensajeIniciar_Fuente", Font_to_String(Opciones_MensajeIniciar_Fuente))
        Registro.SetRegKey(RegPath + "\Opciones", "MensajeIniciar_Color", Color_to_String(Opciones_MensajeIniciar_Color))
        Registro.SetRegKey(RegPath + "\Opciones", "MensajeIniciar_Sonido", Opciones_MensajeIniciar_Sonido)
        Registro.SetRegKey(RegPath + "\Opciones", "UDP", Opciones_UDP.ToString)
        Registro.SetRegKey(RegPath + "\Opciones", "UDPPort", Opciones_UDP_Puerto.ToString)
        Registro.DelReg(RegPath + "\Opciones\Desactivar") : For Cuenta = 0 To Opciones_Desactivar_CCProcesos.Items.Count - 1
            Registro.SetRegKey(RegPath + "\Opciones\Desactivar", Opciones_Desactivar_CCProcesos.Items(Cuenta), "")
        Next : Desactivar = Registro.GetRegValueNames(RegPath + "\Opciones\Desactivar")
        Registro.DelReg(RegPath + "\Opciones\DeshabilitarBackFoward") : For Cuenta = 0 To Opciones_Deshabilitar_CCProcesos.Items.Count - 1
            Registro.SetRegKey(RegPath + "\Opciones\DeshabilitarBackFoward", Opciones_Deshabilitar_CCProcesos.Items(Cuenta), "")
        Next : DeshabilitarBackForward = Registro.GetRegValueNames(RegPath + "\Opciones\DeshabilitarBackFoward")
        Registro.SetRegKey(RegPath + "\Opciones", "Serial", Opciones_Version_Serial)
    End Sub

#End Region

#Region " Controles "

#Region " Mensaje Iniciar "

    Private Sub Opciones_MensajeIniciar_TMensaje_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Opciones_MensajeIniciar_TMensaje.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub Opciones_MensajeIniciar_TMensaje_LostFocus(sender As Object, e As EventArgs) Handles Opciones_MensajeIniciar_TMensaje.LostFocus
        Opciones_MensajeIniciar_TMensaje.Text = Opciones_MensajeIniciar_TMensaje.Text.Trim
        If Opciones_MensajeIniciar_TMensaje.Text.Length > 1 Then Opciones_MensajeIniciar_TMensaje.Text = Opciones_MensajeIniciar_TMensaje.Text.Substring(0, 1).ToUpper + Opciones_MensajeIniciar_TMensaje.Text.Substring(1)
        Opciones_MensajeIniciar_Texto = Opciones_MensajeIniciar_TMensaje.Text
        Opciones_GuardarValor("MensajeIniciar")
    End Sub

    Private Sub Opciones_MensajeIniciar_LMensaje_Click(sender As Object, e As MouseEventArgs) Handles Opciones_MensajeIniciar_LMensaje.Click
        If e.Button = MouseButtons.Right Then
            If Opciones_MensajeIniciar_Texto <> "" Then
                Opciones_OSD_Font = Opciones_MensajeIniciar_Fuente : Opciones_OSD_Color = Opciones_MensajeIniciar_Color : ShowOSD(Replace(Replace(Opciones_MensajeIniciar_Texto, """version""", Version, Compare:=CompareMethod.Text), """ver""", Version, Compare:=CompareMethod.Text))
            Else
                Opciones_OSD_Font = Opciones_MensajeIniciar_Fuente : Opciones_OSD_Color = Opciones_MensajeIniciar_Color : ShowOSD("Mensaje de prueba")
            End If
        End If
    End Sub

    Private Sub Opciones_MensajeIniciar_BOSD_Click(sender As Object, e As MouseEventArgs) Handles Opciones_MensajeIniciar_BOSD.Click
        If e.Button = MouseButtons.Left Then
            Dim Opciones_FontDialog As New FontDialog : Opciones_FontDialog.FontMustExist = True : Opciones_FontDialog.ShowColor = True : Opciones_FontDialog.Font = Opciones_MensajeIniciar_Fuente : Opciones_FontDialog.Color = Opciones_MensajeIniciar_Color
            If Opciones_FontDialog.ShowDialog = DialogResult.OK Then Opciones_MensajeIniciar_Fuente = Opciones_FontDialog.Font : Opciones_MensajeIniciar_Color = Opciones_FontDialog.Color : Opciones_MensajeIniciar_BOSD.ForeColor1 = Opciones_MensajeIniciar_Color : Opciones_MensajeIniciar_BOSD.ForeColor3 = Opciones_MensajeIniciar_Color : Opciones_GuardarValor("MensajeIniciar") Else Exit Sub
        ElseIf e.Button = MouseButtons.Right Then
            Dim Opciones_ColorDialog As New ColorDialog : Opciones_ColorDialog.AllowFullOpen = True : Opciones_ColorDialog.FullOpen = True : Opciones_ColorDialog.AnyColor = True : Opciones_ColorDialog.Color = Opciones_MensajeIniciar_Color
            If Opciones_ColorDialog.ShowDialog = DialogResult.OK Then Opciones_MensajeIniciar_Color = Opciones_ColorDialog.Color : Opciones_MensajeIniciar_BOSD.ForeColor1 = Opciones_MensajeIniciar_Color : Opciones_MensajeIniciar_BOSD.ForeColor3 = Opciones_MensajeIniciar_Color : Opciones_GuardarValor("MensajeIniciar") Else Exit Sub
        ElseIf e.Button = MouseButtons.Middle Then
            Opciones_MensajeIniciar_Fuente = OSD_Default_Font : Opciones_MensajeIniciar_Color = Color.FromArgb(205, 150, 0) : Opciones_MensajeIniciar_BOSD.ForeColor1 = Opciones_MensajeIniciar_Color : Opciones_MensajeIniciar_BOSD.ForeColor3 = Opciones_MensajeIniciar_Color : Opciones_GuardarValor("MensajeIniciar")
        End If : HTexto.Focus()
        If Opciones_MensajeIniciar_Texto <> "" Then
            Opciones_OSD_Font = Opciones_MensajeIniciar_Fuente : Opciones_OSD_Color = Opciones_MensajeIniciar_Color
            ShowOSD(Replace(Replace(Opciones_MensajeIniciar_Texto, """version""", Version, Compare:=CompareMethod.Text), """ver""", Version, Compare:=CompareMethod.Text))
        Else
            Opciones_OSD_Font = Opciones_MensajeIniciar_Fuente : Opciones_OSD_Color = Opciones_MensajeIniciar_Color : ShowOSD("Mensaje de prueba")
        End If
    End Sub

#Region " Sonido "

    Private Sub Opciones_MensajeIniciar_LCSonido_TextChanged(sender As Object, e As EventArgs) Handles Opciones_MensajeIniciar_LCSonido.TextChanged
        Opciones_MensajeIniciar_TSonido.Enabled = False
        Opciones_MensajeIniciar_LCSonido.Text = Rutas.Acortar_Ruta(Opciones_MensajeIniciar_TSonido.Text, Opciones_MensajeIniciar_LCSonido)
        Opciones_MensajeIniciar_Sonido = Opciones_MensajeIniciar_TSonido.Text
        Dim TextSize As Single = 6.75 : Do Until TextRenderer.MeasureText(Opciones_MensajeIniciar_LCSonido.Text, New Font(Opciones_MensajeIniciar_LCSonido.Font.Name, TextSize, FontStyle.Regular)).Width < Opciones_MensajeIniciar_LCSonido.Width Or TextSize < 6 : TextSize -= 1 : Loop : Opciones_MensajeIniciar_LCSonido.Font = New Font(Opciones_MensajeIniciar_LCSonido.Font.Name, TextSize, FontStyle.Regular)
        Opciones_GuardarValor("MensajeIniciar")
    End Sub

    Private Sub Opciones_MensajeIniciar_LCSonido_Click(sender As Object, e As MouseEventArgs) Handles Opciones_MensajeIniciar_LCSonido.Click, Opciones_MensajeIniciar_TSonido.Click
        If e.Button = MouseButtons.Left Then
            Opciones_MensajeIniciar_CSonido.DroppedDown = True : Opciones_MensajeIniciar_CSonido.Focus()
        ElseIf e.Button = MouseButtons.Right Then
            Opciones_MensajeIniciar_LCSonido.Visible = False : Combo_IgnoreOne = True : Opciones_MensajeIniciar_TSonido.ReadOnly = False : Opciones_MensajeIniciar_TSonido.Enabled = True : Opciones_MensajeIniciar_TSonido.Cursor = Cursors.IBeam : Opciones_MensajeIniciar_TSonido.Focus()
        Else : HTexto.Focus()
        End If
    End Sub

    Private Sub Opciones_MensajeIniciar_TSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Opciones_MensajeIniciar_TSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub Opciones_MensajeIniciar_TSonido_KeyDown(sender As Object, e As KeyEventArgs) Handles Opciones_MensajeIniciar_TSonido.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : Opciones_MensajeIniciar_CSonido.DroppedDown = True : Opciones_MensajeIniciar_CSonido.Focus()
    End Sub

    Private Sub Opciones_MensajeIniciar_TSonido_GotFocus(sender As Object, e As EventArgs) Handles Opciones_MensajeIniciar_TSonido.GotFocus
        Texto_Focused = True
    End Sub

    Private Sub Opciones_MensajeIniciar_TSonido_LostFocus(sender As Object, e As EventArgs) Handles Opciones_MensajeIniciar_TSonido.LostFocus
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If Opciones_MensajeIniciar_LCSonido.Visible = False Then Opciones_MensajeIniciar_LCSonido.Visible = True : Opciones_MensajeIniciar_TSonido.ReadOnly = True : Opciones_MensajeIniciar_TSonido.Enabled = False : Opciones_MensajeIniciar_TSonido.Cursor = Cursors.Arrow
        If IO.File.Exists(Opciones_MensajeIniciar_TSonido.Text) = False And Opciones_MensajeIniciar_CSonido.Items.Contains(StrConv(Opciones_MensajeIniciar_TSonido.Text, VbStrConv.ProperCase)) = False Then Opciones_MensajeIniciar_TSonido.Text = "Sin Sonido"
        For Cuenta = 0 To Opciones_MensajeIniciar_CSonido.Items.Count - 1
            If Opciones_MensajeIniciar_TSonido.Text.ToLower = Opciones_MensajeIniciar_CSonido.Items(Cuenta).ToLower Then Opciones_MensajeIniciar_TSonido.Text = Opciones_MensajeIniciar_CSonido.Items(Cuenta)
        Next : Opciones_MensajeIniciar_TSonido.Text = Opciones_MensajeIniciar_TSonido.Text.Trim : Opciones_MensajeIniciar_TSonido.SelectionLength = 0 : Opciones_MensajeIniciar_LCSonido.Text = Opciones_MensajeIniciar_TSonido.Text
    End Sub

    Private Sub Opciones_MensajeIniciar_TSonido_MouseEnter(sender As Object, e As EventArgs) Handles Opciones_MensajeIniciar_TSonido.MouseEnter, Opciones_MensajeIniciar_CSonido.MouseEnter
        Opciones_MensajeIniciar_CSonido.State = NSComboBox.MouseState.None
    End Sub

#Region " Combo Sonido "

    Private Sub Opciones_MensajeIniciar_CSonido_DropDown(sender As Object, e As EventArgs) Handles Opciones_MensajeIniciar_CSonido.DropDown
        Opciones_MensajeIniciar_TSonido.Enabled = True
        Opciones_MensajeIniciar_CSonido.MaxDropDownItems = Opciones_MensajeIniciar_CSonido.Items.Count : Combo_Dropped = True : Combo_TempValue = Opciones_MensajeIniciar_TSonido.Text
        If Opciones_MensajeIniciar_CSonido.Items.Contains(Opciones_MensajeIniciar_TSonido.Text) = True Then Opciones_MensajeIniciar_CSonido.SelectedItem = Opciones_MensajeIniciar_TSonido.Text Else Opciones_MensajeIniciar_CSonido.SelectedIndex = 0
    End Sub

    Private Sub Opciones_MensajeIniciar_CSonido_DropDownClosed(sender As Object, e As EventArgs) Handles Opciones_MensajeIniciar_CSonido.DropDownClosed
        Combo_TempValue = ""
    End Sub

    Private Sub Opciones_MensajeIniciar_CSonido_LostFocus(sender As Object, e As EventArgs) Handles Opciones_MensajeIniciar_CSonido.LostFocus
        Combo_Dropped = False
    End Sub

    Private Sub Opciones_MensajeIniciar_SelectedIndexChanged(sender As Object, e As EventArgs) Handles Opciones_MensajeIniciar_CSonido.SelectedIndexChanged
        If Combo_TempValue = "" Then Opciones_MensajeIniciar_TSonido.Text = Opciones_MensajeIniciar_CSonido.SelectedItem.Trim : Opciones_MensajeIniciar_LCSonido.Text = Opciones_MensajeIniciar_TSonido.Text : HTexto.Focus()
    End Sub

    Private Sub Opciones_MensajeIniciar_CSonido_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Opciones_MensajeIniciar_CSonido.KeyPress
        If Asc(e.KeyChar) = 13 Then Opciones_MensajeIniciar_TSonido.Text = Opciones_MensajeIniciar_CSonido.SelectedItem.Trim : Opciones_MensajeIniciar_LCSonido.Text = Opciones_MensajeIniciar_TSonido.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub Opciones_MensajeIniciar_CSonido_ItemHover(Index As Integer) Handles Opciones_MensajeIniciar_CSonido.ItemHover
        Sonido_PlayTimer.Stop() : Sonido_PlayTimer.Start()
    End Sub

#End Region

#Region " Botones "

    Private Sub Opciones_MensajeIniciar_BPlay_Click(sender As Object, e As MouseEventArgs) Handles Opciones_MensajeIniciar_BPlay.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If Opciones_MensajeIniciar_TSonido.Text = "Sin Sonido" Then My.Computer.Audio.Stop() Else Sonidos.Play_Block(Opciones_MensajeIniciar_TSonido.Text)
    End Sub

    Private Sub Opciones_MensajeIniciar_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles Opciones_MensajeIniciar_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar audio..." : Abrir.Filter = "Archivos de Audio|*.wav;*.mid|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then Opciones_MensajeIniciar_TSonido.Text = Abrir.FileName : Opciones_MensajeIniciar_LCSonido.Text = Opciones_MensajeIniciar_TSonido.Text : Sonidos.Play_Block(Opciones_MensajeIniciar_TSonido.Text)
        Opciones_MensajeIniciar_TSonido.SelectionStart = Opciones_MensajeIniciar_TSonido.Text.Length : Opciones_MensajeIniciar_TSonido.SelectionLength = 0
        Opciones_MensajeIniciar_BExaminar.State = NSButton.MouseState.None : Opciones_MensajeIniciar_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

    Private Sub Opciones_MensajeIniciar_BExaminar_MouseEnter(sender As Object, e As EventArgs) Handles Opciones_MensajeIniciar_BExaminar.MouseEnter
        Opciones_MensajeIniciar_CSonido.State = NSComboBox.MouseState.None
    End Sub

#End Region

#End Region

#End Region

#Region " Iniciar Windows "

    Private Sub Opciones_IniciarWindows_Click(sender As Object, e As MouseEventArgs) Handles Opciones_IniciarWindows_LIniciarWindows.Click, Opciones_IniciarWindows_LIniciarWindows.DoubleClick, Opciones_IniciarWindows_CIniciarWindows.Click, Opciones_IniciarWindows_CIniciarWindows.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If Opciones_IniciarWindows_CIniciarWindows.Checked = True Then Opciones_IniciarWindows_CIniciarWindows.Checked = False Else Opciones_IniciarWindows_CIniciarWindows.Checked = True
        Opciones_IniciarWindows = Opciones_IniciarWindows_CIniciarWindows.Checked : Opciones_GuardarValor("IniciarWindows")
        If Opciones_IniciarWindows = False Then Registro.DesRegistrar() : DesRegistrarTask() Else RegistrarTask(Opciones_IniciarWindows_Modo)
    End Sub

    Private Sub Opciones_IniciarWindows_TModo_Click(sender As Object, e As MouseEventArgs) Handles Opciones_IniciarWindows_TModo.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        If Opciones_IniciarWindows_Modo = "Registro" Then Opciones_IniciarWindows_Modo = "Programado" : Opciones_IniciarWindows_TModo.Width = 60 Else Opciones_IniciarWindows_Modo = "Registro" : Opciones_IniciarWindows_TModo.Width = 42
        Opciones_IniciarWindows_TModo.Text = Opciones_IniciarWindows_Modo : Opciones_IniciarWindows_TModo.Invalidate() : Opciones_GuardarValor("IniciarWindows")
        If Opciones_IniciarWindows = True Then RegistrarTask(Opciones_IniciarWindows_Modo)
    End Sub

    Private Sub RegistrarTask(Modo As String)
        If Modo <> "Programado" Then
            DesRegistrarTask() : Registro.Registrar()
        Else
            Registro.DesRegistrar()
            Using ts As New Microsoft.Win32.TaskScheduler.TaskService()
                Dim td As Microsoft.Win32.TaskScheduler.TaskDefinition = ts.NewTask
                td.RegistrationInfo.Description = "KDesktop"
                td.RegistrationInfo.Author = "Kobayashi"
                td.RegistrationInfo.Date = Now
                td.Settings.DisallowStartIfOnBatteries = False
                td.Settings.StopIfGoingOnBatteries = False
                td.Settings.StartWhenAvailable = True
                td.Principal.RunLevel = Microsoft.Win32.TaskScheduler.TaskRunLevel.Highest
                td.Settings.IdleSettings.StopOnIdleEnd = False
                td.Settings.ExecutionTimeLimit = New TimeSpan(60, 0, 0, 0)
                td.Triggers.Add(New Microsoft.Win32.TaskScheduler.LogonTrigger)
                td.Actions.Add(New Microsoft.Win32.TaskScheduler.ExecAction(Application.ExecutablePath)) '"D:\Programas\Drivers\Mis Programas\K-Programs\KDesktop 4.0 - Launcher\bin\Debug\KDesktopL.exe"))
                ts.RootFolder.RegisterTaskDefinition("KDesktop", td)
            End Using
        End If
    End Sub

    Private Sub DesRegistrarTask()
        Using ts As New Microsoft.Win32.TaskScheduler.TaskService()
            ts.RootFolder.DeleteTask("KDesktop", False)
        End Using
    End Sub

#End Region

#Region " Icono Sistema "

    Private Sub Opciones_IconoSistema_Click(sender As Object, e As MouseEventArgs) Handles Opciones_IconoSistema_LIconoSistema.Click, Opciones_IconoSistema_LIconoSistema.DoubleClick, Opciones_IconoSistema_CIconoSistema.Click, Opciones_IconoSistema_CIconoSistema.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If Opciones_IconoSistema_CIconoSistema.Checked = True Then Opciones_IconoSistema_CIconoSistema.Checked = False Else Opciones_IconoSistema_CIconoSistema.Checked = True
        Opciones_IconoSistema = Opciones_IconoSistema_CIconoSistema.Checked : Opciones_GuardarValor("IconoSistema") : If Opciones_IconoSistema = True Then NotifyIcon.Visible = True Else NotifyIcon.Visible = False
    End Sub

    Private Sub Opciones_IconoSistema_PIconoSistema_Click(sender As Object, e As MouseEventArgs) Handles Opciones_IconoSistema_PIconoSistema.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        NotifyIcono_Menu_Seleccionar_Click(sender, e)
    End Sub

#Region " Menu "

    Private Sub NotifyIcono_Menu_Seleccionar_Click(sender As Object, e As EventArgs) Handles NotifyIcono_Menu_Seleccionar.Click
        FIconDialog.Cancelado = True : FIconDialog.ShowDialog()
        If FIconDialog.Cancelado = False Then
            Opciones_IconoSistema_PIconoSistema.Image = FIconDialog.Icono.ToBitmap
            Iconos.Guardar(Opciones_IconoSistema_PIconoSistema.Image, KobaPath + "KDesktop.ico") : NotifyIcon.Icon = Iconos.Cargar(KobaPath + "KDesktop.ico")
            Estadisticas.Estadisticas.Iconos_Modificados += 1 : Estadisticas.Guardar()
            Logros.Desbloquear("Tomad ejemplo")
        End If
    End Sub

    Private Sub NotifyIcono_Menu_Examinar_Click(sender As Object, e As EventArgs) Handles NotifyIcono_Menu_Examinar.Click
        'Try
        Dim ImageListSmall, ImageListLarge As ImageList : Dim Icono As Bitmap = Nothing
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar icono..." : Abrir.Filter = "Archivos de Iconos|*.ico;*.exe;*.dll;*.lnk|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then
            If Abrir.FileName.ToLower.EndsWith(".lnk") Then ImageListLarge = FIconDialog.GetImageList(Rutas.GetTargetPath(Abrir.FileName)) Else ImageListLarge = FIconDialog.GetImageList(Abrir.FileName)
            ImageListSmall = ImageListLarge : If ImageListSmall IsNot Nothing Then
                For Cuenta = 0 To ImageListSmall.Images.Count - 1
                    If ImageListSmall.Images(Cuenta) IsNot Nothing Then Icono = ImageListSmall.Images(Cuenta) : Exit For
                Next
            Else
                If Abrir.FileName.ToLower.EndsWith(".lnk") Then Abrir.FileName = Rutas.GetTargetPath(Abrir.FileName)
                Icono = Icon.ExtractAssociatedIcon(Abrir.FileName).ToBitmap
            End If
            If Icono Is Nothing Then Exit Sub
            Opciones_IconoSistema_PIconoSistema.Image = Icono
            Iconos.Guardar(Opciones_IconoSistema_PIconoSistema.Image, KobaPath + "KDesktop.ico") : NotifyIcon.Icon = Iconos.Cargar(KobaPath + "KDesktop.ico")
            Estadisticas.Estadisticas.Iconos_Modificados += 1 : Estadisticas.Guardar()
            Logros.Desbloquear("Tomad ejemplo")
        End If
        'Catch : End Try
    End Sub

    Private Sub NotifyIcono_Menu_Default_Click(sender As Object, e As EventArgs) Handles NotifyIcono_Menu_Default.Click
        NotifyIcon.Icon = My.Resources.KDesktop : Iconos.Guardar(My.Resources.KDesktop.ToBitmap, KobaPath + "KDesktop.ico")
        Opciones_IconoSistema_PIconoSistema.Image = NotifyIcon.Icon.ToBitmap
    End Sub

    Private Sub MenuIcono_MItem_MouseEnter(sender As Object, e As EventArgs) Handles NotifyIcono_Menu_Seleccionar.MouseEnter, NotifyIcono_Menu_Examinar.MouseEnter, NotifyIcono_Menu_Default.MouseEnter
        Dim QMItem As ToolStripMenuItem = CType(sender, ToolStripMenuItem) : QMItem.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub MenuIcono_MItem_MouseLeave(sender As Object, e As EventArgs) Handles NotifyIcono_Menu_Seleccionar.MouseLeave, NotifyIcono_Menu_Examinar.MouseLeave, NotifyIcono_Menu_Default.MouseLeave
        Dim QMItem As ToolStripMenuItem = CType(sender, ToolStripMenuItem) : QMItem.ForeColor = Color.FromArgb(130, 130, 130)
    End Sub

#End Region

#End Region

#Region " Disable XButton "

    Private Sub Opciones_DisableXButton_Click(sender As Object, e As MouseEventArgs) Handles Opciones_DisableXButton_LDisableXButton.Click, Opciones_DisableXButton_LDisableXButton.DoubleClick, Opciones_DisableXButton_CDisableXButton.Click, Opciones_DisableXButton_CDisableXButton.DoubleClick
        If e.Button = MouseButtons.Left Then
            If TypeOf sender Is NSLabel Then If Opciones_DisableXButton_CDisableXButton.Checked = True Then Opciones_DisableXButton_CDisableXButton.Checked = False Else Opciones_DisableXButton_CDisableXButton.Checked = True
            Opciones_DisableXButton = Opciones_DisableXButton_CDisableXButton.Checked : Opciones_GuardarValor("DisableXButton")
        End If
    End Sub

#Region " Proceso "

#Region " LCProceso "

    Private Sub Opciones_Deshabilitar_LCProceso_TextChanged(sender As Object, e As EventArgs) Handles Opciones_Deshabilitar_LCProceso.TextChanged
        Rutas.SetFontSize(Opciones_Deshabilitar_LCProceso, 8)
        Opciones_Deshabilitar_TProceso.Enabled = False
        If Opciones_Deshabilitar_TProceso.Text.Trim = "" AndAlso Opciones_Deshabilitar_CCProcesos.Items.Count = 0 Then Opciones_Deshabilitar_LCProceso.Text = "Seleccione una aplicación" : Opciones_Deshabilitar_TProceso.ForeColor1 = Color.FromArgb(72, 72, 72)
    End Sub

    Private Sub Opciones_Deshabilitar_LCProceso_Click(sender As Object, e As MouseEventArgs) Handles Opciones_Deshabilitar_LCProceso.Click, Opciones_Deshabilitar_LCProceso.DoubleClick, Opciones_Deshabilitar_TProceso.Click, Opciones_Deshabilitar_TProceso.DoubleClick
        If e.Button = MouseButtons.Left Then
            If Opciones_Deshabilitar_CCProcesos.Items.Count > 0 Then Opciones_Deshabilitar_ShowCombo() Else Opciones_Deshabilitar_BAñadir_Click(Nothing, e)
        ElseIf e.Button = MouseButtons.Right Then
            Opciones_Deshabilitar_TProceso.Text = "" : Opciones_Deshabilitar_LCProceso.Visible = False : Combo_IgnoreOne = True : Opciones_Deshabilitar_TProceso.ReadOnly = False : Opciones_Deshabilitar_TProceso.Enabled = True : Opciones_Deshabilitar_TProceso.Cursor = Cursors.IBeam : Opciones_Deshabilitar_TProceso.Focus()
        Else : HTexto.Focus() : End If
    End Sub

#End Region

#Region " TProceso "

    Private Sub Opciones_Deshabilitar_TProceso_GotFocus(sender As Object, e As EventArgs) Handles Opciones_Deshabilitar_TProceso.GotFocus
        If Opciones_Deshabilitar_LCProceso.Visible = True Then HTexto.Focus()
        If Opciones_Deshabilitar_TProceso.ForeColor1 = Color.FromArgb(72, 72, 72) Then Opciones_Deshabilitar_TProceso.Text = "" : Opciones_Deshabilitar_TProceso.ForeColor1 = Color.FromArgb(102, 102, 102)
        Texto_Focused = True
    End Sub

    Private Sub Opciones_Deshabilitar_TProceso_LostFocus(sender As Object, e As EventArgs) Handles Opciones_Deshabilitar_TProceso.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If Opciones_Deshabilitar_LCProceso.Visible = False Then Opciones_Deshabilitar_LCProceso.Visible = True : Opciones_Deshabilitar_TProceso.ReadOnly = True : Opciones_Deshabilitar_TProceso.Enabled = False : Opciones_Deshabilitar_TProceso.Cursor = Cursors.Arrow
        If Opciones_Deshabilitar_TProceso.Text.Length > 1 Then Opciones_Deshabilitar_TProceso.Text = Opciones_Deshabilitar_TProceso.Text.Trim.Substring(0, 1).ToUpper + Opciones_Deshabilitar_TProceso.Text.Trim.Substring(1) : Opciones_Deshabilitar_TProceso.SelectionLength = 0
        If Opciones_Deshabilitar_CCProcesos.Items.Count > 0 Then
            For Cuenta = 0 To Opciones_Deshabilitar_CCProcesos.Items.Count - 1
                If Opciones_Deshabilitar_CCProcesos.Items(Cuenta).ToLower = Opciones_Deshabilitar_TProceso.Text.ToLower Then GoTo Sigue
            Next
            Opciones_Deshabilitar_CCProcesos.SelectedItem = 0
            Opciones_Deshabilitar_TProceso.Text = Opciones_Deshabilitar_CCProcesos.Items(0)
Sigue:      Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text
        Else
            Opciones_Deshabilitar_TProceso.Text = ""
            Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text
        End If
    End Sub

    Private Sub Opciones_Deshabilitar_TProceso_KeyDown(sender As Object, e As KeyEventArgs) Handles Opciones_Deshabilitar_TProceso.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : Opciones_Deshabilitar_ShowCombo()
    End Sub

    Private Sub Opciones_Deshabilitar_TProceso_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Opciones_Deshabilitar_TProceso.KeyPress
        If Asc(e.KeyChar) = 13 Then
            Try : Dim Cuenta As Integer : e.Handled = True : Opciones_Deshabilitar_TProceso.Text = Opciones_Deshabilitar_TProceso.Text.Trim
                If Opciones_Deshabilitar_TProceso.Text <> "" Then
                    If Opciones_Deshabilitar_CCProcesos.Items.Count > 0 Then
                        For Cuenta = 0 To Opciones_Deshabilitar_CCProcesos.Items.Count - 1
                            If Opciones_Deshabilitar_CCProcesos.Items(Cuenta).ToLower = Opciones_Deshabilitar_TProceso.Text.ToLower Then Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text : HTexto.Focus() : Exit Sub
                        Next
                    End If
                    Opciones_Deshabilitar_CCProcesos.Items.Add(Opciones_Deshabilitar_TProceso.Text.Substring(0, 1).ToUpper + Opciones_Deshabilitar_TProceso.Text.Substring(1))
                    Opciones_Deshabilitar_CCProcesos.Enabled = True
                    Opciones_GuardarValor("Deshabilitar")
                Else
                    If Opciones_Deshabilitar_CCProcesos.Items.Count > 0 Then
                        Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text
                    Else
                        Opciones_Deshabilitar_TProceso.Text = ""
                        Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text
                    End If
                End If
            Catch : End Try : HTexto.Focus()
        End If
    End Sub

#End Region

#Region " CProcesos "

    Private Sub Opciones_Deshabilitar_ShowCombo()
        If Opciones_Deshabilitar_CCProcesos.Items.Count = 0 Then HTexto.Focus() : Exit Sub
        Opciones_Deshabilitar_CCProcesos.Sorted = True : Opciones_Deshabilitar_CCProcesos.Sorted = False
        Opciones_Deshabilitar_CCProcesos.MaxDropDownItems = 10
        If Opciones_Deshabilitar_CCProcesos.Items.Contains(Opciones_Deshabilitar_TProceso.Text) = True Then Opciones_Deshabilitar_CCProcesos.SelectedItem = Opciones_Deshabilitar_TProceso.Text Else Opciones_Deshabilitar_CCProcesos.SelectedIndex = 0
        Opciones_Deshabilitar_CCProcesos.DroppedDown = True : Combo_Dropped = True : Opciones_Deshabilitar_CCProcesos.Focus()
    End Sub

    Private Sub Opciones_Deshabilitar_CCProcesos_SelectionChangeCommitted(sender As Object, e As EventArgs) Handles Opciones_Deshabilitar_CCProcesos.SelectionChangeCommitted
        Opciones_Deshabilitar_TProceso.Text = Opciones_Deshabilitar_CCProcesos.SelectedItem.Trim
        Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text
        HTexto.Focus()
    End Sub

    Private Sub Opciones_Deshabilitar_CCProcesos_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Opciones_Deshabilitar_CCProcesos.KeyPress
        If Asc(e.KeyChar) = 13 Then Opciones_Deshabilitar_TProceso.Text = Opciones_Deshabilitar_CCProcesos.SelectedItem.Trim : Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub Opciones_Deshabilitar_CCProcesos_LostFocus(sender As Object, e As EventArgs) Handles Opciones_Deshabilitar_CCProcesos.LostFocus
        Combo_Dropped = False
    End Sub

#End Region

#Region " Añadir "

    Private Sub Opciones_Deshabilitar_BAñadir_Click(sender As Object, e As MouseEventArgs) Handles Opciones_Deshabilitar_BAñadir.Click
        If e IsNot Nothing AndAlso e.Button <> MouseButtons.Left Then Exit Sub
        Opciones_Deshabilitar_CProcesos.Items.Clear()
        For Each P As Process In Process.GetProcesses
            If NoAñadir.ToLower.Contains(P.ProcessName.ToLower + ",") = True Then GoTo Salta
            If P.ProcessName <> "" Then
                For Cuenta = 0 To Opciones_Deshabilitar_CCProcesos.Items.Count - 1
                    If Opciones_Deshabilitar_CCProcesos.Items(Cuenta).ToLower = P.ProcessName.ToLower Then GoTo Salta
                Next
                For Cuenta = 0 To Opciones_Deshabilitar_CProcesos.Items.Count - 1
                    If P.ProcessName.ToLower = Opciones_Deshabilitar_CProcesos.Items(Cuenta).ToString.ToLower Then GoTo Salta
                Next : Opciones_Deshabilitar_CProcesos.Items.Add(P.ProcessName.Substring(0, 1).ToUpper + P.ProcessName.Substring(1))
Salta:      End If
        Next
        If Opciones_Deshabilitar_CProcesos.Items.Count = 0 Then HTexto.Focus() : Exit Sub
        Opciones_Deshabilitar_CProcesos.Sorted = True : Opciones_Deshabilitar_CProcesos.Sorted = False
        Opciones_Deshabilitar_CProcesos.MaxDropDownItems = 10
        If Opciones_Deshabilitar_CProcesos.Items.Contains(Opciones_Deshabilitar_TProceso.Text) = True Then Opciones_Deshabilitar_CProcesos.SelectedItem = Opciones_Deshabilitar_TProceso.Text Else Opciones_Deshabilitar_CProcesos.SelectedIndex = 0
        Opciones_Deshabilitar_CProcesos.DroppedDown = True : Combo_Dropped = True : Opciones_Deshabilitar_CProcesos.Focus()
    End Sub

    Private Sub Opciones_Deshabilitar_CProcesos_SelectionChangeCommitted(sender As Object, e As EventArgs) Handles Opciones_Deshabilitar_CProcesos.SelectionChangeCommitted
        For Cuenta = 0 To Comandos_Procesos_CProceso.Items.Count - 1
            If Opciones_Deshabilitar_CCProcesos.Items(Cuenta).ToLower = Opciones_Deshabilitar_CProcesos.SelectedItem.ToString.ToLower.Trim Then HTexto.Focus() : Exit Sub
        Next
        Opciones_Deshabilitar_CCProcesos.Items.Add(Opciones_Deshabilitar_CProcesos.SelectedItem.Trim)
        Opciones_Deshabilitar_TProceso.Text = Opciones_Deshabilitar_CProcesos.SelectedItem.Trim
        Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text
        Opciones_Deshabilitar_CCProcesos.Enabled = True
        Opciones_GuardarValor("Deshabilitar")
        HTexto.Focus()
    End Sub

    Private Sub Opciones_Deshabilitar_CProcesos_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Opciones_Deshabilitar_CProcesos.KeyPress
        If Asc(e.KeyChar) = 13 Then Opciones_Deshabilitar_TProceso.Text = Opciones_Deshabilitar_CProcesos.SelectedItem.Trim : Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub Opciones_Deshabilitar_CProcesos_LostFocus(sender As Object, e As EventArgs) Handles Opciones_Deshabilitar_CProcesos.LostFocus
        Combo_Dropped = False
    End Sub

#End Region

#Region " Eliminar "

    Private Sub Opciones_Deshabilitar_BEliminar_Click(sender As Object, e As MouseEventArgs) Handles Opciones_Deshabilitar_BEliminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Opciones_Deshabilitar_CCProcesos.Items.Remove(Opciones_Deshabilitar_TProceso.Text)
        Opciones_GuardarValor("Deshabilitar")
        If Opciones_Deshabilitar_CCProcesos.Items.Count > 0 Then
            Opciones_Deshabilitar_CCProcesos.SelectedItem = 0
            Opciones_Deshabilitar_TProceso.Text = Opciones_Deshabilitar_CCProcesos.Items(0)
            Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text
        Else
            Opciones_Deshabilitar_CCProcesos.Enabled = False
            Opciones_Deshabilitar_TProceso.Text = ""
            Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text
        End If
    End Sub

#End Region

#Region " Examinar "

    Private Sub Opciones_Deshabilitar_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles Opciones_Deshabilitar_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar aplicacion..." : Abrir.Filter = "Aplicaciones|*.exe|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then
            Opciones_Deshabilitar_TProceso.Text = IO.Path.GetFileNameWithoutExtension(Abrir.FileName).Substring(0, 1).ToUpper + IO.Path.GetFileNameWithoutExtension(Abrir.FileName).Substring(1)
            Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text
            Dim Cuenta As Integer : Opciones_Deshabilitar_TProceso.Text = Opciones_Deshabilitar_TProceso.Text.Trim : If Opciones_Deshabilitar_TProceso.Text <> "" Then
                For Cuenta = 0 To Opciones_Deshabilitar_CCProcesos.Items.Count - 1
                    If Opciones_Deshabilitar_CCProcesos.Items(Cuenta).ToLower = Opciones_Deshabilitar_TProceso.Text.ToLower Then Exit Sub
                Next : Opciones_Deshabilitar_CCProcesos.Items.Add(Opciones_Deshabilitar_TProceso.Text.Substring(0, 1).ToUpper + Opciones_Deshabilitar_TProceso.Text.Substring(1))
                Opciones_GuardarValor("Deshabilitar")
                Opciones_Deshabilitar_TProceso.Text = Opciones_Deshabilitar_TProceso.Text.Substring(0, 1).ToUpper + Opciones_Deshabilitar_TProceso.Text.Substring(1)
                Opciones_Deshabilitar_LCProceso.Text = Opciones_Deshabilitar_TProceso.Text
                Opciones_Deshabilitar_CCProcesos.Enabled = True
            End If
        End If
        Opciones_Deshabilitar_BExaminar.State = NSButton.MouseState.None : Opciones_Deshabilitar_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

#End Region

#End Region

#End Region

#Region " UDP "

    Private Sub Opciones_UDP_Click(sender As Object, e As MouseEventArgs) Handles Opciones_UDP_LUDP.Click, Opciones_UDP_LUDP.DoubleClick, Opciones_UDP_CUDP.Click, Opciones_UDP_CUDP.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If TypeOf sender Is NSLabel Then If Opciones_UDP_CUDP.Checked = True Then Opciones_UDP_CUDP.Checked = False Else Opciones_UDP_CUDP.Checked = True
        Opciones_UDP = Opciones_UDP_CUDP.Checked : Opciones_GuardarValor("UDP")
        If Opciones_UDP = True Then
            Opciones_UDP_LPuerto.Enabled = True : Opciones_UDP_TPuerto.Enabled = True : Opciones_UDP_LEstado.Enabled = True ': Opciones_UDP_LEstado.ForeColor1 = Color.DarkGreen : Opciones_UDP_LEstado.Invalidate()
        Else
            Opciones_UDP_LPuerto.Enabled = False : Opciones_UDP_TPuerto.Enabled = False : Opciones_UDP_LEstado.Enabled = False : Opciones_UDP_LEstado.Text = "Offline" : Opciones_UDP_LEstado.ForeColor1 = Color.DarkRed : Opciones_UDP_LEstado.Invalidate()
        End If
    End Sub

    Private Sub Opciones_UDP_TPuerto_TextChanged(sender As Object, e As EventArgs) Handles Opciones_UDP_TPuerto.TextChanged
        If Opciones_UDP_TPuerto.Text.Trim = "" OrElse CInt(Opciones_UDP_TPuerto.Text) < 1000 Then Opciones_UDP_TPuerto.BorderColor = Color.Red : Opciones_UDP_TPuerto.Invalidate() : Exit Sub
        If CInt(Opciones_UDP_TPuerto.Text) >= 1000 Then If Opciones_UDP_TPuerto.BorderColor = Color.Red Then Opciones_UDP_TPuerto.BorderColor = Color.FromArgb(55, 55, 55) : Opciones_UDP_TPuerto.Invalidate()
    End Sub

    Private Sub Opciones_UDP_TPuerto_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Opciones_UDP_TPuerto.KeyPress
        If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar) Then e.Handled = True
        If Asc(e.KeyChar) = 13 Then e.Handled = True : HTexto.Focus()
    End Sub

    Private Sub Opciones_UDP_TPuerto_LostFocus(sender As Object, e As EventArgs) Handles Opciones_UDP_TPuerto.LostFocus
        ValidarPort()
        UDPClose() : Application.DoEvents() : UDPEscuchar()
    End Sub

    Private Sub ValidarPort()
        If Opciones_UDP_TPuerto.Text.Trim = "" OrElse CInt(Opciones_UDP_TPuerto.Text) < 1000 Then Opciones_UDP_TPuerto.Text = Opciones_UDP_Puerto.ToString : Opciones_UDP_TPuerto.BorderColor = Color.FromArgb(55, 55, 55) : Opciones_UDP_TPuerto.Invalidate()
        If CInt(Opciones_UDP_TPuerto.Text) >= 1000 Then Opciones_UDP_Puerto = Opciones_UDP_TPuerto.Text : Opciones_GuardarValor("UDP")
    End Sub

#End Region

#Region " Sabias Que "

    Private Sub Opciones_SabiasQue_PTipo_Click(sender As Object, e As MouseEventArgs) Handles Opciones_SabiasQue_PTipo.Click, Opciones_SabiasQue_PTipo.DoubleClick
        If e.Button = MouseButtons.Left Then
            If Redo_SabiasQue.Count = 0 Then SabiasQue_Random() Else Undo_SabiasQue.Push(SabiasQue_Indice) : SabiasQue_Indice = Redo_SabiasQue.Pop() : SabiasQue_Show()
        ElseIf e.Button = MouseButtons.Right Then
            If Undo_SabiasQue.Count = 0 Then Exit Sub
            Redo_SabiasQue.Push(SabiasQue_Indice) : SabiasQue_Indice = Undo_SabiasQue.Pop() : SabiasQue_Show()
        ElseIf e.Button = MouseButtons.Middle Then
            If SabiasQue_Lista.Count = 0 Or SabiasQue_Indice = -1 Then Exit Sub
            Clipboard.SetText("[" + SabiasQue_Lista(SabiasQue_Indice).Split("|")(0) + "] - " + SabiasQue_Lista(SabiasQue_Indice).Split("|")(1).Replace("–", "|") + vbCrLf + vbCrLf + SabiasQue_Lista(SabiasQue_Indice).Split("|")(2)) : Exit Sub
        End If : SabiasQue_Contador = 0
    End Sub

#End Region

#Region " Desactivar "

#Region " LCProceso "

    Private Sub Opciones_Desactivar_LCProceso_TextChanged(sender As Object, e As EventArgs) Handles Opciones_Desactivar_LCProceso.TextChanged
        Rutas.SetFontSize(Opciones_Desactivar_LCProceso, 8)
        Opciones_Desactivar_TProceso.Enabled = False
        If Opciones_Desactivar_TProceso.Text.Trim = "" AndAlso Opciones_Desactivar_CCProcesos.Items.Count = 0 Then Opciones_Desactivar_LCProceso.Text = "Seleccione una aplicación" : Opciones_Desactivar_TProceso.ForeColor1 = Color.FromArgb(72, 72, 72)
    End Sub

    Private Sub Opciones_Desactivar_LCProceso_Click(sender As Object, e As MouseEventArgs) Handles Opciones_Desactivar_LCProceso.Click, Opciones_Desactivar_LCProceso.DoubleClick, Opciones_Desactivar_TProceso.Click, Opciones_Desactivar_TProceso.DoubleClick
        If e.Button = MouseButtons.Left Then
            If Opciones_Desactivar_CCProcesos.Items.Count > 0 Then Opciones_Desactivar_ShowCombo() Else Opciones_Desactivar_BAñadir_Click(Nothing, e)
        ElseIf e.Button = MouseButtons.Right Then
            Opciones_Desactivar_TProceso.Text = "" : Opciones_Desactivar_LCProceso.Visible = False : Combo_IgnoreOne = True : Opciones_Desactivar_TProceso.ReadOnly = False : Opciones_Desactivar_TProceso.Enabled = True : Opciones_Desactivar_TProceso.Cursor = Cursors.IBeam : Opciones_Desactivar_TProceso.Focus()
        Else : HTexto.Focus() : End If
    End Sub

#End Region

#Region " TProceso "

    Private Sub Opciones_Desactivar_TProceso_GotFocus(sender As Object, e As EventArgs) Handles Opciones_Desactivar_TProceso.GotFocus
        If Opciones_Desactivar_LCProceso.Visible = True Then HTexto.Focus()
        If Opciones_Desactivar_TProceso.ForeColor1 = Color.FromArgb(72, 72, 72) Then Opciones_Desactivar_TProceso.Text = "" : Opciones_Desactivar_TProceso.ForeColor1 = Color.FromArgb(102, 102, 102)
        Texto_Focused = True
    End Sub

    Private Sub Opciones_Desactivar_TProceso_LostFocus(sender As Object, e As EventArgs) Handles Opciones_Desactivar_TProceso.LostFocus
        Texto_Focused = False
        If Combo_IgnoreOne = True Then Combo_IgnoreOne = False : Exit Sub
        If Opciones_Desactivar_LCProceso.Visible = False Then Opciones_Desactivar_LCProceso.Visible = True : Opciones_Desactivar_TProceso.ReadOnly = True : Opciones_Desactivar_TProceso.Enabled = False : Opciones_Desactivar_TProceso.Cursor = Cursors.Arrow
        If Opciones_Desactivar_TProceso.Text.Length > 1 Then Opciones_Desactivar_TProceso.Text = Opciones_Desactivar_TProceso.Text.Trim.Substring(0, 1).ToUpper + Opciones_Desactivar_TProceso.Text.Trim.Substring(1) : Opciones_Desactivar_TProceso.SelectionLength = 0
        If Opciones_Desactivar_CCProcesos.Items.Count > 0 Then
            For Cuenta = 0 To Opciones_Desactivar_CCProcesos.Items.Count - 1
                If Opciones_Desactivar_CCProcesos.Items(Cuenta).ToLower = Opciones_Desactivar_TProceso.Text.ToLower Then GoTo Sigue
            Next
            Opciones_Desactivar_CCProcesos.SelectedItem = 0
            Opciones_Desactivar_TProceso.Text = Opciones_Desactivar_CCProcesos.Items(0)
Sigue:      Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text
        Else
            Opciones_Desactivar_TProceso.Text = ""
            Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text
        End If
    End Sub

    Private Sub Opciones_Desactivar_TProceso_KeyDown(sender As Object, e As KeyEventArgs) Handles Opciones_Desactivar_TProceso.KeyDown
        If e.KeyCode = Keys.Down Or e.KeyCode = Keys.Up Then e.Handled = True : HTexto.Focus() : Opciones_Desactivar_ShowCombo()
    End Sub

    Private Sub Opciones_Desactivar_TProceso_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Opciones_Desactivar_TProceso.KeyPress
        If Asc(e.KeyChar) = 13 Then
            Try : Dim Cuenta As Integer : e.Handled = True : Opciones_Desactivar_TProceso.Text = Opciones_Desactivar_TProceso.Text.Trim
                If Opciones_Desactivar_TProceso.Text <> "" Then
                    If Opciones_Desactivar_CCProcesos.Items.Count > 0 Then
                        For Cuenta = 0 To Opciones_Desactivar_CCProcesos.Items.Count - 1
                            If Opciones_Desactivar_CCProcesos.Items(Cuenta).ToLower = Opciones_Desactivar_TProceso.Text.ToLower Then Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text : HTexto.Focus() : Exit Sub
                        Next
                    End If
                    Opciones_Desactivar_CCProcesos.Items.Add(Opciones_Desactivar_TProceso.Text.Substring(0, 1).ToUpper + Opciones_Desactivar_TProceso.Text.Substring(1))
                    Opciones_Desactivar_CCProcesos.Enabled = True
                    Opciones_GuardarValor("Desactivar")
                Else
                    If Opciones_Desactivar_CCProcesos.Items.Count > 0 Then
                        Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text
                    Else
                        Opciones_Desactivar_TProceso.Text = ""
                        Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text
                    End If
                End If
            Catch : End Try : HTexto.Focus()
        End If
    End Sub

#End Region

#Region " CProcesos "

    Private Sub Opciones_Desactivar_ShowCombo()
        If Opciones_Desactivar_CCProcesos.Items.Count = 0 Then HTexto.Focus() : Exit Sub
        Opciones_Desactivar_CCProcesos.Sorted = True : Opciones_Desactivar_CCProcesos.Sorted = False
        Opciones_Desactivar_CCProcesos.MaxDropDownItems = 10
        If Opciones_Desactivar_CCProcesos.Items.Contains(Opciones_Desactivar_TProceso.Text) = True Then Opciones_Desactivar_CCProcesos.SelectedItem = Opciones_Desactivar_TProceso.Text Else Opciones_Desactivar_CCProcesos.SelectedIndex = 0
        Opciones_Desactivar_CCProcesos.DroppedDown = True : Combo_Dropped = True : Opciones_Desactivar_CCProcesos.Focus()
    End Sub

    Private Sub Opciones_Desactivar_CCProcesos_SelectionChangeCommitted(sender As Object, e As EventArgs) Handles Opciones_Desactivar_CCProcesos.SelectionChangeCommitted
        Opciones_Desactivar_TProceso.Text = Opciones_Desactivar_CCProcesos.SelectedItem.Trim
        Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text
        HTexto.Focus()
    End Sub

    Private Sub Opciones_Desactivar_CCProcesos_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Opciones_Desactivar_CCProcesos.KeyPress
        If Asc(e.KeyChar) = 13 Then Opciones_Desactivar_TProceso.Text = Opciones_Desactivar_CCProcesos.SelectedItem.Trim : Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub Opciones_Desactivar_CCProcesos_LostFocus(sender As Object, e As EventArgs) Handles Opciones_Desactivar_CCProcesos.LostFocus
        Combo_Dropped = False
    End Sub

#End Region

#Region " Añadir "

    Private Sub Opciones_Desactivar_BAñadir_Click(sender As Object, e As MouseEventArgs) Handles Opciones_Desactivar_BAñadir.Click
        If e IsNot Nothing AndAlso e.Button <> MouseButtons.Left Then Exit Sub
        Opciones_Desactivar_CProcesos.Items.Clear()
        For Each P As Process In Process.GetProcesses
            If NoAñadir.ToLower.Contains(P.ProcessName.ToLower + ",") = True Then GoTo Salta
            If P.ProcessName <> "" Then
                For Cuenta = 0 To Opciones_Desactivar_CCProcesos.Items.Count - 1
                    If Opciones_Desactivar_CCProcesos.Items(Cuenta).ToLower = P.ProcessName.ToLower Then GoTo Salta
                Next
                For Cuenta = 0 To Opciones_Desactivar_CProcesos.Items.Count - 1
                    If P.ProcessName.ToLower = Opciones_Desactivar_CProcesos.Items(Cuenta).ToString.ToLower Then GoTo Salta
                Next : Opciones_Desactivar_CProcesos.Items.Add(P.ProcessName.Substring(0, 1).ToUpper + P.ProcessName.Substring(1))
Salta:      End If
        Next
        If Opciones_Desactivar_CProcesos.Items.Count = 0 Then HTexto.Focus() : Exit Sub
        Opciones_Desactivar_CProcesos.Sorted = True : Opciones_Desactivar_CProcesos.Sorted = False
        Opciones_Desactivar_CProcesos.MaxDropDownItems = 10
        If Opciones_Desactivar_CProcesos.Items.Contains(Opciones_Desactivar_TProceso.Text) = True Then Opciones_Desactivar_CProcesos.SelectedItem = Opciones_Desactivar_TProceso.Text Else Opciones_Desactivar_CProcesos.SelectedIndex = 0
        Opciones_Desactivar_CProcesos.DroppedDown = True : Combo_Dropped = True : Opciones_Desactivar_CProcesos.Focus()
    End Sub

    Private Sub Opciones_Desactivar_CProcesos_SelectionChangeCommitted(sender As Object, e As EventArgs) Handles Opciones_Desactivar_CProcesos.SelectionChangeCommitted
        For Cuenta = 0 To Comandos_Procesos_CProceso.Items.Count - 1
            If Opciones_Desactivar_CCProcesos.Items(Cuenta).ToLower = Opciones_Desactivar_CProcesos.SelectedItem.ToString.ToLower.Trim Then HTexto.Focus() : Exit Sub
        Next
        Opciones_Desactivar_CCProcesos.Items.Add(Opciones_Desactivar_CProcesos.SelectedItem.Trim)
        Opciones_Desactivar_TProceso.Text = Opciones_Desactivar_CProcesos.SelectedItem.Trim
        Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text
        Opciones_Desactivar_CCProcesos.Enabled = True
        Opciones_GuardarValor("Desactivar")
        HTexto.Focus()
    End Sub

    Private Sub Opciones_Desactivar_CProcesos_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Opciones_Desactivar_CProcesos.KeyPress
        If Asc(e.KeyChar) = 13 Then Opciones_Desactivar_TProceso.Text = Opciones_Desactivar_CProcesos.SelectedItem.Trim : Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text : HTexto.Focus() : e.Handled = True
    End Sub

    Private Sub Opciones_Desactivar_CProcesos_LostFocus(sender As Object, e As EventArgs) Handles Opciones_Desactivar_CProcesos.LostFocus
        Combo_Dropped = False
    End Sub

#End Region

#Region " Eliminar "

    Private Sub Opciones_Desactivar_BEliminar_Click(sender As Object, e As MouseEventArgs) Handles Opciones_Desactivar_BEliminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Opciones_Desactivar_CCProcesos.Items.Remove(Opciones_Desactivar_TProceso.Text)
        Opciones_GuardarValor("Desactivar")
        If Opciones_Desactivar_CCProcesos.Items.Count > 0 Then
            Opciones_Desactivar_CCProcesos.SelectedItem = 0
            Opciones_Desactivar_TProceso.Text = Opciones_Desactivar_CCProcesos.Items(0)
            Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text
        Else
            Opciones_Desactivar_CCProcesos.Enabled = False
            Opciones_Desactivar_TProceso.Text = ""
            Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text
        End If
    End Sub

#End Region

#Region " Examinar "

    Private Sub Opciones_Desactivar_BExaminar_Click(sender As Object, e As MouseEventArgs) Handles Opciones_Desactivar_BExaminar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Seleccionar aplicacion..." : Abrir.Filter = "Aplicaciones|*.exe|Todos los Archivos|*.*"
        If Abrir.ShowDialog <> DialogResult.Cancel Then
            Opciones_Desactivar_TProceso.Text = IO.Path.GetFileNameWithoutExtension(Abrir.FileName).Substring(0, 1).ToUpper + IO.Path.GetFileNameWithoutExtension(Abrir.FileName).Substring(1)
            Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text
            Dim Cuenta As Integer : Opciones_Desactivar_TProceso.Text = Opciones_Desactivar_TProceso.Text.Trim : If Opciones_Desactivar_TProceso.Text <> "" Then
                For Cuenta = 0 To Opciones_Desactivar_CCProcesos.Items.Count - 1
                    If Opciones_Desactivar_CCProcesos.Items(Cuenta).ToLower = Opciones_Desactivar_TProceso.Text.ToLower Then Exit Sub
                Next : Opciones_Desactivar_CCProcesos.Items.Add(Opciones_Desactivar_TProceso.Text.Substring(0, 1).ToUpper + Opciones_Desactivar_TProceso.Text.Substring(1))
                Opciones_GuardarValor("Desactivar")
                Opciones_Desactivar_TProceso.Text = Opciones_Desactivar_TProceso.Text.Substring(0, 1).ToUpper + Opciones_Desactivar_TProceso.Text.Substring(1)
                Opciones_Desactivar_LCProceso.Text = Opciones_Desactivar_TProceso.Text
                Opciones_Desactivar_CCProcesos.Enabled = True
            End If
        End If
        Opciones_Desactivar_BExaminar.State = NSButton.MouseState.None : Opciones_Desactivar_BExaminar.Invalidate() : HTexto.Focus()
    End Sub

#End Region

#Region " CTRL + RClick "

    Private Sub LCTRLClick_Click(sender As Object, e As MouseEventArgs) Handles LCTRLClick.Click, LSHIFTClick.Click
        If e.Button = MouseButtons.Left AndAlso Form.ModifierKeys = Keys.Control Then
            Dim ProcessList As New List(Of String)
            For Each P As Process In Process.GetProcesses
                If NoAñadir.ToLower.Contains(P.ProcessName.ToLower + ",") = True Then GoTo Salta
                If P.ProcessName <> "" Then
                    For Cuenta = 0 To Opciones_Desactivar_CCProcesos.Items.Count - 1
                        If Opciones_Desactivar_CCProcesos.Items(Cuenta).ToLower = P.ProcessName.ToLower Then GoTo Salta
                    Next
                    For Cuenta = 0 To ProcessList.Count - 1
                        If ProcessList(Cuenta).ToLower = P.ProcessName.ToLower Then GoTo Salta
                    Next : ProcessList.Add(P.ProcessName.Substring(0, 1).ToUpper + P.ProcessName.Substring(1))
Salta:          End If
            Next
            Dim GuardarFile As New SaveFileDialog : GuardarFile.CheckPathExists = True
            GuardarFile.Title = "Guardar Procesos" : GuardarFile.Filter = "Documento de texto|*.txt|Todos los Archivos|*.*" : GuardarFile.FileName = "Procesos"
            If GuardarFile.ShowDialog <> DialogResult.Cancel Then
                Dim Guardar As New IO.StreamWriter(GuardarFile.FileName)
                For Cuenta = 0 To ProcessList.Count - 1
                    Guardar.WriteLine(ProcessList(Cuenta))
                Next : Guardar.Close()
            End If
        End If
    End Sub

#End Region

#End Region

#Region " Serial "

    Private Sub Opciones_Serial_PSerial_Click(sender As Object, e As MouseEventArgs) Handles Opciones_Version_PSerial.Click, Opciones_Version_BRegistrar.Click
        If e.Button <> MouseButtons.Left Then Exit Sub
        FSerial.Editado = True : FSerial.Serial = Opciones_Version_Serial : FSerial.TNombre.Text = Opciones_Version_Serial : If Opciones_Version_Serial = "invalid" Or Opciones_Version_LCorreo.Text = "Periodo de Prueba" Or Opciones_Version_LCorreo.Text = "Serial Oro" Then FSerial.TNombre.Text = ""
        FSerial.ShowDialog() : If FSerial.Cancelado = "No" Then
            Opciones_Version_Serial = FSerial.Serial : Opciones_GuardarValor("Serial")
Salta2:     Dim DSerial As String = Serial_Decrypt(Opciones_Version_Serial) : If DSerial.Contains("|") Then
                If DSerial.Split("|").Length = 3 Then Opciones_Version_Registro = DSerial.Split("|")(0) : Opciones_Version_Validez = CDate(DSerial.Split("|")(2))
                Opciones_Version_LCorreo.Text = Opciones_Version_Registro : Opciones_Version_LCorreo.ForeColor1 = Color.Gray
                If Opciones_Version_LCorreo.Text = "" Then Opciones_Version_LCorreo.Text = "Sin Datos"
                Opciones_Version_LFecha.Text = Opciones_Version_Validez.ToShortDateString
                If Opciones_Version_LFecha.Text = "31/12/2099" Then Opciones_Version_LFecha.Text = "Sin Límite" : Opciones_Version_LCorreo.Text = "Serial Oro" : Opciones_Version_LCorreo.ForeColor1 = Color.FromArgb(205, 150, 0)
                If Opciones_Version_LFecha.Text = "01/01/0001" Then Opciones_Version_LFecha.Text = "Sin Datos"
                If Opciones_Version_LCorreo.Text = "trial" Or Opciones_Version_LCorreo.Text = "Sin Datos" Then Opciones_Version_BRegistrar.Visible = True Else Opciones_Version_BRegistrar.Visible = False
                If Opciones_Version_LCorreo.Text <> "trial" And Opciones_Version_LCorreo.Text <> "Sin Datos" Then Opciones_Version_PSerial.Visible = True Else Opciones_Version_PSerial.Visible = False
                If Opciones_Version_LCorreo.Text = "trial" Then Opciones_Version_LCorreo.Text = "Periodo de Prueba"
                Opciones_Version_LCorreo.Invalidate() : Opciones_Version_LFecha.Invalidate()
                If Opciones_Version_LCorreo.Text <> "Sin Datos" And Opciones_Version_LCorreo.Text <> "Periodo de Prueba" Then Logros.Desbloquear("Usuario Registrado")
            End If
        End If
    End Sub

#End Region

#Region " Ayuda / Logros / Importar / Exportar "

    Private Sub PAyuda_Click(sender As Object, e As MouseEventArgs) Handles PAyuda.Click, PAyuda.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        FAyuda.Show()
    End Sub

    Private Sub PLogros_Click(sender As Object, e As MouseEventArgs) Handles PLogros.Click, PLogros.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        If Control.ModifierKeys = Keys.Control Then
            If ShowMessageBox("¿Resetar todos los logros y estadisticas?", Version, MsgBoxStyle.YesNo,) = DialogResult.OK Then
                ShowMessageBox("Los logros y estadisticas se han resetado", Version,)
                Logros.Reset() : Estadisticas.Reset() : If FLogros.Visible = True Then FLogros.Actualizar_Logros() : FLogros.Actualizar_Estadisticas()
            End If : Exit Sub
        End If : FLogros.Show()
    End Sub

    Private Sub PImportar_Click(sender As Object, e As MouseEventArgs) Handles PImportar.Click, PImportar.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Abrir As New OpenFileDialog : Abrir.CheckFileExists = True : Abrir.CheckPathExists = True
        Abrir.Title = "Importar datos de K-Desktop" : Abrir.Filter = "Backup de K-Desktop|*.kdt"
        If Abrir.ShowDialog <> DialogResult.Cancel Then
            FImportar.ShowDialog() : Dim Modo As String = FImportar.Modo
            If Modo = "Cancelar" Then Exit Sub
            If IO.Directory.Exists(KobaPathTemp + "Importar") = True Then IO.Directory.Delete(KobaPathTemp + "Importar", True)
            IO.Compression.ZipFile.ExtractToDirectory(Abrir.FileName, KobaPathTemp + "Importar")
            Select Case Modo
                Case "Reemplazar"
                    Registro.DelReg(RegPath + "")
                    If IO.Directory.Exists(KobaPath + "BATs") = True Then IO.Directory.Delete(KobaPath + "BATs", True)
                    If IO.Directory.Exists(KobaPath + "MACROs") = True Then IO.Directory.Delete(KobaPath + "MACROs", True)
                    If IO.Directory.Exists(KobaPath + "Iconos") = True Then IO.Directory.Delete(KobaPath + "Iconos", True)
                    My.Computer.FileSystem.CopyDirectory(KobaPathTemp + "Importar\BATs", KobaPath + "BATs", True)
                    My.Computer.FileSystem.CopyDirectory(KobaPathTemp + "Importar\MACROs", KobaPath + "MACROs", True)
                    My.Computer.FileSystem.CopyDirectory(KobaPathTemp + "Importar\Iconos", KobaPath + "Iconos", True)
                Case "Combinar"
                    My.Computer.FileSystem.CopyDirectory(KobaPathTemp + "Importar\BATs", KobaPath + "BATs", True)
                    My.Computer.FileSystem.CopyDirectory(KobaPathTemp + "Importar\MACROs", KobaPath + "MACROs", True)
                    My.Computer.FileSystem.CopyDirectory(KobaPathTemp + "Importar\Iconos", KobaPath + "Iconos", True)
            End Select
            Shell("Reg Import " + KobaPathTemp + "Importar\KDesktop4.reg")
            Dim Contador As Integer : Do Until Contador > 5 : Application.DoEvents() : Threading.Thread.Sleep(100) : Contador += 1 : Loop
            Comandos_Cargar() : KBoards_Cargar() : Cache_Limpiar()
            Opciones_Cargar() : Opciones_Mostrar() : Logros.Cargar(RegPath) : Estadisticas.Cargar(RegPath)
            Logros.Desbloquear("Inmigrante")
        End If
    End Sub

    Private Sub PExportar_Click(sender As Object, e As MouseEventArgs) Handles PExportar.Click, PExportar.DoubleClick
        If e.Button <> MouseButtons.Left Then Exit Sub
        Dim Guardar As New SaveFileDialog : Guardar.CheckPathExists = True : Guardar.FileName = Version + ".kdt"
        Guardar.Title = "Exportar datos de K-Desktop" : Guardar.Filter = "Backup de K-Desktop|*.kdt"
        If Guardar.ShowDialog <> DialogResult.Cancel Then
            Logros.Desbloquear("Emigrante")
            If IO.Directory.Exists(KobaPathTemp + "Exportar") = True Then IO.Directory.Delete(KobaPathTemp + "Exportar", True)
            IO.Directory.CreateDirectory(KobaPathTemp + "Exportar")
            Shell("Reg Export HKey_Current_User\Software\KDesktop4 """ + KobaPathTemp + "Exportar\KDesktop4.reg" + """ /Y")
            Dim Contador As Integer : Do Until IO.File.Exists(KobaPathTemp + "Exportar\KDesktop4.reg") = True Or Contador > 5 : Application.DoEvents() : Threading.Thread.Sleep(100) : Contador += 1 : Loop
            My.Computer.FileSystem.CopyDirectory(KobaPath + "BATs", KobaPathTemp + "Exportar\BATs", True)
            My.Computer.FileSystem.CopyDirectory(KobaPath + "MACROs", KobaPathTemp + "Exportar\MACROs", True)
            My.Computer.FileSystem.CopyDirectory(KobaPath + "Iconos", KobaPathTemp + "Exportar\Iconos", True)
            IO.Compression.ZipFile.CreateFromDirectory(KobaPathTemp + "Exportar", Guardar.FileName, IO.Compression.CompressionLevel.Optimal, False)
        End If
    End Sub

    Private Sub PBotones_MouseEnter(sender As Object, e As EventArgs) Handles PAyuda.MouseEnter, PLogros.MouseEnter, PImportar.MouseEnter, PExportar.MouseEnter
        Select Case sender.Name
            Case "PAyuda" : PAyuda.Image = My.Resources.Ayuda_On
            Case "PLogros" : PLogros.Image = My.Resources.Logros_On
            Case "PImportar" : PImportar.Image = My.Resources.Importar_On
            Case "PExportar" : PExportar.Image = My.Resources.Exportar_On
        End Select
    End Sub

    Private Sub PBotones_MouseLeave(sender As Object, e As EventArgs) Handles PAyuda.MouseLeave, PLogros.MouseLeave, PImportar.MouseLeave, PExportar.MouseLeave
        Select Case sender.Name
            Case "PAyuda" : PAyuda.Image = My.Resources.Ayuda_Off
            Case "PLogros" : PLogros.Image = My.Resources.Logros_Off
            Case "PImportar" : PImportar.Image = My.Resources.Importar_Off
            Case "PExportar" : PExportar.Image = My.Resources.Exportar_Off
        End Select
    End Sub

#End Region

#Region " Notify Menu "

    Private Sub NotifyIcon_DoubleClick(sender As Object, e As MouseEventArgs) Handles NotifyIcon.DoubleClick
        IconoMenu.Close() : If e.Button <> MouseButtons.Left Then Exit Sub
        If Opacity = 0 Then ShowF("Show") Else ShowF("Hide")
    End Sub

    Private Sub NotifyIcon_Click(sender As Object, e As MouseEventArgs) Handles NotifyIcon.Click
        If e.Button = MouseButtons.Middle Then
            IconoMenu.Close()
            ShowMessageBox(Version + " by Kobayashi (2022)", Version, MsgBoxStyle.OkOnly, "Aceptar")
            Logros.Desbloquear("Arqueologo de los mensajes")
        End If
        If e.Button = MouseButtons.Left AndAlso Opacity = 1 Then ShowF("Show") : IconoMenu.Close()
    End Sub

    Private Sub IconoMenu_Opening(sender As Object, e As ComponentModel.CancelEventArgs) Handles IconoMenu.Opening
        IconoMenu.Height = 54 : NMKDesktop.Width = 74 : NMSalir.Width = 74
    End Sub

    Private Sub NMKDesktop_Click(sender As Object, e As EventArgs) Handles NMKDesktop.Click
        ShowF("Show")
    End Sub

    Private Sub NMSalir_Click(sender As Object, e As EventArgs) Handles NMSalir.Click
        ShowF("Salir")
    End Sub

    Private Sub NMItem_MouseEnter(sender As Object, e As EventArgs) Handles NMKDesktop.MouseEnter, NMSalir.MouseEnter
        Dim QMItem As ToolStripMenuItem = CType(sender, ToolStripMenuItem) : QMItem.ForeColor = Color.FromArgb(205, 150, 0)
    End Sub

    Private Sub NMItem_MouseLeave(sender As Object, e As EventArgs) Handles NMKDesktop.MouseLeave, NMSalir.MouseLeave
        Dim QMItem As ToolStripMenuItem = CType(sender, ToolStripMenuItem) : QMItem.ForeColor = Color.FromArgb(130, 130, 130)
    End Sub

#End Region

#Region " Tooltips "

    Private Sub Opciones_Tooltips(sender As Object, e As EventArgs) Handles Opciones_IniciarWindows_CIniciarWindows.MouseEnter, Opciones_IniciarWindows_LIniciarWindows.MouseEnter, Opciones_IniciarWindows_LModo.MouseEnter, Opciones_IniciarWindows_TModo.MouseEnter, Opciones_IconoSistema_CIconoSistema.MouseEnter, Opciones_IconoSistema_LIconoSistema.MouseEnter, Opciones_IconoSistema_PIconoSistema.MouseEnter, Opciones_DisableXButton_CDisableXButton.MouseEnter, Opciones_DisableXButton_LDisableXButton.MouseEnter, Opciones_UDP_CUDP.MouseEnter, Opciones_UDP_LUDP.MouseEnter, Opciones_UDP_LPuerto.MouseEnter, Opciones_UDP_LEstado.MouseEnter, PAyuda.MouseEnter, PLogros.MouseEnter, PImportar.MouseEnter, PExportar.MouseEnter, Opciones_MensajeIniciar_LMensaje.MouseEnter, Opciones_MensajeIniciar_BOSD.MouseEnter, Opciones_MensajeIniciar_LSonido.MouseEnter, Opciones_MensajeIniciar_BPlay.MouseEnter, Opciones_MensajeIniciar_BExaminar.MouseEnter, Opciones_SabiasQue_PTipo.MouseEnter, Opciones_Version_PSerial.MouseEnter, Opciones_Version_LCorreo.MouseEnter, Opciones_Version_LRegistrado.MouseEnter, Opciones_Version_LFecha.MouseEnter, Opciones_Version_LValido.MouseEnter, Opciones_Version_LVersion.MouseEnter, Opciones_Version_LCVersion.MouseEnter, Opciones_Deshabilitar_BAñadir.MouseEnter, Opciones_Deshabilitar_BEliminar.MouseEnter, Opciones_Deshabilitar_BExaminar.MouseEnter, Opciones_Deshabilitar_LCProceso.MouseEnter, Opciones_Desactivar_BAñadir.MouseEnter, Opciones_Desactivar_BEliminar.MouseEnter, Opciones_Desactivar_BExaminar.MouseEnter, Opciones_Desactivar_LCProceso.MouseEnter, Opciones_MensajeIniciar_LCSonido.MouseEnter
        Select Case sender.Name.Replace("_C", "_").Replace("_L", "_")
            Case "Opciones_MensajeIniciar_Mensaje" : Show_Tooltip(sender, "Mensaje que se muestra al iniciarse K-Desktop")
            Case "Opciones_MensajeIniciar_BOSD" : Show_Tooltip(sender, "Click Izquierdo: Cambiar la fuente" + vbCrLf + "Click Derecho: Cambiar el color" + vbCrLf + "Click Central: Valores predeterminados")
            Case "Opciones_MensajeIniciar_Sonido" : Show_Tooltip(sender, "Sonido que se reproduce al iniciarse K-Desktop")
            Case "Opciones_MensajeIniciar_CSonido" : Show_Tooltip(sender, "Sonido que se reproduce al iniciarse K-Desktop" + vbCrLf + vbCrLf + "Click Derecho: Editar manualmente")
            Case "Opciones_MensajeIniciar_BPlay" : Show_Tooltip(sender, "Reproduce el sonido seleccionado")
            Case "Opciones_MensajeIniciar_BExaminar" : Show_Tooltip(sender, "Seleccionar un archivo de audio")
            Case "Opciones_SabiasQue_PTipo" : Show_Tooltip(sender, "Click Izquierdo: Mostrar siguiente" + vbCrLf + "Click Derecho: Mostrar anterior" + vbCrLf + "Click Central: Copiar al portapapeles")
            Case "Opciones_Version_PSerial" : Show_Tooltip(sender, "Permite ver o cambiar el número de licencia de K-Desktop")
            Case "Opciones_Version_Correo", "Opciones_Version_Registrado"
                If Opciones_Version_LCorreo.Text = "Serial Oro" Then
                    Show_Tooltip(sender, "K-Desktop está registrado con una 'Licencia Oro'")
                ElseIf Opciones_Version_LCorreo.Text = "Periodo de Prueba" Then
                    Show_Tooltip(sender, "K-Desktop está en 'Periodo de Prueba'")
                ElseIf Opciones_Version_LCorreo.Text = "Sin Datos" Then
                    Show_Tooltip(sender, "No hay datos de la licencia")
                Else
                    Show_Tooltip(sender, "Dirección de e-mail vinculada a la licencia de K-Desktop")
                End If
            Case "Opciones_Version_Fecha", "Opciones_Version_Valido"
                If Opciones_Version_LCorreo.Text = "Serial Oro" Then
                    Show_Tooltip(sender, "La lincencia es válidad hasta el fin de los tiempos")
                ElseIf Opciones_Version_LCorreo.Text = "Periodo de Prueba" Then
                    Show_Tooltip(sender, "Fecha en la termina el periodo de prueba")
                Else
                    Show_Tooltip(sender, "Fecha en la que termina la licencia activa")
                End If
            Case "Opciones_Version_Version", "Opciones_Version_CVersion" : Show_Tooltip(sender, "Versión actual de K-Desktop")
            Case "Opciones_Version_ActualizacionesAutomaticas" : Show_Tooltip(sender, "Permite actualizar K-Desktop automáticamente")
            Case "PAyuda" : Show_Tooltip(sender, "Muestra la ayuda de K-Desktop")
            Case "PLogros" : Show_Tooltip(sender, "Muestra los logros y estadisticas de K-Desktop")
            Case "PImportar" : Show_Tooltip(sender, "Importar datos en K-Desktop")
            Case "PExportar" : Show_Tooltip(sender, "Exportar datos de K-Desktop")

            Case "Opciones_IniciarWindows_IniciarWindows" : Show_Tooltip(sender, "Inicia K-Desktop cuando arranca el sistema")
            Case "Opciones_IniciarWindows_Modo" : Show_Tooltip(sender, "Modo en el que si iniciará K-Desktop")
            Case "Opciones_IniciarWindows_TModo" : Show_Tooltip(sender, "Programado: Se inicia a traves del programador de tareas" + vbCrLf + "Registro: Se inicia a traves del registro de Windows")
            Case "Opciones_IconoSistema_IconoSistema" : Show_Tooltip(sender, "Muestra un icono en la bandeja del sistema")
            Case "Opciones_IconoSistema_PIconoSistema" : Show_Tooltip(sender, "Icono que se mostrará en la bandeja del sistema" + vbCrLf + vbCrLf + "Click Izquierdo: Seleccionar un icono" + vbCrLf + "Click Derecho: Mostrar el menú desplegable" + vbCrLf + "Click Central: Establecer icono predeterminado")
            Case "Opciones_DisableXButton_DisableXButton" : Show_Tooltip(sender, "Deshabilita los botones laterales del ratón" + vbCrLf + "en las aplicaciones añadidas a la lista")
            Case "Opciones_Deshabilitar_CProceso" : If Opciones_Deshabilitar_LCProceso.Text = "Seleccione una aplicación" Then Show_Tooltip(sender, "Añade un proceso que esté en ejecución a la lista de procesos" + vbCrLf + vbCrLf + "Se deshabilitarán los botones laterales del ratón en estos procesos") Else Show_Tooltip(sender, "Procesos en los que se deshabilitarán los botones laterales del ratón")
            Case "Opciones_Deshabilitar_BAñadir" : Show_Tooltip(sender, "Añade un proceso que esté en ejecución a la lista de procesos")
            Case "Opciones_Deshabilitar_BEliminar" : Show_Tooltip(sender, "Elimina el proceso seleccionado de la lista de procesos")
            Case "Opciones_Deshabilitar_BExaminar" : Show_Tooltip(sender, "Añade un archivo ejecutable a la lista de procesos")
            Case "Opciones_UDP_UDP" : Show_Tooltip(sender, "Activa el servidor UDP para ejecutar comandos remotos")
            Case "Opciones_UDP_Puerto" : Show_Tooltip(sender, "Puerto que se usará para recibir los comandos remotos")
            Case "Opciones_UDP_Estado" : Show_Tooltip(sender, "Estado actual del servidor UDP")
            Case "Opciones_Desactivar_CProceso" : If Opciones_Desactivar_LCProceso.Text = "Seleccione una aplicación" Then Show_Tooltip(sender, "Añade un proceso que esté en ejecución a la lista de procesos" + vbCrLf + vbCrLf + "Los 'Hotkeys' de K-Desktop se ignorarán en estos procesos" + vbCrLf + "excepto si está marcada la opción 'Ejecutar Siempre'") Else Show_Tooltip(sender, "Procesos en los que se desactivará K-Desktop" + vbCrLf + vbCrLf + "Los 'Hotkeys' de K-Desktop se ignorarán en estos procesos" + vbCrLf + "excepto si está marcada la opción 'Ejecutar Siempre'")
            Case "Opciones_Desactivar_BAñadir" : Show_Tooltip(sender, "Añade un proceso que esté en ejecución a la lista de procesos")
            Case "Opciones_Desactivar_BEliminar" : Show_Tooltip(sender, "Elimina el proceso seleccionado de la lista de procesos")
            Case "Opciones_Desactivar_BExaminar" : Show_Tooltip(sender, "Añade un archivo ejecutable a la lista de procesos")
        End Select
    End Sub

#End Region

#End Region

#End Region

#End Region

#Region " Loggers "

#Region " UDP "

#Region " Escuchar "

    Dim UDP_Threading As New Threading.Thread(AddressOf UDP_Thread)

    Private Sub UDPEscuchar()
        Try : If UDPCliente IsNot Nothing Then UDPCliente.Close()
            UDPCliente = New Net.Sockets.UdpClient()
            UDPCliente.Client.SetSocketOption(Net.Sockets.SocketOptionLevel.Socket, Net.Sockets.SocketOptionName.ReuseAddress, True)
            UDPCliente.Client.Bind(New Net.IPEndPoint(Net.IPAddress.Any, Opciones_UDP_Puerto))
            If UDP_Threading IsNot Nothing AndAlso (UDP_Threading.ThreadState = Threading.ThreadState.Unstarted Or UDP_Threading.ThreadState = Threading.ThreadState.Aborted Or UDP_Threading.ThreadState = Threading.ThreadState.Stopped) Then
                UDP_Threading = New Threading.Thread(AddressOf UDP_Thread)
                UDP_Threading.IsBackground = True
                UDP_Threading.Start()
            End If
        Catch : UDPCliente = Nothing : End Try 'ShowOSD("No se puede crear el Servidor UDP") : End Try
    End Sub

    Private Sub UDPClose()
        If UDPCliente IsNot Nothing Then UDPCliente.Close()
    End Sub

    Private Sub UDP_Thread()
        Dim UDPInfo As UDPST
        Do : Try : Dim bytRecieved As Byte() = UDPCliente.Receive(UDPRemoteEndPoint) : UDPComando = System.Text.Encoding.ASCII.GetString(bytRecieved).Replace(vbCrLf, "")
                If UDPRemoteEndPoint IsNot Nothing AndAlso UDPComando <> "" Then
                    If Opciones_UDP = True Or (Opciones_UDP = False AndAlso UDPRemoteEndPoint.Address.ToString = "127.0.0.1") Then
                        UDPInfo.Comando = UDPComando
                        UDPInfo.RemoteEndPoint = UDPRemoteEndPoint
                        UDP_EjecutarComando(UDPInfo) : UDPComando = ""
                    End If
                End If
            Catch : Exit Do : End Try
        Loop : UDPClose() : Application.DoEvents() : UDPEscuchar()
    End Sub

#End Region

#Region " Enviar "

    Public Sub UDPEnviar(cMensaje As String, cDireccionIP As String, Optional cPuerto As Integer = 0)
        Try : If cPuerto = 0 Then cPuerto = Opciones_UDP_Puerto
            Dim server As New Net.Sockets.Socket(Net.Sockets.AddressFamily.InterNetwork, Net.Sockets.SocketType.Dgram, Net.Sockets.ProtocolType.Udp)
            Dim Data() As Byte = System.Text.Encoding.ASCII.GetBytes(cMensaje)
            server.SendTo(Data, Data.Length, Net.Sockets.SocketFlags.None, New Net.IPEndPoint(Net.IPAddress.Parse(cDireccionIP), cPuerto)) : server.Close()
        Catch : End Try
    End Sub

    Private Sub UDPEnviar(UDPMensaje As String, UDPRemote As Net.IPEndPoint)
        Try : Dim server As New Net.Sockets.Socket(Net.Sockets.AddressFamily.InterNetwork, Net.Sockets.SocketType.Dgram, Net.Sockets.ProtocolType.Udp)
            Dim Data() As Byte = System.Text.Encoding.ASCII.GetBytes(UDPMensaje)
            server.SendTo(Data, Data.Length, Net.Sockets.SocketFlags.None, UDPRemote) : server.Close()
        Catch : End Try
    End Sub

#End Region

#Region " UDP Comandos "

    Private Sub UDP_EjecutarComando(UDPInfo As UDPST)
        Dim Done As Boolean : Dim Ejecutado As Boolean = True

        If UDPInfo.Comando.ToLower = "show kdesktop" Then ShowF() : Estadisticas.Estadisticas.Comandos_UDP += 1 : Estadisticas.Guardar() : Exit Sub

        Dim Contador As Integer

        'Listar Comandos
        If UDPInfo.Comando.ToLower = "list" Or UDPInfo.Comando.ToLower = "lista" Or UDPInfo.Comando.ToLower = "comandos" Or UDPInfo.Comando.ToLower = "commands" Or UDPInfo.Comando.ToLower = "help" Or UDPInfo.Comando.ToLower = "ayuda" Or UDPInfo.Comando.ToLower = "0" Then
            Estadisticas.Estadisticas.Comandos_UDP += 1 : Estadisticas.Guardar()
            Dim ListaUDPComandos As String = vbCrLf + vbCrLf + "---------------[" + Version.ToUpper + "] - [" + Environment.MachineName + "]---------------" + vbCrLf

            ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Comandos, Lista, List"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Play/Pause"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Next"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Previous"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Subir Volumen"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Bajar Volumen"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Sileciar Volumen"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Enter"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Close"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Up"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Down"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Left"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Right"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Tasks"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Refresh"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Fullscreen"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Subs-"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Subs+"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Sync-"
            Contador += 1 : ListaUDPComandos += vbCrLf + "[" + Contador.ToString + "] - " + "Sync+"
            ListaUDPComandos += vbCrLf + vbCrLf + "SendKey [Letra], SK [Letra]"

            ListaUDPComandos += vbCrLf + vbCrLf + "---------------[COMANDOS]---------------" + vbCrLf
            Contador = 20 : For Cuenta = 0 To Comandos.Length - 1 : ListaUDPComandos += vbCrLf + "[" + (Contador + Cuenta).ToString + "] - " + Comandos(Cuenta).Nombre : Next

            UDPEnviar("[" + Comandos.Length.ToString + "] - " + UDPInfo.Comando + " (done)" + ListaUDPComandos, UDPInfo.RemoteEndPoint) : Exit Sub
        End If
        'Por Indice
        If UDPInfo.Comando.Replace(" ", "").All(AddressOf Char.IsDigit) = True Then
            Dim Indice As Integer = UDPInfo.Comando.Replace(" ", "")
            'If Indice < UDPComandos.Length + 19 And UDPComandos(Indice).Accion.ToLower <> "tasks" Then If Deshabilitado(UDPComandos(Indice).Comando) = True Then UDPEnviar("[" + Indice.ToString + "] - " + UDPComandos(Indice).Nombre + " (deshabilitado)", UDPInfo.RemoteEndPoint) : Exit Sub
            If Indice = 1 Then 'Play/Pause
                UDPEnviar("[" + Indice.ToString + "] - " + "Play/Pause" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.MediaPlayPause) : If UDPTaskSwitch = True Then Keyboard.Send_KeyUp(Keys.LMenu) : UDPTaskSwitch = False
            ElseIf Indice = 2 Then 'Next
                UDPEnviar("[" + Indice.ToString + "] - " + "Next" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.MediaNextTrack)
            ElseIf Indice = 3 Then 'Previous
                UDPEnviar("[" + Indice.ToString + "] - " + "Previous" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.MediaPreviousTrack)
            ElseIf Indice = 4 Then 'Subir Volumen
                UDPEnviar("[" + Indice.ToString + "] - " + "Subir Volumen" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.VolumeUp)
            ElseIf Indice = 5 Then 'Bajar Volumen
                UDPEnviar("[" + Indice.ToString + "] - " + "Bajar Volumen" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.VolumeDown)
            ElseIf Indice = 6 Then 'Silenciar Volumen
                UDPEnviar("[" + Indice.ToString + "] - " + "Silenciar Volumen" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.VolumeMute)
            ElseIf Indice = 7 Then 'Enter
                UDPEnviar("[" + Indice.ToString + "] - " + "Enter" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Enter) : If UDPTaskSwitch = True Then Keyboard.Send_KeyUp(Keys.LMenu) : UDPTaskSwitch = False
            ElseIf Indice = 8 Then 'Close
                UDPEnviar("[" + Indice.ToString + "] - " + "Close" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_ReleaseAll() : Keyboard.Send_KeyDown(Keys.LMenu) : Keyboard.Send_KeyDown(Keys.F4) : Keyboard.Send_KeyUp(Keys.LMenu) : Keyboard.Send_KeyUp(Keys.F4) : If UDPTaskSwitch = True Then UDPTaskSwitch = False
            ElseIf Indice = 9 Then 'Up
                UDPEnviar("[" + Indice.ToString + "] - " + "Up" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Up)
            ElseIf Indice = 10 Then 'Down
                UDPEnviar("[" + Indice.ToString + "] - " + "Down" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Down)
            ElseIf Indice = 11 Then 'Left
                UDPEnviar("[" + Indice.ToString + "] - " + "Left" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Left)
            ElseIf Indice = 12 Then 'Right
                UDPEnviar("[" + Indice.ToString + "] - " + "Right" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Left)
            ElseIf Indice = 13 Then 'Tasks
                UDPEnviar("[" + Indice.ToString + "] - " + "Tasks" + " (done)", UDPInfo.RemoteEndPoint) : If UDPTaskSwitch = False Then Keyboard.Send_ReleaseAll() : Keyboard.Send_KeyDown(Keys.LMenu) : Keyboard.Send_KeyDown(Keys.Tab) : Keyboard.Send_KeyUp(Keys.Tab) : UDPTaskSwitch = True Else Keyboard.Send_KeyUp(Keys.LMenu) : UDPTaskSwitch = False
            ElseIf Indice = 14 Then 'Refresh
                UDPEnviar("[" + Indice.ToString + "] - " + "Refresh" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.F5)
            ElseIf Indice = 15 Then 'Fullscreen
                UDPEnviar("[" + Indice.ToString + "] - " + "Fullscreen" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_ReleaseAll() : Keyboard.Send_KeyPress(Keys.F) : If UDPTaskSwitch = True Then UDPTaskSwitch = False
            ElseIf Indice = 16 Then 'Subs-
                UDPEnviar("[" + Indice.ToString + "] - " + "Subs -" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Oem4)
            ElseIf Indice = 17 Then 'Subs+
                UDPEnviar("[" + Indice.ToString + "] - " + "Subs +" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Oem6)
            ElseIf Indice = 18 Then 'Sync-
                UDPEnviar("[" + Indice.ToString + "] - " + "Sync -" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.D7)
            ElseIf Indice = 19 Then 'Sync+
                UDPEnviar("[" + Indice.ToString + "] - " + "Sync +" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.D9)
            ElseIf Indice > Comandos.Length + 20 And Check_Comando_Nombre(UDPInfo.Comando) = False Then 'Comando no existe
                Ejecutado = False
                UDPEnviar("[" + Indice.ToString + "] - No existe" + vbCrLf + vbCrLf + "El comando no existe, escriba 'Lista' " + vbCrLf + "para ver los comandos disponibles", UDPInfo.RemoteEndPoint)
            Else
                If Check_Comando_Nombre(UDPInfo.Comando) = True Then GoTo Sigue
                If UDPTaskSwitch = True Then Keyboard.Send_KeyUp(Keys.LMenu) : UDPTaskSwitch = False
                If Comandos.Length = 0 Then Exit Sub
                Dim cEjecutarComando As EjecutarComandoST
                If Comandos(Indice - 20).Deshabilitar = False Then
                    cEjecutarComando.Indice_Comando = Indice - 20
                    cEjecutarComando.ID_Comando = Comandos(Indice - 20).ID
                    cEjecutarComando.Sonido = Comandos(Indice - 20).Sonido
                    cEjecutarComando.Proceso = Proceso.Get_ProcessST
                    cEjecutarComando.Logger = "Keyboard"
                    cEjecutarComando.Notas = ""
                    Comandos(cEjecutarComando.Indice_Comando).EnEjecucion = True
                    EjecutarComando(cEjecutarComando)
                Else
                    UDPEnviar("[" + Indice.ToString + "] - " + Comandos(Indice - 20).Nombre + " (deshabilitado)", UDPInfo.RemoteEndPoint) : Estadisticas.Estadisticas.Comandos_UDP += 1 : Exit Sub
                End If : Done = True
                If Ejecutado = True Then Estadisticas.Estadisticas.Comandos_UDP += 1 : Estadisticas.Guardar()
                UDPEnviar("[" + Indice.ToString + "] - " + Comandos(Indice - 20).Nombre + " (done)", UDPInfo.RemoteEndPoint)
            End If : Exit Sub
        End If
        'Por Nombre
Sigue:  If UDPInfo.Comando.ToLower <> "tasks" Then If Deshabilitado() = True Then UDPEnviar(UDPInfo.Comando + " (deshabilitado)", UDPInfo.RemoteEndPoint) : Exit Sub
        If UDPInfo.Comando.ToLower = "play" Or UDPInfo.Comando.ToLower = "pause" Or UDPInfo.Comando.ToLower = "play/pause" Then
            UDPEnviar("[1] - " + "Play/Pause" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.MediaPlayPause) : Done = True : If UDPTaskSwitch = True Then Keyboard.Send_KeyUp(Keys.LMenu) : UDPTaskSwitch = False
        ElseIf UDPInfo.Comando.ToLower = "next" Then
            UDPEnviar("[2] - " + "Next" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.MediaNextTrack) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "previous" Then
            UDPEnviar("[3] - " + "Previous" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.MediaPreviousTrack) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "subir volumen" Then
            UDPEnviar("[4] - " + "Subir Volumen" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.VolumeUp) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "bajar volumen" Then
            UDPEnviar("[5] - " + "Bajar Volumen" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.VolumeDown) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "silenciar volumen" Then
            UDPEnviar("[6] - " + "Silenciar Volumen" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.VolumeMute) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "enter" Then
            UDPEnviar("[7] - " + "Enter" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Enter) : Done = True : If UDPTaskSwitch = True Then Keyboard.Send_KeyUp(Keys.LMenu) : UDPTaskSwitch = False
        ElseIf UDPInfo.Comando.ToLower = "close" Then
            UDPEnviar("[8] - " + "Close" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_ReleaseAll() : Keyboard.Send_KeyDown(Keys.LMenu) : Keyboard.Send_KeyDown(Keys.F4) : Keyboard.Send_KeyUp(Keys.LMenu) : Keyboard.Send_KeyUp(Keys.F4) : Done = True : If UDPTaskSwitch = True Then UDPTaskSwitch = False
        ElseIf UDPInfo.Comando.ToLower = "up" Then
            UDPEnviar("[9] - " + "Up" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Up) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "down" Then
            UDPEnviar("[10] - " + "Down" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Down) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "left" Then
            UDPEnviar("[11] - " + "Left" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Left) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "right" Then
            UDPEnviar("[12] - " + "Right" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Right) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "tasks" Then
            UDPEnviar("[13] - " + "Tasks" + " (done)", UDPInfo.RemoteEndPoint) : Done = True : If UDPTaskSwitch = False Then Keyboard.Send_ReleaseAll() : Keyboard.Send_KeyDown(Keys.LMenu) : Keyboard.Send_KeyDown(Keys.Tab) : Keyboard.Send_KeyUp(Keys.Tab) : UDPTaskSwitch = True Else Keyboard.Send_KeyUp(Keys.LMenu) : UDPTaskSwitch = False
        ElseIf UDPInfo.Comando.ToLower = "refresh" Then
            UDPEnviar("[14] - " + "Refresh" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.F5) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "fullscreen" Then
            UDPEnviar("[15] - " + "Fullscreen" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_ReleaseAll() : Keyboard.Send_KeyPress(Keys.F) : Done = True : If UDPTaskSwitch = True Then UDPTaskSwitch = False
        ElseIf UDPInfo.Comando.ToLower = "sub-" Then
            UDPEnviar("[16] - " + "Subs -" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Oem4) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "sub+" Then
            UDPEnviar("[17] - " + "Subs +" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.Oem6) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "sync-" Then
            UDPEnviar("[18] - " + "Sync -" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.D7) : Done = True
        ElseIf UDPInfo.Comando.ToLower = "sync+" Then
            UDPEnviar("[19] - " + "Sync +" + " (done)", UDPInfo.RemoteEndPoint) : Keyboard.Send_KeyPress(Keys.D9) : Done = True
        ElseIf UDPInfo.Comando.ToLower.StartsWith("sk ") = True Or UDPInfo.Comando.ToLower.StartsWith("sendkey ") = True Then
            If UDPInfo.Comando.ToLower.StartsWith("sk ") Then UDPInfo.Comando = UDPInfo.Comando.Substring(3)
            If UDPInfo.Comando.ToLower.StartsWith("sendkey ") Then UDPInfo.Comando = UDPInfo.Comando.Substring(8)
            If UDPInfo.Comando.Length > 0 Then
                If Keyboard.String_to_Key(UDPInfo.Comando, True) <> Keys.None Then
                    If UDPTaskSwitch = True Then Keyboard.Send_KeyUp(Keys.LMenu) : UDPTaskSwitch = False
                    Keyboard.Send_KeyPress(Keyboard.String_to_Key(UDPInfo.Comando, True))
                Else
                    For Each c As Char In UDPInfo.Comando
                        Dim Letra As Keys = Keyboard.String_to_Key(c.ToString, True) : If Letra <> Keys.None Then
                            If UDPTaskSwitch = True Then Keyboard.Send_KeyUp(Keys.LMenu) : UDPTaskSwitch = False
                            Keyboard.Send_KeyPress(Letra)
                        End If
                    Next
                End If
            End If
            UDPEnviar("SendKey [" + UDPInfo.Comando + "] (done)", UDPInfo.RemoteEndPoint) : Done = True
        Else : For Cuenta = 0 To Comandos.Length - 1
                If UDPInfo.Comando.ToLower = Comandos(Cuenta).Nombre.ToLower Then
                    If UDPTaskSwitch = True Then Keyboard.Send_KeyUp(Keys.LMenu) : UDPTaskSwitch = False
                    If Comandos.Length = 0 Then Exit Sub
                    Dim cEjecutarComando As EjecutarComandoST
                    If Comandos(Cuenta).Deshabilitar = False Then
                        cEjecutarComando.Indice_Comando = Cuenta
                        cEjecutarComando.ID_Comando = Comandos(Cuenta).ID
                        cEjecutarComando.Sonido = Comandos(Cuenta).Sonido
                        Proceso.Get_Process_Name()
                        cEjecutarComando.Proceso = Proceso.CurrentProcess
                        cEjecutarComando.Logger = "Keyboard"
                        cEjecutarComando.Notas = ""
                        Comandos(cEjecutarComando.Indice_Comando).EnEjecucion = True
                        EjecutarComando(cEjecutarComando)
                    Else
                        UDPEnviar("[" + (Cuenta + 20).ToString + "] - " + Comandos(Cuenta).Nombre + " (deshabilitado)", UDPInfo.RemoteEndPoint) : Exit Sub
                    End If : Done = True
                    UDPEnviar("[" + (Cuenta + 20).ToString + "] - " + Comandos(Cuenta).Nombre + " (done)", UDPInfo.RemoteEndPoint)
                End If
            Next
        End If : If Done = False Then UDPEnviar(UDPInfo.Comando + vbCrLf + "El comando no existe, escriba 'Lista' " + vbCrLf + "para ver los comandos disponibles", UDPInfo.RemoteEndPoint)
        If Ejecutado = True Then Estadisticas.Estadisticas.Comandos_UDP += 1 : Estadisticas.Guardar()
    End Sub

    Private Function Check_Comando_Nombre(Nombre As String) As Boolean
        For Cuenta = 0 To Comandos.Length - 1
            If Comandos(Cuenta).Nombre.ToLower = Nombre.ToLower Then Return True
        Next : Return False
    End Function

    'Private Sub Log_File(Texto As String, Optional Name As String = "UDPLog.txt")
    'Try : Dim Guardar As IO.StreamWriter = IO.File.AppendText("D:\Downloads\" + Name)
    '    Guardar.WriteLine(Texto) : Guardar.Close()
    'Catch : End Try
    'End Sub


#End Region

#End Region

#Region " Macros "

#Region " Teclado "

    Private Sub Keyboard_Key_Macro(Evento As String, Hotkey As String, Tecla As String, Pausa As Integer) Handles Keyboard.Key_Macro
        Dim AbrirKDesktopComando As String = "CTRL + ALT + Home" : Dim CerrarKDesktopComando As String = "CTRL + ALT + End"
        If GMacro_PrimerComando = False And GMacro_CEventosTeclado.Checked = True And GMacro_CPausasEjecucion.Checked = True And Pausa > 0 Then GMacro_Lista.AddItem(Tipo_to_Texto(Pausa.ToString, NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion), Pausa.ToString, NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion)
        Select Case Evento
            Case "Key Down"
                If GMacro_CEventosTeclado.Checked = True Then
                    GMacro_Lista.AddItem(Tipo_to_Texto(Tecla, NSListViewSK.NSListViewItemSK.TipoEN.KeyDown), Tecla, NSListViewSK.NSListViewItemSK.TipoEN.KeyDown)
                    GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
                End If
            Case "Key Up"
                If GMacro_CEventosTeclado.Checked = True Then
                    GMacro_Lista.AddItem(Tipo_to_Texto(Tecla, NSListViewSK.NSListViewItemSK.TipoEN.KeyUp), Tecla, NSListViewSK.NSListViewItemSK.TipoEN.KeyUp)
                    GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
                End If
                Select Case Hotkey
                    Case AbrirKDesktopComando : ShowF("Show")
                    Case CerrarKDesktopComando : If ShowMessageBox("¿Cancelar grabación de macro?", Version, MsgBoxStyle.YesNo, "YesNo") = DialogResult.Cancel Then Exit Sub Else GMacro_Grabando = False : GMacro_PGrabar.Image = My.Resources.Macro_GrabarNo_Off : CargarMacro() : ShowF("Salir")
                End Select
                If Tecla = "Escape" Then
                    If GMacro_ESCs = 1 And GMacro_ESCs_StopWatch.ElapsedMilliseconds <= 1000 Then
                        GMacro_ESCs += 1 : GMacro_GrabandoOculto = True : GMacro_PGrabar_Click(Nothing, Nothing)
                        If GMacro_PGrabar.ClientRectangle.Contains(GMacro_PGrabar.PointToClient(MousePosition)) = True Then GMacro_PGrabar.Image = My.Resources.Macro_GrabarNo Else GMacro_PGrabar.Image = My.Resources.Macro_GrabarNo_Off
                    ElseIf GMacro_ESCs = -1 Then
                        GMacro_ESCs = 0 : GMacro_ESCs_StopWatch.Reset() : GMacro_ESCs_StopWatch.Start()
                    Else
                        If GMacro_ESCs_StopWatch.ElapsedMilliseconds <= 1000 Then GMacro_ESCs += 1 : GMacro_ESCs_StopWatch.Restart() Else GMacro_ESCs = -1 : GMacro_ESCs_StopWatch.Stop()
                    End If
                Else
                    GMacro_ESCs = -1 : GMacro_ESCs_StopWatch.Stop()
                End If
        End Select : GMacro_PrimerComando = False
    End Sub

#End Region

#Region " Raton "

    Public Sub Keyboard_Mouse_Macro(Evento As String, Boton As String, Location As Point, Pausa As Integer) Handles Keyboard.Mouse_Macro
        If (GMacro_CClicsRaton.Checked = False And GMacro_CClicks_Position.Checked = False) AndAlso (Evento = "Mouse Down" Or Evento = "Mouse Up") Then Exit Sub
        If GMacro_CRuedaRaton.Checked = False AndAlso (Evento = "Wheel Down" Or Evento = "Wheel Up" Or Evento = "HWheel Down" Or Evento = "HWheel Up") Then Exit Sub
        If GMacro_CMovimientoRaton.Checked = False AndAlso Evento = "Mouse Move" Then Exit Sub
        If GMacro_PrimerComando = False And GMacro_CPausasEjecucion.Checked = True And Pausa > 0 Then GMacro_Lista.AddItem(Tipo_to_Texto(Pausa.ToString, NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion), Pausa.ToString, NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion)
        Select Case Evento
            Case "Mouse Down"
                If GMacro_CClicks_Position.Checked = True Then
                    GMacro_Lista.AddItem(Tipo_to_Texto(Location.ToString.Replace("-1", "0"), NSListViewSK.NSListViewItemSK.TipoEN.MouseMove), Location.ToString.Replace("-1", "0"), NSListViewSK.NSListViewItemSK.TipoEN.MouseMove)
                    GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
                End If
                GMacro_Lista.AddItem(Tipo_to_Texto(Boton, NSListViewSK.NSListViewItemSK.TipoEN.MouseDown), Boton, NSListViewSK.NSListViewItemSK.TipoEN.MouseDown)
                GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
            Case "Mouse Up"
                If GMacro_CClicks_Position.Checked = True Then
                    GMacro_Lista.AddItem(Tipo_to_Texto(Location.ToString.Replace("-1", "0"), NSListViewSK.NSListViewItemSK.TipoEN.MouseMove), Location.ToString.Replace("-1", "0"), NSListViewSK.NSListViewItemSK.TipoEN.MouseMove)
                    GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
                End If
                GMacro_Lista.AddItem(Tipo_to_Texto(Boton, NSListViewSK.NSListViewItemSK.TipoEN.MouseUp), Boton, NSListViewSK.NSListViewItemSK.TipoEN.MouseUp)
                GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
            Case "Wheel Down"
                GMacro_Lista.AddItem(Tipo_to_Texto(Boton, NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelDown), Boton, NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelDown)
                GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
            Case "Wheel Up"
                GMacro_Lista.AddItem(Tipo_to_Texto(Boton, NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelUp), Boton, NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelUp)
                GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
            Case "HWheel Down"
                GMacro_Lista.AddItem(Tipo_to_Texto(Boton, NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelDown), Boton, NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelDown)
                GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
            Case "HWheel Up"
                GMacro_Lista.AddItem(Tipo_to_Texto(Boton, NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelUp), Boton, NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelUp)
                GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
            Case "Mouse Move"
                GMacro_Lista.AddItem(Tipo_to_Texto(Location.ToString.Replace("-1", "0"), NSListViewSK.NSListViewItemSK.TipoEN.MouseMove), Location.ToString.Replace("-1", "0"), NSListViewSK.NSListViewItemSK.TipoEN.MouseMove)
                GMacro_Lista.EnsureVisibleAt(GMacro_Lista.Items.Count - 1)
        End Select : GMacro_PrimerComando = False
    End Sub

#End Region

#End Region

#Region " Keylogger "

#Region " Teclado "

#Region " KBoard Cambiar "

    Private Sub KBoard_Cambiar_GetHotKey(HotKey As String, Tecla As String)
        Dim KTecla As NSButton
        For Each cntrl As Control In KBoard_GKeyboard.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton)
                If KTecla.ClientRectangle.Contains(KTecla.PointToClient(MousePosition)) = False Then
                    KTecla.State = NSButton.MouseState.None
                    If cntrl.Name = "BEnter" Then
                        BEnter2.State = NSButton.MouseState.None : BEnter2.Invalidate()
                        BEnter4.BackColor = Color.FromArgb(65, 65, 65) : BEnter4.Invalidate()
                        BEnter5.BackColor = Color.FromArgb(65, 65, 65) : BEnter5.Invalidate()
                    End If
                End If : KTecla.Marked_Set = False : KTecla.Invalidate()
            End If
        Next
        For Each cntrl As Control In KBoard_GNumerico.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton)
                If KTecla.ClientRectangle.Contains(KTecla.PointToClient(MousePosition)) = False Then KTecla.State = NSButton.MouseState.None
                KTecla.Marked_Set = False : KTecla.Invalidate()
            End If
        Next
        For Each cntrl As Control In KBoard_GRaton.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton)
                If KTecla.ClientRectangle.Contains(KTecla.PointToClient(MousePosition)) = False Then KTecla.State = NSButton.MouseState.None
                KTecla.Marked_Set = False : KTecla.Invalidate()
            End If
        Next : ComandoScript = "" : TVTecla.Enabled = False : IniciaContador = False : Contador = 0

        Dim cModificadores As String = ""
        If KBoard_CLCtrl.Checked = True Or KBoard_CRCtrl.Checked = True Then cModificadores += "CTRL + "
        If KBoard_CLAlt.Checked = True Then cModificadores += "ALT + "
        If KBoard_CLShift.Checked = True Or KBoard_CRShift.Checked = True Then cModificadores += "SHIFT + "
        If KBoard_CLWin.Checked = True Or KBoard_CRWin.Checked = True Then cModificadores += "WIN + "

        Dim cKModificadores As String = ""
        If HotKey.Contains("CTRL + ") Then cKModificadores += "CTRL + "
        If HotKey.Contains("ALT + ") Then cKModificadores += "ALT + "
        If HotKey.Contains("SHIFT + ") Then cKModificadores += "SHIFT + "
        If HotKey.Contains("WIN + ") Then cKModificadores += "WIN + "

        For Each cntrl As Control In KBoard_GKeyboard.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton) : If cModificadores = cKModificadores AndAlso KTecla.Tag.ToString.ToLower = Tecla.ToLower Then
                    If KTecla.Name = "BEnter" Or KTecla.Name = "BEnter2" Then
                        BEnter.State = NSButton.MouseState.Hover : BEnter.Invalidate()
                        BEnter2.State = NSButton.MouseState.Hover : BEnter2.Invalidate()
                        BEnter4.BackColor = Color.FromArgb(205, 150, 0) : BEnter4.Invalidate()
                        BEnter5.BackColor = Color.FromArgb(205, 150, 0) : BEnter5.Invalidate()
                    Else
                        KTecla.State = NSButton.MouseState.Hover : KTecla.Invalidate()
                    End If : Exit For
                End If
            End If
        Next
        For Each cntrl As Control In KBoard_GNumerico.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton) : If cModificadores = cKModificadores AndAlso KTecla.Tag.ToString.ToLower = Tecla.ToLower Then KTecla.State = NSButton.MouseState.Hover : KTecla.Invalidate() : Exit For
            End If
        Next
        For Each cntrl As Control In KBoard_GRaton.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton) : If cModificadores = cKModificadores AndAlso KTecla.Tag.ToString.ToLower = Tecla.ToLower Then KTecla.State = NSButton.MouseState.Hover : KTecla.Invalidate() : Exit For
            End If
        Next

        For Cuenta = 0 To KBoards.Length - 1
            If KBoards(Cuenta).Keys IsNot Nothing Then
                For Cuenta2 = 0 To KBoards(Cuenta).Keys.Length - 1
                    If KBoards(Cuenta).Keys(Cuenta2) IsNot Nothing Then
                        If Split(KBoards(Cuenta).Keys(Cuenta2).ToLower, "|-|", , CompareMethod.Text)(0) = HotKey.ToLower Then
                            KBoard_TPor.Text = Split(KBoards(Cuenta).Keys(Cuenta2), "|-|", , CompareMethod.Text)(1)
                            Exit Sub
                        End If
                    End If
                Next
            End If
        Next
        KBoard_TPor.Text = HotKey.Substring(0, HotKey.Length - Tecla.Length) + MainKeyChanged(Tecla)
    End Sub

    Private Sub Set_CTecla(Tecla As String)
        CTecla = Nothing
        Dim KTecla As NSButton
        For Each cntrl As Control In KBoard_GKeyboard.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton) : If KTecla.Tag.ToString.ToLower = Tecla.ToLower Then CTecla = KTecla : Exit Sub
            End If
        Next
        For Each cntrl As Control In KBoard_GNumerico.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton) : If KTecla.Tag.ToString.ToLower = Tecla.ToLower Then CTecla = KTecla : Exit Sub
            End If
        Next
        For Each cntrl As Control In KBoard_GRaton.Controls
            If TypeOf cntrl Is NSButton Then
                KTecla = CType(cntrl, NSButton) : If KTecla.Tag.ToString.ToLower = Tecla.ToLower Then CTecla = KTecla : Exit Sub
            End If
        Next
    End Sub

#End Region

#Region " KBoard Por "

    Private Sub KBoard_Por_GetHotKey(HotKey As String)
        ComandoScript = HotKey : TVTecla.Enabled = False : IniciaContador = False : Contador = 0

        Dim Eliminar As Boolean
        If ComandoScript <> "" Then
            If ComandoScript.EndsWith(" + LShift") Then ComandoScript = ComandoScript.Replace(" + LShift", "")
            If ComandoScript.EndsWith(" + RShift") Then ComandoScript = ComandoScript.Replace(" + RShift", "")
            If ComandoScript.EndsWith(" + LCtrl") Then ComandoScript = ComandoScript.Replace(" + LCtrl", "")
            If ComandoScript.EndsWith(" + RCtrl") Then ComandoScript = ComandoScript.Replace(" + RCtrl", "")
            If ComandoScript.EndsWith(" + LAlt") Then ComandoScript = ComandoScript.Replace(" + LAlt", "")
            If ComandoScript.EndsWith(" + RAlt") Then ComandoScript = ComandoScript.Replace(" + RAlt", "")
            If ComandoScript.EndsWith(" + LWin") Then ComandoScript = ComandoScript.Replace(" + LWin", "")
            If ComandoScript.EndsWith(" + RWin") Then ComandoScript = ComandoScript.Replace(" + RWin", "")

            Dim cModificadores As String = ""
            If KBoard_CLCtrl.Checked = True Or KBoard_CRCtrl.Checked = True Then cModificadores += "CTRL + "
            If KBoard_CLAlt.Checked = True Then cModificadores += "ALT + "
            If KBoard_CLShift.Checked = True Or KBoard_CRShift.Checked = True Then cModificadores += "SHIFT + "
            If KBoard_CLWin.Checked = True Or KBoard_CRWin.Checked = True Then cModificadores += "WIN + "

            Dim cKModificadores As String = ""
            If KBoard_LCCambiar.Text.Contains("CTRL + ") Then cKModificadores += "CTRL + "
            If KBoard_LCCambiar.Text.Contains("ALT + ") Then cKModificadores += "ALT + "
            If KBoard_LCCambiar.Text.Contains("SHIFT + ") Then cKModificadores += "SHIFT + "
            If KBoard_LCCambiar.Text.Contains("WIN + ") Then cKModificadores += "WIN + "

            If cModificadores = cKModificadores Then
                If CTecla IsNot Nothing Then
                    If CTecla.Name = "BEnter" Or CTecla.Name = "BEnter2" Then
                        BEnter.Tag2 = ComandoScript
                        If ComandoScript.ToLower.Contains("ctrl + ") Then BEnter.CTRL = True Else BEnter.CTRL = False
                        If ComandoScript.ToLower.Contains("shift + ") Then BEnter.SHIFT = True Else BEnter.SHIFT = False
                        If ComandoScript.ToLower.Contains("alt + ") Then BEnter.ALT = True Else BEnter.ALT = False
                        If ComandoScript.ToLower.Contains("win + ") Then BEnter.WIN = True Else BEnter.WIN = False
                        BEnter.Text = TagToKey(BEnter.Tag, ComandoScript)
                        BEnter.Text = BEnter.Text.Replace("CTRL + ", "").Replace("SHIFT + ", "").Replace("ALT + ", "").Replace("WIN + ", "")
                        If BEnter.Tag.ToString.ToLower = BEnter.Tag2.ToString.ToLower Then
                            BEnter.Marked = False : BEnter2.Marked = False
                            BEnter4.BackColor = Color.FromArgb(205, 150, 0) : BEnter4.Invalidate()
                            BEnter5.BackColor = Color.FromArgb(205, 150, 0) : BEnter5.Invalidate()
                        Else
                            BEnter.Marked = True : BEnter2.Marked = True
                            BEnter4.BackColor = Color.Green : BEnter4.Invalidate()
                            BEnter5.BackColor = Color.Green : BEnter5.Invalidate()
                        End If
                        BEnter.Marked_Set = False : BEnter.Invalidate()
                        BEnter2.Marked_Set = False : BEnter2.Invalidate()
                    Else
                        CTecla.Tag2 = ComandoScript
                        If ComandoScript.ToLower.Contains("ctrl + ") Then CTecla.CTRL = True Else CTecla.CTRL = False
                        If ComandoScript.ToLower.Contains("shift + ") Then CTecla.SHIFT = True Else CTecla.SHIFT = False
                        If ComandoScript.ToLower.Contains("alt + ") Then CTecla.ALT = True Else CTecla.ALT = False
                        If ComandoScript.ToLower.Contains("win + ") Then CTecla.WIN = True Else CTecla.WIN = False
                        CTecla.Text = TagToKey(CTecla.Tag, ComandoScript)
                        CTecla.Text = CTecla.Text.Replace("CTRL + ", "").Replace("SHIFT + ", "").Replace("ALT + ", "").Replace("WIN + ", "")
                        Rutas.SetFontSize(CTecla, 7, 5)
                        'If CTecla.Tag.ToString.ToLower = CTecla.Tag2.ToString.ToLower Then CTecla.Marked = False : BEnter2.Marked = False : Eliminar = True Else CTecla.Marked = True : BEnter2.Marked = True
                        CTecla.Marked_Set = False : CTecla.Invalidate()
                    End If
                End If
            End If
            ComandoScript = "" : TVTecla.Enabled = False : IniciaContador = False : Contador = 0

            If CTecla.Name = "BEnter" Or CTecla.Name = "BEnter2" Then
                If (cModificadores + CTecla.Tag).ToString.ToLower = CTecla.Tag2.ToString.ToLower Then BEnter.Marked = False : BEnter2.Marked = False : Eliminar = True Else BEnter.Marked = True : BEnter2.Marked = True
            Else
                If (cModificadores + CTecla.Tag).ToString.ToLower = CTecla.Tag2.ToString.ToLower Then CTecla.Marked = False : Eliminar = True Else CTecla.Marked = True
            End If

            If Eliminar = True Then KBoard_Tecla_Eliminar(HotKeyToTag(KBoard_LCCambiar.Text)) Else KBoard_Tecla_Añadir(HotKeyToTag(KBoard_LCCambiar.Text), HotKey)
            KBoard_Guardar(KBoard_Nombre_TNombre.Tag.ToString.ToLower)
        End If
    End Sub

#End Region

    Private Sub Keyboard_Key(Evento As String, HotKey As String, Tecla As String) Handles Keyboard.Key
        Dim AbrirKDesktopComando As String = "CTRL + ALT + Home" : Dim CerrarKDesktopComando As String = "CTRL + ALT + End"
        Select Case Evento
            Case "Key Down"
                If (HotKey <> AbrirKDesktopComando And HotKey <> CerrarKDesktopComando) Or (Get_Macro_Key = True Or Get_Pulsacion_Key = True Or Get_KBoard_Key = True) Then
                    'Get HotKey
                    If Get_HotKey = True Then
                        If HotKey.ToLower.EndsWith("ctrl") Or HotKey.ToLower.EndsWith("alt") Or HotKey.ToLower.EndsWith("shift") Or HotKey.ToLower.EndsWith("win") Then Exit Sub
                        If HotKey = "Enter" And Comandos_Hotkey_THotkey.Text <> "" Then Comandos_Hotkey_BHotkeyAdd_Click(Nothing, Nothing) : Exit Sub
                        If HotKey = "Escape" And Comandos_Hotkey_THotkey.Text = "Escape" Then Comandos_Hotkey_THotkey.Text = "" : HTexto.Focus() : ExitHotKey() : HotkeyM = True : Exit Sub
                        If HotKey = "Delete" And Comandos_Hotkey_THotkey.Text = "Delete" Then Comandos_Hotkey_THotkey.Text = "" : HTexto.Focus() : ExitHotKey() : HotkeyM = True : Exit Sub
                        Comandos_Hotkey_THotkey.Text = HotKey : Exit Sub
                    End If

                    If KBoard_Cambiar_HotKey = True Then
                        If (HotKey.ToLower.EndsWith("ctrl") Or HotKey.ToLower.EndsWith("shift") Or HotKey.ToLower.EndsWith("alt") Or HotKey.ToLower.EndsWith("win")) AndAlso KBoard_LCCambiar.Text.Contains("Mouse") = True Then Exit Sub

                        If HotKey.ToLower.EndsWith("ctrl") AndAlso HotKey.ToLower.Contains("ctrl + ") Then HotKey = HotKey.Replace("CTRL + ", "")
                        If HotKey.ToLower.EndsWith("shift") AndAlso HotKey.ToLower.Contains("shift + ") Then HotKey = HotKey.Replace("SHIFT + ", "")
                        If HotKey.ToLower.EndsWith("alt") AndAlso HotKey.ToLower.Contains("alt + ") Then HotKey = HotKey.Replace("ALT + ", "")
                        If HotKey.ToLower.EndsWith("win") AndAlso HotKey.ToLower.Contains("win + ") Then HotKey = HotKey.Replace("WIN + ", "")

                        'If HotKey = "Enter" And KBoard_TCambiar.Text <> "" Then HTexto.Focus() : ExitHotKey() : Exit Sub
                        If HotKey = "Escape" And KBoard_TCambiar.Text = "Escape" Then KBoard_TCambiar.Text = "" : HTexto.Focus() : ExitHotKey() : HotkeyM = True : Exit Sub
                        If HotKey = "Delete" And KBoard_TCambiar.Text = "Delete" Then KBoard_TCambiar.Text = "" : HTexto.Focus() : ExitHotKey() : HotkeyM = True : Exit Sub
                        If KBoard_LCambiar.Text.Contains(HotKey) AndAlso (KBoard_LCambiar.Text.Contains("Mouse") Or KBoard_LCambiar.Text.Contains("Wheel")) Then Exit Sub
                        KBoard_TCambiar.Text = TagToHotKey(HotKey) : KBoard_Cambiar_GetHotKey(HotKey, Tecla) : Set_CTecla(Tecla) : Exit Sub
                    End If

                    If KBoard_Por_HotKey = True Then
                        If (HotKey.ToLower.EndsWith("ctrl") Or HotKey.ToLower.EndsWith("shift") Or HotKey.ToLower.EndsWith("alt") Or HotKey.ToLower.EndsWith("win")) AndAlso KBoard_LCPor.Text.Contains("Mouse") = True Then Exit Sub

                        If HotKey.ToLower.EndsWith("ctrl") AndAlso HotKey.ToLower.Contains("ctrl + ") Then HotKey = HotKey.Replace("CTRL + ", "")
                        If HotKey.ToLower.EndsWith("shift") AndAlso HotKey.ToLower.Contains("shift + ") Then HotKey = HotKey.Replace("SHIFT + ", "")
                        If HotKey.ToLower.EndsWith("alt") AndAlso HotKey.ToLower.Contains("alt + ") Then HotKey = HotKey.Replace("ALT + ", "")
                        If HotKey.ToLower.EndsWith("win") AndAlso HotKey.ToLower.Contains("win + ") Then HotKey = HotKey.Replace("WIN + ", "")

                        'If HotKey = "Enter" And KBoard_TPor.Text <> "" Then HTexto.Focus() : ExitHotKey() : Exit Sub
                        If HotKey = "Escape" And KBoard_TPor.Text = "Escape" Then KBoard_TPor.Text = "" : HTexto.Focus() : ExitHotKey() : HotkeyM = True : Exit Sub
                        If HotKey = "Delete" And KBoard_TPor.Text = "Delete" Then KBoard_TPor.Text = "" : HTexto.Focus() : ExitHotKey() : HotkeyM = True : Exit Sub
                        KBoard_TPor.Text = TagToHotKey(HotKey) : KBoard_Por_GetHotKey(HotKey) : Exit Sub
                    End If

                    If Get_Macro_Key = True Then
                        If HotKey = "Enter" And GMacro_TTecla.Text <> "" Then HTexto.Focus() : ExitHotKey() : Exit Sub
                        If HotKey = "Escape" And GMacro_TTecla.Text = "Escape" Then HTexto.Focus() : ExitHotKey() : GMacro_MacroM = True : GMacro_TTecla.Text = "" : GMacro_LCTecla.Text = "" : Exit Sub
                        If HotKey = "Delete" And GMacro_TTecla.Text = "Delete" Then HTexto.Focus() : ExitHotKey() : GMacro_MacroM = True : GMacro_TTecla.Text = "" : GMacro_LCTecla.Text = "" : Exit Sub
                        GMacro_TTecla.Text = Tecla : Exit Sub
                    End If
                    If Get_Pulsacion_Key = True Then
                        If HotKey.ToLower.EndsWith("ctrl") Or HotKey.ToLower.EndsWith("alt") Or HotKey.ToLower.EndsWith("shift") Or HotKey.ToLower.EndsWith("win") Then Exit Sub
                        If HotKey = "Enter" And GEnviarPulsacion_TPulsacion.Tag <> "" Then HTexto.Focus() : ExitHotKey() : Exit Sub
                        If HotKey = "Escape" And GEnviarPulsacion_TPulsacion.Tag = "Escape" Then HTexto.Focus() : ExitHotKey() : GEnviarPulsacion_PulsacionM = True : GEnviarPulsacion_TPulsacion.Text = "" : GEnviarPulsacion_LCPulsacion.Text = "" : GEnviarPulsacion_TPulsacion.Tag = "" : GEnviarPulsacion_CWin.Checked = False : GEnviarPulsacion_CCTRL.Checked = False : GEnviarPulsacion_CSHIFT.Checked = False : GEnviarPulsacion_CALT.Checked = False : If Comandos_Accion_ListaAccion.SelectedItems.Length > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
                        If HotKey = "Delete" And GEnviarPulsacion_TPulsacion.Tag = "Delete" Then HTexto.Focus() : ExitHotKey() : GEnviarPulsacion_PulsacionM = True : GEnviarPulsacion_TPulsacion.Text = "" : GEnviarPulsacion_LCPulsacion.Text = "" : GEnviarPulsacion_TPulsacion.Tag = "" : GEnviarPulsacion_CWin.Checked = False : GEnviarPulsacion_CCTRL.Checked = False : GEnviarPulsacion_CSHIFT.Checked = False : GEnviarPulsacion_CALT.Checked = False : If Comandos_Accion_ListaAccion.SelectedItems.Length > 0 Then Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub

                        Dim cPulsacion As String = HotKey
                        If cPulsacion.ToLower.Contains("ctrl") Then GEnviarPulsacion_CCTRL.Checked = True : cPulsacion = cPulsacion.Replace("CTRL", "") Else GEnviarPulsacion_CCTRL.Checked = False
                        If cPulsacion.ToLower.Contains("shift") Then GEnviarPulsacion_CSHIFT.Checked = True : cPulsacion = cPulsacion.Replace("SHIFT", "") Else GEnviarPulsacion_CSHIFT.Checked = False
                        If cPulsacion.ToLower.Contains("alt") Then GEnviarPulsacion_CALT.Checked = True : cPulsacion = cPulsacion.Replace("ALT", "") Else GEnviarPulsacion_CALT.Checked = False
                        If cPulsacion.ToLower.Contains("win") Then GEnviarPulsacion_CWin.Checked = True : cPulsacion = cPulsacion.Replace("WIN", "") Else GEnviarPulsacion_CWin.Checked = False
                        'GEnviarPulsacion_CWin.Checked = False
                        If cPulsacion.EndsWith("+") Then cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "") + "+" Else cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "")
                        cPulsacion = cPulsacion.Replace("Mouse1", "Mouse 1").Replace("Mouse2", "Mouse 2").Replace("Mouse3", "Mouse 3").Replace("Mouse4", "Mouse 4").Replace("Mouse5", "Mouse 5").Replace("WheelDown", "Wheel Down").Replace("WheelUp", "Wheel Up")
                        GEnviarPulsacion_TPulsacion.Tag = HotKey : GEnviarPulsacion_TPulsacion.Text = cPulsacion : Exit Sub
                    End If
                    If Get_KBoard_Key = True Then Exit Sub : ComandoScript = HotKey : Get_KBoard_Key = False : Exit Sub
                    'Mouse coordenadas
                    If Tecla.Substring(1).ToLower = "ctrl" AndAlso GMacro_GAñadirMacro.Visible = True And GMacro_CoorLCX.Visible = True Then GMacro_TX.Text = Cursor.Position.X.ToString : GMacro_TY.Text = Cursor.Position.Y.ToString : GMacro_Cambios() : Exit Sub
                    If Tecla.Substring(1).ToLower = "ctrl" AndAlso GEnviarPulsacion.Visible = True And GEnviarPulsacion_CoorLCX.Visible = True Then GEnviarPulsacion_TX.Text = Cursor.Position.X.ToString : GEnviarPulsacion_TY.Text = Cursor.Position.Y.ToString : Settings_Guardar(Comandos_Accion_ListaAccion.SelectedItems(0).Tag) : Exit Sub
                    'HotKey repetido
                    If Not HotKey.ToLower.EndsWith("ctrl") And Not HotKey.ToLower.EndsWith("alt") And Not HotKey.ToLower.EndsWith("shift") And Not HotKey.ToLower.EndsWith("win") Then
                        If Last_HotKey = Tecla Then Rep_HotKey = True Else Rep_HotKey = False
                        Last_HotKey = Tecla
                    End If
                    'Cancelar temporizadores
                    If HotKey = "Escape" Then
                        If FSelectDisplay.Visible = True Then GGrabacionPantalla_Cancelar = True : FSelectDisplay.Close()
                        Dim Sonido_Played As Boolean
                        If GCapturaPantalla_Grabando = True Then
                            GCapturaPantalla_Grabando = False : If GCapturaPantalla_WaitTime IsNot Nothing Then GCapturaPantalla_WaitTime.CancelWaiting = True
                            If Sonido_Played = False Then Sonido_Played = True : Sonidos.Play("Default", "CapturarPantalla")
                            If GCapturaPantalla_OSD = True Then Opciones_OSD_Font = GCapturaPantalla_OSD_Fuente : Opciones_OSD_Color = GCapturaPantalla_OSD_Color : HideOSD() : ShowOSD("Captura cancelada", 1000)
                        End If
                        If GGrabacionPantalla_Grabando = True Then
                            GGrabacionPantalla_Grabando = False : If GApagarEquipo_WaitTime IsNot Nothing Then GApagarEquipo_WaitTime.CancelWaiting = True
                            If Sonido_Played = False Then Sonido_Played = True : Sonidos.Play("Default", "GrabarPantalla")
                            If GGrabacionPantalla_OSD = True Then Opciones_OSD_Font = GGrabacionPantalla_OSD_Fuente : Opciones_OSD_Color = GGrabacionPantalla_OSD_Color : HideOSD() : ShowOSD("Grabación cancelada", 1000)
                        End If
                        If GGrabacionAudio_Grabando = True Then
                            GGrabacionAudio_Grabando = False : If GGrabacionAudio_WaitTime IsNot Nothing Then GGrabacionAudio_WaitTime.CancelWaiting = True
                            If Sonido_Played = False Then Sonido_Played = True : Sonidos.Play("Default", "GrabarAudio")
                            If GGrabacionAudio_OSD = True Then Opciones_OSD_Font = GGrabacionAudio_OSD_Fuente : Opciones_OSD_Color = GGrabacionAudio_OSD_Color : HideOSD() : ShowOSD("Grabación cancelada", 1000)
                        End If
                        If GApagarEquipo_Apagando = True Then
                            GApagarEquipo_Apagando = False : If GApagarEquipo_WaitTime IsNot Nothing Then GApagarEquipo_WaitTime.CancelWaiting = True
                            If Sonido_Played = False Then Sonidos.Play("Default", "ApagarEquipo")
                            If GApagarEquipo_OSD = True Then Opciones_OSD_Font = GApagarEquipo_OSD_Fuente : Opciones_OSD_Color = GApagarEquipo_OSD_Color : HideOSD() : If GApagarEquipo_Accion = "Apagar Equipo" Then ShowOSD("Apagado cancelado", 1000) Else If GApagarEquipo_Accion = "Reiniciar Equipo" Then ShowOSD("Reinicio cancelado", 1000) Else If GApagarEquipo_Accion = "Cerrar Sesion" Then ShowOSD("Cierre de sesión cancelada", 1000) Else If GApagarEquipo_Accion = "Cambiar Usuario" Then ShowOSD("Cambio de usuario cancelado", 1000)
                        End If
                    End If
                    If HotKey.ToLower = "shift + escape" Then
                        If GMostrarMensaje_Mostrando = True Then
                            GMostrarMensaje_Mostrando = False : If GMostrarMensaje_WaitTime IsNot Nothing Then GMostrarMensaje_WaitTime.CancelWaiting = True
                            HideOSD()
                        End If
                        If GEsperar_Esperando = True Then
                            GEsperar_Esperando = False : If GEsperar_WaitTime IsNot Nothing Then GEsperar_WaitTime.CancelWaiting = True
                            HideOSD()
                        End If
                    End If
                    'Cancelar macro
                    If HotKey.ToLower = "shift + escape" AndAlso MacroEjecutando = True Then MacroEjecutando = False
                    'Ejecutar comando
                    If Comandos.Length = 0 Then Exit Sub
                    Dim cEjecutarComando As EjecutarComandoST = Nothing
                    For Cuenta = 0 To Comandos.Length - 1
                        If Comandos(Cuenta).Hotkey IsNot Nothing AndAlso Comandos(Cuenta).Hotkey.Length > 0 Then
                            For Cuenta2 = 0 To Comandos(Cuenta).Hotkey.Length - 1
                                If HotKey.Trim <> "" AndAlso HotKey.ToLower = Comandos(Cuenta).Hotkey(Cuenta2).ToLower And Comandos(Cuenta).Deshabilitar = False Then
                                    cEjecutarComando.Indice_Comando = Cuenta
                                    cEjecutarComando.ID_Comando = Comandos(Cuenta).ID
                                    cEjecutarComando.Sonido = Comandos(Cuenta).Sonido
                                    Proceso.Get_Process_Name()
                                    cEjecutarComando.Proceso = Proceso.CurrentProcess
                                    cEjecutarComando.Logger = "Keyboard"
                                    Comandos(cEjecutarComando.Indice_Comando).EnEjecucion = True
                                    EjecutarComando(cEjecutarComando)
                                End If
                            Next
                        End If
                    Next
                Else
                    'Comandos por defecto
                    If Get_HotKey = True Then Comandos_Hotkey_THotkey.Text = "" : Exit Sub
                    Select Case HotKey
                        Case AbrirKDesktopComando : ShowF("Show")
                        Case CerrarKDesktopComando : ShowF("Salir")
                    End Select
                End If
            Case "Key Up"
                If Get_KBoard_Key = True Then ComandoScript = HotKey : Get_KBoard_Key = False
                If Not HotKey.ToLower.EndsWith("ctrl") And Not HotKey.ToLower.EndsWith("alt") And Not HotKey.ToLower.EndsWith("shift") And Not HotKey.ToLower.EndsWith("win") And Last_HotKey = Tecla Then Last_HotKey = "" : Rep_HotKey = False
        End Select
    End Sub

#End Region

#Region " Raton "

    Public Sub Keyboard_Mouse(Location As Point, Boton As String, Evento As String, HotKey As String) Handles Keyboard.Mouse
        If Evento = "Mouse Down" Then
            'Cerrar QuickMenu
            If QuickMenu_OnMenu = False Then
                QuickMenuRightClick = False
                For Cuenta = 0 To QuickMenus_F.Length - 1
                    If QuickMenus_F(Cuenta).Visible = True Then QuickMenu_F_SetAutoClose(QuickMenus_F(Cuenta), True) : QuickMenus_F(Cuenta).Close() : Exit For
                Next
            End If
            'Cerrar FSelectDisplay
            If FSelectDisplay.Visible = True Then
                Dim Coordinates As New Rectangle(FSelectDisplay.Location, FSelectDisplay.Size)
                If Coordinates.Contains(MousePosition) = False Then GGrabacionPantalla_Cancelar = True : FSelectDisplay.Close()
            End If
        End If
        'Reset Macro_ESC
        If GMacro_ESCs_StopWatch.IsRunning = True And GMacro_ESCs_StopWatch.ElapsedMilliseconds > 2000 Then GMacro_ESCs_StopWatch.Stop()
        Select Case Evento
            Case "Mouse Down"
                'If Get_KBoard_Key = True Then ComandoScript = HotKey : Get_KBoard_Key = False
            Case "Mouse Up", "Wheel Up", "Wheel Down", "HWheel Up", "HWheel Down"
                Last_HotKey = "" : Rep_HotKey = False
                'Get HotKey
                If Get_HotKey = True AndAlso Comandos_Hotkey_BHotkeyAdd.ClientRectangle.Contains(Comandos_Hotkey_BHotkeyAdd.PointToClient(MousePosition)) = False Then If HotKey.Trim <> "" AndAlso HotKey <> "Mouse 1" Then Comandos_Hotkey_THotkey.Text = HotKey : Exit Sub
                If KBoard_Cambiar_HotKey = True AndAlso HotKey.Trim <> "" Then
                    Dim GetCambiarCancel As Boolean = True
                    If KBoard_TCambiar.ClientRectangle.Contains(KBoard_TCambiar.PointToClient(MousePosition)) = True Or KBoard_LCCambiar.ClientRectangle.Contains(KBoard_LCCambiar.PointToClient(MousePosition)) = True Then GetCambiarCancel = False
                    HotKey = HotKey.Replace("Mouse1", "Mouse 1").Replace("Mouse2", "Mouse 2").Replace("Mouse3", "Mouse 3").Replace("Mouse4", "Mouse 4").Replace("Mouse5", "Mouse 5").Replace("WheelDown", "Wheel Down").Replace("WheelUp", "Wheel Up")
                    Dim cBoton As String = Boton.Replace("Mouse1", "Mouse 1").Replace("Mouse2", "Mouse 2").Replace("Mouse3", "Mouse 3").Replace("Mouse4", "Mouse 4").Replace("Mouse5", "Mouse 5").Replace("WheelDown", "Wheel Down").Replace("WheelUp", "Wheel Up")
                    If GetCambiarCancel = False Or HotKey.Contains("Wheel Up") Or HotKey.Contains("Wheel Down") Then KBoard_TCambiar.Tag = HotKey : KBoard_TCambiar.Text = TagToHotKey(HotKey) : KBoard_Cambiar_GetHotKey(HotKey, cBoton) : Exit Sub
                End If
                If KBoard_Por_HotKey = True AndAlso HotKey.Trim <> "" Then
                    Dim GetCambiarCancel As Boolean = True
                    If KBoard_TPor.ClientRectangle.Contains(KBoard_TPor.PointToClient(MousePosition)) = True Or KBoard_LCPor.ClientRectangle.Contains(KBoard_LCPor.PointToClient(MousePosition)) = True Then GetCambiarCancel = False
                    HotKey = HotKey.Replace("Mouse1", "Mouse 1").Replace("Mouse2", "Mouse 2").Replace("Mouse3", "Mouse 3").Replace("Mouse4", "Mouse 4").Replace("Mouse5", "Mouse 5").Replace("WheelDown", "Wheel Down").Replace("WheelUp", "Wheel Up")
                    If GetCambiarCancel = False Or HotKey.Contains("Wheel Up") Or HotKey.Contains("Wheel Down") Then KBoard_TPor.Tag = HotKey : KBoard_TPor.Text = TagToHotKey(HotKey) : KBoard_Por_GetHotKey(HotKey) : Exit Sub
                End If
                If Get_Pulsacion_Key = True AndAlso HotKey.Trim <> "" Then
                    Dim GetPulsacionCancel As Boolean = True
                    If GEnviarPulsacion_TPulsacion.ClientRectangle.Contains(GEnviarPulsacion_TPulsacion.PointToClient(MousePosition)) = True Or GEnviarPulsacion_LCPulsacion.ClientRectangle.Contains(GEnviarPulsacion_LCPulsacion.PointToClient(MousePosition)) = True Then GetPulsacionCancel = False
                    Dim cPulsacion As String = HotKey
                    If cPulsacion.ToLower.Contains("ctrl") Then cPulsacion = cPulsacion.Replace("CTRL", "")
                    If cPulsacion.ToLower.Contains("shift") Then cPulsacion = cPulsacion.Replace("SHIFT", "")
                    If cPulsacion.ToLower.Contains("alt") Then cPulsacion = cPulsacion.Replace("ALT", "")
                    GEnviarPulsacion_CWin.Checked = False
                    If cPulsacion.EndsWith("+") Then cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "") + "+" Else cPulsacion = cPulsacion.Replace("+", "").Replace(" ", "")
                    cPulsacion = cPulsacion.Replace("Mouse1", "Mouse 1").Replace("Mouse2", "Mouse 2").Replace("Mouse3", "Mouse 3").Replace("Mouse4", "Mouse 4").Replace("Mouse5", "Mouse 5").Replace("WheelDown", "Wheel Down").Replace("WheelUp", "Wheel Up")
                    If GetPulsacionCancel = False Or cPulsacion = "Wheel Up" Or cPulsacion = "Wheel Down" Then
                        If HotKey.ToLower.Contains("ctrl") Then GEnviarPulsacion_CCTRL.Checked = True Else GEnviarPulsacion_CCTRL.Checked = False
                        If HotKey.ToLower.Contains("shift") Then GEnviarPulsacion_CSHIFT.Checked = True Else GEnviarPulsacion_CSHIFT.Checked = False
                        If HotKey.ToLower.Contains("alt") Then GEnviarPulsacion_CALT.Checked = True Else GEnviarPulsacion_CALT.Checked = False
                        GEnviarPulsacion_TPulsacion.Tag = HotKey : GEnviarPulsacion_TPulsacion.Text = cPulsacion
                    End If : Exit Sub
                End If
                If Get_Macro_Key = True Then Exit Sub
                If Get_KBoard_Key = True Then Exit Sub
                'Proceso actual
                If Opacity = 1 AndAlso PanelComandos.Visible = True AndAlso HotKey = "CTRL + Mouse 1" AndAlso Proceso.Get_Process_Name(True) <> "KDesktop" Then Comandos_Procesos_TProceso.Text = Proceso.Get_Process_Name(True) + "  " : Comandos_Procesos_TProceso.Text = (Comandos_Procesos_TProceso.Text.Substring(0, 1).ToUpper + Comandos_Procesos_TProceso.Text.Substring(1)).Trim : Activate() : Focus() : Comandos_Procesos_LCProcesos.Visible = False : Comandos_Procesos_TProceso.ForeColor1 = Color.FromArgb(102, 102, 102) : Comandos_Procesos_TProceso.Enabled = True : Comandos_Procesos_TProceso.ReadOnly = False : Combo_IgnoreOne = True : Comandos_Procesos_TProceso.Focus() : Exit Sub
                If Opacity = 1 AndAlso PanelComandos.Visible = True AndAlso HotKey = "SHIFT + Mouse 1" AndAlso Proceso.Get_Process_Name(True) <> "KDesktop" Then GAplicaciones_TAplicacion.Text = Proceso.Get_Process_Name(True) + "  " : GAplicaciones_TAplicacion.Text = (GAplicaciones_TAplicacion.Text.Substring(0, 1).ToUpper + GAplicaciones_TAplicacion.Text.Substring(1)).Trim : Activate() : Focus() : GAplicaciones_LCAplicacion.Visible = False : GAplicaciones_TAplicacion.ForeColor1 = Color.FromArgb(102, 102, 102) : GAplicaciones_TAplicacion.Enabled = True : GAplicaciones_TAplicacion.ReadOnly = False : Combo_IgnoreOne = True : GAplicaciones_TAplicacion.Focus() : Exit Sub
                If Opacity = 1 AndAlso PanelKBoard1.Visible = True AndAlso HotKey = "CTRL + Mouse 1" AndAlso Proceso.Get_Process_Name(True) <> "KDesktop" Then KBoard_TProceso.Text = Proceso.Get_Process_Name(True) + "  " : KBoard_TProceso.Text = (KBoard_TProceso.Text.Substring(0, 1).ToUpper + KBoard_TProceso.Text.Substring(1)).Trim : Activate() : Focus() : KBoard_LCProceso.Visible = False : KBoard_TProceso.ForeColor1 = Color.FromArgb(102, 102, 102) : KBoard_TProceso.Enabled = True : KBoard_TProceso.ReadOnly = False : Combo_IgnoreOne = True : KBoard_TProceso.Focus() : Exit Sub
                If Opacity = 1 AndAlso PanelOpciones.Visible = True AndAlso HotKey = "CTRL + Mouse 1" AndAlso Proceso.Get_Process_Name(True) <> "KDesktop" Then Opciones_Desactivar_TProceso.Text = Proceso.Get_Process_Name(True) + "  " : Opciones_Desactivar_TProceso.Text = (Opciones_Desactivar_TProceso.Text.Substring(0, 1).ToUpper + Opciones_Desactivar_TProceso.Text.Substring(1)).Trim : Activate() : Focus() : Opciones_Desactivar_LCProceso.Visible = False : Opciones_Desactivar_TProceso.ForeColor1 = Color.FromArgb(102, 102, 102) : Opciones_Desactivar_TProceso.Enabled = True : Opciones_Desactivar_TProceso.ReadOnly = False : Combo_IgnoreOne = True : Opciones_Desactivar_TProceso.Focus() : Exit Sub
                If Opacity = 1 AndAlso PanelOpciones.Visible = True AndAlso HotKey = "SHIFT + Mouse 1" AndAlso Proceso.Get_Process_Name(True) <> "KDesktop" Then Opciones_Deshabilitar_TProceso.Text = Proceso.Get_Process_Name(True) + "  " : Opciones_Deshabilitar_TProceso.Text = (Opciones_Deshabilitar_TProceso.Text.Substring(0, 1).ToUpper + Opciones_Deshabilitar_TProceso.Text.Substring(1)).Trim : Activate() : Focus() : Opciones_Deshabilitar_LCProceso.Visible = False : Opciones_Deshabilitar_TProceso.ForeColor1 = Color.FromArgb(102, 102, 102) : Opciones_Deshabilitar_TProceso.Enabled = True : Opciones_Deshabilitar_TProceso.ReadOnly = False : Combo_IgnoreOne = True : Opciones_Deshabilitar_TProceso.Focus() : Exit Sub
                'Ejecutar Comando
                If Comandos.Length = 0 Then Exit Sub
                Dim cEjecutarComando As EjecutarComandoST = Nothing
                For Cuenta = 0 To Comandos.Length - 1
                    If Comandos(Cuenta).Hotkey IsNot Nothing AndAlso Comandos(Cuenta).Hotkey.Length > 0 Then
                        For Cuenta2 = 0 To Comandos(Cuenta).Hotkey.Length - 1
                            If HotKey.Trim <> "" AndAlso HotKey.ToLower = Comandos(Cuenta).Hotkey(Cuenta2).ToLower And Comandos(Cuenta).Deshabilitar = False Then
                                cEjecutarComando.Indice_Comando = Cuenta
                                cEjecutarComando.ID_Comando = Comandos(Cuenta).ID
                                cEjecutarComando.Sonido = Comandos(Cuenta).Sonido
                                Proceso.Get_Process_Name(True)
                                cEjecutarComando.Proceso = Proceso.CurrentProcess
                                cEjecutarComando.Logger = "Mouselogger"
                                Comandos(cEjecutarComando.Indice_Comando).EnEjecucion = True
                                EjecutarComando(cEjecutarComando)
                            End If
                        Next
                    End If
                Next
        End Select
    End Sub

#End Region

#End Region

#Region " Get Changed Key "

    Dim KBoard_Pressed As New List(Of String)

    Public Function GetChangedKey(Key As String, Optional Evento As String = "") As Keys
        If KBoards Is Nothing Then Return Nothing
        For Cuenta = 0 To KBoards.Length - 1
            If KBoards(Cuenta).Deshabilitado = True Then KBoards(Cuenta).Activo = False
            If KBoards(Cuenta).AutoActivar = True Then
                If KBoards(Cuenta).Procesos IsNot Nothing AndAlso KBoards(Cuenta).Procesos.Length > 0 Then
                    If KBoards(Cuenta).Procesos.Length = 1 AndAlso KBoards(Cuenta).Procesos(0).Trim = "" Then KBoards(Cuenta).Activo = False : GoTo Sigue1
                    For Cuenta2 = 0 To KBoards(Cuenta).Procesos.Length - 1
                        If KBoards(Cuenta).Procesos(Cuenta2).ToLower = Proceso.CurrentProcess.Process_Name.ToLower Then
                            Estadisticas.Estadisticas.KBoard_Ejecutados += 1 : Estadisticas.Guardar()
                            KBoards(Cuenta).Activo = True : GoTo Sigue1
                        End If
                    Next : KBoards(Cuenta).Activo = False
                End If
            End If
Sigue1: Next
        If Opacity = 1 AndAlso BPanelKBoard.Visible = True AndAlso (KBoard_Nombre_TNombre.Tag Is Nothing OrElse KBoard_Nombre_TNombre.Tag.ToString <> "") Then
            For Cuenta = 0 To KBoards.Length - 1
                If KBoards(Cuenta).Nombre.ToLower = KBoard_Nombre_TNombre.Tag.ToString.ToLower Then
                    If KBoards(Cuenta).Activo = True Then KBoard_TEstado.Text = "activado" : KBoard_TEstado.ForeColor = Color.DarkGreen Else KBoard_TEstado.Text = "desactivado" : KBoard_TEstado.ForeColor = Color.DarkRed
                    Exit For
                End If
            Next
        End If
        If Proceso.CurrentProcess.Process_Name.ToLower = "kdesktop" Then Return Nothing

        For Cuenta = 0 To KBoards.Length - 1
            If KBoards(Cuenta).Activo = True Then
                If KBoards(Cuenta).Keys Is Nothing Then Return Nothing
                If KBoards(Cuenta).Procesos IsNot Nothing AndAlso KBoards(Cuenta).Procesos.Length > 0 Then
                    If KBoards(Cuenta).Procesos.Length = 1 AndAlso KBoards(Cuenta).Procesos(0).Trim = "" Then GoTo Sigue2
                    For Cuenta2 = 0 To KBoards(Cuenta).Procesos.Length - 1
                        If KBoards(Cuenta).Procesos(Cuenta2).ToLower = Proceso.CurrentProcess.Process_Name.ToLower Then GoTo Sigue2
                    Next : Return Nothing
                End If
Sigue2:         For Cuenta2 = 0 To KBoards(Cuenta).Keys.Length - 1
                    If KBoards(Cuenta).Keys(Cuenta2) IsNot Nothing Then
                        If Split(KBoards(Cuenta).Keys(Cuenta2).ToLower, "|-|", , CompareMethod.Text)(0) = Key.ToLower Then
                            Dim cKey As String = Split(KBoards(Cuenta).Keys(Cuenta2), "|-|", , CompareMethod.Text)(1) : Dim Modificadores As String = ""
                            If cKey.ToLower.Contains("ctrl + ") Then cKey = cKey.ToLower.Replace("ctrl + ", "") : Modificadores += "C + "
                            If cKey.ToLower.Contains("shift + ") Then cKey = cKey.ToLower.Replace("shift + ", "") : Modificadores += "S + "
                            If cKey.ToLower.Contains("alt + ") Then cKey = cKey.ToLower.Replace("alt + ", "") : Modificadores += "A + "
                            Modificadores = Modificadores.Replace(" + ", "")
                            Select Case Evento
                                Case "Key Down", "Wheel Up", "Wheel Down"
                                    If KBoard_Pressed.Contains("doble mouse 1") Then Return Nothing
                                    If Modificadores.Contains("C") Then Keyboard.Send_KeyDown(Keys.LControlKey)
                                    If Modificadores.Contains("S") Then Keyboard.Send_KeyDown(Keys.LShiftKey)
                                    If Modificadores.Contains("A") Then Keyboard.Send_KeyDown(Keys.LMenu)
                                    If cKey.ToLower = "doble mouse 1" Then
                                        KBoard_Pressed.Add("doble mouse 1")
                                        Keyboard.Send_MousePress(Keyboard.String_to_Button("mouse 1")) : Keyboard.Send_MouseDown(Keyboard.String_to_Button("mouse 1"))
                                    Else
                                        If cKey = "Wheel Up" Then
                                            Keyboard.Send_ScrollUp(Keyboard.Mouse_Buttons.B_Wheel)
                                        ElseIf cKey = "Wheel Down" Then
                                            Keyboard.Send_ScrollDown(Keyboard.Mouse_Buttons.B_Wheel)
                                        Else
                                            If Keyboard.String_to_Button(cKey) = Nothing Then Keyboard.Send_KeyDown(Keyboard.String_to_Key(cKey)) Else Keyboard.Send_MouseDown(Keyboard.String_to_Button(cKey))
                                        End If
                                    End If
                                    If Modificadores.Contains("C") Then Keyboard.Send_KeyUp(Keys.LControlKey)
                                    If Modificadores.Contains("S") Then Keyboard.Send_KeyUp(Keys.LShiftKey)
                                    If Modificadores.Contains("A") Then Keyboard.Send_KeyUp(Keys.LMenu)
                                Case "Key Up"
                                    If cKey.ToLower = "doble mouse 1" Then KBoard_Pressed.RemoveAll(Function(x) x.Contains("doble mouse 1")) : cKey = "mouse 1"
                                    If Keyboard.String_to_Button(cKey) = Nothing Then Keyboard.Send_KeyUp(Keyboard.String_to_Key(cKey)) Else Keyboard.Send_MouseUp(Keyboard.String_to_Button(cKey))
                                    'Keyboard.Send_ReleaseAll()
                                Case "Check"
                                    If cKey = "Mouse Wheel" Then Return Keys.None
                                    If cKey.ToLower = "doble mouse 1" Then cKey = "mouse 1"
                                    If Keyboard.String_to_Button(cKey) = Nothing Then Return Keyboard.String_to_Key(cKey) Else Return Keyboard.String_to_Button(cKey)
                                Case Else
                                    If cKey.ToLower = "doble mouse 1" Then cKey = "mouse 1"
                                    If Keyboard.String_to_Button(cKey) = Nothing Then Return Keyboard.String_to_Key(cKey) Else Return Keyboard.String_to_Button(cKey)
                            End Select
                        End If
                    End If
                Next
            End If
        Next
        Return Nothing
    End Function

#End Region

#End Region

#Region " Ejecutar "

#Region " Ejecutar Comando "

#Region " Must Wait "

    Private Function MustWait(Comando_Indice As Integer, Accion_Indice As Integer) As Boolean
        Dim Settings() As String = Split(Comandos(Comando_Indice).Accion(Accion_Indice).Settings, "|-|", , CompareMethod.Text)
        Select Case Comandos(Comando_Indice).Accion(Accion_Indice).Tipo
            Case "Enviar Pulsación" : Return True
            Case "Esperar" : Return True
            Case "Mostrar Mensaje" : If Settings.Length >= 5 AndAlso CBool(Settings(4)) = True Then Return True
            Case "Reproducir Sonido" : If Settings.Length >= 2 AndAlso CBool(Settings(1)) = True Then Return True
            Case "Macros" : Return True
            Case "Aplicaciones"
                If Settings.Length >= 3 AndAlso Settings(0) <> "Esperar Aplicacion" AndAlso CBool(Settings(2)) = True Then Return True
                If Settings.Length >= 3 AndAlso Settings(0) = "Esperar Aplicacion" Then Return True
        End Select : Return False
    End Function

#End Region

    Public Sub EjecutarComando(cEjecutarComando As EjecutarComandoST)
        'Todas las acciones en ejecucion = false y esperando = false
        If Comandos(cEjecutarComando.Indice_Comando).Thread_EjecutarComando IsNot Nothing AndAlso Comandos(cEjecutarComando.Indice_Comando).Thread_EjecutarComando.IsAlive = True Then Comandos(cEjecutarComando.Indice_Comando).Thread_EjecutarComando.Abort()
        For Cuenta = 0 To Comandos(cEjecutarComando.Indice_Comando).Accion.Length - 1
            Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Esperando = False
            Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).EnEjecucion = False
            If Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Thread_EjecutarAccion IsNot Nothing AndAlso Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Thread_EjecutarAccion.IsAlive = True Then Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Thread_EjecutarAccion.Abort()
        Next

        Comandos(cEjecutarComando.Indice_Comando).Thread_EjecutarComando = New Threading.Thread(AddressOf TEjecutarComando)
        Comandos(cEjecutarComando.Indice_Comando).Thread_EjecutarComando.Start(cEjecutarComando)
        If Comandos(cEjecutarComando.Indice_Comando).Deshabilitar = False And (Comandos(cEjecutarComando.Indice_Comando).Accion IsNot Nothing AndAlso Comandos(cEjecutarComando.Indice_Comando).Accion.Length >= 5) Then Logros.Desbloquear("Multifacético")
    End Sub

    Private Sub TEjecutarComando(cEjecutarComando As EjecutarComandoST)
        Try
            Dim SonidoPlayed, ProcesoBloqueado As Boolean : If cEjecutarComando.Notas Is Nothing Then cEjecutarComando.Notas = ""
            ' Si se ejecuta al Iniciar o Salir no reproduce sonido
            If cEjecutarComando.Logger.Contains("Iniciar") = True Or cEjecutarComando.Logger.Contains("Salir") = True Then cEjecutarComando.Sonido += "NoSonar"
            ' Comprueba si solo debe ejecutarse en un proceso de la lista de procesos
            If Comandos(cEjecutarComando.Indice_Comando).Procesos IsNot Nothing AndAlso Comandos(cEjecutarComando.Indice_Comando).Procesos.Length > 0 Then
                If Comandos(cEjecutarComando.Indice_Comando).Procesos.Length = 1 AndAlso Comandos(cEjecutarComando.Indice_Comando).Procesos(0).Trim = "" Then GoTo Sigue1
                For Cuenta = 0 To Comandos(cEjecutarComando.Indice_Comando).Procesos.Length - 1
                    If Proceso.CurrentProcess.Process_Name.ToLower = Comandos(cEjecutarComando.Indice_Comando).Procesos(Cuenta).ToLower Then GoTo Sigue1
                Next : ProcesoBloqueado = True
            End If
Sigue1: ' Ejecutar siempre la accion 'Desactivar En'
            If ProcesoBloqueado = True Or (Comandos(cEjecutarComando.Indice_Comando).EjecutarSiempre = False AndAlso Deshabilitado() = True) Then
                For Cuenta = 0 To Comandos(cEjecutarComando.Indice_Comando).Accion.Length - 1
                    If Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Tipo = "Desactivar en (On/Off)" Then
                        Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Sonido = cEjecutarComando.Sonido
                        Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Logger = cEjecutarComando.Logger
                        Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Notas = cEjecutarComando.Notas
                        If Rep_HotKey = False AndAlso SonidoPlayed = False Then Sonidos.Play(cEjecutarComando.Sonido, cEjecutarComando.ID_Comando) : SonidoPlayed = True
                        Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Thread_EjecutarAccion = New Threading.Thread(AddressOf EjecutarAccion_Final)
                        Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Thread_EjecutarAccion.Start(Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta))
                        Exit For
                    End If
                Next : Exit Sub
            End If

            ' Si la accion es una macro con repetición y sin Hotkey, muestra un aviso
            If cEjecutarComando.Notas.Contains("Menu_Lista") = True AndAlso cEjecutarComando.Notas.Contains("EjecutarMacro") = False Then
                For Cuenta = 0 To Comandos(cEjecutarComando.Indice_Comando).Accion.Length - 1
                    If Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Tipo = "Macros" AndAlso Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).EnEjecucion = False AndAlso CBool(Split(Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Settings, "|-|", , CompareMethod.Text)(6)) = True AndAlso Comandos_Hotkey_ListaHotkey.Items.Count = 0 Then
                        If ShowMessageBox("¿Ejecutar macro con repetición sin hotkey?", Version, MsgBoxStyle.YesNo, "YesNo", "Pulse 'Shift + Escape' para detener la macro") = DialogResult.Cancel Then cEjecutarComando.Notas += "EjecutarMacro(False)|-|" Else cEjecutarComando.Notas += "EjecutarMacro(True)|-|"
                        Exit For
                    End If
                Next
            End If

            ' Ejecuta las acciones
            For Cuenta = 0 To Comandos(cEjecutarComando.Indice_Comando).Accion.Length - 1
                Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Sonido = cEjecutarComando.Sonido
                Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Logger = cEjecutarComando.Logger
                Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Notas = cEjecutarComando.Notas

                ' Si el Hotkey esta pulsado y la accion es diferente de 'Volumen' no ejecuta la accion
                If Rep_HotKey = True AndAlso Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Tipo <> "Volumen" Then Continue For

                ' Espera a que se ejecute la acción anterior
                Text = Text ' Hace falta esto para que se espere correctamente ¿?
                If Cuenta > 0 AndAlso MustWait(cEjecutarComando.Indice_Comando, Cuenta - 1) = True Then
                    Do Until Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta - 1).Esperando = False Or (Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta - 1).Thread_EjecutarAccion IsNot Nothing AndAlso Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta - 1).Thread_EjecutarAccion.IsAlive = False) : Loop
                End If

                ' Reproduce el sonido del comando una sola vez
                If Rep_HotKey = False AndAlso SonidoPlayed = False Then Sonidos.Play(cEjecutarComando.Sonido, cEjecutarComando.ID_Comando) : SonidoPlayed = True

                'Detiene la macro si está en ejecución (o debería de empezar nuevamente?)
                If Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Tipo = "Macros" AndAlso Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).EnEjecucion = True Then Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).EnEjecucion = False : Continue For
                ' Ejecuta la macro sin repetición
                If cEjecutarComando.Notas.Contains("Menu_Lista") = True AndAlso cEjecutarComando.Notas.Contains("EjecutarMacro(False)") = True AndAlso Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Tipo = "Macros" AndAlso Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).EnEjecucion = False AndAlso CBool(Split(Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Settings, "|-|", , CompareMethod.Text)(6)) = True AndAlso Comandos_Hotkey_ListaHotkey.Items.Count = 0 Then Continue For
                ' Detiene todas las macros 
                If Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Tipo = "Macros" Then
                    For Cuenta1 = 0 To Comandos.Length - 1
                        If Comandos(Cuenta1).Accion IsNot Nothing AndAlso Comandos(Cuenta1).Accion.Length > 0 Then
                            For Cuenta2 = 0 To Comandos(Cuenta1).Accion.Length - 1
                                If Comandos(Cuenta1).Accion(Cuenta2).Tipo = "Macros" AndAlso Comandos(Cuenta1).Accion(Cuenta2).EnEjecucion = True Then Comandos(Cuenta1).Accion(Cuenta2).EnEjecucion = False
                            Next
                        End If
                    Next
                End If

                ' Ejecuta la accion
                If Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Thread_EjecutarAccion IsNot Nothing Then
Repite2:            If Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Thread_EjecutarAccion.IsAlive = False Then
                        Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Notas = cEjecutarComando.Notas
                        Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Thread_EjecutarAccion = New Threading.Thread(AddressOf EjecutarAccion_Final)
                        Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Thread_EjecutarAccion.Start(Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta))
                    Else
                        Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Thread_EjecutarAccion.Abort() : GoTo Repite2
                    End If
                Else
                    Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Notas = cEjecutarComando.Notas
                    Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Thread_EjecutarAccion = New Threading.Thread(AddressOf EjecutarAccion_Final)
                    Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta).Thread_EjecutarAccion.Start(Comandos(cEjecutarComando.Indice_Comando).Accion(Cuenta))
                End If

                ' Estadisticas
                Estadisticas.Estadisticas.Comandos_Ejecutados += 1 : Estadisticas.Guardar()
            Next
        Catch

        End Try
    End Sub

#End Region

#Region " Ejecutar Accion (Revisar) "

    Public Sub EjecutarAccion(Indice_Comando As Integer, Indice_Accion As Integer)
        Dim AvisoMacro, CancelarMacro As Boolean
        If Indice_Comando = -1 AndAlso Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice_Accion).Tag).Tipo = "Macros" Then CancelarMacro = True
        If Indice_Comando <> -1 AndAlso Comandos(Indice_Comando).Accion(Indice_Accion).Tipo = "Macros" Then CancelarMacro = True
        If Indice_Comando = -1 AndAlso Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice_Accion).Tag).Tipo = "Macros" AndAlso Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice_Accion).Tag).EnEjecucion = False AndAlso CBool(Split(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice_Accion).Tag).Settings, "|-|", , CompareMethod.Text)(6)) = True AndAlso Comandos_Hotkey_ListaHotkey.Items.Count = 0 Then AvisoMacro = True
        If Indice_Comando <> -1 AndAlso Comandos(Indice_Comando).Accion(Indice_Accion).Tipo = "Macros" AndAlso Comandos(Indice_Comando).Accion(Indice_Accion).EnEjecucion = False AndAlso CBool(Split(Comandos(Indice_Comando).Accion(Indice_Accion).Settings, "|-|", , CompareMethod.Text)(6)) = True AndAlso Comandos_Hotkey_ListaHotkey.Items.Count = 0 Then AvisoMacro = True

        If AvisoMacro = True AndAlso ShowMessageBox("¿Ejecutar macro con repetición sin hotkey?", Version, MsgBoxStyle.YesNo, "YesNo", "Pulse 'Shift + Escape' para detener la macro") = DialogResult.Cancel Then Exit Sub

        'Cancela macro si está en ejecución
        If Indice_Comando = -1 AndAlso Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice_Accion).Tag).Tipo = "Macros" AndAlso Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice_Accion).Tag).EnEjecucion = True Then Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice_Accion).Tag).EnEjecucion = False
        If Indice_Comando <> -1 AndAlso Comandos(Indice_Comando).Accion(Indice_Accion).Tipo = "Macros" AndAlso Comandos(Indice_Comando).Accion(Indice_Accion).EnEjecucion = True Then Comandos(Indice_Comando).Accion(Indice_Accion).EnEjecucion = False : Exit Sub
        'Cancela todas las macros
        If CancelarMacro = True Then
            For Cuenta = 0 To Comandos.Length - 1
                For Cuenta1 = 0 To Comandos(Cuenta).Accion.Length - 1
                    If Comandos(Cuenta).Accion(Cuenta1).Tipo = "Macros" AndAlso Comandos(Cuenta).Accion(Cuenta1).EnEjecucion = True Then Comandos(Cuenta).Accion(Cuenta1).EnEjecucion = False
                Next
            Next
        End If
        If EjecutarAccion_Thread IsNot Nothing Then
Repite1:    If EjecutarAccion_Thread.ThreadState = Threading.ThreadState.Unstarted Or EjecutarAccion_Thread.ThreadState = Threading.ThreadState.Aborted Or EjecutarAccion_Thread.ThreadState = Threading.ThreadState.Stopped Then
                EjecutarAccion_Thread = New Threading.Thread(AddressOf EjecutarAccion_Final) : EjecutarAccion_Thread.IsBackground = True
                If Indice_Comando = -1 Then EjecutarAccion_Thread.Start(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice_Accion).Tag))
                If Indice_Comando <> -1 Then EjecutarAccion_Thread.Start(Comandos(Indice_Comando).Accion(Indice_Accion))
            Else
                EjecutarAccion_Thread.Abort() : GoTo Repite1
            End If
        Else
            EjecutarAccion_Thread = New Threading.Thread(AddressOf EjecutarAccion_Final) : EjecutarAccion_Thread.IsBackground = True
            If Indice_Comando = -1 Then EjecutarAccion_Thread.Start(Comandos_Accion_AccionesTemporales(Comandos_Accion_ListaAccion.Items(Indice_Accion).Tag))
            If Indice_Comando <> -1 Then EjecutarAccion_Thread.Start(Comandos(Indice_Comando).Accion(Indice_Accion))
        End If
    End Sub

#End Region

#Region " Ejecutar Final "

    Private Delegate Sub Delegate_EjecutarAccion_Final(Accion As AccionST)
    Private Sub EjecutarAccion_Final(Accion As AccionST)
        If InvokeRequired Then : Invoke(New Delegate_EjecutarAccion_Final(AddressOf EjecutarAccion_Final), Accion) : Else
            Try : If Saliendo = True AndAlso NoEjecutarSalir.Contains(Accion.Tipo) = True Then CloseAllowed = "Done" : Exit Sub
                Estadisticas.Estadisticas.Acciones_Ejecutadas += 1 : Estadisticas.Guardar()
                Select Case Accion.Tipo.ToLower
                    'Aplicaciones
                    Case "ejecutar aplicacion" : EjecutarAplicacion(Accion)
                    Case "abrir carpeta" : AbrirCarpeta(Accion)
                    Case "pagina web" : PaginaWeb(Accion)
                    Case "aplicaciones" : Aplicaciones(Accion)
                    Case "ejecutar bat" : EjecutarBAT(Accion)
                    'Audio y Video
                    Case "capturar pantalla" : CapturarPantalla(Accion) : If GCapturaPantalla_Grabando = False Then CapturandoPantalla = True Else CapturandoPantalla = False
                    Case "grabar pantalla (on/off)" : GrabarPantalla(Accion)
                    Case "grabar audio (on/off)" : GrabarAudio(Accion)
                    Case "reproducir sonido" : ReproducirSonido(Accion)
                    Case "salida de audio" : SalidaAudio(Accion)
                    Case "volumen" : Volumen(Accion)
                    'Utilidades
                    Case "macros" : EjecutarMacro(Accion)
                'Case "k-note" : KNote(Accion)
                    Case "k-board" : KBoard(Accion)
                    Case "quickmenu" : QuickMenu(Accion)
                    Case "red ad-hoc" : RedAdHoc(Accion)
                    'Acciones
                    Case "enviar pulsación" : EnviarPulsacion(Accion)
                    Case "topmost (on/off)" : TopMostEn(Accion)
                    Case "archivos ocultos (on/off)" : ArchivosOcultos(Accion)
                    Case "desactivar en (on/off)" : DesactivarEn(Accion)
                    Case "mostrar mensaje" : MostrarMensaje(Accion)
                    Case "apagar equipo" : ApagarEquipo(Accion) : If GApagarEquipo_Apagando = False Then ApagandoEquipo = True Else ApagandoEquipo = False
                    Case "comandos" : EjeComando(Accion)
                    Case "esperar" : Esperar(Accion)
                End Select
            Catch : End Try
        End If : If CloseAllowed = "Wait" Then CloseAllowed = "Done"
    End Sub

#End Region

#Region " Ejecutar (Acciones) "

#Region " Aplicaciones "

#Region " Ejecutar Aplicacion "

    Private Sub EjecutarAplicacion(Accion As AccionST) ' (0) Ruta, (1) Parametros, (2) IniciarEn, (3) Modo, (4) Prioridad, (5) TopMost, (6) Administrador
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 7 Or Split(Accion.Settings, "|-|", , CompareMethod.Text)(0).Trim = "" Then Exit Sub
            'Administrador = False
            If CBool(Split(Accion.Settings, "|-|", , CompareMethod.Text)(6)) = False Then
                CreateKPS() : RunProcess.RunAsStandar(KobaPathTemp + "KPS.exe", (Accion.Tipo + "|-|" + Accion.Settings).Replace("""", "|||"))
                If Estadisticas.Estadisticas.Acciones_Unicas.Contains("a") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "a" : Estadisticas.Guardar()
                Logros.Desbloquear("Accionista 1")
                Dim cRuta As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)(0) : If cRuta.ToLower = "telegram" Then cRuta = Rutas.TelegramPath()
                If IO.Directory.Exists(cRuta) = True Then
                    Estadisticas.Estadisticas.Carpetas_Abiertas += 1 : Estadisticas.Guardar()
                ElseIf cRuta.ToLower = "cmd" Then
                    Estadisticas.Estadisticas.CMD_Ejecutados += 1 : Estadisticas.Guardar()
                ElseIf Internet.ValidarURL(cRuta) = True Then
                    Estadisticas.Estadisticas.Paginas_Webs += 1 : Estadisticas.Guardar()
                Else
                    Estadisticas.Estadisticas.Aplicaciones_Ejecutadas += 1 : Estadisticas.Guardar()
                End If : Exit Sub
            End If
            'Administrador = True
            Dim Ruta As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)(0) : If Ruta.ToLower = "telegram" Then Ruta = Rutas.TelegramPath()
            Dim Parametros As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)(1)
            Dim IniciarEn As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)(2)
            Dim WindowMode As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)(3)
            Dim Prioridad As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)(4)
            Dim TopMost As Boolean = Split(Accion.Settings, "|-|", , CompareMethod.Text)(5)
            Dim P As New Process()
            Dim isDirectory As Boolean : If IO.Directory.Exists(Ruta) = True Then
                isDirectory = True
            Else
                If IO.Directory.Exists(IniciarEn) = True Then
                    P.StartInfo.WorkingDirectory = IniciarEn
                Else
                    If IO.Directory.Exists(IO.Path.GetDirectoryName(Ruta)) = True Then P.StartInfo.WorkingDirectory = IO.Path.GetDirectoryName(Ruta)
                End If
            End If

            Select Case WindowMode
                Case "Minimizado" : P.StartInfo.WindowStyle = ProcessWindowStyle.Minimized
                Case "Maximizado" : P.StartInfo.WindowStyle = ProcessWindowStyle.Maximized
                Case "Oculto" : P.StartInfo.CreateNoWindow = True : P.StartInfo.WindowStyle = ProcessWindowStyle.Hidden
                Case Else : P.StartInfo.WindowStyle = ProcessWindowStyle.Normal
            End Select

            If Ruta.ToLower = "cmd" Then
                Dim ShowWindow As Boolean : If WindowMode <> "Oculto" Then ShowWindow = True Else ShowWindow = False
                P.StartInfo.CreateNoWindow = Not ShowWindow : P.StartInfo.Arguments = " " + If(ShowWindow, "/K", "/C") + " " + Parametros : P.StartInfo.FileName = Ruta : P.Start()
            Else
                P.StartInfo.Arguments = Parametros : P.StartInfo.FileName = Ruta : Try : P.Start() : Catch : Exit Sub : End Try
            End If

            Try : If isDirectory = False Then
                    Select Case Prioridad
                        Case "Low" : P.PriorityClass = ProcessPriorityClass.Idle
                        Case "Below Normal" : P.PriorityClass = ProcessPriorityClass.BelowNormal
                        Case "Normal" : P.PriorityClass = ProcessPriorityClass.Normal
                        Case "Above Normal" : P.PriorityClass = ProcessPriorityClass.AboveNormal
                        Case "High" : P.PriorityClass = ProcessPriorityClass.High
                        Case "Real Time" : P.PriorityClass = ProcessPriorityClass.RealTime
                    End Select
                End If
            Catch : End Try

            If TopMost = True AndAlso WindowMode <> "Oculto" AndAlso isDirectory = False Then
                For Cuenta = 0 To 30
                    Threading.Thread.Sleep(25) : P.Refresh() : If P.MainWindowHandle <> IntPtr.Zero Then Exit For
                Next
                Dim Titulo As String = P.MainWindowTitle
                If P.MainWindowTitle Is Nothing Or Titulo = "" Then Titulo = Proceso.Get_ProcessST.Window_Title
                If Titulo = "" Then Titulo = P.ProcessName
                If Titulo = "" Then GoTo Sigue2
                If P.MainWindowHandle <> 0 Then
                    If AppsTopMost.Contains(Titulo) = False Then AppsTopMost.Add(Titulo)
                    Process_CL.SetWindowPos(P.MainWindowHandle, New IntPtr(-&H1), 0, 0, 0, 0, &H2 Or &H1)
                End If
            End If

Sigue2:     If Estadisticas.Estadisticas.Acciones_Unicas.Contains("a") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "a" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 1")
            If isDirectory = True Then
                Estadisticas.Estadisticas.Carpetas_Abiertas += 1 : Estadisticas.Guardar()
            ElseIf Ruta.ToLower = "cmd" Then
                Estadisticas.Estadisticas.CMD_Ejecutados += 1 : Estadisticas.Guardar()
            ElseIf Internet.ValidarURL(Ruta) = True Then
                Estadisticas.Estadisticas.Paginas_Webs += 1 : Estadisticas.Guardar()
            Else
                Estadisticas.Estadisticas.Aplicaciones_Ejecutadas += 1 : Estadisticas.Guardar()
            End If
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Abrir Carpeta "

    Private Sub AbrirCarpeta(Accion As AccionST) ' (0) Ruta
        Try : Dim Ruta As String = Accion.Settings
            Dim isCarpeta As Boolean = True
            Select Case Ruta.ToLower
                Case "equipo" : Keyboard.Send_ReleaseAll() : Keyboard.Send_KeyDown(Keys.LWin) : Keyboard.Send_KeyDown(Keys.E) : Keyboard.Send_KeyUp(Keys.E) : Keyboard.Send_KeyUp(Keys.LWin)
                Case "panel de control" : Process.Start("control") : isCarpeta = False
                Case "control de volumen" : Process.Start("sndvol") : isCarpeta = False
                Case "ajustes de audio" : Process.Start("mmsys.cpl") : isCarpeta = False
                Case "papelera de reciclaje" : Process.Start("shell:RecycleBinFolder")
                Case "papelera (vaciar)" : SHEmptyRecycleBin(Handle.ToInt32, vbNullString, &H1) : isCarpeta = False : Estadisticas.Estadisticas.Papelera_Vaciada += 1 : Estadisticas.Guardar()
                Case "modo 'god'" : isCarpeta = False
                    If IO.Directory.Exists(KobaPathTemp + "GodMode.{ED7BA470-8E54-465E-825C-99712043E01C}") = False Then IO.Directory.CreateDirectory(KobaPathTemp + "GodMode.{ED7BA470-8E54-465E-825C-99712043E01C}")
                    Process.Start(KobaPathTemp + "GodMode.{ED7BA470-8E54-465E-825C-99712043E01C}")
                Case "documentos" : Process.Start(Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments))
                Case "imagenes" : Process.Start(Environment.GetFolderPath(Environment.SpecialFolder.MyPictures))
                Case "musicas" : Process.Start(Environment.GetFolderPath(Environment.SpecialFolder.MyMusic))
                Case "escritorio" : Process.Start(Environment.GetFolderPath(Environment.SpecialFolder.Desktop))
                Case "videos" : Process.Start(Environment.GetFolderPath(Environment.SpecialFolder.MyVideos))
                Case "descargas" : Process.Start(GetDownloadsPath)
                Case "k-temp" : Process.Start(KobaPathTemp)
                Case "k-desktop" : Process.Start(KobaPath) : Logros.Desbloquear("Tengo curiosidad")
                Case "usuario" : Process.Start(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile))
                Case "fuentes" : Process.Start(Environment.GetFolderPath(Environment.SpecialFolder.Fonts))
                Case "menu inicio (usuario)" : Process.Start(Environment.GetFolderPath(Environment.SpecialFolder.StartMenu))
                Case "menu inicio" : Process.Start(Environment.GetFolderPath(Environment.SpecialFolder.CommonStartMenu))
                Case "directivas de grupo" : Process.Start("gpedit.msc") : isCarpeta = False
                Case "programador de tareas" : Process.Start("taskschd.msc") : isCarpeta = False
                Case "registro de windows" : Process.Start("regedit") : isCarpeta = False
                Case "teclado en pantalla" : Process.Start("osk") : isCarpeta = False
                Case "conexiones de red" : Process.Start("ncpa.cpl")
                Case "task switcher" : Keyboard.Send_ReleaseAll() : Keyboard.Send_KeyDown(Keys.LWin) : Keyboard.Send_KeyDown(Keys.Tab) : Keyboard.Send_KeyUp(Keys.Tab) : Keyboard.Send_KeyUp(Keys.LWin) : isCarpeta = False
                Case "k-link" : isCarpeta = False : FKLink.Show() : FocusMe(FKLink)
                Case "powershell" : Process.Start("powershell.exe") : isCarpeta = False
                Case "windows apps" : Process.Start(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) + "\Packages")
                Case Else : If IO.Directory.Exists(Ruta) = True Then Process.Start(Ruta)
            End Select
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("c") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "c" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 3")
            If isCarpeta = True Then Estadisticas.Estadisticas.Carpetas_Abiertas += 1 : Estadisticas.Guardar()
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Pagina Web "

    Private Sub PaginaWeb(Accion As AccionST) ' (0) URL, (1) Navegador, (2) Nueva_Ventana, (3) Incognito, (4) Administrador
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 5 Or Split(Accion.Settings, "|-|", , CompareMethod.Text)(0).Trim = "" Then Exit Sub
            'Administrador = False
            If CBool(Split(Accion.Settings, "|-|", , CompareMethod.Text)(4)) = False Then
                CreateKPS() : RunProcess.RunAsStandar(KobaPathTemp + "KPS.exe", (Accion.Tipo + "|-|" + Accion.Settings).Replace("""", "|||"))
                If Estadisticas.Estadisticas.Acciones_Unicas.Contains("b") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "b" : Estadisticas.Guardar()
                Logros.Desbloquear("Accionista 2")
                Logros.Desbloquear("Surfero")
                Estadisticas.Estadisticas.Paginas_Webs += 1 : Estadisticas.Guardar()
                Exit Sub
            End If
            'Administrador = True
            Dim URL As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)(0)
            Dim Navegador As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)(1)
            Dim NuevaVentana As Boolean = CBool(Split(Accion.Settings, "|-|", , CompareMethod.Text)(2))
            Dim VentanaIncognito As Boolean = CBool(Split(Accion.Settings, "|-|", , CompareMethod.Text)(3))
            Dim URLComando As String = ""
            Select Case Navegador.ToLower
                Case "google chrome"
                    If NuevaVentana = True Then URLComando += "--new-window "
                    If VentanaIncognito = True Then URLComando += "-incognito "
                    Dim Proceso As Process = Process.Start("Chrome", URLComando + "-url " + URL)
                Case "mozilla firefox"
                    If VentanaIncognito = True Then URLComando += "-private-window " Else If NuevaVentana = True Then URLComando += "-new-window "
                    Dim Proceso As Process = Process.Start("Firefox", URLComando + URL)
                Case "microsoft edge"
                    Dim Proceso As Process = Process.Start("Microsoft-edge:" + URL)
                Case "opera"
                    Dim Ruta As String = Get_Navegador_Ruta("opera")
                    If NuevaVentana = True Then URLComando += "--new-window "
                    If VentanaIncognito = True Then URLComando += "-incognito "
                    Dim Proceso As Process = Process.Start(Ruta, URLComando + "-url " + URL)
                Case "vivaldi"
                    Dim Ruta As String = Get_Navegador_Ruta("vivaldi")
                    If NuevaVentana = True Then URLComando += "--new-window "
                    If VentanaIncognito = True Then URLComando += "-incognito "
                    Dim Proceso As Process = Process.Start(Ruta, URLComando + "-url " + URL)
                Case "uc browser"
                    If NuevaVentana = True Then URLComando += "--new-window "
                    If VentanaIncognito = True Then URLComando += "-incognito "
                    Dim Proceso As Process = Process.Start("ucbrowser", URLComando + "-url " + URL)
                Case "brave"
                    If NuevaVentana = True Then URLComando += "--new-window "
                    If VentanaIncognito = True Then URLComando += "-incognito "
                    Dim Proceso As Process = Process.Start("brave", URLComando + "-url " + URL)
                Case Else
                    Dim Ruta As String = Get_Navegador_Ruta(Navegador)
                    If NuevaVentana = True Then URLComando += "--new-window "
                    If VentanaIncognito = True Then URLComando += "-incognito "
                    Dim Proceso As Process = Process.Start(Ruta, URLComando + "-url " + URL)
            End Select
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("b") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "b" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 2")
            Estadisticas.Estadisticas.Paginas_Webs += 1 : Estadisticas.Guardar()
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Aplicaciones "

    'Private Enum SHOW_WINDOW As Integer
    '    SW_HIDE = 0
    '    SW_SHOWNORMAL = 1
    '    SW_NORMAL = 1
    '    SW_SHOWMINIMIZED = 2
    '    SW_SHOWMAXIMIZED = 3
    '    SW_MAXIMIZE = 3
    '    SW_SHOWNOACTIVATE = 4
    '    SW_SHOW = 5
    '    SW_MINIMIZE = 6
    '    SW_SHOWMINNOACTIVE = 7
    '    SW_SHOWNA = 8
    '    SW_RESTORE = 9
    '    SW_SHOWDEFAULT = 10
    '    SW_FORCEMINIMIZE = 11
    '    SW_MAX = 11
    'End Enum

    Private Sub Aplicaciones(Accion As AccionST) ' (0) Accion, (1) Proceso, (2) Esperar / Forzar, (3) Activar / Abrir / Cerrar
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 4 Or Split(Accion.Settings, "|-|", , CompareMethod.Text)(1).Trim = "" Then Exit Sub
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("d") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "d" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 4")
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = True
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            Select Case Settings(0)
                Case "Activar Aplicacion"
                    For Each P As Process In Process.GetProcesses
                        If P.ProcessName.ToLower = Settings(1).ToLower Then
                            If IsIconic(P.Handle) = 1 Then ShowWindow(P.Handle, 9)
                            If IsIconic(P.MainWindowHandle) = 1 Then ShowWindow(P.MainWindowHandle, 9)
                            If Settings(1).ToLower = "chrome" Then ShowWindow(P.MainWindowHandle, 3) : ShowWindow(P.MainWindowHandle, 3)
                            Process_CL.SetActiveWindow(P.Handle) : Process_CL.SetActiveWindow(P.MainWindowHandle)
                            Process_CL.BringWindowToTop(P.Handle) : Process_CL.BringWindowToTop(P.MainWindowHandle)
                            Process_CL.SetForegroundWindow(P.Handle) : Process_CL.SetForegroundWindow(P.MainWindowHandle)
                            If Settings(1).ToLower <> "chrome" Then Try : AppActivate(P.Id) : Catch : End Try
                        End If
                    Next
                    If CBool(Settings(2)) = True Then Dim Contador As Integer : Do Until Proceso.CurrentProcess.Process_Name.ToLower = Settings(1).ToLower Or Contador = 100 : WaitTime(10) : Contador += 1 : Loop
                Case "Cerrar Aplicacion"
                    Dim Contador As Integer
Repite:             If Contador > 10 Then GoTo Sigue1 Else Contador += 1
                    Dim NoTerminado As Boolean = True
                    For Each P As Process In Process.GetProcesses
                        Application.DoEvents()
                        If P.ProcessName.ToLower = Settings(1).ToLower Then NoTerminado = False : If CBool(Settings(2)) = False Then P.CloseMainWindow() Else P.Kill()
                    Next : If NoTerminado = False Then Threading.Thread.Sleep(50) : GoTo Repite
                Case "Esperar Aplicacion"
                    Select Case Settings(3)
                        Case "Activar"
                            Do Until Proceso.CurrentProcess.Process_Name.ToLower = Settings(1).ToLower : WaitTime(30) : Loop
                        Case "Abrir"
                            Do Until Process.GetProcessesByName(Settings(1)).Length > 0 : WaitTime(30) : Loop
                        Case "Cerrar"
                            Do Until Process.GetProcessesByName(Settings(1)).Length = 0 : WaitTime(30) : Loop
                    End Select
            End Select
Sigue1:     Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Ejecutar BAT "

    Private Sub EjecutarBAT(Accion As AccionST) ' (0) Nombre, (1) Ruta, (2) Modo, (3) Administrador
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 4 Or Split(Accion.Settings, "|-|", , CompareMethod.Text)(1).Trim = "" Then Exit Sub
            'Administrador = False
            If CBool(Split(Accion.Settings, "|-|", , CompareMethod.Text)(3)) = False Then
                CreateKPS() : RunProcess.RunAsStandar(KobaPathTemp + "KPS.exe", (Accion.Tipo + "|-|" + Accion.Settings).Replace("""", "|||"))
                If Estadisticas.Estadisticas.Acciones_Unicas.Contains("e") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "e" : Estadisticas.Guardar()
                Logros.Desbloquear("Accionista 5")
                Estadisticas.Estadisticas.BAT_Ejecutados += 1 : Estadisticas.Guardar()
                Exit Sub
            End If
            'Administrador = True
            Dim Ruta As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)(1)
            Dim WindowMode As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)(2)
            If IO.File.Exists(Ruta) = False Then Exit Sub
            Dim Texto_BAT As String : Dim Leer As New IO.StreamReader(Ruta) : Texto_BAT = Leer.ReadToEnd : Leer.Close() : If Texto_BAT.Trim = "" Then Exit Sub
            Dim P As New Process()
            Select Case WindowMode
                Case "Minimizado" : P.StartInfo.WindowStyle = ProcessWindowStyle.Minimized
                Case "Maximizado" : P.StartInfo.WindowStyle = ProcessWindowStyle.Maximized
                Case "Oculto" : P.StartInfo.CreateNoWindow = True : P.StartInfo.WindowStyle = ProcessWindowStyle.Hidden
                Case Else : P.StartInfo.WindowStyle = ProcessWindowStyle.Normal
            End Select
            P.StartInfo.FileName = Ruta : P.Start()
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("e") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "e" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 5")
            Estadisticas.Estadisticas.BAT_Ejecutados += 1 : Estadisticas.Guardar()
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#End Region

#Region " Audio y Video "

#Region " Captura de Pantalla "

    Private Sub CapturarPantalla(Accion As AccionST) ' (0) Sonido, (1) Tiempo, (2) Tiempo_Modo, (3) Cuenta_Atras, (4) OSD, (5) OSD_Font, (6) OSD_Color
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 7 Then Exit Sub
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("f") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "f" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 6")
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            If Settings(1).Trim = "" Then Settings(1) = "0" : If Settings(2).Trim = "" Then Settings(2) = "sec"
            Select Case Settings(2)
                Case "sec" : Settings(1) = Settings(1) * 1000
                Case "min" : Settings(1) = Settings(1) * 60000
            End Select
            Dim CuentaAtras As Boolean = Settings(3) : If CInt(Settings(1)) < 1000 Then CuentaAtras = False
            GCapturaPantalla_OSD = CBool(Settings(4)) : Opciones_OSD_Font = String_to_Font(Settings(5)) : Opciones_OSD_Color = String_to_Color(Settings(6))
            If GCapturaPantalla_Grabando = True Then
                GCapturaPantalla_Grabando = False : CapturandoPantalla = False : If GApagarEquipo_WaitTime IsNot Nothing Then GApagarEquipo_WaitTime.Stop()
                If CInt(Settings(1)) > 1000 Or CBool(Settings(4)) = True Then Sonidos.Play("Default", "CapturarPantalla")
                If CBool(Settings(4)) = True Then ShowOSD("Captura cancelada", 500)
            ElseIf GCapturaPantalla_Grabando = False Then
                GCapturaPantalla_Grabando = True : CapturandoPantalla = True
                If (CBool(Settings(4)) = False And CInt(Settings(1)) < 1000) Then
                    If FCapturaPantalla_Opening = True Then Exit Sub Else FCapturaPantalla_Opening = True
                    Try : FCapturarPantalla.Close() : Catch : Exit Sub : End Try
                    If GCapturaPantalla_Grabando = True Then FCapturarPantalla.Sonido = Settings(0) : Try : Capturar() : FCapturarPantalla.Show() : Catch : Exit Sub : End Try : GCapturaPantalla_Grabando = False : CapturandoPantalla = False : Estadisticas.Estadisticas.Capturas_Pantalla += 1 : Estadisticas.Guardar()
                Else
                    CapturandoPantalla = True : If CBool(Settings(4)) = True Then ShowOSD("Captura de pantalla", Settings(1), CuentaAtras, EndAnimation:=OSD_CL.AnimateMode.None)
                    GCapturaPantalla_WaitTime = New WaitTime_CL() : GCapturaPantalla_WaitTime.Start(Settings(1))
                    If FCapturaPantalla_Opening = True Then Exit Sub Else FCapturaPantalla_Opening = True
                    Try : FCapturarPantalla.Close() : Catch : Exit Sub : End Try
                    If GCapturaPantalla_Grabando = True Then FCapturarPantalla.Sonido = Settings(0) : Try : Capturar() : FCapturarPantalla.Show() : Catch : Exit Sub : End Try : GCapturaPantalla_Grabando = False : Estadisticas.Estadisticas.Capturas_Pantalla += 1 : Estadisticas.Guardar()
                End If
            End If
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Grabacion de Pantalla "

    Private Sub GrabarPantalla(Accion As AccionST) ' (0) Pantalla, (1) Desktop_Duplication, (2) Sonido, (3) Microfono, (4) MouseClicks, (5) Sonido, (6) Tiempo, (7) Tiempo_Modo, (8) Cuenta_Atras, (9) OSD, (10) OSD_Font, (11) OSD_Color
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 12 Then Exit Sub
            If FSelectDisplay.Visible = True Then FSelectDisplay.Close() : GGrabacionPantalla_Cancelar = True : Exit Sub
            If IO.File.Exists(Application.StartupPath + "\ScreenRecorderLib.dll") = False Then Exit Sub

            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("g") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "g" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 7")

            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            If Settings(6).Trim = "" Then Settings(6) = "0" : Settings(7) = "sec"
            Select Case Settings(7)
                Case "sec" : Settings(6) = Settings(6) * 1000
                Case "min" : Settings(6) = Settings(6) * 60000
            End Select
            Dim CuentaAtras As Boolean = Settings(8) : If CInt(Settings(6)) < 1000 Then CuentaAtras = False
            GGrabacionPantalla_OSD = CBool(Settings(9)) : Opciones_OSD_Font = String_to_Font(Settings(10)) : Opciones_OSD_Color = String_to_Color(Settings(11))

            If GGrabacionPantalla_Grabando = False And VideoRecorder.Recording = False Then
                Try : FVideoRecorder.Close() : Catch : Exit Sub : End Try
                If Settings(0) = "?" Then
                    If Screen.AllScreens.Count > 1 Then
                        If FSelectDisplay.Visible = False Then
                            FSelectDisplay.CDesktopDuplication.Checked = CBool(Settings(1))
                            FSelectDisplay.CSonido.Checked = CBool(Settings(2))
                            FSelectDisplay.CMicrofono.Checked = CBool(Settings(3))
                            FSelectDisplay.CMarcarClicks.Checked = CBool(Settings(4))
                            FSelectDisplay.ShowDialog()
                        End If
                        If GGrabacionPantalla_Cancelar = True Then GGrabacionPantalla_Cancelar = False : Exit Sub
                    Else
                        GGrabacionPantalla_Pantalla = 0
                        GGrabacionPantalla_DesktopDuplication = CBool(Settings(1))
                        GGrabacionPantalla_Sonido = CBool(Settings(2))
                        GGrabacionPantalla_Microfono = CBool(Settings(3))
                        GGrabacionPantalla_MarcarClicks = CBool(Settings(4))
                    End If
                Else
                    GGrabacionPantalla_Pantalla = Settings(0)
                    GGrabacionPantalla_DesktopDuplication = CBool(Settings(1))
                    GGrabacionPantalla_Sonido = CBool(Settings(2))
                    GGrabacionPantalla_Microfono = CBool(Settings(3))
                    GGrabacionPantalla_MarcarClicks = CBool(Settings(4))
                End If
                If GGrabacionPantalla_Pantalla >= Screen.AllScreens.Count Then Exit Sub
            End If

            If GGrabacionPantalla_Grabando = True And VideoRecorder.Recording = False Then
                GGrabacionPantalla_Grabando = False : GrabandoPantalla = False : If GGrabacionPantalla_WaitTime IsNot Nothing Then GGrabacionPantalla_WaitTime.Stop()
                If CInt(Settings(6)) > 1000 Or CBool(Settings(10)) = True Then Sonidos.Play("Default", "GrabarPantalla")
                If CBool(Settings(9)) = True Then ShowOSD("Grabación cancelada", 500)
            ElseIf GGrabacionPantalla_Grabando = False And VideoRecorder.Recording = False Then
                Try : FVideoRecorder.Close() : Catch : Exit Sub : End Try
                GGrabacionPantalla_Grabando = True
                Sonidos.Play(Settings(5), "GrabarPantalla") : If CBool(Settings(9)) = True Then ShowOSD("Grabación de pantalla", Settings(6), CuentaAtras, EndAnimation:=OSD_CL.AnimateMode.None)
                If GGrabacionPantalla_DesktopDuplication = True Then Sonidos.Play("Battery Low", "GrabarPantalla", True)
                GGrabacionPantalla_WaitTime = New WaitTime_CL() : GGrabacionPantalla_WaitTime.Start(Settings(6))
                If GGrabacionPantalla_Grabando = True Then GGrabacionPantalla_Grabando = False : VideoRecorder.Record(GGrabacionPantalla_Pantalla, GGrabacionPantalla_DesktopDuplication, GGrabacionPantalla_Sonido, GGrabacionPantalla_Microfono, Settings(4)) : GrabandoPantalla = True
            ElseIf GGrabacionPantalla_Grabando = False And VideoRecorder.Recording = True Then
                If FGrabacionPantalla_Opening = True Then Exit Sub Else FGrabacionPantalla_Opening = True
                GGrabacionPantalla_Grabando = False : VideoRecorder.Stop() : VideoRecorder.Recording = False : Threading.Thread.Sleep(100)
                FocusMe(Me) : GrabandoPantalla = False : FVideoRecorder.Monitor = VideoRecorder.RMonitor + 1 : Try : FVideoRecorder.Show() : Catch : Exit Sub : End Try : Estadisticas.Estadisticas.Grabaciones_Pantalla += 1 : Estadisticas.Guardar()
            ElseIf GGrabacionPantalla_Grabando = True And VideoRecorder.Recording = True Then
                VideoRecorder.Stop() : GrabandoPantalla = False
            End If
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Grabacion de Audio "

    Private Sub GrabarAudio(Accion As AccionST) ' (0) Sonido, (1) Tiempo, (2) Tiempo_Modo, (3) Cuenta_Atras, (4) OSD, (5) OSD_Font, (6) OSD_Color
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 7 Then Exit Sub
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("h") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "h" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 8")
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            If Settings(1).Trim = "" Then Settings(1) = "0" : If Settings(2).Trim = "" Then Settings(2) = "sec"
            Select Case Settings(2)
                Case "sec" : Settings(1) = Settings(1) * 1000
                Case "min" : Settings(1) = Settings(1) * 60000
            End Select
            If CInt(Settings(1)) < Sonidos.Duracion(Settings(0)) Then Settings(1) = Sonidos.Duracion(Settings(0))
            Dim CuentaAtras As Boolean = Settings(3) : If CInt(Settings(1)) < 1000 Then CuentaAtras = False
            GGrabacionAudio_OSD = CBool(Settings(4)) : Opciones_OSD_Font = String_to_Font(Settings(5)) : Opciones_OSD_Color = String_to_Color(Settings(6))
            If GGrabacionAudio_Grabando = True And GGrabacionAudio_Recorder.IsRecording = False Then
                GGrabacionAudio_Grabando = False : GrabandoAudio = False : If GApagarEquipo_WaitTime IsNot Nothing Then GApagarEquipo_WaitTime.Stop()
                If CInt(Settings(1)) > 1000 Or CBool(Settings(4)) = True Then Sonidos.Play("Default", "GrabarAudio")
                If CBool(Settings(4)) = True Then ShowOSD("Grabación cancelada", 500)
            ElseIf GGrabacionAudio_Grabando = False And GGrabacionAudio_Recorder.IsRecording = False Then
                Try : FAudioRecorder.Close() : Catch : Exit Sub : End Try
                GGrabacionAudio_Grabando = True
                Sonidos.Play(Settings(0), "GrabarAudio") : If CBool(Settings(4)) = True Then ShowOSD("Grabación de audio", Settings(1), CuentaAtras, EndAnimation:=OSD_CL.AnimateMode.Blend)
                GGrabacionAudio_WaitTime = New WaitTime_CL() : GGrabacionAudio_WaitTime.Start(Settings(1), Opciones_OSD_AnimationTime)
                If GGrabacionAudio_Grabando = True Then GGrabacionAudio_Grabando = False : GGrabacionAudio_Recorder.StartRecording() : GrabandoAudio = True
            ElseIf GGrabacionAudio_Grabando = False And GGrabacionAudio_Recorder.IsRecording = True Then
                If FGrabacionAudio_Opening = True Then Exit Sub Else FGrabacionAudio_Opening = True
                GGrabacionAudio_Grabando = False : GGrabacionAudio_Recorder.StopRecording() : FocusMe(Me) : GrabandoAudio = False : Try : FAudioRecorder.Show() : Catch : Exit Sub : End Try : Estadisticas.Estadisticas.Grabaciones_Audio += 1 : Estadisticas.Guardar()
            ElseIf GGrabacionAudio_Grabando = True And GGrabacionAudio_Recorder.IsRecording = True Then
                GGrabacionAudio_Recorder = New AudioRecorder_CL : GrabandoAudio = False
            End If
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Reproducir Sonido "

    Private Sub ReproducirSonido(Accion As AccionST) ' (0) Sonido, (1) Esperar
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 2 Then Exit Sub
            If Accion.Logger Is Nothing Then Accion.Logger = ""
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("j") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "j" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 10")
            If Comandos_GetByID(Accion.ParentID) <> -1 Then Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = True
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            If Accion.Logger.Contains("Iniciar") = True Or Accion.Logger.Contains("Salir") = True Then Settings(0) += "NoSonar"
            Sonidos.Play(Settings(0), Accion.ID, Settings(1))
            If Comandos_GetByID(Accion.ParentID) <> -1 Then Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Salida de Audio "

    Private Sub SalidaAudio(Accion As AccionST) ' (0) Sonido, (1) OSD, (2) OSD_Font, (3) OSD_Color, (4...) Audio_Devices
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 4 Then Exit Sub
            Dim SelectedAudioIndice As Integer = -1
            Dim SelectedAudios(0) As AudioAPI.AudioDeviceST
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            If Settings.Length > 4 Then
                For Cuenta = 4 To Settings.Length - 1
                    Dim TempAudio As AudioAPI.AudioDeviceST = Audio.GetAudioDevice(Settings(Cuenta))
                    If TempAudio.ID <> "" Then
                        If TempAudio.State.ToString = "Active" Then
                            ReDim Preserve SelectedAudios(Cuenta - 4)
                            SelectedAudios(SelectedAudios.Length - 1) = Audio.GetAudioDevice(Settings(Cuenta))
                            If SelectedAudios(SelectedAudios.Length - 1).Multimedia = True Then SelectedAudioIndice = SelectedAudios.Length - 1
                        End If
                    End If
                Next
            End If
            SelectedAudioIndice += 1 : If SelectedAudioIndice = SelectedAudios.Length Then SelectedAudioIndice = 0
            Dim AudioDevice As SalidaAudioST
Repite:     AudioDevice.ID = SelectedAudios(SelectedAudioIndice).ID
            If AudioDevice.ID = "" Then
                If SelectedAudioIndice + 1 >= SelectedAudios.Length Then Exit Sub Else SelectedAudioIndice += 1 : GoTo Repite
            End If
            AudioDevice.Sonido = Settings(0)
            AudioDevice.AccionID = Accion.ID
            Opciones_OSD_Font = String_to_Font(Settings(2)) : Opciones_OSD_Color = String_to_Color(Settings(3))
            If CBool(Settings(1)) = True Then HideOSD() : ShowOSD("Salida de Audio: " + SelectedAudios(SelectedAudioIndice).Name)
            Audio.SetDefault(AudioDevice.ID) : Sonidos.Play_Async(AudioDevice.Sonido, AudioDevice.AccionID)
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("i") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "i" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 9")
            Estadisticas.Estadisticas.Salidas_Audio += 1 : Estadisticas.Guardar()
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Volumen "

    Private Sub Volumen(Accion As AccionST) ' (0) Accion, (1) Intervalo
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 2 Then Exit Sub
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("k") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "k" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 11")
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            Select Case Settings(0)
                Case "Establecer Volumen"
                    If Settings(1).Trim = "" Then Settings(1) = "0"
                    If CInt(Settings(1)) > 100 Then Settings(1) = "100"
                    Audio.Volume(CInt(Settings(1)))
                Case "Silenciar Volumen" : Keyboard.Send_KeyPress(Keys.VolumeMute)
                Case "Subir Volumen" : Keyboard.Send_KeyPress(Keys.VolumeUp)
                Case "Bajar Volumen" : Keyboard.Send_KeyPress(Keys.VolumeDown)
            End Select
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#End Region

#Region " Utilidades "

#Region " Macros "

    Private Sub EjecutarMacro(Accion As AccionST) ' (0) Pausas_Ejecucion, (1) Eventos_Teclado, (2) Clicks_Raton, (3) Rueda_Raton, (4) Movimiento_Raton, (5) Repetir, (6) Esperar
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 8 Then Exit Sub
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            If CBool(Settings(6)) = True AndAlso Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = True Then MacroEjecutando = False : Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False : SendKeyRShiftBlock = False : Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False : Exit Sub
            If IO.File.Exists(KobaPath + "MACROs\" + Accion.ID + ".mcr") = False Then Exit Sub
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("n") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "n" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 14")
            MacroEjecutando = True : Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = True
            If CBool(Settings(7)) = True Then Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = True
            Dim WaitTime = New WaitTime_CL()
            SendKeyRShiftBlock = True : Keyboard.Send_Virtual_ReleaseAll()
Repite:     Keyboard.Send_ReleaseAll()
            Dim Leer As New IO.StreamReader(KobaPath + "MACROs\" + Accion.ID + ".mcr")
            Dim Linea() As String : Dim Tipo As NSListViewSK.NSListViewItemSK.TipoEN
            Do Until Leer.EndOfStream
                Linea = Split(Leer.ReadLine, "|-|", , CompareMethod.Text) : Tipo = CInt(Linea(1))
                Select Case Tipo
                    Case NSListViewSK.NSListViewItemSK.TipoEN.EsperarEjecucion
                        If CInt(Linea(0)) < 5 Then Linea(0) = 5
                        WaitTime.Start(Linea(0))
                    Case NSListViewSK.NSListViewItemSK.TipoEN.KeyDown
                        Keyboard.Send_KeyDown(Keyboard.String_to_Key(Linea(0)))
                    Case NSListViewSK.NSListViewItemSK.TipoEN.KeyUp
                        Keyboard.Send_KeyUp(Keyboard.String_to_Key(Linea(0)))
                    Case NSListViewSK.NSListViewItemSK.TipoEN.MouseDown
                        Keyboard.Send_MouseDown(Keyboard.String_to_Button(Linea(0)))
                    Case NSListViewSK.NSListViewItemSK.TipoEN.MouseUp
                        Keyboard.Send_MouseUp(Keyboard.String_to_Button(Linea(0)))
                    Case NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelDown
                        Keyboard.Send_Virtual_ScrollDown(Keyboard.Mouse_Buttons.Wheel)
                    Case NSListViewSK.NSListViewItemSK.TipoEN.MouseWheelUp
                        Keyboard.Send_Virtual_ScrollUp(Keyboard.Mouse_Buttons.Wheel)
                    Case NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelDown
                        Keyboard.Send_Virtual_ScrollDown(Keyboard.Mouse_Buttons.HWheel)
                    Case NSListViewSK.NSListViewItemSK.TipoEN.MouseHWheelUp
                        Keyboard.Send_Virtual_ScrollUp(Keyboard.Mouse_Buttons.HWheel)
                    Case NSListViewSK.NSListViewItemSK.TipoEN.MouseMove
                        Keyboard.Send_MouseMove(String_to_Point(Linea(0)))
                    Case NSListViewSK.NSListViewItemSK.TipoEN.MouseMoveR
                        Keyboard.Send_MouseMove(String_to_Point(Linea(0)), True)
                End Select : Application.DoEvents()
                If MacroEjecutando = False Then Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False : Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
                If Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False Then Keyboard.Send_ReleaseAll() : SendKeyRShiftBlock = False : Leer.Close() : Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False : GoTo Sigue1
            Loop : Leer.Close()
            If CBool(Settings(6)) = True And Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = True Then GoTo Repite
            MacroEjecutando = False : Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False : SendKeyRShiftBlock = False : Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
Sigue1:     Estadisticas.Estadisticas.Macros_Ejecutadas += 1 : Estadisticas.Guardar()
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

    Private Function String_to_Point(Texto As String) As Point
        Return New Point(System.Text.RegularExpressions.Regex.Match(Texto.Split(",")(0), "\d+").Value, System.Text.RegularExpressions.Regex.Match(Texto.Split(",")(1), "\d+").Value)
    End Function

    Private Function Forzar_VirtualKey(Tecla As String) As Boolean
        Dim Teclas As String = "PrintScreen, Numlock, WinKey, AppsKey, VolumeMute, MediaStop, MediaPlayPause, MediaPreviousTrack, MediaNextTrack, VolumeUp, VolumeDown, VolumeMute, LaunchMail, LaunchApplication1, LaunchApplication2, BrowserBack, BrowserFavorites, BrowserForward, BrowserHome, BrowserRefresh, BrowserSearch, BrowserStop"
        Return Teclas.Contains(Tecla)
    End Function

#End Region

#Region " K-Board "

    Private Sub KBoard(Accion As AccionST) ' (0) Accion, (1) Nombre, (2) OSD, (3) OSD_Font, (4) OSD_Color
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 5 Then Exit Sub
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text) : If Settings(1).Trim = "" Then Exit Sub
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("m") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "m" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 13")
            Select Case Settings(0)
                Case "K-Board (On/Off)"
                    For Cuenta = 0 To KBoards.Length - 1
                        If KBoards(Cuenta).Nombre.ToLower = Settings(1).ToLower Then
                            KBoards(Cuenta).Activo = Not KBoards(Cuenta).Activo
                            If KBoards(Cuenta).Activo = True Then Estadisticas.Estadisticas.KBoard_Ejecutados += 1 : Estadisticas.Guardar()
                            If CBool(Settings(2)) = True Then
                                Opciones_OSD_Font = String_to_Font(Settings(3)) : Opciones_OSD_Color = String_to_Color(Settings(4))
                                If KBoards(Cuenta).Activo = True Then ShowOSD("Script '" + Settings(1) + "' activado") Else ShowOSD("Script '" + Settings(1) + "' desactivado")
                            End If
                            For Cuenta2 = 0 To KBoards.Length - 1
                                If KBoards(Cuenta2).Nombre.ToLower <> Settings(1).ToLower Then KBoards(Cuenta2).Activo = False
                            Next
                            Exit For
                        End If
                    Next
                Case "Activar K-Board"
                    Estadisticas.Estadisticas.KBoard_Ejecutados += 1 : Estadisticas.Guardar()
                    For Cuenta = 0 To KBoards.Length - 1
                        If KBoards(Cuenta).Nombre.ToLower = Settings(1).ToLower Then KBoards(Cuenta).Activo = True Else KBoards(Cuenta).Activo = False
                    Next
                    If CBool(Settings(2)) = True Then
                        Opciones_OSD_Font = String_to_Font(Settings(3)) : Opciones_OSD_Color = String_to_Color(Settings(4))
                        ShowOSD("K-Board '" + Settings(1) + "' activado")
                    End If
                Case "Desactivar K-Board"
                    For Cuenta = 0 To KBoards.Length - 1
                        If KBoards(Cuenta).Nombre.ToLower = Settings(1).ToLower Then KBoards(Cuenta).Activo = False : Exit For
                    Next
                    If CBool(Settings(2)) = True Then
                        Opciones_OSD_Font = String_to_Font(Settings(3)) : Opciones_OSD_Color = String_to_Color(Settings(4))
                        ShowOSD("K-Board '" + Settings(1) + "' desactivado")
                    End If
                Case "Habilitar K-Board"
                    For Cuenta = 0 To KBoards.Length - 1
                        If KBoards(Cuenta).Nombre.ToLower = Settings(1).ToLower Then KBoards(Cuenta).Deshabilitado = False : Exit For
                    Next
                    If CBool(Settings(2)) = True Then
                        Opciones_OSD_Font = String_to_Font(Settings(3)) : Opciones_OSD_Color = String_to_Color(Settings(4))
                        ShowOSD("K-Board '" + Settings(1) + "' habiliado")
                    End If
                Case "Deshabilitar K-Board"
                    For Cuenta = 0 To KBoards.Length - 1
                        If KBoards(Cuenta).Nombre.ToLower = Settings(1).ToLower Then KBoards(Cuenta).Deshabilitado = True : Exit For
                    Next
                    If CBool(Settings(2)) = True Then
                        Opciones_OSD_Font = String_to_Font(Settings(3)) : Opciones_OSD_Color = String_to_Color(Settings(4))
                        ShowOSD("K-Board '" + Settings(1) + "' deshabilitador")
                    End If
            End Select
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " QuickMenu "

    Private Sub QuickMenu(Accion As AccionST) ' (0) Accion, (1) Nombre
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 2 Then Exit Sub
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text) : If Settings(0).Trim = "" Then Exit Sub
            QuickMenuRightClick = False
            For Cuenta = 0 To QuickMenus_F.Length - 1 : QuickMenu_F_SetAutoClose(QuickMenus_F(Cuenta), True, True) : QuickMenus_F(Cuenta).Close() : Next
            For Cuenta = 0 To QuickMenus_F.Length - 1
                If QuickMenus_F(Cuenta).Nombre.ToLower = Settings(0).ToLower Then
                    SetForegroundWindow(New Runtime.InteropServices.HandleRef(QuickMenus_F(Cuenta), QuickMenus_F(Cuenta).Handle))
                    QuickMenu_F_SetAutoClose(QuickMenus_F(Cuenta), False)
                    QuickMenus_F(Cuenta).Show(MousePosition.X, MousePosition.Y)
                Else
                    QuickMenu_F_SetAutoClose(QuickMenus_F(Cuenta), True, True)
                    QuickMenus_F(Cuenta).Close()
                End If
            Next
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            For Cuenta = 0 To QuickMenus_F.Length - 1
                If QuickMenus_F(Cuenta).Nombre.ToLower = Settings(0).ToLower Then
                    If Estadisticas.Estadisticas.Acciones_Unicas.Contains("o") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "o" : Estadisticas.Guardar()
                    Logros.Desbloquear("Accionista 15")
                    Estadisticas.Estadisticas.QuickMenus_Abiertos += 1 : Estadisticas.Guardar()
                End If
            Next
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Red Ad-Hoc "

    Private Sub RedAdHoc(Accion As AccionST) ' (0) Nombre, (1) Contraseña, (2) Sonido, (3) OSD, (4) OSD_Font, (5) OSD_Color
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 6 Then Exit Sub
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("l") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "l" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 12")
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            If Accion.Logger.Contains("Iniciar") = True Or Accion.Logger.Contains("Salir") = True Then Settings(2) += "NoSonar"
            If Red_AdHoc_Soportada() = False Then Sonidos.Play("Default", Accion.ID) : If CBool(Settings(3)) = True Then Opciones_OSD_Font = Opciones_MensajeIniciar_Fuente : Opciones_OSD_Color = Opciones_MensajeIniciar_Color : ShowOSD("Red Ad-Hoc no soportada") : Exit Sub
            Opciones_OSD_Font = String_to_Font(Settings(4)) : Opciones_OSD_Color = String_to_Color(Settings(5))
            If Settings(0) = "" Or Settings(1).Length < 8 Or Settings(1).Length > 63 Then Exit Sub
            Dim cActive As Boolean = Red_AdHoc_Activa()
            If cActive = True Then
                Dim cName As String = GetCMDValue("netsh wlan show hostednetwork", "Nombre de SSID").Replace("""", "")
                If cName = "" Then cName = GetCMDValue("netsh wlan show hostednetwork", "SSID name").Replace("""", "")
                Dim cPassword As String = GetCMDValue("netsh wlan show hostednetwork setting=security", "Clave de seguridad de usuario")
                If cPassword = "" Then cPassword = GetCMDValue("netsh wlan show hostednetwork setting=security", "User security key")
                If cName <> Settings(0) Or cPassword <> Settings(1) Then
                    If CBool(Settings(3)) = True Then ShowOSD("Red Ad-Hoc " + Settings(0) + " activada")
                    Logros.Desbloquear("Red abierta")
                    Sonidos.Play(Settings(2), Accion.ID) : Crear_Red_AdHoc(Settings(0), Settings(1))
                Else
                    If CBool(Settings(3)) = True Then ShowOSD("Red Ad-Hoc " + Settings(0) + " desactivada")
                    Sonidos.Play(Settings(2), Accion.ID) : Crear_Red_AdHoc(Settings(0), Settings(1), cActive)
                End If
            Else
                If CBool(Settings(3)) = True Then ShowOSD("Red Ad-Hoc " + Settings(0) + " activada")
                Logros.Desbloquear("Red abierta")
                Sonidos.Play(Settings(2), Accion.ID) : Crear_Red_AdHoc(Settings(0), Settings(1))
            End If : If GRedAdHoc.Visible = True Then Accion_Mostrar(Accion.Indice)
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#End Region

#Region " Acciones "

#Region " Enviar Pulsacion "

    Public SendKeyRShiftBlock As Boolean
    Private Sub EnviarPulsacion(Accion As AccionST) ' (0) Accion, (1) Pulsacion / Texto / Coordenadas
        If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 3 Then Exit Sub
        Try : Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text) : If Settings(1).Trim = "" Then Exit Sub
            Dim Ctrl, Shift, Alt, AltGr, Win, Acento, AcentoInvert, DosPuntos, Triangulo, isMouse As Boolean
            If Settings(0) = "Enviar Pulsació" Or Settings(0) = "Enviar Texto" Then SendKeyRShiftBlock = True : Keyboard.Send_Virtual_ReleaseAll()
            BlockInput(True) : Dim WaitTime = New WaitTime_CL()
            Select Case Settings(0)
                Case "Enviar Pulsación"
                    If Settings(1).ToLower.Contains("ctrl") Then Ctrl = True : Settings(1) = Settings(1).Replace("CTRL", "")
                    If Settings(1).ToLower.Contains("shift") Then Shift = True : Settings(1) = Settings(1).Replace("SHIFT", "")
                    If Settings(1).ToLower.Contains("alt") Then Alt = True : Settings(1) = Settings(1).Replace("ALT", "")
                    If Settings(1).ToLower.Contains("win") Then Win = True : Settings(1) = Settings(1).Replace("WIN", "")
                    If Settings(1).EndsWith("+") Then Settings(1) = Settings(1).Replace("+", "").Replace(" ", "") + "+" Else Settings(1) = Settings(1).Replace("+", "").Replace(" ", "")
                    Settings(1) = Settings(1).Replace("Mouse1", "Mouse 1").Replace("Mouse2", "Mouse 2").Replace("Mouse3", "Mouse 3").Replace("Mouse4", "Mouse 4").Replace("Mouse5", "Mouse 5").Replace("WheelDown", "Wheel Down").Replace("WheelUp", "Wheel Up")
                    isMouse = PressMouse(Settings(1))

                    Keyboard.Send_ReleaseAll()
                    If Win = True Then Keyboard.Send_KeyDown(Keys.LWin)
                    If Ctrl = True Then Keyboard.Send_KeyDown(Keys.LControlKey)
                    If Shift = True Then Keyboard.Send_KeyDown(Keys.LShiftKey)
                    If Alt = True Then Keyboard.Send_KeyDown(Keys.LMenu)
                    If isMouse = False Then
                        Keyboard.Send_KeyPress(Keyboard.String_to_Key(Settings(1)))
                    Else
                        Select Case Settings(1)
                            Case "Wheel Up" : Keyboard.Send_ScrollUp(Keyboard.Mouse_Buttons.Wheel)
                            Case "Wheel Down" : Keyboard.Send_ScrollDown(Keyboard.Mouse_Buttons.Wheel)
                            Case Else : Keyboard.Send_MousePress(Keyboard.String_to_Button(Settings(1)))
                        End Select
                    End If
                    If Alt = True Then Keyboard.Send_KeyUp(Keys.LMenu)
                    If Shift = True Then Keyboard.Send_KeyUp(Keys.LShiftKey)
                    If Ctrl = True Then Keyboard.Send_KeyUp(Keys.LControlKey)
                    If Win = True Then Keyboard.Send_KeyUp(Keys.LWin) : WaitTime = New WaitTime_CL() : WaitTime.Start(100)
                    ' WaitTime = New WaitTime_CL() : WaitTime.Start(100)
                Case "Enviar Texto"
                    For Each c As Char In Settings(1) : Shift = False : AltGr = False : Acento = False : AcentoInvert = False : DosPuntos = False : Triangulo = False
                        Dim AcentoList As String = "áéíóúÁÉÍÓÚ" : If AcentoList.Contains(c) Then Acento = True
                        Dim AcentoInvertList As String = "àèìòùÀÈÌÒÙ" : If AcentoInvertList.Contains(c) Then AcentoInvert = True
                        Dim DosPuntosList As String = "äëïöüÄËÏÖÜ" : If DosPuntosList.Contains(c) Then DosPuntos = True
                        Dim TrianguloList As String = "âêîôûÂÊÎÔÛ" : If TrianguloList.Contains(c) Then Triangulo = True
                        Shift = PressShift(c) : AltGr = PressAltGr(c)

                        Keyboard.Send_ReleaseAll()
                        If Acento = True Then Keyboard.Send_KeyPress(Keys.Oem7)
                        If AcentoInvert = True Then Keyboard.Send_KeyPress(Keys.Oem1)
                        If DosPuntos = True Then Keyboard.Send_KeyDown(Keys.LShiftKey) : Keyboard.Send_KeyPress(Keys.Oem7) : Keyboard.Send_KeyUp(Keys.LShiftKey)
                        If Triangulo = True Then Keyboard.Send_KeyDown(Keys.LShiftKey) : Keyboard.Send_KeyPress(Keys.Oem1) : Keyboard.Send_KeyUp(Keys.LShiftKey)
                        If AltGr = True Then Keyboard.Send_KeyDown(Keys.LControlKey) : Keyboard.Send_KeyDown(Keys.LMenu)
                        If Shift = True Then Keyboard.Send_KeyDown(Keys.LShiftKey)
                        Keyboard.Send_KeyPress(Keyboard.String_to_Key(c))
                        If Shift = True Then Keyboard.Send_KeyUp(Keys.LShiftKey)
                        If AltGr = True Then Keyboard.Send_KeyUp(Keys.LControlKey) : Keyboard.Send_KeyUp(Keys.LMenu)
                    Next
                    ' WaitTime = New WaitTime_CL() : WaitTime.Start(100)
                Case "Mover Ratón"
                    If Settings(1).Split("-").Length > 1 Then Dim cLocation As New Point(Settings(1).Split("-")(0), Settings(1).Split("-")(1)) : Keyboard.Send_MouseMove(cLocation)
                Case "Desplazar Ratón"
                    If Settings(1).Split("-").Length > 1 Then Dim cLocation As New Point(Settings(1).Split("-")(0), Settings(1).Split("-")(1)) : Keyboard.Send_MouseMove(cLocation, True)
            End Select
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try : BlockInput(False) : SendKeyRShiftBlock = False
        If Estadisticas.Estadisticas.Acciones_Unicas.Contains("p") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "p" : Estadisticas.Guardar()
        Logros.Desbloquear("Accionista 16")
    End Sub

    Private Function PressShift(c As Char) As Boolean
        If Asc(c) > 64 AndAlso Asc(c) < 91 Then
            If My.Computer.Keyboard.CapsLock = False Then Return True
        ElseIf Asc(c) > 96 AndAlso Asc(c) < 123 Then
            If My.Computer.Keyboard.CapsLock = True Then Return True
        End If
        Dim AcentoUpperList As String = "ÁÉÍÓÚ" : If AcentoUpperList.Contains(c) Then If My.Computer.Keyboard.CapsLock = False Then Return True
        Dim AcentoLowerList As String = "áéíóú" : If AcentoLowerList.Contains(c) Then If My.Computer.Keyboard.CapsLock = True Then Return True

        Dim AcentoInvertUpperList As String = "ÀÈÌÒÙ" : If AcentoInvertUpperList.Contains(c) Then If My.Computer.Keyboard.CapsLock = False Then Return True
        Dim AcentoInvertLowerList As String = "àèìòù" : If AcentoInvertLowerList.Contains(c) Then If My.Computer.Keyboard.CapsLock = True Then Return True

        Dim DosPuntosUpperList As String = "ÄËÏÖÜ" : If DosPuntosUpperList.Contains(c) Then If My.Computer.Keyboard.CapsLock = False Then Return True
        Dim DosPuntosLowerList As String = "äëïöü" : If DosPuntosLowerList.Contains(c) Then If My.Computer.Keyboard.CapsLock = True Then Return True

        Dim TrianguloUpperList As String = "ÂÊÎÔÛ" : If TrianguloUpperList.Contains(c) Then If My.Computer.Keyboard.CapsLock = False Then Return True
        Dim TrianguloLowerList As String = "âêîôû" : If TrianguloLowerList.Contains(c) Then If My.Computer.Keyboard.CapsLock = True Then Return True

        If c = "ç" Then If My.Computer.Keyboard.CapsLock = True Then Return True
        If c = "Ç" Then If My.Computer.Keyboard.CapsLock = False Then Return True
        Dim ShiftList As String = "ª!""·$%&/()=?¿^*¨>;:_" : If ShiftList.Contains(c) Then Return True

        Return False
    End Function

    Private Function PressAltGr(c As Char) As Boolean
        Dim AltGrList As String = "\|@#~€¬[]{}€" : If AltGrList.Contains(c) Then Return True
        Return False
    End Function

    Private Function PressMouse(Pulsacion As String) As Boolean
        Dim MouseList As String = "Mouse 1 Mouse 2 Mouse 3 Mouse 4 Mouse 5 Wheel Up Wheel Down" : If MouseList.Contains(Pulsacion) Then Return True
        Return False
    End Function

#End Region

#Region " TopMost "

    Public Sub TopMostEn(Accion As AccionST) ' (0) Sonido, (1) OSD, (2) OSD_Font, (3) OSD_Color
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 4 Then Exit Sub
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            If Accion.Logger.Contains("Iniciar") = True Or Accion.Logger.Contains("Salir") = True Then Settings(0) += "NoSonar"
            Dim ProcessTitle As String = Proceso.CurrentProcess.Window_Title
            Dim ProcessHandle As IntPtr = Proceso.CurrentProcess.Process_Handle

            If ProcessTitle = Version AndAlso Accion.Notas.Contains("Menu_Lista") = True Then Exit Sub
            If ProcessTitle = "" Then Exit Sub
            If AppsTopMost.Contains(ProcessTitle) Then
                If Accion.Notas = "QuickMenu" Then Process_CL.SetWindowPos(ProcessHandle, New IntPtr(-&H2), 0, 0, 0, 0, &H2 Or &H1) Else Process_CL.SetWindowPos(Process_CL.GetForegroundWindow, New IntPtr(-&H2), 0, 0, 0, 0, &H2 Or &H1)
                AppsTopMost.Remove(ProcessTitle) : If Settings(0) <> "" And Settings(0) <> "Sin Sonido" Then Sonidos.Play("Default", Accion.ID)
                If CBool(Settings(1)) = True Then
                    Opciones_OSD_Font = String_to_Font(Settings(2)) : Opciones_OSD_Color = String_to_Color(Settings(3))
                    ShowOSD("TopMost: Desactivado en " + ProcessTitle)
                End If
            Else
                If Accion.Notas = "QuickMenu" Then Process_CL.SetWindowPos(ProcessHandle, New IntPtr(-&H1), 0, 0, 0, 0, &H2 Or &H1) Else Process_CL.SetWindowPos(Process_CL.GetForegroundWindow, New IntPtr(-&H1), 0, 0, 0, 0, &H2 Or &H1)
                AppsTopMost.Add(ProcessTitle) : Sonidos.Play(Settings(0), Accion.ID)
                If CBool(Settings(1)) = True Then
                    Opciones_OSD_Font = String_to_Font(Settings(2)) : Opciones_OSD_Color = String_to_Color(Settings(3))
                    ShowOSD("TopMost: Activado en " + ProcessTitle)
                    Estadisticas.Estadisticas.TopMost_Ejecutados += 1 : Estadisticas.Guardar()
                End If
            End If
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("q") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "q" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 17")
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Archivos Ocultos "

    Public Sub ArchivosOcultos(Accion As AccionST) ' (0) Sonido, (1) OSD, (2) OSD_Font, (3) OSD_Color
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 4 Then Exit Sub
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            If Accion.Logger.Contains("Iniciar") = True Or Accion.Logger.Contains("Salir") = True Then Settings(0) += "NoSonar"
            Dim key = Microsoft.Win32.Registry.CurrentUser.OpenSubKey("Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced", True)
            Dim IsHidden As Boolean = Not CBool(key.GetValue("Hidden")) : key.SetValue("Hidden", If(IsHidden, 1, 0)) : key.Close()
            Sonidos.Play(Settings(0), Accion.ID)
            If CBool(Settings(1)) = True Then
                Opciones_OSD_Font = String_to_Font(Settings(2)) : Opciones_OSD_Color = String_to_Color(Settings(3))
                If IsHidden = False Then ShowOSD("Ocultar archivos") Else ShowOSD("Mostrar archivos")
            End If
            PostMessage(GetWindow(FindWindow("Progman", "Program Manager"), 3), 256, &H74, 3)
            Dim obj4 As Object = Type.GetTypeFromCLSID(New Guid("13709620-C279-11CE-A49E-444553540000"), True).InvokeMember("Windows", Reflection.BindingFlags.InvokeMethod, Nothing, Activator.CreateInstance(Type.GetTypeFromCLSID(New Guid("13709620-C279-11CE-A49E-444553540000"), True)), New Object(0 - 1) {}) : Dim type1 As Type = obj4.GetType : Dim obj2 As Object = type1.InvokeMember("Count", Reflection.BindingFlags.GetProperty, Nothing, obj4, Nothing)
            If (CInt(obj2) <> 0) Then
                Dim num2 As Integer = (CInt(obj2) - 1) : Dim i As Integer = 0 : Do While (i <= num2)
                    Dim obj5 As Object = type1.InvokeMember("Item", Reflection.BindingFlags.InvokeMethod, Nothing, obj4, New Object() {i}) : Dim type3 As Type = obj5.GetType
                    If (CStr(type3.InvokeMember("Name", Reflection.BindingFlags.GetProperty, Nothing, obj5, Nothing)).ToLower = "file explorer") Then type3.InvokeMember("Refresh", Reflection.BindingFlags.InvokeMethod, Nothing, obj5, Nothing)
                    If (CStr(type3.InvokeMember("Name", Reflection.BindingFlags.GetProperty, Nothing, obj5, Nothing)).ToLower = "explorador de archivos") Then type3.InvokeMember("Refresh", Reflection.BindingFlags.InvokeMethod, Nothing, obj5, Nothing)
                    i += 1
                Loop
            End If
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("s") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "s"
            Logros.Desbloquear("Accionista 19")
            Estadisticas.Estadisticas.Archivos_Ocultados += 1 : Estadisticas.Guardar()
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " DesactivarEn "

    Public Sub DesactivarEn(Accion As AccionST) ' (0) Sonido, (1) OSD, (2) OSD_Font, (3) OSD_Color
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 4 Then Exit Sub
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            If Accion.Logger.Contains("Iniciar") = True Or Accion.Logger.Contains("Salir") = True Then Settings(0) += "NoSonar"
            Dim ProcessName As String = Proceso.CurrentProcess.Process_Name : Dim Desactivar_Accion As String = "Desactivar"
            If ProcessName.Length > 2 Then ProcessName = ProcessName.Substring(0, 1).ToUpper + ProcessName.Substring(1)
            If ProcessName Is Nothing OrElse (ProcessName.ToLower = "kdesktop" Or ProcessName = "") Then Exit Sub
            Desactivar = Registro.GetRegValueNames(RegPath + "\Opciones\Desactivar")
            For Cuenta = 0 To Desactivar.Length - 1
                If Desactivar(Cuenta).ToLower = ProcessName.ToLower Then Registro.DelRegKey(RegPath + "\Opciones\Desactivar", ProcessName) : Desactivar_Accion = "Activar"
            Next
            Select Case Desactivar_Accion
                Case "Desactivar"
                    Registro.SetRegKey(RegPath + "\Opciones\Desactivar", ProcessName.Substring(0, 1).ToUpper + ProcessName.Substring(1), "")
                    If CBool(Settings(1)) = True Then
                        Opciones_OSD_Font = String_to_Font(Settings(2)) : Opciones_OSD_Color = String_to_Color(Settings(3))
                        ShowOSD("K-Desktop: Desactivado en el proceso """ + ProcessName + """")
                    End If
                Case "Activar"
                    If CBool(Settings(1)) = True Then
                        Opciones_OSD_Font = String_to_Font(Settings(2)) : Opciones_OSD_Color = String_to_Color(Settings(3))
                        ShowOSD("K-Desktop: Activado en el proceso """ + ProcessName + """")
                    End If
                    If Settings(0) <> "" And Settings(0) <> "Sin Sonido" Then Settings(0) = "Default"
            End Select : Sonidos.Play(Settings(0), Accion.ID)
            Desactivar = Registro.GetRegValueNames(RegPath + "\Opciones\Desactivar")
            Opciones_Desactivar_CCProcesos.Items.Clear() : If Desactivar.Length > 0 Then
                For Cuenta = 0 To Desactivar.Length - 1
                    If Desactivar(Cuenta).Trim <> "" Then Opciones_Desactivar_CCProcesos.Items.Add(Desactivar(Cuenta))
                Next
            End If
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("t") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "t"
            Logros.Desbloquear("Accionista 20")
            Estadisticas.Estadisticas.DesactivadoEn += 1 : Estadisticas.Guardar()
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Mostrar Mensaje "

    Private Sub MostrarMensaje(Accion As AccionST) ' (0) Mensaje, (1) Tiempo, (2) Tiempo_Modo, (3) Cuenta_Atras, (4) Esperar, (5) OSD_Font, (6) OSD_Color, (7) Sonido
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 8 Then Exit Sub
            Dim IndiceID As Integer = Comandos_GetByID(Accion.ParentID)
            If IndiceID <> -1 Then Comandos(IndiceID).Accion(Accion.Indice).Esperando = True
            GMostrarMensaje_Mostrando = True
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            If Accion.Logger.Contains("Iniciar") = True Or Accion.Logger.Contains("Salir") = True Then Settings(7) += "NoSonar"
            If Settings(0) = "" Then Settings(0) = " "
            If Settings(1).Trim = "" Then Settings(1) = "0"
            If Settings(2).Trim = "" Then Settings(2) = "sec"
            Select Case Settings(2)
                Case "sec" : Settings(1) = Settings(1) * 1000
                Case "min" : Settings(1) = Settings(1) * 60000
            End Select
            If CInt(Settings(1)) < 1000 Then Settings(3) = "False"
            Opciones_OSD_Font = String_to_Font(Settings(5)) : Opciones_OSD_Color = String_to_Color(Settings(6))
            ShowOSD(Settings(0), Settings(1), Settings(3))
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("v") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "v" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 22")
            Sonidos.Play(Settings(7), Accion.ID)
            If CBool(Settings(4)) = True Then GMostrarMensaje_WaitTime = New WaitTime_CL() : GMostrarMensaje_WaitTime.Start(Settings(1))
            GMostrarMensaje_Mostrando = False
            If IndiceID <> -1 Then Comandos(IndiceID).Accion(Accion.Indice).Esperando = False
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Apagar Equipo "

    Private Sub ApagarEquipo(Accion As AccionST) ' (0) Accion, (1) Sonido, (2) Tiempo, (3) Tiempo_Modo, (4) Cuenta_Atras, (5) OSD, (6) OSD_Font, (7) OSD_Color
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 8 Then Exit Sub
            If GApagarEquipo_Apagando = True Then GApagarEquipo_Apagando = False : Sonidos.Play("Default", Accion.ID) : GApagarEquipo_WaitTime.Stop() : HideOSD() : Exit Sub
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("w") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "w" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 23")
            Estadisticas.Estadisticas.Apagado_Equipo += 1 : Estadisticas.Guardar()
            If (Estadisticas.Estadisticas.Apagado_Equipo >= 100) Then Logros.Desbloquear("Corto-Circuíto")
            GApagarEquipo_Apagando = True
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            GApagarEquipo_Accion = Settings(0)
            If Settings(2).Trim = "" Then Settings(2) = "0"
            If Settings(3).Trim = "" Then Settings(3) = "sec"
            Select Case Settings(3)
                Case "sec" : Settings(2) = Settings(2) * 1000
                Case "min" : Settings(2) = Settings(2) * 60000
            End Select
            ApagandoEquipo = True : Dim CuentaAtras As Boolean = Settings(4) : If CInt(Settings(2)) < 1000 Then CuentaAtras = False
            GApagarEquipo_OSD = CBool(Settings(5))
            If CBool(Settings(5)) = False And CuentaAtras = False Then GoTo Salta
            If CBool(Settings(5)) = True Then
                Opciones_OSD_Font = String_to_Font(Settings(6)) : Opciones_OSD_Color = String_to_Color(Settings(7))
                ShowOSD(Settings(0), Settings(2), CuentaAtras)
            End If
            If Settings(0) <> "Cambiar Usuario" Then Sonidos.Play(Settings(1), Accion.ID)
            GApagarEquipo_WaitTime = New WaitTime_CL() : GApagarEquipo_WaitTime.Start(Settings(2))
            ApagandoEquipo = False : If GApagarEquipo_Apagando = False Then Exit Sub
Salta:      If Settings(0) = "Cambiar Usuario" Then
                Sonidos.Play(Settings(1), "ApagarEquipo") : GApagarEquipo_WaitTime = New WaitTime_CL() : GApagarEquipo_WaitTime.Start(Sonidos.Duracion(Settings(1)))
                GApagarEquipo_Apagando = False : LockWorkStation()
            Else
                GApagarEquipo_Accion = Settings(0) : GApagarEquipo_Sonido = Settings(1) : ShowF("SalirS")
            End If
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Comandos "

    Private Sub EjeComando(Accion As AccionST) ' (0) Accion, (1) Nombre_Comando
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 2 Then Exit Sub
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            Dim Indice As Integer
            If Settings(1) = "" Then Exit Sub
            For Cuenta = 0 To Comandos.Length - 1
                If Comandos(Cuenta).ID = Settings(1) Then Indice = Cuenta : GoTo Sigue
            Next : Exit Sub
Sigue:      If Accion.ParentID = Settings(1) Then Exit Sub
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("x") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "x" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 24")
            Select Case Settings(0)
                Case "Ejecutar Comando"
                    If Accion.Notas Is Nothing OrElse Accion.Notas.Contains(Accion.ParentID) = False Then
                        Dim cEjecutarComando As EjecutarComandoST = Nothing
                        cEjecutarComando.Indice_Comando = Indice
                        cEjecutarComando.ID_Comando = Comandos(Indice).ID
                        cEjecutarComando.Sonido = Comandos(Indice).Sonido
                        cEjecutarComando.Logger = "Keyboard"
                        cEjecutarComando.Notas += Accion.Notas + Accion.ParentID + "|-|" : If cEjecutarComando.Notas.Contains("EjeComando") = False Then cEjecutarComando.Notas += "EjeComando|-|"
                        Comandos(Indice).EnEjecucion = True
                        EjecutarComando(cEjecutarComando)
                    End If
                Case "Habilitar Comando"
                    Comandos(Indice).Deshabilitar = False : If ComandoActualID = Settings(1) Then Comandos_Deshabilitar_CDeshabilitar.Checked = Comandos(Indice).Deshabilitar : Comandos_Deshabilitar_Click(Nothing, Nothing)
                    Comando_GuardarValor("Deshabilitar", Indice)
                Case "Deshabilitar Comando"
                    Comandos(Indice).Deshabilitar = True : If ComandoActualID = Settings(1) Then Comandos_Deshabilitar_CDeshabilitar.Checked = Comandos(Indice).Deshabilitar : Comandos_Deshabilitar_Click(Nothing, Nothing)
                    Comando_GuardarValor("Deshabilitar", Indice)
                Case "Comando (On/Off)"
                    Comandos(Indice).Deshabilitar = Not Comandos(Indice).Deshabilitar : If ComandoActualID = Settings(1) Then Comandos_Deshabilitar_CDeshabilitar.Checked = Comandos(Indice).Deshabilitar : Comandos_Deshabilitar_Click(Nothing, Nothing)
                    Comando_GuardarValor("Deshabilitar", Indice)
            End Select
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#Region " Esperar "

    Private Sub Esperar(Accion As AccionST) ' (0) Tiempo, (1) Tiempo_Modo, (2) Cuenta_Atras, (3) OSD, (4) OSD_Font, (5) OSD_Color, (6) Mensaje
        Try : If Split(Accion.Settings, "|-|", , CompareMethod.Text).Length < 7 Then Exit Sub
            Dim IndiceID As Integer = Comandos_GetByID(Accion.ParentID)
            If IndiceID <> -1 Then Comandos(IndiceID).Accion(Accion.Indice).Esperando = True
            GEsperar_Esperando = True
            Dim Settings() As String = Split(Accion.Settings, "|-|", , CompareMethod.Text)
            If Settings(0).Trim = "" Then Settings(0) = "0"
            If Settings(1).Trim = "" Then Settings(1) = "sec"
            Select Case Settings(1)
                Case "sec" : Settings(0) = Settings(0) * 1000
                Case "min" : Settings(0) = Settings(0) * 60000
            End Select
            If CBool(Settings(3)) = True AndAlso CInt(Settings(0)) >= 1000 AndAlso (CBool(Settings(2)) = True Or Settings(6).Trim <> "") Then
                Opciones_OSD_Font = String_to_Font(Settings(4)) : Opciones_OSD_Color = String_to_Color(Settings(5))
                ShowOSD(Settings(6), Settings(0), CBool(Settings(2)))
            End If
            If Estadisticas.Estadisticas.Acciones_Unicas.Contains("u") = False Then Estadisticas.Estadisticas.Acciones_Unicas += "u" : Estadisticas.Guardar()
            Logros.Desbloquear("Accionista 21")
            GEsperar_WaitTime = New WaitTime_CL() : GEsperar_WaitTime.Start(Settings(0))
            GEsperar_Esperando = False
            If IndiceID <> -1 Then Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
        Catch
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).Esperando = False
            Comandos(Comandos_GetByID(Accion.ParentID)).Accion(Accion.Indice).EnEjecucion = False
        End Try
    End Sub

#End Region

#End Region

#Region " Otros "

#Region " RunCMD "

    Public Sub RunCMD(Comando As String, Optional ShowWindow As Boolean = False, Optional WaitForProcessComplete As Boolean = False)
        Try : Dim P As New Process() : P.StartInfo.FileName = "cmd.exe"
            P.StartInfo.Arguments = " " + If(ShowWindow, "/K", "/C") + " " + Comando

            P.StartInfo.CreateNoWindow = Not ShowWindow : If ShowWindow = False Then P.StartInfo.WindowStyle = ProcessWindowStyle.Hidden
            P.Start()
            If WaitForProcessComplete Then Do Until P.HasExited : Application.DoEvents() : Loop
        Catch : End Try
    End Sub

#End Region

#Region " Deshabilitado "

    Public Function Deshabilitado() As Boolean
        'Try
        For Cuenta = 0 To Desactivar.Length - 1
            If Desactivar(Cuenta) <> "" And Proceso.CurrentProcess.Process_Name.ToLower <> "" Then If Desactivar(Cuenta).ToLower = Proceso.CurrentProcess.Process_Name.ToLower Then Return True
        Next
        'atch : End Try
        Return False
    End Function

#End Region

#Region " Existe Comando "

    Public Function Comando_Existe_Hotkey(Comando_HotKey As String) As Boolean
        'Try
        Dim IsDeshabilitado As Boolean = Deshabilitado()
        For Cuenta = 0 To Comandos.Length - 1
            For Cuenta2 = 0 To Comandos(Cuenta).Hotkey.Length - 1
                If Comando_HotKey.ToLower = Comandos(Cuenta).Hotkey(Cuenta2).ToLower And Comandos(Cuenta).Deshabilitar = False Then
                    If IsDeshabilitado = True Then
                        Dim DescactivarEnTipo As Boolean
                        For Cuenta3 = 0 To Comandos(Cuenta).Accion.Length - 1
                            If Comandos(Cuenta).Accion(Cuenta3).Tipo = "Desactivar en (On/Off)" Then DescactivarEnTipo = True : Exit For
                        Next
                        If (Comandos(Cuenta).EjecutarSiempre = True Or DescactivarEnTipo = True) And Comandos(Cuenta).BloquearPulsacion = True Then Return True
                    Else
                        If Comandos(Cuenta).BloquearPulsacion = True Then Return True
                    End If
                End If
            Next
        Next
        'Catch : End Try
        Return False
    End Function

    Public Function Comando_Existe(Comando_ID As String) As Boolean
        'Try
        For Cuenta = 0 To Comandos.Length - 1
            If Comandos(Cuenta).ID = Comando_ID Then Return True
        Next
        'Catch : End Try
        Return False
    End Function

    Public Function Comando_Get(Comando_ID As String) As ComandosST
        'Try
        For Cuenta = 0 To Comandos.Length - 1
            If Comandos(Cuenta).ID = Comando_ID Then Return Comandos(Cuenta)
        Next
        'Catch : End Try
        Return Nothing
    End Function

#End Region

#End Region

#End Region

#End Region

#Region " Borrar "

    Private Sub GGrabacionPantalla_Microfono_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LGMicrofono.DoubleClick, GGrabacionPantalla_CGMicrofono.DoubleClick

    End Sub

    Private Sub GGrabacionPantalla_Sonido_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LGSonido.DoubleClick, GGrabacionPantalla_CGSonido.DoubleClick

    End Sub

    Private Sub GGrabacionPantalla_BIdentificar_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_BIdentificar.Click

    End Sub

    Private Sub GGrabacionPantalla_Preguntar_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LPreguntar.DoubleClick, GGrabacionPantalla_CPreguntar.DoubleClick

    End Sub

    Private Sub GGrabacionPantalla_Pantalla4_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LPantalla4.DoubleClick, GGrabacionPantalla_CPantalla4.DoubleClick

    End Sub

    Private Sub GGrabacionPantalla_Pantalla3_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LPantalla3.DoubleClick, GGrabacionPantalla_CPantalla3.DoubleClick

    End Sub

    Private Sub GGrabacionPantalla_Pantalla2_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LPantalla2.DoubleClick, GGrabacionPantalla_CPantalla2.DoubleClick

    End Sub

    Private Sub GGrabacionPantalla_Pantalla1_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LPantalla1.DoubleClick, GGrabacionPantalla_CPantalla1.DoubleClick

    End Sub

    Private Sub GGrabacionPantalla_CuentaAtras_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LCuentaAtras.DoubleClick, GGrabacionPantalla_CCuentaAtras.DoubleClick

    End Sub

    Private Sub GGrabacionPantalla_LFormato_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LFormato.DoubleClick

    End Sub

    Private Sub GGrabacionPantalla_BPlay_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_BPlay.Click

    End Sub

    Private Sub GGrabacionPantalla_LHelp_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LHelp.DoubleClick

    End Sub

    Private Sub GGrabacionPantalla_LCSonido_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_TSonido.Click

    End Sub

    Private Sub GGrabacionPantalla_OSD_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LOSD.DoubleClick, GGrabacionPantalla_COSD.DoubleClick

    End Sub

    Private Sub GCapturaPantalla_CuentaAtras_Click(sender As Object, e As EventArgs) Handles GCapturaPantalla_LCuentaAtras.DoubleClick, GCapturaPantalla_CCuentaAtras.DoubleClick

    End Sub

    Private Sub GCapturaPantalla_LFormato_Click(sender As Object, e As EventArgs) Handles GCapturaPantalla_LFormato.DoubleClick

    End Sub

    Private Sub GCapturaPantalla_BPlay_Click(sender As Object, e As EventArgs) Handles GCapturaPantalla_BPlay.Click

    End Sub

    Private Sub GCapturaPantalla_LHelp_Click(sender As Object, e As EventArgs) Handles GCapturaPantalla_LHelp.DoubleClick

    End Sub

    Private Sub GCapturaPantalla_LCSonido_Click(sender As Object, e As EventArgs) Handles GCapturaPantalla_TSonido.Click

    End Sub

    Private Sub GCapturaPantalla_OSD_Click(sender As Object, e As EventArgs) Handles GCapturaPantalla_LOSD.DoubleClick, GCapturaPantalla_COSD.DoubleClick

    End Sub

    Private Sub GMacro_PBoton_Click(sender As Object, e As EventArgs) Handles GMacro_PBoton.DoubleClick, GMacro_PBoton.Click

    End Sub

    Private Sub GMacro_PAccion_Click(sender As Object, e As EventArgs) Handles GMacro_PAccion.DoubleClick, GMacro_PAccion.Click

    End Sub

    Private Sub GMacro_PTecla_Click(sender As Object, e As EventArgs) Handles GMacro_PTecla.DoubleClick, GMacro_PTecla.Click

    End Sub

    Private Sub GMacro_LCBoton_Click(sender As Object, e As EventArgs) Handles GMacro_TBoton.Click

    End Sub

    Private Sub GMacro_TAccion_Click(sender As Object, e As EventArgs) Handles GMacro_TAccion.Click

    End Sub

    Private Sub GMacro_Esperar_Click(sender As Object, e As EventArgs) Handles GMacro_LEsperar.DoubleClick, GMacro_CEsperar.DoubleClick

    End Sub

    Private Sub GMacro_PGrabar_Click(sender As Object, e As EventArgs) Handles GMacro_PGrabar.DoubleClick

    End Sub

    Private Sub GMacro_PClear_Click(sender As Object, e As EventArgs) Handles GMacro_PClear.DoubleClick

    End Sub

    Private Sub GMacro_PEliminar_Click(sender As Object, e As EventArgs) Handles GMacro_PEliminar.DoubleClick

    End Sub

    Private Sub GMacro_PSetTime_Click(sender As Object, e As EventArgs) Handles GMacro_PSetTime.DoubleClick

    End Sub

    Private Sub GMacro_PResetTime_Click(sender As Object, e As EventArgs) Handles GMacro_PResetTime.DoubleClick

    End Sub

    Private Sub GMacro_PPegar_Click(sender As Object, e As EventArgs) Handles GMacro_PPegar.DoubleClick

    End Sub

    Private Sub GMacro_PCopiar_Click(sender As Object, e As EventArgs) Handles GMacro_PCopiar.DoubleClick

    End Sub

    Private Sub GMacro_PEditar_Click(sender As Object, e As EventArgs) Handles GMacro_PEditar.DoubleClick

    End Sub

    Private Sub GMacro_PAñadir_Click(sender As Object, e As EventArgs) Handles GMacro_PAñadir.DoubleClick

    End Sub

    Private Sub GMacro_ClicsRaton_Click(sender As Object, e As EventArgs) Handles GMacro_LClicsRaton.DoubleClick, GMacro_CClicsRaton.DoubleClick

    End Sub

    Private Sub GMacro_EventosTeclado_Click(sender As Object, e As EventArgs) Handles GMacro_LEventosTeclado.DoubleClick, GMacro_CEventosTeclado.DoubleClick

    End Sub

    Private Sub GMacro_PausasEjecucion_Click(sender As Object, e As EventArgs) Handles GMacro_LPausasEjecucion.DoubleClick, GMacro_CPausasEjecucion.DoubleClick

    End Sub

    Private Sub GMacro_Repetir_Click(sender As Object, e As EventArgs) Handles GMacro_LRepetir.DoubleClick, GMacro_CRepetir.DoubleClick

    End Sub

    Private Sub GMacro_MovimientoRaton_Click(sender As Object, e As EventArgs) Handles GMacro_LMovimientoRaton.DoubleClick, GMacro_CMovimientoRaton.DoubleClick

    End Sub

    Private Sub GMacro_ModoVirtual_Click(sender As Object, e As EventArgs) Handles GMacro_LClicks_Position.DoubleClick, GMacro_CClicks_Position.DoubleClick

    End Sub

    Private Sub GMacro_RuedaRaton_Click(sender As Object, e As EventArgs) Handles GMacro_LRuedaRaton.DoubleClick, GMacro_CRuedaRaton.DoubleClick

    End Sub

    Private Sub GMacro_Lista_DobleClick(sender As Object, e As EventArgs, Indice As Integer) Handles GMacro_Lista.DobleClick

    End Sub

    Private Sub GMacro_Lista_DragLeave(sender As Object, e As EventArgs) Handles GMacro_Lista.DragLeave

    End Sub

    Private Sub GMacro_Down_Click(sender As Object, e As EventArgs) Handles GMacro_Down.DoubleClick

    End Sub

    Private Sub GMacro_Up_Click(sender As Object, e As EventArgs) Handles GMacro_Up.DoubleClick

    End Sub

    Private Sub GMacro_LHelp_Click(sender As Object, e As EventArgs) Handles GMacro_LHelp.DoubleClick

    End Sub

    Private Sub GEnviarPulsacion_PPulsacion_Click(sender As Object, e As EventArgs) Handles GEnviarPulsacion_PPulsacion.DoubleClick

    End Sub

    Private Sub GEnviarPulsacion_PAccion_Click(sender As Object, e As EventArgs) Handles GEnviarPulsacion_PAccion.DoubleClick

    End Sub

    Private Sub GEnviarPulsacion_ALT_Click(sender As Object, e As EventArgs) Handles GEnviarPulsacion_LALT.DoubleClick, GEnviarPulsacion_CALT.DoubleClick

    End Sub

    Private Sub GEnviarPulsacion_SHIFT_Click(sender As Object, e As EventArgs) Handles GEnviarPulsacion_LSHIFT.DoubleClick, GEnviarPulsacion_CSHIFT.DoubleClick

    End Sub

    Private Sub GEnviarPulsacion_WIN_Click(sender As Object, e As EventArgs) Handles GEnviarPulsacion_LWIN.DoubleClick, GEnviarPulsacion_CWin.DoubleClick

    End Sub

    Private Sub GEnviarPulsacion_CTRL_Click(sender As Object, e As EventArgs) Handles GEnviarPulsacion_LCTRL.DoubleClick, GEnviarPulsacion_CCTRL.DoubleClick

    End Sub

    Private Sub GEnviarPulsacion_ModoVirtual_Click(sender As Object, e As EventArgs)

    End Sub

    Private Sub GEnviarPulsacion_TAccion_Click(sender As Object, e As EventArgs) Handles GEnviarPulsacion_TAccion.Click

    End Sub

    Private Sub GEnviarPulsacion_LHelp_Click(sender As Object, e As EventArgs) Handles GEnviarPulsacion_LHelp.DoubleClick

    End Sub

    Private Sub GKBoard_BOSD_Click(sender As Object, e As EventArgs) Handles GKBoard_BOSD.Click

    End Sub

    Private Sub GKBoard_OSD_Click(sender As Object, e As EventArgs) Handles GKBoard_LOSD.DoubleClick, GKBoard_LOSD.Click, GKBoard_COSD.DoubleClick, GKBoard_COSD.Click

    End Sub

    Private Sub GKBoard_PPreview_Click(sender As Object, e As EventArgs) Handles GKBoard_PPreview.Click

    End Sub

    Private Sub GKBoard_TAccion_Click(sender As Object, e As EventArgs) Handles GKBoard_TAccion.Click, GKBoard_LCAccion.Click

    End Sub

    Private Sub GKBoard_LHelp_Click(sender As Object, e As EventArgs) Handles GKBoard_LHelp.DoubleClick

    End Sub

    Private Sub GKBoard_LCNombre_Click(sender As Object, e As EventArgs) Handles GKBoard_TNombre.Click

    End Sub

    Private Sub GKBoard_PAccion_Click(sender As Object, e As EventArgs) Handles GKBoard_PAccion.DoubleClick, GKBoard_PAccion.Click

    End Sub

    Private Sub GRedAdhoc_BOSD_Click(sender As Object, e As EventArgs) Handles GRedAdHoc_BOSD.Click

    End Sub

    Private Sub GRedAdHoc_OSD_Click(sender As Object, e As EventArgs) Handles GRedAdHoc_LOSD.DoubleClick, GRedAdHoc_COSD.DoubleClick

    End Sub

    Private Sub GRedAdHoc_BPlay_Click(sender As Object, e As EventArgs) Handles GRedAdHoc_BPlay.Click

    End Sub

    Private Sub GRedAdHoc_BExaminar_Click(sender As Object, e As EventArgs) Handles GRedAdHoc_BExaminar.Click

    End Sub

    Private Sub GRedAdHoc_LCSonido_Click(sender As Object, e As EventArgs) Handles GRedAdHoc_TSonido.Click

    End Sub

    Private Sub GRedAdHoc_BCerrarRed_Click(sender As Object, e As EventArgs) Handles GRedAdHoc_BCerrarRed.Click

    End Sub

    Private Sub GRedAdHoc_BCrearRed_Click(sender As Object, e As EventArgs) Handles GRedAdHoc_BCrearRed.Click

    End Sub

    Private Sub GRedAdHoc_LHelp_Click(sender As Object, e As EventArgs) Handles GRedAdHoc_LHelp.DoubleClick

    End Sub

    Private Sub GGrabacionAudio_CuentaAtras_Click(sender As Object, e As EventArgs) Handles GGrabacionAudio_LCuentaAtras.DoubleClick, GGrabacionAudio_CCuentaAtras.DoubleClick

    End Sub

    Private Sub GGrabacionAudio_LFormato_Click(sender As Object, e As EventArgs) Handles GGrabacionAudio_LFormato.DoubleClick

    End Sub

    Private Sub GGrabacionAudio_BPlay_Click(sender As Object, e As EventArgs) Handles GGrabacionAudio_BPlay.Click

    End Sub

    Private Sub GGrabacionAudio_LHelp_Click(sender As Object, e As EventArgs) Handles GGrabacionAudio_LHelp.DoubleClick

    End Sub

    Private Sub GGrabacionAudio_LCSonido_Click(sender As Object, e As EventArgs) Handles GGrabacionAudio_TSonido.Click

    End Sub

    Private Sub GGrabacionAudio_OSD_Click(sender As Object, e As EventArgs) Handles GGrabacionAudio_LOSD.DoubleClick, GGrabacionAudio_COSD.DoubleClick

    End Sub

    Private Sub GEjecutarAplicacion_Admin_Click(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_LAdmin.DoubleClick, GEjecutarAplicacion_CAdmin.DoubleClick

    End Sub

    Private Sub GEjecutarAplicacion_TopMost_Click(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_LTopMost.DoubleClick, GEjecutarAplicacion_CTopMost.DoubleClick

    End Sub

    Private Sub GEjecutarAplicacion_TPrioridad_Click(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TPrioridad.Click

    End Sub

    Private Sub GEjecutarAplicacion_PPrioridad_PModo_Click(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_PPrioridad.DoubleClick, GEjecutarAplicacion_PPrioridad.Click

    End Sub

    Private Sub GEjecutarAplicacion_PModo_Click(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_PModo.DoubleClick, GEjecutarAplicacion_PModo.Click

    End Sub

    Private Sub GEjecutarAplicacion_TModo_Click(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_TModo.Click

    End Sub

    Private Sub GEjecutarAplicacion_LHelp_Click(sender As Object, e As EventArgs) Handles GEjecutarAplicacion_LHelp.DoubleClick, GEjecutarAplicacion_LHelp.Click

    End Sub

    Private Sub GAplicaciones_Esperar_Click(sender As Object, e As EventArgs) Handles GAplicaciones_LEsperar.DoubleClick, GAplicaciones_CEsperar.DoubleClick

    End Sub

    Private Sub GAplicaciones_TAccion_Click(sender As Object, e As EventArgs) Handles GAplicaciones_TAccion.Click

    End Sub

    Private Sub GAplicaciones_LHelp_Click(sender As Object, e As EventArgs) Handles GAplicaciones_LHelp.DoubleClick

    End Sub

    Private Sub GAplicaciones_ExaminarAplicacion_Click(sender As Object, e As EventArgs) Handles GAplicaciones_BExaminarAplicacion.Click, GAplicaciones_BAñadirAplicacion.Click

    End Sub

    Private Sub GAplicaciones_LCAplicacion_Click(sender As Object, e As EventArgs) Handles GAplicaciones_TAplicacion.Click

    End Sub

    Private Sub GAplicaciones_PAccion_Click(sender As Object, e As EventArgs) Handles GAplicaciones_PAccion.DoubleClick, GAplicaciones_PAccion.Click

    End Sub

    Private Sub GAbrirCarpeta_TRuta_Click(sender As Object, e As EventArgs) Handles GAbrirCarpeta_TRuta.Click, GAbrirCarpeta_LCRuta.Click

    End Sub

    Private Sub GAbrirCarpeta_Icono_Click(sender As Object, e As EventArgs) Handles GAbrirCarpeta_Icono.DoubleClick

    End Sub

    Private Sub GAbrirCarpeta_LHelp_Click(sender As Object, e As EventArgs) Handles GAbrirCarpeta_LHelp.DoubleClick

    End Sub

    Private Sub GAbrirCarpeta_BExaminar_Click(sender As Object, e As EventArgs) Handles GAbrirCarpeta_BExaminar.Click

    End Sub

    Private Sub GEjecutarBAT_LHelp_Click(sender As Object, e As EventArgs) Handles GEjecutarBAT_LHelp.DoubleClick

    End Sub

    Private Sub GEjecutarBAT_TModo_Click(sender As Object, e As EventArgs) Handles GEjecutarBAT_TModo.Click

    End Sub

    Private Sub GEjecutarBAT_Administrador_Click(sender As Object, e As EventArgs) Handles GEjecutarBAT_LAdministrador.DoubleClick, GEjecutarBAT_CAdministrador.DoubleClick

    End Sub

    Private Sub GEjecutarBAT_PNotepad_Click(sender As Object, e As EventArgs) Handles GEjecutarBAT_PNotepad.Click

    End Sub

    Private Sub GEjecutarBAT_PProbar_Click(sender As Object, e As EventArgs) Handles GEjecutarBAT_PProbar.Click

    End Sub

    Private Sub GEjecutarBAT_PModo_Click(sender As Object, e As EventArgs) Handles GEjecutarBAT_PModo.DoubleClick, GEjecutarBAT_PModo.Click

    End Sub

    Private Sub GSalidaAudio_BOSD_Click(sender As Object, e As EventArgs) Handles GSalidaAudio_BOSD.Click

    End Sub

    Private Sub GSalidaAudio_OSD_Click(sender As Object, e As EventArgs) Handles GSalidaAudio_LOSD.DoubleClick, GSalidaAudio_COSD.DoubleClick

    End Sub

    Private Sub GSalidaAudio_LCSonido_Click(sender As Object, e As EventArgs) Handles GSalidaAudio_TSonido.Click

    End Sub

    Private Sub GSalidaAudio_ListaSeleccionados_DragLeave(sender As Object, e As EventArgs) Handles GSalidaAudio_ListaSeleccionados.DragLeave

    End Sub

    Private Sub GSalidaAudio_ListaDisponibles_DragLeave(sender As Object, e As EventArgs) Handles GSalidaAudio_ListaDisponibles.DragLeave

    End Sub

    Private Sub GSalidaAudio_Down_Click(sender As Object, e As EventArgs) Handles GSalidaAudio_Down.DoubleClick

    End Sub

    Private Sub GSalidaAudio_Up_Click(sender As Object, e As EventArgs) Handles GSalidaAudio_Up.DoubleClick

    End Sub

    Private Sub GSalidaAudio_LHelp_Click(sender As Object, e As EventArgs) Handles GSalidaAudio_LHelp.DoubleClick

    End Sub

    Private Sub GReproducirSonido_Esperar_Click(sender As Object, e As EventArgs) Handles GReproducirSonido_LEsperar.DoubleClick, GReproducirSonido_CEsperar.DoubleClick

    End Sub

    Private Sub GReproducirSonido_LHelp_Click(sender As Object, e As EventArgs) Handles GReproducirSonido_LHelp.DoubleClick

    End Sub

    Private Sub GReproducirSonido_BPlay_Click(sender As Object, e As EventArgs) Handles GReproducirSonido_BPlay.Click

    End Sub

    Private Sub GReproducirSonido_BExaminar_Click(sender As Object, e As EventArgs) Handles GReproducirSonido_BExaminar.Click

    End Sub

    Private Sub GReproducirSonido_LCSonido_Click(sender As Object, e As EventArgs) Handles GReproducirSonido_TSonido.Click

    End Sub

    Private Sub GVolumen_BControlVolumen_Click(sender As Object, e As EventArgs) Handles GVolumen_BControlVolumen.Click

    End Sub

    Private Sub GVolumen_LHelp_Click(sender As Object, e As EventArgs) Handles GVolumen_LHelp.DoubleClick

    End Sub

    Private Sub GVolumen_TAccion_Click(sender As Object, e As EventArgs) Handles GVolumen_TAccion.Click

    End Sub

    Private Sub GVolumen_PAccion_Click(sender As Object, e As EventArgs) Handles GVolumen_PAccion.DoubleClick, GVolumen_PAccion.Click

    End Sub

    Private Sub GTopMost_BPlay_Click(sender As Object, e As EventArgs) Handles GTopMost_BPlay.Click

    End Sub

    Private Sub GTopMost_BOSD_Click(sender As Object, e As EventArgs) Handles GTopMost_BOSD.Click

    End Sub

    Private Sub GTopMost_BExaminar_Click(sender As Object, e As EventArgs) Handles GTopMost_BExaminar.Click

    End Sub

    Private Sub GTopMost_LCSonido_Click(sender As Object, e As EventArgs) Handles GTopMost_TSonido.Click

    End Sub

    Private Sub GTopMost_OSD_Click(sender As Object, e As EventArgs) Handles GTopMost_LOSD.DoubleClick, GTopMost_LOSD.Click, GTopMost_COSD.DoubleClick, GTopMost_COSD.Click

    End Sub

    Private Sub GTopMost_LHelp_Click(sender As Object, e As EventArgs) Handles GTopMost_LHelp.DoubleClick

    End Sub

    Private Sub GArchivosOcultos_BPlay_Click(sender As Object, e As EventArgs) Handles GArchivosOcultos_BPlay.Click

    End Sub

    Private Sub GArchivosOcultos_BOSD_Click(sender As Object, e As EventArgs) Handles GArchivosOcultos_BOSD.Click

    End Sub

    Private Sub GArchivosOcultos_BExaminar_Click(sender As Object, e As EventArgs) Handles GArchivosOcultos_BExaminar.Click

    End Sub

    Private Sub GArchivosOcultos_LCSonido_Click(sender As Object, e As EventArgs) Handles GArchivosOcultos_TSonido.Click

    End Sub

    Private Sub GArchivosOcultos_OSD_Click(sender As Object, e As EventArgs) Handles GArchivosOcultos_LOSD.DoubleClick, GArchivosOcultos_LOSD.Click, GArchivosOcultos_COSD.DoubleClick, GArchivosOcultos_COSD.Click

    End Sub

    Private Sub GArchivosOcultos_LHelp_Click(sender As Object, e As EventArgs) Handles GArchivosOcultos_LHelp.DoubleClick

    End Sub

    Private Sub GDesactivarEn_BPlay_Click(sender As Object, e As EventArgs) Handles GDesactivarEn_BPlay.Click

    End Sub

    Private Sub GDesactivarEn_BOSD_Click(sender As Object, e As EventArgs) Handles GDesactivarEn_BOSD.Click

    End Sub

    Private Sub GDesactivarEn_BExaminar_Click(sender As Object, e As EventArgs) Handles GDesactivarEn_BExaminar.Click

    End Sub

    Private Sub GDesactivarEn_LCSonido_Click(sender As Object, e As EventArgs) Handles GDesactivarEn_TSonido.Click

    End Sub

    Private Sub GDesactivarEn_OSD_Click(sender As Object, e As EventArgs) Handles GDesactivarEn_LOSD.DoubleClick, GDesactivarEn_LOSD.Click, GDesactivarEn_COSD.DoubleClick, GDesactivarEn_COSD.Click

    End Sub

    Private Sub GDesactivarEn_LHelp_Click(sender As Object, e As EventArgs) Handles GDesactivarEn_LHelp.DoubleClick

    End Sub

    Private Sub GComandos_PAccion_Click(sender As Object, e As EventArgs) Handles GComandos_PAccion.DoubleClick

    End Sub

    Private Sub GComandos_PComandos_Click(sender As Object, e As EventArgs) Handles GComandos_PComandos.DoubleClick

    End Sub

    Private Sub GComandos_TComandos_Click(sender As Object, e As EventArgs) Handles GComandos_TComandos.DoubleClick, GComandos_TComandos.Click, GComandos_LCComandos.DoubleClick

    End Sub

    Private Sub GComandos_LHelp_Click(sender As Object, e As EventArgs) Handles GComandos_LHelp.DoubleClick

    End Sub

    Private Sub GComandos_TAccion_Click(sender As Object, e As EventArgs) Handles GComandos_TAccion.Click

    End Sub

    Private Sub GEsperar_CuentaAtras_Click(sender As Object, e As EventArgs) Handles GEsperar_LCuentaAtras.DoubleClick, GEsperar_LCuentaAtras.Click, GEsperar_CCuentaAtras.DoubleClick, GEsperar_CCuentaAtras.Click

    End Sub

    Private Sub GEsperar_OSD_Click(sender As Object, e As EventArgs) Handles GEsperar_LOSD.DoubleClick, GEsperar_COSD.DoubleClick

    End Sub

    Private Sub GEsperar_LHelp_Click(sender As Object, e As EventArgs) Handles GEsperar_LHelp.DoubleClick

    End Sub

    Private Sub GEsperar_LFormato_Click(sender As Object, e As EventArgs) Handles GEsperar_LFormato.DoubleClick, GEsperar_LFormato.Click

    End Sub

    Private Sub GApagarEquipo_PAccion_Click(sender As Object, e As EventArgs) Handles GApagarEquipo_PAccion.DoubleClick

    End Sub

    Private Sub GApagarEquipo_CuentaAtras_Click(sender As Object, e As EventArgs) Handles GApagarEquipo_LCuentaAtras.DoubleClick, GApagarEquipo_CCuentaAtras.DoubleClick

    End Sub

    Private Sub GApagarEquipo_LFormato_Click(sender As Object, e As EventArgs) Handles GApagarEquipo_LFormato.DoubleClick

    End Sub

    Private Sub GApagarEquipo_BPlay_Click(sender As Object, e As EventArgs) Handles GApagarEquipo_BPlay.Click

    End Sub

    Private Sub GApagarEquipo_BExaminar_Click(sender As Object, e As EventArgs) Handles GApagarEquipo_BExaminar.Click

    End Sub

    Private Sub GApagarEquipo_LHelp_Click(sender As Object, e As EventArgs) Handles GApagarEquipo_LHelp.DoubleClick

    End Sub

    Private Sub GApagarEquipo_LCSonido_Click(sender As Object, e As EventArgs) Handles GApagarEquipo_TSonido.Click, GApagarEquipo_LCSonido.Click

    End Sub

    Private Sub GApagarEquipo_OSD_Click(sender As Object, e As EventArgs) Handles GApagarEquipo_LOSD.DoubleClick, GApagarEquipo_COSD.DoubleClick

    End Sub

    Private Sub GApagarEquipo_TAccion_Click(sender As Object, e As EventArgs) Handles GApagarEquipo_TAccion.Click

    End Sub

    Private Sub GMostrarMensaje_BPlay_Click(sender As Object, e As EventArgs) Handles GMostrarMensaje_BPlay.Click

    End Sub

    Private Sub GMostrarMensaje_LCSonido_Click(sender As Object, e As EventArgs) Handles GMostrarMensaje_TSonido.Click, GMostrarMensaje_LCSonido.Click

    End Sub

    Private Sub GMostrarMensaje_BExaminar_Click(sender As Object, e As EventArgs) Handles GMostrarMensaje_BExaminar.Click

    End Sub

    Private Sub GMostrarMensaje_Esperar_Click(sender As Object, e As EventArgs) Handles GMostrarMensaje_LEsperar.DoubleClick, GMostrarMensaje_CEsperar.DoubleClick

    End Sub

    Private Sub GMostrarMensaje_CuentaAtras_Click(sender As Object, e As EventArgs) Handles GMostrarMensaje_LCuentaAtras.DoubleClick, GMostrarMensaje_CCuentaAtras.DoubleClick

    End Sub

    Private Sub GMacro_Clicks_Position_Click(sender As Object, e As EventArgs) Handles GMacro_LClicks_Position.DoubleClick, GMacro_CClicks_Position.DoubleClick

    End Sub

    Private Sub GAplicaciones_BAñadirAplicacion_Click(sender As Object, e As EventArgs) Handles GAplicaciones_BAñadirAplicacion.Click

    End Sub

    Private Sub GGrabacionPantalla_DesktopDuplication_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LDesktopDuplication.DoubleClick, GGrabacionPantalla_CDesktopDuplication.DoubleClick

    End Sub

    Private Sub QuickMenu_TQuickMenuSize_MouseDown(sender As Object, e As MouseEventArgs) Handles QuickMenu_TQuickMenuSize.MouseDown

    End Sub

    Private Sub PBuscar_Click(sender As Object, e As EventArgs) Handles PBuscar.DoubleClick, PBuscar.Click

    End Sub

    Private Sub GMostrarMensaje_LHelp_Click(sender As Object, e As EventArgs) Handles GMostrarMensaje_LHelp.DoubleClick

    End Sub

    Private Sub GMostrarMensaje_LFormato_Click(sender As Object, e As EventArgs) Handles GMostrarMensaje_LFormato.DoubleClick

    End Sub

    Private Sub GQuickMenu_PQuickMenu_Click(sender As Object, e As EventArgs) Handles GQuickMenu_PQuickMenu.Click

    End Sub

    Private Sub GQuickMenu_LHelp_Click(sender As Object, e As EventArgs) Handles GQuickMenu_LHelp.DoubleClick

    End Sub

    Private Sub GQuickMenu_LCNombre_Click(sender As Object, e As EventArgs) Handles GQuickMenu_TNombre.Click

    End Sub

    Private Sub GPaginaWeb_LHelp_Click(sender As Object, e As EventArgs) Handles GPaginaWeb_LHelp.DoubleClick

    End Sub

    Private Sub GPaginaWeb_PNavegadores_Click(sender As Object, e As EventArgs) Handles GPaginaWeb_GNavegadores_PNavegador9.Click, GPaginaWeb_GNavegadores_PNavegador8.Click, GPaginaWeb_GNavegadores_PNavegador7.Click, GPaginaWeb_GNavegadores_PNavegador6.Click, GPaginaWeb_GNavegadores_PNavegador5.Click, GPaginaWeb_GNavegadores_PNavegador4.Click, GPaginaWeb_GNavegadores_PNavegador3.Click, GPaginaWeb_GNavegadores_PNavegador2.Click, GPaginaWeb_GNavegadores_PNavegador11.Click, GPaginaWeb_GNavegadores_PNavegador10.Click, GPaginaWeb_GNavegadores_PNavegador1.Click

    End Sub

    Private Sub GPaginaWeb_PNavegador_Click(sender As Object, e As EventArgs) Handles GPaginaWeb_PNavegador.DoubleClick, GPaginaWeb_PNavegador.Click

    End Sub

    Private Sub Paneles_Click(sender As Object, e As EventArgs) Handles BPanelQuickMenu.Click

    End Sub

    Private Sub GPaginaWeb_Administrador_Click(sender As Object, e As EventArgs) Handles GPaginaWeb_LAdmin.DoubleClick, GPaginaWeb_CAdmin.DoubleClick

    End Sub

    Private Sub GPaginaWeb_VentanaIncognito_Click(sender As Object, e As EventArgs) Handles GPaginaWeb_LVentanaIncognito.DoubleClick, GPaginaWeb_CVentanaIncognito.DoubleClick

    End Sub

    Private Sub GPaginaWeb_NuevaVentana_Click(sender As Object, e As EventArgs) Handles GPaginaWeb_LNuevaVentana.DoubleClick, GPaginaWeb_CNuevaVentana.DoubleClick

    End Sub

    Private Sub Comandos_Accion_ListaAccion_DragLeave(sender As Object, e As EventArgs) Handles Comandos_Accion_ListaAccion.DragLeave

    End Sub

    Private Sub Comandos_Accion_Down_Click(sender As Object, e As EventArgs) Handles Comandos_Accion_Down.DoubleClick

    End Sub

    Private Sub Comandos_Accion_Up_Click(sender As Object, e As EventArgs) Handles Comandos_Accion_Up.DoubleClick

    End Sub

    Private Sub Comandos_EjecutarSiempre_Click(sender As Object, e As EventArgs) Handles Comandos_EjecutarSiempre_LEjecutarSiempre.DoubleClick, Comandos_EjecutarSiempre_CEjecutarSiempre.DoubleClick

    End Sub

    Private Sub Comandos_Deshabilitar_Click(sender As Object, e As EventArgs) Handles Comandos_Deshabilitar_LDeshabilitar.DoubleClick, Comandos_Deshabilitar_CDeshabilitar.DoubleClick

    End Sub

    Private Sub Comandos_EjecutarSalir_Click(sender As Object, e As EventArgs) Handles Comandos_EjecutarSalir_LEjecutarSalir.DoubleClick, Comandos_EjecutarSalir_CEjecutarSalir.DoubleClick

    End Sub

    Private Sub Comandos_BloquearPulsacion_Click(sender As Object, e As EventArgs) Handles Comandos_BloquearPulsacion_LBloquearPulsacion.DoubleClick, Comandos_BloquearPulsacion_LBloquearPulsacion.Click, Comandos_BloquearPulsacion_CBloquearPulsacion.DoubleClick, Comandos_BloquearPulsacion_CBloquearPulsacion.Click

    End Sub

    Private Sub Comandos_EjecutarIniciar_Click(sender As Object, e As EventArgs) Handles Comandos_EjecutarIniciar_LEjecutarIniciar.DoubleClick, Comandos_EjecutarIniciar_CEjecutarIniciar.DoubleClick, Comandos_Procesos_LEjecutarProcesos.DoubleClick, Comandos_LEjecutarAl.DoubleClick

    End Sub

    Private Sub Comandos_Sonido_LCSonido_Click(sender As Object, e As EventArgs) Handles Comandos_Sonido_TSonido.Click

    End Sub

    Private Sub Comandos_POculto_Click(sender As Object, e As EventArgs) Handles Comandos_POculto.DoubleClick, Comandos_POculto.Click

    End Sub

    Private Sub Comandos_Procesos_LCProcesos_Click(sender As Object, e As EventArgs) Handles Comandos_Procesos_TProceso.DoubleClick, Comandos_Procesos_TProceso.Click, Comandos_Procesos_LCProcesos.DoubleClick

    End Sub

    Private Sub Opciones_SabiasQue_PTipo_Click(sender As Object, e As EventArgs) Handles Opciones_SabiasQue_PTipo.DoubleClick, Opciones_SabiasQue_PTipo.Click

    End Sub

    Private Sub PExportar_Click(sender As Object, e As EventArgs) Handles PExportar.DoubleClick

    End Sub

    Private Sub PLogros_Click(sender As Object, e As EventArgs) Handles PLogros.DoubleClick

    End Sub

    Private Sub PAyuda_Click(sender As Object, e As EventArgs) Handles PAyuda.DoubleClick

    End Sub

    Private Sub PImportar_Click(sender As Object, e As EventArgs) Handles PImportar.DoubleClick

    End Sub

    Private Sub Opciones_Version_ActualizacionesAutomaticas_Click(sender As Object, e As EventArgs)

    End Sub

    Private Sub Opciones_Version_BActualizar_Click(sender As Object, e As EventArgs)

    End Sub

    Private Sub Opciones_Desactivar_LCProceso_Click(sender As Object, e As EventArgs) Handles Opciones_Desactivar_TProceso.DoubleClick, Opciones_Desactivar_TProceso.Click, Opciones_Desactivar_LCProceso.DoubleClick

    End Sub

    Private Sub LCTRLClick_Click(sender As Object, e As EventArgs) Handles LSHIFTClick.Click

    End Sub

    Private Sub Opciones_Deshabilitar_LCProceso_Click(sender As Object, e As EventArgs) Handles Opciones_Deshabilitar_TProceso.DoubleClick, Opciones_Deshabilitar_LCProceso.DoubleClick

    End Sub

    Private Sub Opciones_DisableXButton_Click(sender As Object, e As EventArgs) Handles Opciones_DisableXButton_LDisableXButton.DoubleClick, Opciones_DisableXButton_CDisableXButton.DoubleClick

    End Sub

    Private Sub Opciones_IniciarWindows_Click(sender As Object, e As EventArgs) Handles Opciones_IniciarWindows_LIniciarWindows.DoubleClick, Opciones_IniciarWindows_CIniciarWindows.DoubleClick

    End Sub

    Private Sub Opciones_IconoSistema_Click(sender As Object, e As EventArgs) Handles Opciones_IconoSistema_LIconoSistema.DoubleClick, Opciones_IconoSistema_CIconoSistema.DoubleClick

    End Sub

    Private Sub Opciones_UDP_Click(sender As Object, e As EventArgs) Handles Opciones_UDP_LUDP.DoubleClick, Opciones_UDP_LUDP.Click, Opciones_UDP_CUDP.DoubleClick, Opciones_UDP_CUDP.Click

    End Sub

    Private Sub Opciones_MensajeIniciar_LCSonido_Click(sender As Object, e As EventArgs) Handles Opciones_MensajeIniciar_TSonido.Click

    End Sub

    Private Sub Controles_KBoard_Click(sender As Object, e As EventArgs) Handles PanelKBoard1.Click, KBoard_TPor.Click, KBoard_TEstado.Click, KBoard_TCambiar.Click, KBoard_Separador.Click, KBoard_PRaton.Click, KBoard_Nombre_LNombre.Click, KBoard_Nombre_LCNombre.Click, KBoard_Nombre_BDelete.Click, KBoard_Nombre_BAdd.Click, KBoard_LVersion.Click, KBoard_LTeclado.Click, KBoard_LRaton.Click, KBoard_LProceso.Click, KBoard_LPor.Click, KBoard_LNumerico.Click, KBoard_LEstado.Click, KBoard_LDeshabilitado.Click, KBoard_LCProceso.Click, KBoard_LCPor.Click, KBoard_LCCambiar.Click, KBoard_LAutoActivar.Click, KBoard_GVersion.Click, KBoard_GRaton.Click, KBoard_GNumerico.Click, KBoard_GKeyboard.Click, KBoard_CRWin.Click, KBoard_CRShift.Click, KBoard_CRCtrl.Click, KBoard_CRAlt.Click, KBoard_CLWin.Click, KBoard_CLShift.Click, KBoard_CLCtrl.Click, KBoard_CLAlt.Click, KBoard_CDeshabilitado.Click, KBoard_CAutoActivar.Click, KBoard_BProcesoExaminar.Click, KBoard_BProcesoEliminar.Click, KBoard_BProcesoAdd.Click, BPanelKBoard.Click, KBoard_LCambiar.Click, PResetear.Click

    End Sub

    Private Sub KBoard_ModoVirtual_Click(sender As Object, e As EventArgs)

    End Sub

    Private Sub KBoard_Deshabilitado_Click(sender As Object, e As EventArgs) Handles KBoard_LDeshabilitado.DoubleClick, KBoard_CDeshabilitado.DoubleClick

    End Sub

    Private Sub KBoard_BResetear_Click(sender As Object, e As EventArgs)

    End Sub

    Private Sub KBoard_TEstado_Click(sender As Object, e As EventArgs) Handles KBoard_TEstado.DoubleClick

    End Sub

    Private Sub KBoard_AutoActivar_Click(sender As Object, e As EventArgs) Handles KBoard_LAutoActivar.DoubleClick, KBoard_CAutoActivar.DoubleClick

    End Sub

    Private Sub KBoard_LCProceso_Click(sender As Object, e As EventArgs) Handles KBoard_TProceso.DoubleClick, KBoard_TProceso.Click, KBoard_LCProceso.DoubleClick

    End Sub

    Private Sub KBoard_Nombre_LCNombre_Click(sender As Object, e As EventArgs) Handles KBoard_Nombre_TNombre.Click

    End Sub

    Private Sub KBoard_Win_Click(sender As Object, e As EventArgs) Handles KBoard_CRWin.DoubleClick, KBoard_CLWin.DoubleClick

    End Sub

    Private Sub KBoard_Shift_Click(sender As Object, e As EventArgs) Handles KBoard_CRShift.DoubleClick, KBoard_CLShift.DoubleClick

    End Sub

    Private Sub KBoard_Ctrl_Click(sender As Object, e As EventArgs) Handles KBoard_CRCtrl.DoubleClick, KBoard_CLCtrl.DoubleClick

    End Sub

    Private Sub KBoard_LAlt_Click(sender As Object, e As EventArgs) Handles KBoard_CLAlt.DoubleClick

    End Sub

    Private Sub KBoard_RAlt_Click(sender As Object, e As EventArgs) Handles KBoard_CRAlt.DoubleClick

    End Sub

    Private Sub QuickMenu_Nombre_BDelete_Click(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_BDelete.Click

    End Sub

    Private Sub QuickMenu_Nombre_BAdd_Click(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_BAdd.Click

    End Sub

    Private Sub QuickMenu_Controles_MouseDown(sender As Object, e As MouseEventArgs) Handles QuickMenu_TQuickMenuSize.MouseDown, QuickMenu_Nombre_LNombre.MouseDown, QuickMenu_LQuickMenu.MouseDown, QuickMenu_GQuickMenu.MouseDown, PanelQuickMenu.MouseDown, Lista.MouseDown, BPanelQuickMenu.MouseDown

    End Sub

    Private Sub QuickMenu_Controles_MouseUp(sender As Object, e As MouseEventArgs) Handles QuickMenu_Nombre_LNombre.MouseUp, QuickMenu_LQuickMenu.MouseUp, QuickMenu_GQuickMenu.MouseUp, PanelQuickMenu.MouseUp, FTheme.MouseUp, BPanelQuickMenu.MouseUp

    End Sub

    Private Sub QuickMenu_Nombre_LCNombre_Click(sender As Object, e As EventArgs) Handles QuickMenu_Nombre_TNombre.Click, QuickMenu_Nombre_LCNombre.Click

    End Sub

    Private Sub QuickMenu_TQuickMenuSize_MouseUp(sender As Object, e As MouseEventArgs) Handles QuickMenu_TQuickMenuSize.MouseUp

    End Sub

    Private Sub Lista_POculto_Click(sender As Object, e As EventArgs) Handles Lista_POculto.DoubleClick, Lista_POculto.Click, PBuscar.DoubleClick, PBuscar.Click

    End Sub

    Private Sub Comandos_LHelp_Click(sender As Object, e As EventArgs) Handles LHelp.DoubleClick, LHelp.Click

    End Sub

    Private Sub NotifyIcon_Click(sender As Object, e As EventArgs) Handles NotifyIcon.Click

    End Sub

    Private Sub NotifyIcon_DoubleClick(sender As Object, e As EventArgs) Handles NotifyIcon.DoubleClick

    End Sub

    Private Sub GGrabacionPantalla_MarcarClicks_Click(sender As Object, e As EventArgs) Handles GGrabacionPantalla_LMarcarClicks.DoubleClick, GGrabacionPantalla_CMarcarClicks.DoubleClick, GGrabacionPantalla_LGSonido.DoubleClick, GGrabacionPantalla_LGMicrofono.DoubleClick, GGrabacionPantalla_CGSonido.DoubleClick, GGrabacionPantalla_CGMicrofono.DoubleClick, GGrabacionPantalla_LDesktopDuplication.DoubleClick, GGrabacionPantalla_CDesktopDuplication.DoubleClick

    End Sub

#End Region

End Class

#End Region

#Region " Clases "

#Region " Keyboard "

Public Class Keyboard

#Region " Variables "

#Region " Declaraciones "

    'Send Keys
    Private Declare Auto Function MapVirtualKey Lib "user32.dll" (uCode As Integer, uMapType As MapVirtualKeyMapTypes) As Integer
    Private Declare Auto Function GetSystemMetrics Lib "user32.dll" (smIndex As Integer) As Integer
    Private Declare Function SendInput Lib "user32.dll" (cInputs As Integer, ByRef pInputs As INPUT, cbSize As Integer) As Integer
    Private Declare Sub mouse_event Lib "user32" Alias "mouse_event" (dwFlags As Integer, dx As Integer, dy As Integer, cButtons As Integer, dwExtraInfo As Integer)
    <Runtime.InteropServices.DllImport("user32.dll", CallingConvention:=Runtime.InteropServices.CallingConvention.StdCall, CharSet:=Runtime.InteropServices.CharSet.Unicode, EntryPoint:="keybd_event", ExactSpelling:=True, SetLastError:=True)> Public Shared Function Keybd_event(bVk As Int32, bScan As Int32, dwFlags As Int32, dwExtraInfo As Int32) As Boolean : End Function
    'Mouse Location
    <Runtime.InteropServices.DllImport("user32.dll")> Private Shared Function SetCursorPos(X As Integer, Y As Integer) As Boolean : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Private Shared Function GetCursorPos(ByRef lpPoint As Point) As Boolean : End Function
    'Keyboard
    <Runtime.InteropServices.DllImport("user32.dll")> Private Shared Function GetAsyncKeyState(vKey As IntPtr) As Short : End Function
    <Runtime.InteropServices.DllImport("User32.dll")> Private Shared Function SetWindowsHookEx(idHook As Integer, HookProc As KHookProc, hInstance As IntPtr, wParam As Integer) As Integer : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Private Shared Function CallNextHookEx(idHook As IntPtr, nCode As Integer, wParam As IntPtr, ByRef lParam As KBDLLHOOKSTRUCT) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("User32.dll")> Private Shared Function UnhookWindowsHookEx(idHook As Integer) As Boolean : End Function
    Private Structure KBDLLHOOKSTRUCT : Public vkCode As Integer : Public scanCode As Integer : Public flags As KBDLLHOOKSTRUCTFlags : Public time As Integer : Public dwExtraInfo As IntPtr : End Structure : Private Enum KBDLLHOOKSTRUCTFlags As Integer : LLKHF_EXTENDED = &H1 : LLKHF_INJECTED = &H10 : LLKHF_ALTDOWN = &H20 : LLKHF_UP = &H80 : End Enum
    Private Delegate Function KHookProc(nCode As Integer, wParam As IntPtr, lParam As KBDLLHOOKSTRUCT) As Integer : Private ReadOnly KHookProcDelegate As New KHookProc(AddressOf Keyboard_Hook) : Private ReadOnly KHookID As IntPtr = SetWindowsHookEx(13, KHookProcDelegate, Runtime.InteropServices.Marshal.GetHINSTANCE(Reflection.Assembly.GetExecutingAssembly.GetModules()(0)), 0)
    'Mouse
    <Runtime.InteropServices.DllImport("user32.dll")> Private Shared Function SetWindowsHookEx(idHook As Integer, HookProc As MHookProc, hInstance As IntPtr, wParam As Integer) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Private Shared Function CallNextHookEx(idHook As IntPtr, nCode As Integer, wParam As IntPtr, ByRef lParam As MSLLHOOKSTRUCT) As IntPtr : End Function
    Private Structure MSLLHOOKSTRUCT : Public pt As Point : Public MouseData As Integer : Public flags As Integer : Public time As Integer : Public dwExtraInfo As Integer : End Structure
    Private Delegate Function MHookProc(nCode As Integer, wParam As IntPtr, ByRef lParam As MSLLHOOKSTRUCT) As Integer : Private ReadOnly MHookProcDelegate As New MHookProc(AddressOf Mouse_Hook) : Private ReadOnly MHookID As IntPtr = SetWindowsHookEx(14, MHookProcDelegate, Runtime.InteropServices.Marshal.GetHINSTANCE(Reflection.Assembly.GetExecutingAssembly.GetModules()(0)), 0)

#End Region

#Region " Structures "

    Private Structure KEYBDINPUT : Public wVk As Short : Public wScan As Short : Public dwFlags As Integer : Public time As Integer : Public dwExtraInfo As IntPtr : End Structure
    Private Structure MOUSEINPUT : Public dx As Integer : Public dy As Integer : Public mouseData As Integer : Public dwFlags As Integer : Public time As Integer : Public dwExtraInfo As IntPtr : End Structure
    Private Structure HARDWAREINPUT : Public uMsg As Integer : Public wParamL As Short : Public wParamH As Short : End Structure
    Private Structure INPUT : Dim dwType As Integer : Dim mkhi As MOUSEKEYBDHARDWAREINPUT : End Structure
    <Runtime.InteropServices.StructLayout(Runtime.InteropServices.LayoutKind.Explicit)> Private Structure MOUSEKEYBDHARDWAREINPUT : <Runtime.InteropServices.FieldOffset(0)> Public mi As MOUSEINPUT : <Runtime.InteropServices.FieldOffset(0)> Public ki As KEYBDINPUT : <Runtime.InteropServices.FieldOffset(0)> Public hi As HARDWAREINPUT : End Structure

    Private Enum MapVirtualKeyMapTypes As Integer : MAPVK_VK_TO_VSC = &H0 : MAPVK_VSC_TO_VK = &H1 : MAPVK_VK_TO_CHAR = &H2 : MAPVK_VSC_TO_VK_EX = &H3 : MAPVK_VK_TO_VSC_EX = &H4 : End Enum
    Public Enum ScrollDirection : Up = 120 : Down = -120 : Left = -120 : Right = 120 : End Enum

    Private Structure ScanKey
        Dim ScanCode As UInteger : Dim Extended As Boolean
        Public Sub New(sCode As UInteger, Optional ex As Boolean = False)
            ScanCode = sCode : Extended = ex
        End Sub
    End Structure

    Private Structure KeyPressStruct
        Dim Keys() As Keys : Dim Delay As Integer
        Public Sub New(KeysToPress() As Keys, Optional DelayTime As Integer = 0)
            Keys = KeysToPress : Delay = DelayTime
        End Sub
    End Structure

    Private Structure MousePressStruct
        Dim MKeys() As Mouse_Buttons : Dim Delay As Integer
        Public Sub New(MKeysToPress() As Mouse_Buttons, Optional DelayTime As Integer = 0)
            MKeys = MKeysToPress : Delay = DelayTime
        End Sub
    End Structure

    Public Shared ReadOnly Property IsLeftHanded() As Boolean
        Get
            Try : Return (GetSystemMetrics(23) = 1)
            Catch : Return False : End Try
        End Get
    End Property

    Public Enum Mouse_Buttons
        LMouse = &H1
        RMouse = &H2
        MMouse = &H3
        X1Mouse = &H4
        X2Mouse = &H5
        Wheel = &H800
        HWheel = &H1000

        B_LMouseDown = &H2
        B_LMouseUp = &H4
        B_RMouseDown = &H8
        B_RMouseUp = &H10
        B_MMouseDown = &H20
        B_MMouseUp = &H40
        B_XMouseDown = &H80
        B_XMouseUp = &H100
        B_Wheel = &H800
        B_HWheel = &H1000
        B_Move = &H8000
        B_RMove = &H1

        XBUTTON1 = &H1
        XBUTTON2 = &H2
    End Enum

#End Region

#Region " Events "

    Public Event Key(Evento As String, Hotkey As String, Tecla As String)
    Public Event Mouse(Location As Point, Boton As String, Evento As String, Hotkey As String)
    Public Event Key_Macro(Evento As String, Hotkey As String, Tecla As String, Pausa As Integer)
    Public Event Mouse_Macro(Evento As String, Boton As String, Location As Point, Pausa As Integer)

#End Region

    'Private ProcessList As New List(Of String) From {"explorer", "iexplorer", "chrome", "firefox", "telegram"}
    Private DeshabilitarBackFoward As String
    Private Keyboard_StopWatch, Mouse_StopWatch As New Stopwatch
    Private JustHandledM4, JustHandledM5, JustHandledCM As Boolean
    Private Hotkey As String
    Public Hotkeys As New List(Of String)

#End Region

#Region " Metodos "

#Region " Send Input "

#Region " Keys "

#Region " Send Keys "

    Public Sub Send_ReleaseAll()
        Send_KeyUp(Keys.LControlKey) : Send_KeyUp(Keys.RControlKey) : Send_KeyUp(Keys.LShiftKey) : Send_KeyUp(Keys.RShiftKey) : Send_KeyUp(Keys.LMenu) : Send_KeyUp(Keys.RMenu) : Send_KeyUp(Keys.LWin) : Send_KeyUp(Keys.RWin)
    End Sub

    Public Sub Send_KeyDown(kCode As Keys)
        If Force_VirtualKey(kCode) = True Then Send_Virtual_KeyDown(kCode) : Exit Sub
        Dim sKey As ScanKey = GetScanKey(kCode)
        Dim input As New INPUT()
        input.dwType = 1
        input.mkhi.ki = New KEYBDINPUT()
        input.mkhi.ki.wScan = sKey.ScanCode
        input.mkhi.ki.dwExtraInfo = 10
        input.mkhi.ki.dwFlags = &H8 Or IIf(sKey.Extended, &H1, Nothing)
        Dim cbSize As Integer = Runtime.InteropServices.Marshal.SizeOf(GetType(INPUT))
        SendInput(1, input, cbSize)
    End Sub

    Public Sub Send_KeyUp(kCode As Keys)
        If Force_VirtualKey(kCode) = True Then Send_Virtual_KeyUp(kCode) : Exit Sub
        Dim sKey As ScanKey = GetScanKey(kCode)
        Dim input As New INPUT()
        input.dwType = 1
        input.mkhi.ki = New KEYBDINPUT()
        input.mkhi.ki.wScan = sKey.ScanCode
        input.mkhi.ki.dwFlags = &H8 Or &H2 Or IIf(sKey.Extended, &H1, Nothing)
        Dim cbSize As Integer = Runtime.InteropServices.Marshal.SizeOf(GetType(INPUT))
        input.mkhi.ki.dwExtraInfo = 10
        SendInput(1, input, cbSize)
    End Sub

    Public Sub Send_KeyPress(kCode As Keys)
        Send_KeyDown(kCode) : Send_KeyUp(kCode)
    End Sub

    Public Sub Send_ShortcutKeys(kCode() As Keys, Optional Delay As Integer = 0)
        Dim KeysPress As New KeyPressStruct(kCode, Delay)
        Dim t As New Threading.Thread(New Threading.ParameterizedThreadStart(AddressOf ShortcutKeys_Thread)) : t.Start(KeysPress)
    End Sub

#End Region

#Region " Send Virtual Keys "

    Public Sub Send_Virtual_ReleaseAll()
        Send_Virtual_KeyUp(Keys.LControlKey) : Send_Virtual_KeyUp(Keys.RControlKey) : Send_Virtual_KeyUp(Keys.LShiftKey) : Send_Virtual_KeyUp(Keys.RShiftKey) : Send_Virtual_KeyUp(Keys.LMenu) : Send_Virtual_KeyUp(Keys.RMenu) : Send_Virtual_KeyUp(Keys.LWin) : Send_Virtual_KeyUp(Keys.RWin)
    End Sub

    Public Sub Send_Virtual_KeyDown(kCode As Keys)
        Keybd_event(kCode, 0, &H0, 0)
    End Sub

    Public Sub Send_Virtual_KeyUp(kCode As Keys)
        Keybd_event(kCode, 0, &H2, 0)
    End Sub

    Public Sub Send_Virtual_KeyPress(kCode As Keys)
        Send_Virtual_KeyDown(kCode) : Send_Virtual_KeyUp(kCode)
    End Sub

    Public Sub Send_Virtual_ShortcutKeys(kCode() As Keys, Optional Delay As Integer = 0)
        Dim KeyPress As New KeyPressStruct(kCode, Delay)
        Dim t As New Threading.Thread(New Threading.ParameterizedThreadStart(AddressOf Virtual_ShortcutKeys_Thread)) : t.Start(KeyPress)
    End Sub

#End Region

#Region " Key State "

    Public Function Get_KeyState(kCode As Keys)
        If GetAsyncKeyState(kCode) Then Return True Else Return False
    End Function

#End Region

#Region " Functions "

    Private Function GetScanKey(VKey As Integer) As ScanKey
        Dim ScanCode As Integer = MapVirtualKey(VKey, MapVirtualKeyMapTypes.MAPVK_VK_TO_VSC)
        Dim Extended As Boolean = (VKey = Keys.RMenu Or VKey = Keys.RControlKey Or VKey = Keys.Left Or VKey = Keys.Right Or VKey = Keys.Up Or VKey = Keys.Down Or VKey = Keys.Home Or VKey = Keys.Delete Or VKey = Keys.PageUp Or VKey = Keys.PageDown Or VKey = Keys.End Or VKey = Keys.Insert Or VKey = Keys.NumLock Or VKey = Keys.PrintScreen Or VKey = Keys.Divide)
        Return New ScanKey(ScanCode, Extended)
    End Function

    Private Sub ShortcutKeys_Thread(KeysP As KeyPressStruct)
        For Each k As Keys In KeysP.Keys : Send_KeyDown(k) : Next
        If KeysP.Delay > 0 Then Threading.Thread.Sleep(KeysP.Delay)
        For Each k As Keys In KeysP.Keys : Send_KeyUp(k) : Next
    End Sub

    Private Sub Virtual_ShortcutKeys_Thread(KeysP As KeyPressStruct)
        For Each k As Keys In KeysP.Keys : Send_Virtual_KeyDown(k) : Next
        If KeysP.Delay > 0 Then Threading.Thread.Sleep(KeysP.Delay)
        For Each k As Keys In KeysP.Keys : Send_Virtual_KeyUp(k) : Next
    End Sub

    Private Function Force_VirtualKey(Key As String) As Boolean
        Return (" PrintScreen, Numlock, WinKey, AppsKey, VolumeMute, MediaStop, MediaPlayPause, MediaPreviousTrack, MediaNextTrack, VolumeUp, VolumeDown, VolumeMute, LaunchMail, LaunchApplication1, LaunchApplication2, BrowserBack, BrowserFavorites, BrowserForward, BrowserHome, BrowserRefresh, BrowserSearch, BrowserStop, LWin, RWin,").Contains(" " + Key + ",")
    End Function

    Private Function Force_VirtualKey(Key As Keys) As Boolean
        Return (" PrintScreen, Numlock, WinKey, AppsKey, VolumeMute, MediaStop, MediaPlayPause, MediaPreviousTrack, MediaNextTrack, VolumeUp, VolumeDown, VolumeMute, LaunchMail, LaunchApplication1, LaunchApplication2, BrowserBack, BrowserFavorites, BrowserForward, BrowserHome, BrowserRefresh, BrowserSearch, BrowserStop, LWin, RWin,").Contains(" " + Key.ToString + ",")
    End Function

#Region " String to Key "

    Public Function String_to_Key(Key As String, Optional Lowered As Boolean = False) As Keys
        'kOEM1 = &HBA : kOEM4 = &HDB : kOEM7 = &HDE
        'kOEM2 = &HBF : kOEM5 = &HDC : kOEM8 = &HDF
        'kOEM3 = &HC0 : kOEM6 = &HDD : kOEM102 = &HE2

        If Lowered = True Then GoTo isLowered

        Select Case Key
            'Multimedia
            Case "SelectMedia" : Return Keys.SelectMedia
            Case "MediaStop" : Return Keys.MediaStop
            Case "MediaPlayPause" : Return Keys.MediaPlayPause
            Case "MediaPreviousTrack" : Return Keys.MediaPreviousTrack
            Case "MediaNextTrack" : Return Keys.MediaNextTrack
            Case "VolumeUp" : Return Keys.VolumeUp
            Case "VolumeDown" : Return Keys.VolumeDown
            Case "VolumeMute" : Return Keys.VolumeMute
            Case "LaunchMail" : Return Keys.LaunchMail
            Case "LaunchApplication1" : Return Keys.LaunchApplication1
            Case "LaunchApplication2" : Return Keys.LaunchApplication2
            Case "BrowserBack" : Return Keys.BrowserBack
            Case "BrowserFavorites" : Return Keys.BrowserFavorites
            Case "BrowserForward" : Return Keys.BrowserForward
            Case "BrowserHome" : Return Keys.BrowserHome
            Case "BrowserRefresh" : Return Keys.BrowserRefresh
            Case "BrowserSearch" : Return Keys.BrowserSearch
            Case "BrowserStop" : Return Keys.BrowserStop
            'Cursores
            Case "PrintScreen" : Return Keys.PrintScreen
            Case "Scroll" : Return Keys.Scroll
            Case "Pause" : Return Keys.Pause
            Case "Insert" : Return Keys.Insert
            Case "Delete" : Return Keys.Delete
            Case "Home" : Return Keys.Home
            Case "End" : Return Keys.End
            Case "PageUp" : Return Keys.Prior
            Case "PageDown" : Return Keys.Next
            Case "Up" : Return Keys.Up
            Case "Down" : Return Keys.Down
            Case "Left" : Return Keys.Left
            Case "Right" : Return Keys.Right
            'Windows
            Case "Escape" : Return Keys.Escape
            Case "Backspace" : Return Keys.Back
            Case "LShift" : Return Keys.LShiftKey
            Case "RShift" : Return Keys.RShiftKey
            Case "LWin" : Return Keys.LWin
            Case "RWin" : Return Keys.RWin
            Case "Tab" : Return Keys.Tab
            Case "Enter" : Return Keys.Enter
            Case "LCtrl" : Return Keys.LControlKey
            Case "RCtrl" : Return Keys.RControlKey
            Case "AppsKey" : Return Keys.Apps
            Case "Capital" : Return Keys.Capital
            Case "Space", " " : Return Keys.Space
            Case "LAlt" : Return Keys.LMenu
            Case "RAlt" : Return Keys.RMenu
            'Numeros
            Case "0", "=" : Return Keys.D0
            Case "1", "!", "|" : Return Keys.D1
            Case "2", """", "@" : Return Keys.D2
            Case "3", "·", "#" : Return Keys.D3
            Case "4", "$", "~" : Return Keys.D4
            Case "5", "%", "€" : Return Keys.D5
            Case "6", "&", "¬" : Return Keys.D6
            Case "7", "/" : Return Keys.D7
            Case "8", "(" : Return Keys.D8
            Case "9", ")" : Return Keys.D9
            'Letras
            Case "A", "a", "Á", "á", "À", "à", "Ä", "ä", "Â", "â" : Return Keys.A
            Case "B", "b" : Return Keys.B
            Case "C", "c" : Return Keys.C
            Case "D", "d" : Return Keys.D
            Case "E", "e", "É", "é", "È", "è", "Ë", "ë", "Ê", "ê", "€" : Return Keys.E
            Case "F", "f" : Return Keys.F
            Case "G", "g" : Return Keys.G
            Case "H", "h" : Return Keys.H
            Case "I", "i", "Í", "í", "Ì", "ì", "Ï", "ï", "Î", "î" : Return Keys.I
            Case "J", "j" : Return Keys.J
            Case "K", "k" : Return Keys.K
            Case "L", "l" : Return Keys.L
            Case "M", "m" : Return Keys.M
            Case "N", "n" : Return Keys.N
            Case "Ñ", "ñ" : Return Keys.Oemtilde
            Case "O", "o", "Ó", "ó", "Ò", "ò", "Ö", "ö", "Ô", "ô" : Return Keys.O
            Case "P", "p" : Return Keys.P
            Case "Q", "q" : Return Keys.Q
            Case "R", "r" : Return Keys.R
            Case "S", "s" : Return Keys.S
            Case "T", "t" : Return Keys.T
            Case "U", "u", "Ú", "ú", "Ù", "ù", "Ü", "ü", "Û", "û" : Return Keys.U
            Case "V", "v" : Return Keys.V
            Case "W", "w" : Return Keys.W
            Case "X", "x" : Return Keys.X
            Case "Y", "y" : Return Keys.Y
            Case "Z", "z" : Return Keys.Z
            'NumPad
            Case "NumLock" : Return Keys.NumLock
            Case "NumPad0" : Return Keys.NumPad0
            Case "NumPad1" : Return Keys.NumPad1
            Case "NumPad2" : Return Keys.NumPad2
            Case "NumPad3" : Return Keys.NumPad3
            Case "NumPad4" : Return Keys.NumPad4
            Case "NumPad5" : Return Keys.NumPad5
            Case "NumPad6" : Return Keys.NumPad6
            Case "NumPad7" : Return Keys.NumPad7
            Case "NumPad8" : Return Keys.NumPad8
            Case "NumPad9" : Return Keys.NumPad9
            Case "NumPadDiv", "/" : Return Keys.Divide
            Case "NumPadAdd" : Return Keys.Add
            Case "NumPadDot" : Return Keys.Decimal
            Case "NumPadMult", "*" : Return Keys.Multiply
            Case "NumPadSub", "-" : Return Keys.Subtract
            Case "NumPadEnter", "-" : Return Keys.Enter
            Case "Separator" : Return Keys.Separator
            'Otros
            Case ",", ";" : Return Keys.Oemcomma
            Case ".", "." : Return Keys.OemPeriod
            Case "-", "_" : Return Keys.OemMinus
            Case "+", "*", "]" : Return Keys.Oemplus
            Case "ç", "Ç", "}" : Return Keys.OemQuestion
            Case "'", "?" : Return Keys.OemOpenBrackets
            Case "<", ">" : Return Keys.OemBackslash
            Case "`", "^", "[" : Return Keys.Oem1
            Case "º", "ª", "\" : Return Keys.Oem5
            Case "¡", "¿" : Return Keys.Oem6
            Case "´", "¨", "{" : Return Keys.Oem7
                      'Funcion    
            Case "F1" : Return Keys.F1
            Case "F2" : Return Keys.F2
            Case "F3" : Return Keys.F3
            Case "F4" : Return Keys.F4
            Case "F5" : Return Keys.F5
            Case "F6" : Return Keys.F6
            Case "F7" : Return Keys.F7
            Case "F8" : Return Keys.F8
            Case "F9" : Return Keys.F9
            Case "F10" : Return Keys.F10
            Case "F11" : Return Keys.F11
            Case "F12" : Return Keys.F12
            Case "F13" : Return Keys.F13
            Case "F14" : Return Keys.F14
            Case "F15" : Return Keys.F15
            Case "F16" : Return Keys.F16
            Case "F17" : Return Keys.F17
            Case "F18" : Return Keys.F18
            Case "F19" : Return Keys.F19
            Case "F20" : Return Keys.F20
            Case "F21" : Return Keys.F21
            Case "F22" : Return Keys.F22
            Case "F23" : Return Keys.F23
            Case "F24" : Return Keys.F24
                'Modificadores
            Case "LCTRL", "CTRL" : Return Keys.LControlKey
            Case "RCTRL" : Return Keys.RControlKey
            Case "LSHIFT", "SHIFT" : Return Keys.LShiftKey
            Case "RSHIFT" : Return Keys.RShiftKey
            Case "LALT", "ALT" : Return Keys.LMenu
            Case "RALT" : Return Keys.RMenu
            Case "LWIN", "WIN" : Return Keys.LWin
            Case "RWIN" : Return Keys.RWin
            Case Else : Return [Enum].Parse(GetType(Keys), Key.ToString, True)
        End Select

isLowered: Select Case Key.ToLower
            'Multimedia
            Case "selectmedia" : Return Keys.SelectMedia
            Case "mediastop" : Return Keys.MediaStop
            Case "mediaplaypause" : Return Keys.MediaPlayPause
            Case "mediaprevioustrack" : Return Keys.MediaPreviousTrack
            Case "medianexttrack" : Return Keys.MediaNextTrack
            Case "volumeup" : Return Keys.VolumeUp
            Case "volumedown" : Return Keys.VolumeDown
            Case "volumemute" : Return Keys.VolumeMute
            Case "launchmail" : Return Keys.LaunchMail
            Case "launchapplication1" : Return Keys.LaunchApplication1
            Case "launchapplication2" : Return Keys.LaunchApplication2
            Case "browserback" : Return Keys.BrowserBack
            Case "browserfavorites" : Return Keys.BrowserFavorites
            Case "browserforward" : Return Keys.BrowserForward
            Case "browserhome" : Return Keys.BrowserHome
            Case "browserrefresh" : Return Keys.BrowserRefresh
            Case "browsersearch" : Return Keys.BrowserSearch
            Case "browserstop" : Return Keys.BrowserStop
            'Cursores
            Case "printscreen" : Return Keys.PrintScreen
            Case "scroll" : Return Keys.Scroll
            Case "pause" : Return Keys.Pause
            Case "insert" : Return Keys.Insert
            Case "delete" : Return Keys.Delete
            Case "home" : Return Keys.Home
            Case "end" : Return Keys.End
            Case "pageup" : Return Keys.Prior
            Case "pagedown" : Return Keys.Next
            Case "up" : Return Keys.Up
            Case "down" : Return Keys.Down
            Case "left" : Return Keys.Left
            Case "right" : Return Keys.Right
            'Windows
            Case "escape" : Return Keys.Escape
            Case "backspace" : Return Keys.Back
            Case "lshift" : Return Keys.LShiftKey
            Case "rshift" : Return Keys.RShiftKey
            Case "lwin" : Return Keys.LWin
            Case "rwin" : Return Keys.RWin
            Case "tab" : Return Keys.Tab
            Case "enter" : Return Keys.Enter
            Case "lctrl" : Return Keys.LControlKey
            Case "rctrl" : Return Keys.RControlKey
            Case "appskey" : Return Keys.Apps
            Case "capital" : Return Keys.Capital
            Case "space", " " : Return Keys.Space
            Case "lalt" : Return Keys.LMenu
            Case "ralt" : Return Keys.RMenu
            'Numeros
            Case "0", "=" : Return Keys.D0
            Case "1", "!", "|" : Return Keys.D1
            Case "2", """", "@" : Return Keys.D2
            Case "3", "·", "#" : Return Keys.D3
            Case "4", "$", "~" : Return Keys.D4
            Case "5", "%", "€" : Return Keys.D5
            Case "6", "&", "¬" : Return Keys.D6
            Case "7", "/" : Return Keys.D7
            Case "8", "(" : Return Keys.D8
            Case "9", ")" : Return Keys.D9
            'Letras
            Case "a", "á", "à", "ä", "â" : Return Keys.A
            Case "b" : Return Keys.B
            Case "c" : Return Keys.C
            Case "d" : Return Keys.D
            Case "e", "é", "è", "ë", "ê", "€" : Return Keys.E
            Case "f" : Return Keys.F
            Case "g" : Return Keys.G
            Case "h" : Return Keys.H
            Case "i", "í", "ì", "ï", "î" : Return Keys.I
            Case "j" : Return Keys.J
            Case "k" : Return Keys.K
            Case "l" : Return Keys.L
            Case "m" : Return Keys.M
            Case "n" : Return Keys.N
            Case "ñ" : Return Keys.Oemtilde
            Case "o", "ó", "ò", "ö", "ô" : Return Keys.O
            Case "p" : Return Keys.P
            Case "q" : Return Keys.Q
            Case "r" : Return Keys.R
            Case "s" : Return Keys.S
            Case "t" : Return Keys.T
            Case "u", "ú", "ù", "ü", "û" : Return Keys.U
            Case "v" : Return Keys.V
            Case "w" : Return Keys.W
            Case "x" : Return Keys.X
            Case "y" : Return Keys.Y
            Case "z" : Return Keys.Z
            'NumPad
            Case "numlock" : Return Keys.NumLock
            Case "numpad0" : Return Keys.NumPad0
            Case "numpad1" : Return Keys.NumPad1
            Case "numpad2" : Return Keys.NumPad2
            Case "numpad3" : Return Keys.NumPad3
            Case "numpad4" : Return Keys.NumPad4
            Case "numpad5" : Return Keys.NumPad5
            Case "numpad6" : Return Keys.NumPad6
            Case "numpad7" : Return Keys.NumPad7
            Case "numpad8" : Return Keys.NumPad8
            Case "numpad9" : Return Keys.NumPad9
            Case "numpadiv", "/" : Return Keys.Divide
            Case "numpadadd" : Return Keys.Add
            Case "numpaddot" : Return Keys.Decimal
            Case "numpadmult", "*" : Return Keys.Multiply
            Case "numpadsub", "-" : Return Keys.Subtract
            Case "separator" : Return Keys.Separator
            'Otros
            Case ",", ";" : Return Keys.Oemcomma
            Case ".", "." : Return Keys.OemPeriod
            Case "-", "_" : Return Keys.OemMinus
            Case "+", "*", "]" : Return Keys.Oemplus
            Case "ç", "Ç", "}" : Return Keys.OemQuestion
            Case "'", "?" : Return Keys.OemOpenBrackets
            Case "<", ">" : Return Keys.OemBackslash
            Case "`", "^", "[" : Return Keys.Oem1
            Case "º", "ª", "\" : Return Keys.Oem5
            Case "¡", "¿" : Return Keys.Oem6
            Case "´", "¨", "{" : Return Keys.Oem7
                      'Funcion    
            Case "f1" : Return Keys.F1
            Case "f2" : Return Keys.F2
            Case "f3" : Return Keys.F3
            Case "f4" : Return Keys.F4
            Case "f5" : Return Keys.F5
            Case "f6" : Return Keys.F6
            Case "f7" : Return Keys.F7
            Case "f8" : Return Keys.F8
            Case "f9" : Return Keys.F9
            Case "f10" : Return Keys.F10
            Case "f11" : Return Keys.F11
            Case "f12" : Return Keys.F12
            Case "f13" : Return Keys.F13
            Case "f14" : Return Keys.F14
            Case "f15" : Return Keys.F15
            Case "f16" : Return Keys.F16
            Case "f17" : Return Keys.F17
            Case "f18" : Return Keys.F18
            Case "f19" : Return Keys.F19
            Case "f20" : Return Keys.F20
            Case "f21" : Return Keys.F21
            Case "f22" : Return Keys.F22
            Case "f23" : Return Keys.F23
            Case "f24" : Return Keys.F24
            Case Else : Return Keys.None
        End Select

    End Function

    Public Function Key_to_String(Key As Keys) As Boolean
        Return Key.ToString
    End Function

#End Region

#End Region

#End Region

#Region " Mouse "

#Region " Send Mouse "

#Region " Send Mouse Button "

    Public Sub Send_MouseDown(mButton As Mouse_Buttons)
        Select Case mButton
            Case Mouse_Buttons.LMouse
                SendButton(Mouse_Buttons.B_LMouseDown)
            Case Mouse_Buttons.RMouse
                SendButton(Mouse_Buttons.B_RMouseDown)
            Case Mouse_Buttons.MMouse
                SendButton(Mouse_Buttons.B_MMouseDown)
            Case Mouse_Buttons.X1Mouse
                SendButton(Mouse_Buttons.B_XMouseDown, Mouse_Buttons.XBUTTON1)
            Case Mouse_Buttons.X2Mouse
                SendButton(Mouse_Buttons.B_XMouseDown, Mouse_Buttons.XBUTTON2)
        End Select
    End Sub

    Public Sub Send_MouseUp(mButton As Mouse_Buttons)
        Select Case mButton
            Case Mouse_Buttons.LMouse
                SendButton(Mouse_Buttons.B_LMouseUp)
            Case Mouse_Buttons.RMouse
                SendButton(Mouse_Buttons.B_RMouseUp)
            Case Mouse_Buttons.MMouse
                SendButton(Mouse_Buttons.B_MMouseUp)
            Case Mouse_Buttons.X1Mouse
                SendButton(Mouse_Buttons.B_XMouseUp, Mouse_Buttons.XBUTTON1)
            Case Mouse_Buttons.X2Mouse
                SendButton(Mouse_Buttons.B_XMouseUp, Mouse_Buttons.XBUTTON2)
        End Select
    End Sub

    Public Sub Send_MousePress(mButton As Mouse_Buttons, Optional Delay As Integer = 0)
        Dim SendMouse() As Mouse_Buttons = {mButton}
        Dim MousePress As New MousePressStruct(SendMouse, Delay)
        Dim t As New Threading.Thread(New Threading.ParameterizedThreadStart(AddressOf MousePress_Thread)) : t.Start(MousePress)
    End Sub

    Private Sub SendButton(mButton As Mouse_Buttons, Optional XButton As Integer = 0)
        Dim input As New INPUT()
        input.dwType = 0
        input.mkhi.mi = New MOUSEINPUT()
        input.mkhi.mi.dwExtraInfo = IntPtr.Zero
        input.mkhi.mi.dwFlags = mButton
        If mButton = Mouse_Buttons.B_XMouseDown Or mButton = Mouse_Buttons.B_XMouseUp Then input.mkhi.mi.mouseData = XButton
        input.mkhi.mi.dx = 0
        input.mkhi.mi.dy = 0
        Dim cbSize As Integer = Runtime.InteropServices.Marshal.SizeOf(GetType(INPUT))
        SendInput(1, input, cbSize)
    End Sub

#End Region

#Region " Send Scroll Wheel "

    Public Sub Send_ScrollDown(mButton As Mouse_Buttons)
        Dim input As New INPUT()
        input.dwType = 0
        input.mkhi.mi = New MOUSEINPUT()
        input.mkhi.mi.dwExtraInfo = IntPtr.Zero
        input.mkhi.mi.dwFlags = mButton
        input.mkhi.mi.mouseData = ScrollDirection.Down
        input.mkhi.mi.dx = Cursor.Position.X
        input.mkhi.mi.dy = Cursor.Position.Y
        Dim cbSize As Integer = Runtime.InteropServices.Marshal.SizeOf(GetType(INPUT))
        SendInput(1, input, cbSize)
    End Sub

    Public Sub Send_ScrollUp(mButton As Mouse_Buttons)
        Dim input As New INPUT()
        input.dwType = 0
        input.mkhi.mi = New MOUSEINPUT()
        input.mkhi.mi.dwExtraInfo = IntPtr.Zero
        input.mkhi.mi.dwFlags = mButton
        input.mkhi.mi.mouseData = ScrollDirection.Up
        input.mkhi.mi.dx = Cursor.Position.X
        input.mkhi.mi.dy = Cursor.Position.Y
        Dim cbSize As Integer = Runtime.InteropServices.Marshal.SizeOf(GetType(INPUT))
        SendInput(1, input, cbSize)
    End Sub

    Public Sub Send_Scroll(mButton As Mouse_Buttons, Direction As ScrollDirection)
        Dim input As New INPUT()
        input.dwType = 0
        input.mkhi.mi = New MOUSEINPUT()
        input.mkhi.mi.dwExtraInfo = IntPtr.Zero
        input.mkhi.mi.dwFlags = mButton
        input.mkhi.mi.mouseData = Direction
        input.mkhi.mi.dx = Cursor.Position.X
        input.mkhi.mi.dy = Cursor.Position.Y
        Dim cbSize As Integer = Runtime.InteropServices.Marshal.SizeOf(GetType(INPUT))
        SendInput(1, input, cbSize)
    End Sub

#End Region

#Region " Send Mouse Move "

    Public Sub Send_MouseMove(Location As Point, Optional Relative As Boolean = False)
        Dim input As New INPUT()
        input.dwType = 0
        input.mkhi.mi = New MOUSEINPUT()
        input.mkhi.mi.dwExtraInfo = IntPtr.Zero
        Select Case Relative
            Case False
                input.mkhi.mi.dwFlags = &H8000 + &H1
                input.mkhi.mi.dx = Location.X * (65535 / Screen.PrimaryScreen.Bounds.Width)
                input.mkhi.mi.dy = Location.Y * (65535 / Screen.PrimaryScreen.Bounds.Height)
            Case True
                input.mkhi.mi.dwFlags = &H1
                input.mkhi.mi.dx = Location.X
                input.mkhi.mi.dy = Location.Y
        End Select
        Dim cbSize As Integer = Runtime.InteropServices.Marshal.SizeOf(GetType(INPUT))
        SendInput(1, input, cbSize)
    End Sub

#End Region

#End Region

#Region " Send Virtual Mouse "

#Region " Send Mouse Button "

    Public Sub Send_Virtual_MouseDown(mButton As Mouse_Buttons)
        Select Case mButton
            Case Mouse_Buttons.LMouse
                mouse_event(Mouse_Buttons.B_LMouseDown, 0, 0, 0, 0)
            Case Mouse_Buttons.RMouse
                mouse_event(Mouse_Buttons.B_RMouseDown, 0, 0, 0, 0)
            Case Mouse_Buttons.MMouse
                mouse_event(Mouse_Buttons.B_MMouseDown, 0, 0, 0, 0)
            Case Mouse_Buttons.X1Mouse
                mouse_event(Mouse_Buttons.B_XMouseDown, 0, 0, Mouse_Buttons.XBUTTON1, 0)
            Case Mouse_Buttons.X2Mouse
                mouse_event(Mouse_Buttons.B_XMouseDown, 0, 0, Mouse_Buttons.XBUTTON2, 0)
        End Select
    End Sub

    Public Sub Send_Virtual_MouseUp(mButton As Mouse_Buttons)
        Select Case mButton
            Case Mouse_Buttons.LMouse
                mouse_event(Mouse_Buttons.B_LMouseUp, 0, 0, 0, 0)
            Case Mouse_Buttons.RMouse
                mouse_event(Mouse_Buttons.B_RMouseUp, 0, 0, 0, 0)
            Case Mouse_Buttons.MMouse
                mouse_event(Mouse_Buttons.B_MMouseUp, 0, 0, 0, 0)
            Case Mouse_Buttons.X1Mouse
                mouse_event(Mouse_Buttons.B_XMouseUp, 0, 0, Mouse_Buttons.XBUTTON1, 0)
            Case Mouse_Buttons.X2Mouse
                mouse_event(Mouse_Buttons.B_XMouseUp, 0, 0, Mouse_Buttons.XBUTTON2, 0)
        End Select
    End Sub

    Public Sub Send_Virtual_MousePress(mButton As Mouse_Buttons, Optional Delay As Integer = 0)
        Dim SendMouse() As Mouse_Buttons = {mButton}
        Dim MousePress As New MousePressStruct(SendMouse, Delay)
        Dim t As New Threading.Thread(New Threading.ParameterizedThreadStart(AddressOf Virtual_MousePress_Thread)) : t.Start(MousePress)
    End Sub

#End Region

#Region " Send Mouse Wheel "

    Public Sub Send_Virtual_ScrollDown(KeyCode As Mouse_Buttons)
        If KeyCode = Mouse_Buttons.Wheel Then mouse_event(Mouse_Buttons.Wheel, 0, 0, ScrollDirection.Down, 0)
        If KeyCode = Mouse_Buttons.HWheel Then mouse_event(Mouse_Buttons.HWheel, 0, 0, ScrollDirection.Down, 0)
    End Sub

    Public Sub Send_Virtual_ScrollUp(KeyCode As Mouse_Buttons)
        If KeyCode = Mouse_Buttons.Wheel Then mouse_event(Mouse_Buttons.Wheel, 0, 0, ScrollDirection.Up, 0)
        If KeyCode = Mouse_Buttons.HWheel Then mouse_event(Mouse_Buttons.HWheel, 0, 0, ScrollDirection.Up, 0)
    End Sub

    Public Sub Send_Virtual_Scroll(KeyCode As Mouse_Buttons, Direction As ScrollDirection)
        If KeyCode = Mouse_Buttons.Wheel Then mouse_event(Mouse_Buttons.Wheel, 0, 0, Direction, 0)
        If KeyCode = Mouse_Buttons.HWheel Then mouse_event(Mouse_Buttons.HWheel, 0, 0, Direction, 0)
    End Sub

#End Region

#Region " Send Mouse Move "

    Public Sub Send_Virtual_MouseMove(Location As Point, Optional Relativo As Boolean = False)
        If Relativo = False Then Cursor.Position = Location
        If Relativo = True Then Cursor.Position = New Point(Cursor.Position.X + Location.X, Cursor.Position.Y + Location.Y)
    End Sub

#End Region

#End Region

#Region " Mouse Location "

    Public Sub Set_Mouse_Location(Location As Point)
        SetCursorPos(Location.X, Location.Y)
    End Sub

    Public Sub Set_Mouse_Location(x As Integer, y As Integer)
        SetCursorPos(x, y)
    End Sub

    Public Function Get_Mouse_Location() As Point
        Dim CursorPos As Point : GetCursorPos(CursorPos) : Return CursorPos
    End Function

#End Region

#Region " Functions "

    Private Sub MousePress_Thread(MKeysP As MousePressStruct)
        For Each k As Mouse_Buttons In MKeysP.MKeys : Send_MouseDown(k) : Next
        If MKeysP.Delay > 0 Then Threading.Thread.Sleep(MKeysP.Delay)
        For Each k As Mouse_Buttons In MKeysP.MKeys : Send_MouseUp(k) : Next
    End Sub

    Private Sub Virtual_MousePress_Thread(MKeysP As MousePressStruct)
        For Each k As Mouse_Buttons In MKeysP.MKeys : Send_Virtual_MouseDown(k) : Next
        If MKeysP.Delay > 0 Then Threading.Thread.Sleep(MKeysP.Delay)
        For Each k As Mouse_Buttons In MKeysP.MKeys : Send_Virtual_MouseUp(k) : Next
    End Sub

#Region " String to Button "

    Public Function String_to_Button(Boton As String) As Mouse_Buttons
        Select Case Boton.ToLower
            Case "mouse 1", "doble mouse 1" : Return Mouse_Buttons.LMouse
            Case "mouse 2" : Return Mouse_Buttons.RMouse
            Case "mouse 3" : Return Mouse_Buttons.MMouse
            Case "mouse 4" : Return Mouse_Buttons.X1Mouse
            Case "mouse 5" : Return Mouse_Buttons.X2Mouse
            Case "rueda", "wheel up", "wheel down" : Return Mouse_Buttons.Wheel
            Case "hrueda" : Return Mouse_Buttons.HWheel
        End Select : Return Nothing
    End Function

#End Region

#End Region

#End Region

#End Region

#Region " Close "

    Public Sub Close()
        If Not KHookID = IntPtr.Zero Then UnhookWindowsHookEx(KHookID)
        If Not MHookID = IntPtr.Zero Then UnhookWindowsHookEx(MHookID)
    End Sub

#End Region

#End Region

#Region " Funciones "

#Region " Keyboard Hook "

#Region " Filtro "

    Public Shared Function Filtrar(Key As String, Optional Flags As String = "") As String
        If Key.ToLower = "return" Then If Flags = "LLKHF_EXTENDED" Then Return "NumPadEnter" Else Return "Enter"
        If Key.ToLower = "back" Then Return "Backspace"
        If Key.ToLower = "lshiftkey" Then Return "LShift"
        If Key.ToLower = "rshiftkey" Then Return "RShift"
        If Key.ToLower = "lcontrolkey" Then Return "LCtrl"
        If Key.ToLower = "rcontrolkey" Then Return "RCtrl"
        If Key.ToLower = "lmenu" Then Return "LAlt"
        If Key.ToLower = "rmenu" Then Return "RAlt"
        If Key.ToLower = "lwin" Then Return "LWin"
        If Key.ToLower = "rwin" Then Return "RWin"
        If Key.ToLower = "apps" Then Return "AppsKey"
        If Key.ToLower = "d0" Then Return "0"
        If Key.ToLower = "d1" Then Return "1"
        If Key.ToLower = "d2" Then Return "2"
        If Key.ToLower = "d3" Then Return "3"
        If Key.ToLower = "d4" Then Return "4"
        If Key.ToLower = "d5" Then Return "5"
        If Key.ToLower = "d6" Then Return "6"
        If Key.ToLower = "d7" Then Return "7"
        If Key.ToLower = "d8" Then Return "8"
        If Key.ToLower = "d9" Then Return "9"
        If Key.ToLower = "oemcomma" Then Return ","
        If Key.ToLower = "oemperiod" Then Return "."
        If Key.ToLower = "oemminus" Then Return "-"
        If Key.ToLower = "oemplus" Then Return "+"
        If Key.ToLower = "oemquestion" Then Return "ç"
        If Key.ToLower = "oemopenbrackets" Then Return "'"
        If Key.ToLower = "oembackslash" Then Return "<"
        If Key.ToLower = "oemtilde" Then Return "Ñ"
        If Key.ToLower = "oem1" Then Return "`"
        If Key.ToLower = "oem5" Then Return "\"
        If Key.ToLower = "oem6" Then Return "¡"
        If Key.ToLower = "oem7" Then Return "´"
        If Key.ToLower = "divide" Then Return "NumPadDiv"
        If Key.ToLower = "multiply" Then Return "NumPadMult"
        If Key.ToLower = "subtract" Then Return "NumPadSub"
        If Key.ToLower = "add" Then Return "NumPadAdd"
        If Key.ToLower = "decimal" Then Return "NumPadDot"
        If Key.ToLower = "clear" Then Return "NumPadClear"
        If Key.ToLower = "prior" Then Return "PageUp"
        If Key.ToLower = "next" Then Return "PageDown"
        If Key.ToLower = "pgdn" Then Return "PageDown"
        Return Key
    End Function

#End Region

    Private Function Keyboard_Hook(nCode As Integer, wParam As IntPtr, lParam As KBDLLHOOKSTRUCT) As Integer
        If nCode = 0 Then
            Dim Hotkey As String = Filtrar(CType(lParam.vkCode, Keys).ToString, lParam.flags.ToString) : Dim SKey As String = Hotkey : Dim Modificador As String = ""
            Dim Injected As Boolean : If lParam.flags = 10 Or lParam.dwExtraInfo = 10 Then Injected = True Else Injected = False
            If Injected = True Then Return CallNextHookEx(13, nCode, wParam, lParam)
            If FMenu.SendKeyRShiftBlock = True AndAlso SKey = "RShift" AndAlso (wParam = &H100 Or wParam = &H104) Then Return -1
            If FMenu.GMacro_Grabando = True Then
                If FMenu.GMacro_Pausar = True Then Return CallNextHookEx(13, nCode, wParam, lParam)
                If Keyboard_StopWatch.IsRunning = False Then Keyboard_StopWatch.Reset() : Keyboard_StopWatch.Start()
                If Get_KeyState(Keys.LControlKey) Or Get_KeyState(Keys.RControlKey) Then Modificador = "CTRL + "
                If Get_KeyState(Keys.LMenu) Or Get_KeyState(Keys.RMenu) Then Modificador += "ALT + "
                If Get_KeyState(Keys.LShiftKey) Or Get_KeyState(Keys.RShiftKey) Then Modificador += "SHIFT + "
                If Get_KeyState(Keys.LWin) Or Get_KeyState(Keys.RWin) Then Modificador += "WIN + "
                If Hotkey <> "" Then Hotkey = Modificador + Hotkey
                Select Case wParam
                    Case &H100, &H104
                        'If Hotkeys.Contains("KeyDown" + SKey) = False Then
                        Hotkeys.Add("KeyDown" + SKey)
                        RaiseEvent Key_Macro("Key Down", Hotkey, SKey, Keyboard_StopWatch.ElapsedMilliseconds)
                        If FMenu.GMacro_CEventosTeclado.Checked = True Then Keyboard_StopWatch.Restart()
                        'End If
                    Case &H101, &H105
                        'If Hotkeys.Contains("KeyDown" + SKey) = True Then
                        Hotkeys.Remove("KeyDown" + SKey)
                        RaiseEvent Key_Macro("Key Up", Hotkey, SKey, Keyboard_StopWatch.ElapsedMilliseconds)
                        If FMenu.GMacro_CEventosTeclado.Checked = True Then Keyboard_StopWatch.Restart()
                        'End If
                End Select
            Else
                If Keyboard_StopWatch.IsRunning = True Then Keyboard_StopWatch.Stop() : Mouse_StopWatch.Stop()
                If Get_KeyState(Keys.LControlKey) Or Get_KeyState(Keys.RControlKey) Then Modificador = "CTRL + "
                If Get_KeyState(Keys.LMenu) Or Get_KeyState(Keys.RMenu) Then Modificador += "ALT + "
                If Get_KeyState(Keys.LShiftKey) Or Get_KeyState(Keys.RShiftKey) Then Modificador += "SHIFT + "
                If Get_KeyState(Keys.LWin) Or Get_KeyState(Keys.RWin) Then Modificador += "WIN + "
                If Hotkey <> "" Then Hotkey = Modificador + Hotkey
                Dim Bloquear As Boolean
                If Hotkey = "Escape" And (FMenu.GCapturaPantalla_Grabando = True Or FMenu.GGrabacionPantalla_Grabando = True Or FMenu.GGrabacionAudio_Grabando = True Or FMenu.GMostrarMensaje_Mostrando = True Or FMenu.GApagarEquipo_Apagando = True Or FMenu.GEsperar_Esperando = True Or FSelectDisplay.Visible = True) Then Bloquear = True
                If FMenu.Get_HotKey = True Or FMenu.Get_Macro_Key = True Or FMenu.Get_Pulsacion_Key = True Or FMenu.Get_KBoard_Key = True Or FMenu.KBoard_Cambiar_HotKey = True Or FMenu.KBoard_Por_HotKey = True Then Bloquear = True
                Select Case wParam
                    Case &H100, &H104
                        'If Not Hotkey.ToLower.EndsWith("ctrl") And Not Hotkey.ToLower.EndsWith("shift") And Not Hotkey.ToLower.EndsWith("alt") And Not Hotkey.ToLower.EndsWith("win") Then RaiseEvent Key("Key Down", Hotkey, SKey)
                        RaiseEvent Key("Key Down", Hotkey, SKey)
                    Case &H101, &H105
                        'If Not Hotkey.ToLower.EndsWith("ctrl") And Not Hotkey.ToLower.EndsWith("shift") And Not Hotkey.ToLower.EndsWith("alt") And Not Hotkey.ToLower.EndsWith("win") Then RaiseEvent Key("Key Up", Hotkey, SKey)
                        RaiseEvent Key("Key Up", Hotkey, SKey)
                End Select
                If Not FMenu.GetChangedKey(Hotkey, "Check") = Nothing Then
                    Select Case wParam
                        Case &H100, &H104
                            FMenu.GetChangedKey(Hotkey, "Key Down") : Return -1
                        Case &H101, &H105
                            FMenu.GetChangedKey(Hotkey, "Key Up") : Return -1
                    End Select
                End If
                If Not Hotkey.EndsWith("Ctrl") And Not Hotkey.EndsWith("Shift") And Not Hotkey.EndsWith("Alt") And Not Hotkey.EndsWith("Win") Then
                    If FMenu.Get_HotKey = True Or FMenu.Get_Macro_Key = True Or FMenu.Get_Pulsacion_Key = True Then Return 1
                    If Bloquear = True Then Return -1
                End If
                If FMenu.Comando_Existe_Hotkey(Hotkey) = True Then Return 1
            End If
        End If
        Try : Return CallNextHookEx(13, nCode, wParam, lParam)
        Catch : Return 1 : End Try
    End Function

#End Region

#Region " Mouse Hook "

    Private Function Mouse_Hook(nCode As Integer, wParam As Integer, ByRef lParam As MSLLHOOKSTRUCT) As Integer
        Try : If nCode = 0 Then
                Dim Injected As Boolean : If lParam.flags = &H1 Then Injected = True Else Injected = False
                If Injected = True Then Return CallNextHookEx(14, nCode, wParam, lParam)
                If FMenu.GMacro_Grabando = True Then
                    If FMenu.Macros_OnRecordButton = False Then
                        Dim Location As Point = lParam.pt : Dim Boton As String = "" : Dim Evento As String = ""
                        If Keyboard_StopWatch.IsRunning = False Then Keyboard_StopWatch.Reset() : Keyboard_StopWatch.Start()
                        If Mouse_StopWatch.IsRunning = False Then Mouse_StopWatch.Reset() : Mouse_StopWatch.Start()
                        Select Case wParam
                            Case &H201, &H202 : Boton = "Mouse 1"
                            Case &H204, &H205 : Boton = "Mouse 2"
                            Case &H207, &H208 : Boton = "Mouse 3"
                            Case &H20A, &H20E : Boton = "Rueda"
                            Case 523, 524
                                If lParam.MouseData = 65536 Then Boton = "Mouse 4"
                                If lParam.MouseData = 131072 Then Boton = "Mouse 5"
                        End Select
                        Select Case wParam
                            Case &H201, &H204, &H207, 523
                                If Hotkeys.Contains("MouseDown" + Boton) = False Then
                                    Hotkeys.Add("MouseDown" + Boton)
                                    RaiseEvent Mouse_Macro("Mouse Down", Boton, Location, Keyboard_StopWatch.ElapsedMilliseconds)
                                    If FMenu.GMacro_CClicsRaton.Checked = True Or FMenu.GMacro_CClicks_Position.Checked = True Then Keyboard_StopWatch.Restart()
                                End If
                            Case &H202, &H205, &H208, 524
                                If Hotkeys.Contains("MouseDown" + Boton) = True Then
                                    Hotkeys.Remove("MouseDown" + Boton)
                                    RaiseEvent Mouse_Macro("Mouse Up", Boton, Location, Keyboard_StopWatch.ElapsedMilliseconds)
                                    If FMenu.GMacro_CClicsRaton.Checked = True Or FMenu.GMacro_CClicks_Position.Checked = True Then Keyboard_StopWatch.Restart()
                                End If
                            Case &H20A
                                If lParam.MouseData < 0 Then
                                    RaiseEvent Mouse_Macro("Wheel Down", "abajo", Location, Keyboard_StopWatch.ElapsedMilliseconds)
                                    If FMenu.GMacro_CRuedaRaton.Checked = True Then Keyboard_StopWatch.Restart()
                                Else
                                    RaiseEvent Mouse_Macro("Wheel Up", "arriba", Location, Keyboard_StopWatch.ElapsedMilliseconds)
                                    If FMenu.GMacro_CRuedaRaton.Checked = True Then Keyboard_StopWatch.Restart()
                                End If
                            Case &H20E
                                If lParam.MouseData < 0 Then
                                    RaiseEvent Mouse_Macro("HWheel Down", "izquierda", Location, Keyboard_StopWatch.ElapsedMilliseconds)
                                    If FMenu.GMacro_CRuedaRaton.Checked = True Then Keyboard_StopWatch.Restart()
                                Else
                                    RaiseEvent Mouse_Macro("HWheel Up", "derecha", Location, Keyboard_StopWatch.ElapsedMilliseconds)
                                    If FMenu.GMacro_CRuedaRaton.Checked = True Then Keyboard_StopWatch.Restart()
                                End If
                            Case &H200
                                If Mouse_StopWatch.ElapsedMilliseconds > 10 Then
                                    Mouse_StopWatch.Restart() : RaiseEvent Mouse_Macro("Mouse Move", "Mover", Location, Keyboard_StopWatch.ElapsedMilliseconds)
                                    If FMenu.GMacro_CMovimientoRaton.Checked = True Then Keyboard_StopWatch.Restart()
                                End If
                        End Select
                    End If
                ElseIf wParam <> &H200 Then
                    Dim Location As Point = lParam.pt : Dim Boton As String = "" : Dim Evento As String = "" : Dim Modificador As String = ""
                    If Keyboard_StopWatch.IsRunning = True Then Keyboard_StopWatch.Stop() : Mouse_StopWatch.Stop()
                    Dim HandleButton As Boolean
                    Select Case wParam
                        Case &H20A : Boton = "Mouse Wheel"
                        Case &H201, &H202 : Boton = "Mouse 1"
                        Case &H204, &H205 : Boton = "Mouse 2"
                        Case &H207, &H208 : Boton = "Mouse 3"
                        Case 523, 524
                            If lParam.MouseData = 65536 Then Boton = "Mouse 4"
                            If lParam.MouseData = 131072 Then Boton = "Mouse 5"
                    End Select

                    Select Case wParam
                        Case &H201, &H204, &H207, 523 : Evento = "Mouse Down" : Hotkey += " + " + Boton
                            If FMenu.Opciones_DisableXButton = True Then
                                'If Boton = "Mouse 4" AndAlso (ProcessList.Contains(FMenu.Proceso.Get_ProcessST(True).Process_Name.ToLower) = True Or FMenu.CQuickMenu.Visible = True) Then HandleButton = True : JustHandledM4 = True
                                'If Boton = "Mouse 5" AndAlso (ProcessList.Contains(FMenu.Proceso.Get_ProcessST(True).Process_Name.ToLower) = True Or FMenu.CQuickMenu.Visible = True) Then HandleButton = True : JustHandledM5 = True
                                DeshabilitarBackFoward = "" : For Cuenta = 0 To FMenu.DeshabilitarBackForward.Length - 1 : DeshabilitarBackFoward += FMenu.DeshabilitarBackForward(Cuenta).ToLower : Next
                                If Boton = "Mouse 4" AndAlso DeshabilitarBackFoward.Contains(FMenu.Proceso.Get_ProcessST(True).Process_Name.ToLower) = True Then HandleButton = True : JustHandledM4 = True
                                If Boton = "Mouse 5" AndAlso DeshabilitarBackFoward.Contains(FMenu.Proceso.Get_ProcessST(True).Process_Name.ToLower) = True Then HandleButton = True : JustHandledM5 = True
                            End If
                        Case &H202, &H205, &H208, 524 : Evento = "Mouse Up"
                            If Boton = "Mouse 4" And JustHandledM4 = True Then HandleButton = True : JustHandledM4 = False
                            If Boton = "Mouse 5" And JustHandledM5 = True Then HandleButton = True : JustHandledM5 = False
                        Case &H20A
                            If lParam.MouseData < 0 Then Evento = "Wheel Down" Else Evento = "Wheel Up"
                            Hotkey += " + " + Evento
                        Case &H20E
                            If lParam.MouseData < 0 Then Evento = "HWheel Down" Else Evento = "HWheel Up"
                            Hotkey += " + " + Evento
                    End Select
                    If Get_KeyState(Keys.LControlKey) Or Get_KeyState(Keys.RControlKey) Then Modificador = "CTRL + "
                    If Get_KeyState(Keys.LMenu) Or Get_KeyState(Keys.RMenu) Then Modificador += "ALT + "
                    If Get_KeyState(Keys.LShiftKey) Or Get_KeyState(Keys.RShiftKey) Then Modificador += "SHIFT + "
                    If Hotkey = Nothing Then Hotkey = ""
                    If Hotkey.StartsWith(" + ") Then Hotkey = Hotkey.Substring(3)
                    If JustHandledCM = True Then HandleButton = True : JustHandledCM = False
                    If HandleButton = False AndAlso Evento = "Mouse Down" AndAlso FMenu.Comando_Existe_Hotkey(Modificador + Hotkey) = True Then HandleButton = True : JustHandledCM = True
                    If Evento = "Mouse Up" Or Evento = "Wheel Down" Or Evento = "Wheel Up" Then
                        RaiseEvent Mouse(Location, Boton, Evento, Modificador + Hotkey) : Hotkey = ""
                    Else
                        RaiseEvent Mouse(Location, Boton, Evento, Modificador + Hotkey)
                    End If
                    If Boton = "Mouse Wheel" Then Boton = Evento
                    If Not FMenu.GetChangedKey(Boton, "Check") = Nothing Then
                        Select Case wParam
                            Case &H201, &H204, &H207, 523
                                FMenu.GetChangedKey(Hotkey, "Key Down") : Return -1
                            Case &H202, &H205, &H208, 524
                                FMenu.GetChangedKey(Hotkey, "Key Up") : Return -1
                            Case &H20A
                                If lParam.MouseData < 0 Then FMenu.GetChangedKey(Boton, "Wheel Down") : Return -1 Else FMenu.GetChangedKey(Boton, "Wheel Up") : Return -1
                            Case &H20E
                                If lParam.MouseData < 0 Then FMenu.GetChangedKey(Boton, "HWheel Down") : Return -1 Else FMenu.GetChangedKey(Boton, "HWheel Up") : Return -1
                        End Select
                    End If
                    If HandleButton = True Then Return 1
                End If
            End If
        Catch : End Try : Return CallNextHookEx(14, nCode, wParam, lParam)
    End Function

#End Region

#End Region

End Class

#End Region

#Region " Recorders "

#Region " AudioRecorder "

Public Class AudioRecorder_CL

#Region " Variables "

#Region " Declaraciones "

    <Runtime.InteropServices.DllImport("winmm.dll", EntryPoint:="mciSendStringW")> Private Shared Function MciSendStringW(<Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.LPWStr)> lpstrCommand As String, <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.LPWStr)> lpstrReturnString As Text.StringBuilder, uReturnLength As Integer, hwndCallback As IntPtr) As Integer : End Function

#End Region

    Public IsRecording As Boolean
    Dim Writer As NAudio.Wave.WaveFileWriter
    Dim PlaySilence As New NAudio.Wave.WaveOutEvent
    ReadOnly sb As New Text.StringBuilder

#End Region

#Region " Metodos "

    Public Sub StartRecording()
        'Try
        If IsRecording = True Then Exit Sub
        IsRecording = True : IO.Directory.CreateDirectory(FMenu.KobaPathTemp)
        FMenu.GGrabacionAudio_WaveInAudio = New NAudio.Wave.WasapiLoopbackCapture()
        Writer = New NAudio.Wave.WaveFileWriter(FMenu.KobaPathTemp + "AudioS.wav", FMenu.GGrabacionAudio_WaveInAudio.WaveFormat)
        AddHandler FMenu.GGrabacionAudio_WaveInAudio.DataAvailable, AddressOf OnDataAvailable
        AddHandler FMenu.GGrabacionAudio_WaveInAudio.RecordingStopped, AddressOf OnRecordingStopped
        PlaySilence.Init(New NAudio.Wave.SilenceProvider(New NAudio.Wave.WaveFormat(44100, 2))) : PlaySilence.Play() : FMenu.GGrabacionAudio_WaveInAudio.StartRecording()
        MciSendStringW("open new Type waveaudio Alias capture", sb, 0, IntPtr.Zero)
        MciSendStringW("set capture time format ms bitspersample 16 channels 2 samplespersec 48000 bytespersec 192000 alignment 4", Nothing, 0, IntPtr.Zero)
        MciSendStringW("record capture", sb, 0, IntPtr.Zero)
        'Catch : CancelRecording() : End Try
    End Sub

    Public Sub StopRecording()
        'Try : FMenu.Sonidos.Play("Default")
        If FMenu.GGrabacionAudio_WaveInAudio IsNot Nothing Then FMenu.GGrabacionAudio_WaveInAudio.StopRecording()
        Dim Done As Boolean : Do : Done = True : Application.DoEvents() : If IsRecording = True Then Done = False
        Loop Until Done = True
        'Catch : IsRecording = False : End Try
    End Sub

    Public Sub CancelRecording(Optional Silenced As Boolean = False)
        FMenu.GGrabacionAudio_Grabando = False : IsRecording = False : StopRecording()
        If Silenced = False Then Sonidos.Stop() : Sonidos.Play_Block("Default") : If FMenu.GGrabacionAudio_OSD = True Then FMenu.Opciones_OSD_Font = FMenu.GGrabacionAudio_OSD_Fuente : FMenu.Opciones_OSD_Color = FMenu.GGrabacionAudio_OSD_Color : FMenu.ShowOSD("Grabación cancelada", 500)
    End Sub

#End Region

#Region " Funciones "

    Private Sub OnDataAvailable(sender As Object, e As NAudio.Wave.WaveInEventArgs)
        Writer.Write(e.Buffer, 0, e.BytesRecorded)
    End Sub

    Private Sub OnRecordingStopped(sender As Object, e As NAudio.Wave.StoppedEventArgs)
        Try : PlaySilence.Stop()
            If Writer IsNot Nothing Then Writer.Close() : Writer = Nothing
            MciSendStringW("stop capture", sb, 0, IntPtr.Zero)
            MciSendStringW("save capture " + Chr(34) + FMenu.KobaPathTemp + "AudioM.wav" + Chr(34), sb, 0, IntPtr.Zero)
            MciSendStringW("close capture", sb, 0, IntPtr.Zero)
            If IO.File.Exists(FMenu.KobaPathTemp + "AudioS.wav") = True AndAlso IO.File.Exists(FMenu.KobaPathTemp + "AudioM.wav") = True Then
                Dim mixer As New NAudio.Wave.WaveMixerStream32 With {.AutoStop = True}
                mixer.AddInputStream(New NAudio.Wave.WaveChannel32(New NAudio.Wave.WaveFileReader(FMenu.KobaPathTemp + "AudioS.wav")))
                mixer.AddInputStream(New NAudio.Wave.WaveChannel32(New NAudio.Wave.WaveFileReader(FMenu.KobaPathTemp + "AudioM.wav")))
                NAudio.Wave.WaveFileWriter.CreateWaveFile(FMenu.KobaPathTemp + "AudioA.wav", New NAudio.Wave.Wave32To16Stream(mixer)) : mixer.Close()
            End If
            SaveMP3("AudioS") : SaveMP3("AudioM") : SaveMP3("AudioA")
        Catch : End Try : IsRecording = False
    End Sub

    Private Sub SaveMP3(AudioFile As String)
        Dim Ruta_WAV As String = FMenu.KobaPathTemp + AudioFile + ".wav"
        Dim Ruta_MP3 As String = FMenu.KobaPathTemp + AudioFile + ".mp3"
        If IO.File.Exists(Ruta_WAV) = False Then Exit Sub
        Try : IO.Directory.CreateDirectory(FMenu.KobaPathTemp) : If IO.File.Exists(Ruta_MP3) = True Then IO.File.Delete(Ruta_MP3)
            'If IO.File.Exists(Application.StartupPath + "\NAudio.Lame.dll") = False Then IO.File.Copy(Ruta_WAV, Ruta_MP3, True) : Exit Sub
            Using Reader = New NAudio.Wave.AudioFileReader(Ruta_WAV)
                Using Writer = New NAudio.Lame.LameMP3FileWriter(Ruta_MP3, Reader.WaveFormat, 128)
                    Reader.CopyTo(Writer)
                End Using
            End Using
        Catch : IO.File.Copy(Ruta_WAV, Ruta_MP3, True) : End Try
    End Sub

#End Region

End Class

#End Region

#Region " VideoRecorder "

Public Class VideoRecorderCL

#Region " Variables "

    Public Recording As Boolean
    Public RMonitor As Integer
    Dim Speaker As ScreenRecorderLib.Recorder
    Dim SavePath As String : Dim Handled, cDesktopDuplication As Boolean

    Sub New(SPath As String)
        SavePath = SPath
    End Sub

#End Region

#Region " Record "

    Public Sub Record(Monitor As UInteger, DesktopDuplication As Boolean, Sonido As Boolean, Microfono As Boolean, MouseClicks As Boolean)
        If IO.File.Exists((Application.StartupPath + "\ScreenRecorderLib.dll").Replace("\\", "\")) = False Then IO.File.WriteAllBytes((Application.StartupPath + "\ScreenRecorderLib.dll").Replace("\\", "\"), My.Resources.ScreenRecorderLib)
        RMonitor = Monitor : If Monitor >= Screen.AllScreens.Count Then Exit Sub
        Recording = True : Record_Speaker(Monitor, DesktopDuplication, Sonido, Microfono, MouseClicks)
        If Handled = False Then
            Handled = True
            AddHandler Speaker.OnRecordingComplete, AddressOf OnRecordingComplete
            AddHandler Speaker.OnRecordingFailed, AddressOf OnRecordingFailed
            AddHandler Speaker.OnStatusChanged, AddressOf OnStatusChanged
        End If
    End Sub

    Private Sub DeleteFile(FilePath As String)
        If IO.File.Exists(FilePath) Then IO.File.Delete(FilePath)
    End Sub

#Region " Speaker "

    Private Sub Record_Speaker(Monitor As Integer, DesktopDuplication As Boolean, Sonido As Boolean, Microfono As Boolean, MouseClicks As Boolean)
        Dim cSonido As Boolean = True : If Sonido = False And Microfono = False Then cSonido = False
        cDesktopDuplication = DesktopDuplication
        Dim tDesktopDuplication As ScreenRecorderLib.RecorderApi = ScreenRecorderLib.RecorderApi.WindowsGraphicsCapture
        If DesktopDuplication = True Then tDesktopDuplication = ScreenRecorderLib.RecorderApi.DesktopDuplication
        Dim Options As New ScreenRecorderLib.RecorderOptions With {
        .DisplayOptions = New ScreenRecorderLib.DisplayOptions With {.MonitorDeviceName = Screen.AllScreens(Monitor).DeviceName},
        .RecorderMode = ScreenRecorderLib.RecorderMode.Video,
        .RecorderApi = tDesktopDuplication,
        .IsThrottlingDisabled = False,
        .IsHardwareEncodingEnabled = True,
        .IsLowLatencyEnabled = False,
        .IsMp4FastStartEnabled = False,
        .AudioOptions = New ScreenRecorderLib.AudioOptions With {
        .Bitrate = ScreenRecorderLib.AudioBitrate.bitrate_128kbps,
        .Channels = ScreenRecorderLib.AudioChannels.Stereo,
        .IsAudioEnabled = cSonido,
        .IsOutputDeviceEnabled = Sonido,
        .IsInputDeviceEnabled = Microfono
        },
        .VideoOptions = New ScreenRecorderLib.VideoOptions With {
        .BitrateMode = ScreenRecorderLib.BitrateControlMode.Quality,
        .Quality = 100,
        .Framerate = 30,
        .IsFixedFramerate = False,
        .EncoderProfile = ScreenRecorderLib.H264Profile.Main
        },
        .MouseOptions = New ScreenRecorderLib.MouseOptions With {
        .IsMouseClicksDetected = MouseClicks,
        .MouseClickDetectionColor = "#CD9600",
        .MouseRightClickDetectionColor = "#298222",
        .MouseClickDetectionRadius = 15,
        .MouseClickDetectionDuration = 100,
        .IsMousePointerEnabled = True,
        .MouseClickDetectionMode = ScreenRecorderLib.MouseDetectionMode.Polling
        }}
        Speaker = ScreenRecorderLib.Recorder.CreateRecorder(Options) : DeleteFile(SavePath + "VideoRecording.mp4") : Speaker.Record(SavePath + "VideoRecording.mp4")
    End Sub

#End Region

#End Region

#Region " Stop "

    Public Sub [Stop]()
        If Speaker IsNot Nothing Then Speaker.Stop()
        If Speaker.Status <> ScreenRecorderLib.RecorderStatus.Recording Then Recording = False
    End Sub

#End Region

#Region " Events "

    Private Sub OnRecordingComplete(sender As Object, e As ScreenRecorderLib.RecordingCompleteEventArgs)
        If Speaker.Status <> ScreenRecorderLib.RecorderStatus.Recording Then Recording = False
        If cDesktopDuplication = True Then Sonidos.Play("Default", "GrabarPantalla")
    End Sub

    Private Sub OnRecordingFailed(sender As Object, e As ScreenRecorderLib.RecordingFailedEventArgs)
        If Speaker.Status <> ScreenRecorderLib.RecorderStatus.Recording Then Recording = False
        If cDesktopDuplication = True Then Sonidos.Play("Default", "GrabarPantalla")
    End Sub

    Private Sub OnStatusChanged(sender As Object, e As ScreenRecorderLib.RecordingStatusEventArgs)
        Dim Status As ScreenRecorderLib.RecorderStatus = e.Status
    End Sub

#End Region

End Class

#End Region

#End Region

#Region " Process "

Public Class Process_CL

#Region " Variables "

#Region " Declarations "

    <Runtime.InteropServices.DllImport("user32.dll")> Private Shared Function GetWindowText(hwnd As Integer, lpString As System.Text.StringBuilder, cch As Integer) As Integer : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Public Shared Function GetForegroundWindow() As IntPtr : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Public Shared Function SetForegroundWindow(hWnd As IntPtr) As Boolean : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Public Shared Function WindowFromPoint(p As Point) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Private Shared Function GetWindowThreadProcessId(hWnd As IntPtr, ByRef lpdwProcessId As IntPtr) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Public Shared Function GetShellWindow() As IntPtr : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Public Shared Function SetActiveWindow(hWnd As IntPtr) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Public Shared Function BringWindowToTop(hwnd As IntPtr) As Boolean : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Public Shared Function SetWindowPos(hWnd As IntPtr, hWndInsertAfter As IntPtr, X As Integer, Y As Integer, cx As Integer, cy As Integer, uFlags As SetWindowPosFlags) As Boolean : End Function : Public Enum SetWindowPosFlags As UInteger : IgnoreMove = &H2 : IgnoreResize = &H1 : End Enum
    <Runtime.InteropServices.DllImport("user32.dll")> Public Shared Function FindWindow(className As String, windowTitle As String) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Private Shared Function FindWindowByCaption(zero As IntPtr, lpWindowName As String) As IntPtr : End Function
    Public Structure ProcessST : Dim Hover As Boolean : Dim Window_Title As String : Dim Process_Name As String : Dim Process_Handle As IntPtr : Dim Process_ID As Integer : End Structure

#End Region

    Public CurrentProcess As ProcessST
    Dim Process_Thread As Threading.Thread
    Dim Process_Thread_Close As Boolean

#Region " Constructor "

    Public Sub New()
        Process_Thread = New Threading.Thread(AddressOf Process_Thread_Sub) : Process_Thread.Start()
    End Sub

#End Region

#End Region

#Region " Methods "

#Region " Process Activate "

    Public Sub Process_Activate(Handle As IntPtr)
        Process_CL.SetForegroundWindow(Handle) : BringWindowToTop(Handle) : Process_CL.SetActiveWindow(Handle)
    End Sub

    Public Sub Process_Activate(Name As String, Optional isTitle As Boolean = False)
        If isTitle = False Then
            For Each P As Process In Process.GetProcessesByName(Name)
                Process_CL.SetForegroundWindow(P.MainWindowHandle) : BringWindowToTop(P.MainWindowHandle) : Process_CL.SetActiveWindow(P.MainWindowHandle)
            Next
        Else
            Dim Handle As IntPtr = FindWindow(IntPtr.Zero, Name)
            Process_CL.SetForegroundWindow(Handle) : BringWindowToTop(Handle) : Process_CL.SetActiveWindow(Handle)
        End If
    End Sub

#End Region

#Region " Process Close "

    Public Sub Process_Close(Handle As IntPtr, Optional Kill As Boolean = False)
        Dim ProcIdXL As Integer = 0 : GetWindowThreadProcessId(Handle, ProcIdXL)
        If Kill = False Then Process.GetProcessById(ProcIdXL).CloseMainWindow() Else Process.GetProcessById(ProcIdXL).Kill()
    End Sub

    Public Sub Process_Close(Name As String, Optional isTitle As Boolean = False, Optional Kill As Boolean = False)
        If isTitle = False Then
            For Each P As Process In Process.GetProcessesByName(Name)
                If Kill = False Then P.CloseMainWindow() Else P.Kill()
            Next
        Else
            Dim ProcIdXL As Integer = 0
            GetWindowThreadProcessId(FindWindow(IntPtr.Zero, Name), ProcIdXL)
            If Kill = False Then Process.GetProcessById(ProcIdXL).CloseMainWindow() Else Process.GetProcessById(ProcIdXL).Kill()
        End If
    End Sub

#End Region

#Region " Get Process "

#Region " ProcessST "

    Public Function Get_ProcessST(Optional Hover As Boolean = False)
        Dim cProcess As ProcessST = Nothing : Dim ProcIdXL As Integer = 0 : Dim Title As New Text.StringBuilder(256)
        Try : If Hover = False Then
                GetWindowText(GetForegroundWindow, Title, Title.Capacity)
                GetWindowThreadProcessId(GetForegroundWindow, ProcIdXL)
                cProcess.Process_Handle = GetForegroundWindow()
            Else
                GetWindowText(WindowFromPoint(Cursor.Position), Title, Title.Capacity)
                GetWindowThreadProcessId(WindowFromPoint(Cursor.Position), ProcIdXL)
                cProcess.Process_Handle = Process.GetProcessById(ProcIdXL).MainWindowHandle  'WindowFromPoint(Cursor.Position)
            End If
            cProcess.Hover = Hover
            cProcess.Window_Title = Title.ToString : If cProcess.Window_Title = "" Then cProcess.Window_Title = Process.GetProcessById(ProcIdXL).MainWindowTitle
            If cProcess.Window_Title = "" Then cProcess.Window_Title = Process.GetProcessById(ProcIdXL).ProcessName
            If cProcess.Window_Title.Length > 1 Then cProcess.Window_Title = cProcess.Window_Title.Substring(0, 1).ToUpper + cProcess.Window_Title.Substring(1)
            cProcess.Process_Name = Process.GetProcessById(ProcIdXL).ProcessName
            cProcess.Process_ID = Process.GetProcessById(ProcIdXL).Id

        Catch : End Try : CurrentProcess = cProcess : Return cProcess
    End Function

    Public Function Get_ProcessST(Handle As IntPtr) As ProcessST
        Dim cProcess As ProcessST = Nothing : Dim ProcIdXL As Integer = 0
        Try : GetWindowThreadProcessId(Handle, ProcIdXL)
            cProcess.Window_Title = Process.GetProcessById(ProcIdXL).MainWindowTitle
            If cProcess.Window_Title = "" Then cProcess.Window_Title = Process.GetProcessById(ProcIdXL).ProcessName
            If cProcess.Window_Title.Length > 1 Then cProcess.Window_Title = cProcess.Window_Title.Substring(0, 1).ToUpper + cProcess.Window_Title.Substring(1)
            cProcess.Process_Handle = Process.GetProcessById(ProcIdXL).MainWindowHandle
            cProcess.Process_Name = Process.GetProcessById(ProcIdXL).ProcessName
            cProcess.Process_ID = Process.GetProcessById(ProcIdXL).Id

        Catch : End Try : CurrentProcess = cProcess : Return cProcess
    End Function

    Public Function Get_ProcessST(Name As String, Optional isTitle As Boolean = False) As ProcessST
        Dim cProcess As ProcessST = Nothing
        Try : If isTitle = False Then
                cProcess.Window_Title = Process.GetProcessesByName(Name)(0).MainWindowTitle
                If cProcess.Window_Title = "" Then cProcess.Window_Title = Process.GetProcessesByName(Name)(0).ProcessName
                If cProcess.Window_Title.Length > 1 Then cProcess.Window_Title = cProcess.Window_Title.Substring(0, 1).ToUpper + cProcess.Window_Title.Substring(1)
                cProcess.Process_Handle = Process.GetProcessesByName(Name)(0).MainWindowHandle
                cProcess.Process_Name = Process.GetProcessesByName(Name)(0).ProcessName
                cProcess.Process_ID = Process.GetProcessesByName(Name)(0).Id
            Else
                Dim Handle As IntPtr = FindWindow(IntPtr.Zero, Name)
                Dim ProcIdXL As Integer = 0 : GetWindowThreadProcessId(GetForegroundWindow, ProcIdXL)
                Dim Title As New Text.StringBuilder(256) : GetWindowText(Handle, Title, Title.Capacity)
                cProcess.Window_Title = Title.ToString : If cProcess.Window_Title = "" Then cProcess.Window_Title = Process.GetProcessById(ProcIdXL).MainWindowTitle
                If cProcess.Window_Title = "" Then cProcess.Window_Title = Process.GetProcessById(ProcIdXL).ProcessName
                If cProcess.Window_Title.Length > 1 Then cProcess.Window_Title = cProcess.Window_Title.Substring(0, 1).ToUpper + cProcess.Window_Title.Substring(1)
                cProcess.Process_Handle = Handle
                cProcess.Process_Name = Process.GetProcessById(ProcIdXL).ProcessName
                cProcess.Process_ID = Process.GetProcessById(ProcIdXL).Id
            End If
        Catch : End Try : CurrentProcess = cProcess : Return cProcess
    End Function

#End Region

#Region " Process Handle "

    Public Function Get_Process_Handle(Optional Hover As Boolean = False) As IntPtr
        Try : Dim ProcIdXL As Integer = 0
            If Hover = False Then GetWindowThreadProcessId(GetForegroundWindow, ProcIdXL) Else GetWindowThreadProcessId(WindowFromPoint(Cursor.Position), ProcIdXL)
            Return Process.GetProcessById(ProcIdXL).MainWindowHandle
        Catch : End Try : Return 0
    End Function

    Public Function Get_Process_Handle(Name As String, Optional isTitle As Boolean = False) As IntPtr
        Try : If isTitle = False Then
                Return Process.GetProcessesByName(Name)(0).MainWindowHandle
            Else
                Return FindWindow(IntPtr.Zero, Name)
            End If
        Catch : End Try : Return 0
    End Function

#End Region

#Region " Process Name "

    Public Function Get_Process_Name(Optional Hover As Boolean = False) As String
        Try : Dim ProcIdXL As Integer = 0
            If Hover = False Then GetWindowThreadProcessId(GetForegroundWindow, ProcIdXL) Else GetWindowThreadProcessId(WindowFromPoint(Cursor.Position), ProcIdXL)
            Return Process.GetProcessById(ProcIdXL).ProcessName
        Catch : End Try : Return ""
    End Function

    Public Function Get_Process_Name(Handle As IntPtr) As IntPtr
        Try : Dim ProcIdXL As Integer = 0
            GetWindowThreadProcessId(Handle, ProcIdXL)
            Return Process.GetProcessById(ProcIdXL).ProcessName
        Catch : End Try : Return ""
    End Function

#End Region

#Region " Process Title "

    Public Function Get_Process_Title(Optional Hover As Boolean = False) As String
        Try : Dim cHandle As IntPtr : Dim cTitle As String : Dim ProcIdXL As Integer = 0 : Dim Title As New Text.StringBuilder(256)
            If Hover = False Then
                GetWindowText(GetForegroundWindow, Title, Title.Capacity)
                GetWindowThreadProcessId(GetForegroundWindow, ProcIdXL)
                cHandle = GetForegroundWindow()
            Else
                GetWindowText(WindowFromPoint(Cursor.Position), Title, Title.Capacity)
                GetWindowThreadProcessId(WindowFromPoint(Cursor.Position), ProcIdXL)
                cHandle = WindowFromPoint(Cursor.Position)
            End If
            cTitle = Title.ToString : If cTitle = "" Then cTitle = Process.GetProcessById(ProcIdXL).MainWindowTitle
            If cTitle = "" Then cTitle = Process.GetProcessById(ProcIdXL).ProcessName
            If cTitle.Length > 1 Then cTitle = cTitle.Substring(0, 1).ToUpper + cTitle.Substring(1)
            Return cTitle
        Catch : End Try : Return ""
    End Function

    Public Function Get_Process_Title(Handle As IntPtr) As String
        Try : Dim cTitle As String : Dim ProcIdXL As Integer = 0 : Dim Title As New Text.StringBuilder(256)
            GetWindowText(Handle, Title, Title.Capacity)
            GetWindowThreadProcessId(GetForegroundWindow, ProcIdXL)
            cTitle = Title.ToString : If cTitle = "" Then cTitle = Process.GetProcessById(ProcIdXL).MainWindowTitle
            If cTitle = "" Then cTitle = Process.GetProcessById(ProcIdXL).ProcessName
            If cTitle.Length > 1 Then cTitle = cTitle.Substring(0, 1).ToUpper + cTitle.Substring(1)
            Return cTitle
        Catch : End Try : Return ""
    End Function

#End Region

#End Region

#End Region

#Region " Functions "

    Private Sub Process_Thread_Sub()
Repeat: Dim ProcIdXL As Integer = 0 : Dim Title As New Text.StringBuilder(256) : Process_Thread_Close = False
        Try
            Do Until Process_Thread_Close = True
                If CurrentProcess.Process_Handle <> GetForegroundWindow() Then
                    GetWindowText(GetForegroundWindow, Title, Title.Capacity)
                    GetWindowThreadProcessId(GetForegroundWindow, ProcIdXL)
                    CurrentProcess.Process_Handle = GetForegroundWindow()
                    CurrentProcess.Window_Title = Title.ToString : If CurrentProcess.Window_Title = "" Then CurrentProcess.Window_Title = Process.GetProcessById(ProcIdXL).MainWindowTitle
                    If CurrentProcess.Window_Title = "" Then CurrentProcess.Window_Title = Process.GetProcessById(ProcIdXL).ProcessName
                    If CurrentProcess.Window_Title.Length > 1 Then CurrentProcess.Window_Title = CurrentProcess.Window_Title.Substring(0, 1).ToUpper + CurrentProcess.Window_Title.Substring(1)
                    CurrentProcess.Process_Name = Process.GetProcessById(ProcIdXL).ProcessName
                    CurrentProcess.Process_ID = Process.GetProcessById(ProcIdXL).Id
                End If : Threading.Thread.Sleep(250)
            Loop
        Catch : Threading.Thread.Sleep(250) : GoTo Repeat : End Try
    End Sub

#Region " Close "

    Public Sub Close()
        Process_Thread_Close = True
    End Sub

#End Region

#End Region

End Class

#End Region

#Region " OSD "

Public Class OSD_CL : Inherits NativeWindow

#Region " Variables "

#Region " Declarations "

    <Runtime.InteropServices.StructLayout(Runtime.InteropServices.LayoutKind.Sequential, Pack:=1)> Private Structure BLENDFUNCTION : Public BlendOp As Byte : Public BlendFlags As Byte : Public SourceConstantAlpha As Byte : Public AlphaFormat As Byte : End Structure
    <Runtime.InteropServices.DllImport("User32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function AnimateWindow(hWnd As IntPtr, dwTime As UInteger, dwFlags As UInteger) As Boolean : End Function
    <Runtime.InteropServices.DllImport("User32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function BeginPaint(hWnd As IntPtr, ByRef ps As PAINTSTRUCT) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("User32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function EndPaint(hWnd As IntPtr, ByRef ps As PAINTSTRUCT) As Boolean : End Function
    <Runtime.InteropServices.DllImport("User32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function GetDC(hWnd As IntPtr) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("User32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function GetWindowRect(hWnd As IntPtr, ByRef rect As Rectangle) As Boolean : End Function
    <Runtime.InteropServices.DllImport("User32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function ReleaseDC(hWnd As IntPtr, hDC As IntPtr) As Integer : End Function
    <Runtime.InteropServices.DllImport("User32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function SetWindowPos(hWnd As IntPtr, hWndAfter As IntPtr, X As Integer, Y As Integer, Width As Integer, Height As Integer, flags As UInteger) As Integer : End Function
    <Runtime.InteropServices.DllImport("User32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function ShowWindow(hWnd As IntPtr, cmdShow As Short) As Integer : End Function
    <Runtime.InteropServices.DllImport("User32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function UpdateLayeredWindow(hwnd As IntPtr, hdcDst As IntPtr, ByRef pptDst As Point, ByRef psize As Size, hdcSrc As IntPtr, ByRef pprSrc As Point, crKey As Integer, ByRef pblend As BLENDFUNCTION, dwFlags As Integer) As Boolean : End Function
    <Runtime.InteropServices.DllImport("gdi32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function CreateCompatibleDC(hDC As IntPtr) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("gdi32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function DeleteDC(hDC As IntPtr) As Boolean : End Function
    <Runtime.InteropServices.DllImport("gdi32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function SelectObject(hDC As IntPtr, hObject As IntPtr) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("gdi32.dll", CharSet:=Runtime.InteropServices.CharSet.Auto)> Private Shared Function DeleteObject(hObject As IntPtr) As IntPtr : End Function
    Private Structure PAINTSTRUCT : Dim hdc As IntPtr : Dim fErase As Integer : Dim rcPaint As Rectangle : Dim fRestore As Integer : Dim fIncUpdate As Integer : Dim Reserved1 As Integer : Dim Reserved2 As Integer : Dim Reserved3 As Integer : Dim Reserved4 As Integer : Dim Reserved5 As Integer : Dim Reserved6 As Integer : Dim Reserved7 As Integer : Dim Reserved8 As Integer : End Structure
    Public Enum AnimateMode : None : Blend : RollLeftToRight : RollRightToLeft : RollTopToBottom : RollBottomToTop : ExpandCollapse : End Enum

#End Region

#Region " Properties "

    Private _Location As New Point(20, 20)
    Public Property Location As Point
        Get
            Return _Location
        End Get
        Set(Value As Point)
            If Handle <> IntPtr.Zero Then
                SetBoundsCore(Value.X, Value.Y, _Size.Width, _Size.Height)
                Dim Rect As New Rectangle : GetWindowRect(Handle, Rect)
                _Location = New Point(Rect.Left, Rect.Top)
                UpdateLayeredWindow()
            Else : _Location = Value : End If
        End Set
    End Property

    Private _Size As New Size(250, 50)
    Public Property Size As Size
        Get
            Return _Size
        End Get
        Set(Value As Size)
            If Handle <> IntPtr.Zero Then
                SetBoundsCore(_Location.X, _Location.Y, Value.Width, Value.Height)
                Dim Rect As New Rectangle : GetWindowRect(Handle, Rect)
                _Size = New Size(Rect.Right - Rect.Left, Rect.Bottom - Rect.Top)
                UpdateLayeredWindow()
            Else : _Size = Value : End If
        End Set
    End Property

    Public Property Height As Integer
        Get
            Return _Size.Height
        End Get
        Set(Value As Integer)
            _Size = New Size(_Size.Width, Value)
        End Set
    End Property

    Public Property Width As Integer
        Get
            Return _Size.Width
        End Get
        Set(Value As Integer)
            _Size = New Size(Value, _Size.Height)
        End Set
    End Property

    Public Property X As Integer
        Get
            Return _Location.X
        End Get
        Set(Value As Integer)
            Location = New Point(Value, Location.Y)
        End Set
    End Property

    Public Property Y As Integer
        Get
            Return _Location.Y
        End Get
        Set(Value As Integer)
            Location = New Point(Location.X, Value)
        End Set
    End Property

    Public ReadOnly Property Bound As Rectangle
        Get
            Return New Rectangle(New Point(0, 0), _Size)
        End Get
    End Property

    Private _Alpha As Byte = 250
    Public Property Alpha As Byte
        Get
            Return _Alpha
        End Get
        Set(Value As Byte)
            If _Alpha = Value Then Return
            _Alpha = Value : UpdateLayeredWindow()
        End Set
    End Property

#End Region

    Private _DefaultColor As Color = Color.FromArgb(205, 150, 0)
    Private _DefaultFont As New Font("Arial", 16, FontStyle.Regular)
    Private _OSDTimer As New Timer With {.Enabled = False}
    Private _BlendTimer As New Timer With {.Enabled = False}
    Private _StringFormat As New StringFormat With {.Alignment = StringAlignment.Near, .LineAlignment = StringAlignment.Near, .Trimming = StringTrimming.EllipsisWord}
    Private _TextColor As Color
    Private _TextFont As Font
    Private _Text, _TextOriginal As String
    Private _TimeSec, _TempTime, _TotalTime, _Animationtime, _OriginalAlpha As Integer
    Private _CountDown, _LoadTimer, _Show As Boolean
    Private _EndMode As AnimateMode
    Public Showing As Boolean
    Public CurrentTime As Integer

#Region " Constructor "

    Public Sub New()
        AddHandler _OSDTimer.Tick, AddressOf Timer_Tick
        AddHandler _BlendTimer.Tick, AddressOf BlendTimer_Tick
    End Sub

#End Region

#End Region

#Region " Methods "

    Public Sub Show(cText As String, Optional cTimeMSec As Integer = 3000, Optional cCountDown As Boolean = False, Optional cColor As Color = Nothing, Optional cAlpha As Byte = 250, Optional cFont As Font = Nothing, Optional cStartAnimation As AnimateMode = AnimateMode.Blend, Optional cEndAnimation As AnimateMode = AnimateMode.Blend, Optional cAnimationTime As Integer = 1000, Optional X As Integer = 20, Optional Y As Integer = 20)
        If cTimeMSec = 1000 Then cTimeMSec = 1001
        If cTimeMSec < 1001 Then cTimeMSec = 1001 'Exit Sub
        Size = New Size(Screen.PrimaryScreen.WorkingArea.Width, Screen.PrimaryScreen.WorkingArea.Height)
        If Not cColor = Nothing Then _TextColor = cColor Else _TextColor = _DefaultColor
        If cFont IsNot Nothing Then _TextFont = cFont Else _TextFont = _DefaultFont
        Location = New Point(X, Y) : _Text = cText : _TextOriginal = cText : Alpha = cAlpha
        _Animationtime = cAnimationTime : _EndMode = cEndAnimation : _CountDown = cCountDown
        _TotalTime = cTimeMSec
        _TimeSec = Math.Max(Math.Round(cTimeMSec / 1000) - Math.Round(_Animationtime / 1000), 0)
        If _TimeSec = 0 Then _TimeSec = 1
        CurrentTime = _TimeSec : _TempTime = 0
        _OSDTimer.Enabled = False : Close() : Showing = True : _LoadTimer = True : _OSDTimer.Enabled = True
        Dim TextArea As SizeF
        If _CountDown = True AndAlso _TimeSec > 0 Then
            TextArea = Graphics.FromImage(New Bitmap(Width, Height)).MeasureString(_Text + " " + Math.Round(_TotalTime / 1000).ToString, cFont, Screen.PrimaryScreen.Bounds.Width, _StringFormat)
        Else
            TextArea = Graphics.FromImage(New Bitmap(Width, Height)).MeasureString(cText, cFont, Screen.PrimaryScreen.Bounds.Width, _StringFormat)
        End If
        Size = New Size(Math.Ceiling(TextArea.Width), Math.Ceiling(TextArea.Height))
        If cAnimationTime > 0 And cStartAnimation <> AnimateMode.None Then ShowAnimate(cStartAnimation, cAnimationTime) : _OSDTimer.Interval = cAnimationTime Else ShowNoAnimate() : _OSDTimer.Interval = 1
    End Sub

    Public Sub ShowNoAnimate()
        If Handle = IntPtr.Zero Then CreateWindowOnly()
        ShowWindow(Handle, 4)
    End Sub

    Public Sub ShowAnimate(cMode As AnimateMode, cTime As Integer)
        Dim dwFlag As UInteger = 0
        Select Case cMode
            Case AnimateMode.None : cTime = 0
            Case AnimateMode.Blend : dwFlag = &H80000
            Case AnimateMode.ExpandCollapse : dwFlag = &H10
            Case AnimateMode.RollLeftToRight : dwFlag = &H1
            Case AnimateMode.RollRightToLeft : dwFlag = &H2
            Case AnimateMode.RollBottomToTop : dwFlag = &H8
            Case AnimateMode.RollTopToBottom : dwFlag = &H4
        End Select : If Handle = IntPtr.Zero Then CreateWindowOnly()

        If _CountDown = True AndAlso _TimeSec > 0 Then _Text += " " + Math.Round(_TotalTime / 1000).ToString
        If (dwFlag And &H80000) <> 0 Then
            AnimateWithBlend(True, cTime)
        Else : Dim _Thread As New Threading.Thread(Sub() AnimateWindow(Handle, cTime, dwFlag)) : _Thread.Start()
        End If
    End Sub

    Public Sub HideAnimate(cMode As AnimateMode, cTime As Integer)
        If Handle = IntPtr.Zero Then Return
        Dim dwFlag As UInteger = 0
        Select Case cMode
            Case AnimateMode.None : Hide()
            Case AnimateMode.Blend : dwFlag = &H80000
            Case AnimateMode.ExpandCollapse : dwFlag = &H10
            Case AnimateMode.RollLeftToRight : dwFlag = &H1
            Case AnimateMode.RollRightToLeft : dwFlag = &H2
            Case AnimateMode.RollBottomToTop : dwFlag = &H8
            Case AnimateMode.RollTopToBottom : dwFlag = &H4
        End Select : dwFlag = dwFlag Or &H10000
        If dwFlag And &H80000 <> 0 Then
            AnimateWithBlend(False, cTime)
        Else : Dim _Thread As New Threading.Thread(Sub() AnimateWindow(Handle, cTime, dwFlag)) : _Thread.Start()
        End If
    End Sub

    Public Sub Hide()
        Showing = False : If Handle = IntPtr.Zero Then Return
        ShowWindow(Handle, 0) : DestroyHandle()
    End Sub

    Public Sub Close()
        Showing = False : _BlendTimer.Enabled = False : Hide() : DestroyHandle() : GC.SuppressFinalize(Me)
    End Sub

#End Region

#Region " Functions "

    Private Sub Timer_Tick()
        Dim TextArea As SizeF
        If _LoadTimer = True Then
            _LoadTimer = False : _OSDTimer.Interval = 1000
            If _CountDown = True Then
                _Text = _TextOriginal + " " + (_TimeSec - _TempTime).ToString : CurrentTime = _TimeSec - _TempTime
                If _Text.EndsWith(" 0") = True Then _Text = _Text.Substring(0, _Text.Length - 2)
                TextArea = Graphics.FromImage(New Bitmap(Width, Height)).MeasureString(_Text, _TextFont, Screen.PrimaryScreen.Bounds.Width, _StringFormat)
                Size = New Size(Math.Ceiling(TextArea.Width), Math.Ceiling(TextArea.Height)) : UpdateLayeredWindow() : _TempTime += 1
            End If
        Else
            If _TempTime >= _TimeSec Then
                If _CountDown = True Then
                    If _Text.EndsWith(" 0") = True Then _Text = _Text.Substring(0, _Text.Length - 2)
                    _Text = _TextOriginal : CurrentTime = 0 : TextArea = Graphics.FromImage(New Bitmap(Width, Height)).MeasureString(_Text, _TextFont, Screen.PrimaryScreen.Bounds.Width, _StringFormat)
                    Size = New Size(Math.Ceiling(TextArea.Width), Math.Ceiling(TextArea.Height))
                End If : UpdateLayeredWindow() : _OSDTimer.Enabled = False : If _Animationtime > 0 Then HideAnimate(_EndMode, _Animationtime)
            Else
                If _CountDown = True Then
                    If _Text.EndsWith(" 0") = True Then _Text = _Text.Substring(0, _Text.Length - 2)
                    _Text = _TextOriginal + " " + (_TimeSec - _TempTime).ToString : CurrentTime = _TimeSec - _TempTime
                    TextArea = Graphics.FromImage(New Bitmap(Width, Height)).MeasureString(_Text, _TextFont, Screen.PrimaryScreen.Bounds.Width, _StringFormat)
                    Size = New Size(Math.Ceiling(TextArea.Width), Math.Ceiling(TextArea.Height)) : UpdateLayeredWindow()
                End If : _TempTime += 1
            End If
        End If
    End Sub

    Private Sub AnimateWithBlend(cShow As Boolean, cTime As Integer)
        _Show = cShow : _OriginalAlpha = Alpha
        If _Show = True Then Alpha = 0 : UpdateLayeredWindow() : ShowWindow(Handle, 4)
        _BlendTimer.Interval = Math.Max(Math.Round(1 / (_OriginalAlpha / cTime)), 1) : _BlendTimer.Enabled = True
    End Sub

    Private Sub BlendTimer_Tick()
        If _Show = True Then
            If Alpha < _OriginalAlpha Then Alpha += 2 : UpdateLayeredWindow() Else _BlendTimer.Enabled = False
        Else
            If Alpha > 0 Then Alpha -= 2 : UpdateLayeredWindow() Else _BlendTimer.Enabled = False : Close()
        End If
    End Sub

    Private Sub PerformPaint(e As PaintEventArgs)
        If Handle = IntPtr.Zero Then Return
        Dim G As Graphics = e.Graphics : Dim _GP = New Drawing2D.GraphicsPath() : _GP.AddString(_Text, _TextFont.FontFamily, _TextFont.Style, G.DpiY * _TextFont.SizeInPoints / 72, Bound, _StringFormat) : G.SmoothingMode = Drawing2D.SmoothingMode.HighQuality : G.FillPath(New SolidBrush(_TextColor), _GP)
        'If _DobleColor = True Then _GP.AddString(_Text, _TextFont.FontFamily, _TextFont.Style, G.DpiY * _TextFont.SizeInPoints / 72, New Rectangle(Bound.X - 1, Bound.Y - 1, Bound.Width, Bound.Height), _StringFormat) : G.FillPath(New SolidBrush(Color.Black), _GP)
    End Sub

    Private Sub UpdateLayeredWindow()
        If Width = 0 Or Height = 0 Then Exit Sub
        Dim _Bitmap As New Bitmap(Width, Height, Imaging.PixelFormat.Format32bppArgb)
        Dim _BlendFunction As New BLENDFUNCTION With {.BlendOp = 0, .BlendFlags = 0, .SourceConstantAlpha = _Alpha, .AlphaFormat = 1}
        PerformPaint(New PaintEventArgs(Graphics.FromImage(_Bitmap), New Rectangle(0, 0, Width, Height)))
        Dim _Ptr1 As IntPtr = GetDC(IntPtr.Zero)
        Dim _Ptr2 As IntPtr = CreateCompatibleDC(_Ptr1)
        Dim _Ptr3 As IntPtr = _Bitmap.GetHbitmap(Color.FromArgb(0))
        Dim _Ptr4 As IntPtr = SelectObject(_Ptr2, _Ptr3)
        UpdateLayeredWindow(Handle, _Ptr1, New Point(X, Y), New Size(Width, Height), _Ptr2, New Point(0, 0), 0, _BlendFunction, 2)
        SelectObject(_Ptr2, _Ptr4) : ReleaseDC(IntPtr.Zero, _Ptr1) : DeleteObject(_Ptr3) : DeleteDC(_Ptr2)
    End Sub

    Private Sub CreateWindowOnly()
        Dim nX As Integer = _Location.X : Dim nY As Integer = _Location.Y
        If (nX + _Size.Width) > Screen.FromHandle(Handle).Bounds.Width Then nX = Screen.FromHandle(Handle).Bounds.Width - _Size.Width
        If (nY + _Size.Height) > Screen.FromHandle(Handle).Bounds.Height Then nY = Screen.FromHandle(Handle).Bounds.Height - _Size.Height
        _Location = New Point(nX, nY) : Dim _Params As New CreateParams() : _Params.Caption = "FloatingNativeWindow"
        _Params.X = nX : _Params.Y = nY : _Params.Height = _Size.Height : _Params.Width = _Size.Width : _Params.Parent = IntPtr.Zero : _Params.Style = &H80000000
        _Params.ExStyle = &H8 Or &H80 Or &H80000 Or &H8000000 Or &H20 : CreateHandle(_Params) : UpdateLayeredWindow()
    End Sub

    Private Sub PerformWmPaint_WmPrintClient(ByRef m As Message, isPaintMessage As Boolean)
        Dim _PaintStruct As New PAINTSTRUCT : Dim _Rect As New Rectangle : GetWindowRect(Handle, _Rect)
        Dim _Rectangle As New Rectangle(0, 0, _Rect.Right - _Rect.Left, _Rect.Bottom - _Rect.Top)
        Dim _Graphics As Graphics = Graphics.FromHdc((If(isPaintMessage, BeginPaint(m.HWnd, _PaintStruct), m.WParam))) : Dim _Bitmap As New Bitmap(_Rectangle.Width, _Rectangle.Height)
        PerformPaint(New PaintEventArgs(Graphics.FromImage(_Bitmap), _Rectangle)) : _Graphics.DrawImageUnscaled(_Bitmap, 0, 0) : If isPaintMessage Then EndPaint(m.HWnd, _PaintStruct)
    End Sub

    Private Sub SetBoundsCore(x As Integer, y As Integer, width As Integer, height As Integer)
        If ((Me.X <> x) OrElse (Me.Y <> y)) OrElse ((Me.Width <> width) OrElse (Me.Height <> height)) Then
            If Handle <> IntPtr.Zero Then
                Dim _Num As Integer = 20 : If (Me.X = x) AndAlso (Me.Y = y) Then _Num = _Num Or 2
                If (Me.Width = width) AndAlso (Me.Height = height) Then _Num = _Num Or 1
                SetWindowPos(Handle, IntPtr.Zero, x, y, width, height, _Num)
            Else : Location = New Point(x, y) : Size = New Size(width, height)
            End If
        End If
    End Sub

    Protected Overrides Sub WndProc(ByRef m As Message)
        If m.Msg = 15 Then
            PerformWmPaint_WmPrintClient(m, True) : Return
        ElseIf m.Msg = &H318 Then
            PerformWmPaint_WmPrintClient(m, False) : Return
        End If : MyBase.WndProc(m)
    End Sub

#End Region

End Class

#End Region

#Region " WaitTime "

Public Class WaitTime_CL

#Region " Variables "
    Private WaitTime_Thread As Threading.Thread
    Private WaitTime_StopWatch As Stopwatch
    Private _Time As Integer
    Public Waiting, CancelWaiting As Boolean

#End Region

#Region " Methods "

    Public Sub Start(cTime As Integer, Optional cExtraTime As Integer = 0)
        _Time = cTime + cExtraTime : If _Time = 0 Then Exit Sub
        WaitTime_StopWatch = New Stopwatch : Waiting = True
        WaitTime_Thread = New Threading.Thread(AddressOf WaitTime_Thread_Sub) : WaitTime_Thread.Start()
        Do Until Waiting = False : Application.DoEvents() : Loop
    End Sub

    Public Sub [Stop]()
        WaitTime_Thread.Abort()
    End Sub

#End Region

#Region " Functions "

    Private Sub WaitTime_Thread_Sub()
        WaitTime_StopWatch.Start()
        Do Until WaitTime_StopWatch.ElapsedMilliseconds >= _Time Or CancelWaiting = True : Loop
        WaitTime_StopWatch.Stop() : Waiting = False
    End Sub

#End Region

End Class

#End Region

#Region " Play Async "

Public Class MciSafeCall

    <Runtime.InteropServices.DllImport("winmm.dll")> Private Shared Function mciSendString(command As String, buffer As Text.StringBuilder, bufferSize As Integer, hwndCallback As IntPtr) As Integer : End Function

    Private syncMciCommand As String
    Private formulario As Form

    Public Sub New(form As Form)
        formulario = form
        syncMciCommand = ""
    End Sub

    Public Sub MciReplacement(Command As String)
        syncMciCommand = Command
        If Not String.IsNullOrEmpty(syncMciCommand) Then
            If formulario.InvokeRequired Then
                formulario.Invoke(New Action(Sub()
                                                 mciSendString(syncMciCommand, Nothing, 0, IntPtr.Zero)
                                             End Sub))
            Else
                mciSendString(syncMciCommand, Nothing, 0, IntPtr.Zero)
            End If
        End If
    End Sub
End Class

#End Region

#Region " AudioAPI "

Public Class AudioAPI

#Region " Variables "

#Region " Declarations "

    <Runtime.InteropServices.DllImport("user32.dll", CallingConvention:=Runtime.InteropServices.CallingConvention.StdCall, CharSet:=Runtime.InteropServices.CharSet.Unicode, EntryPoint:="keybd_event", ExactSpelling:=True, SetLastError:=True)> Public Shared Function Keybd_event(bVk As Int32, bScan As Int32, dwFlags As Int32, dwExtraInfo As Int32) As Boolean : End Function
    Public Event AudioDevices_Updated()

#End Region

#Region " Structures "

    Structure AudioDeviceST
        Dim Name As String
        Dim Manufacter As String
        Dim ID As String
        Dim IconPath As String
        Dim Communications As Boolean
        Dim Multimedia As Boolean
        Dim State As String
    End Structure

#End Region

    Public DefaultAudioDevice As AudioDeviceST
    Public AudioDevices() As AudioDeviceST

#Region " Constructor "

    Sub New()

    End Sub

#End Region

#End Region

#Region " Load Devices "

    Public Sub LoadDevices()
        Dim DeviceEnumerator As New NAudio.CoreAudioApi.MMDeviceEnumerator()
        Dim DefaultDevice As NAudio.CoreAudioApi.MMDevice = DeviceEnumerator.GetDefaultAudioEndpoint(NAudio.CoreAudioApi.DataFlow.Render, NAudio.CoreAudioApi.Role.Multimedia)
        DefaultAudioDevice.Name = DefaultDevice.FriendlyName.Replace("(" + DefaultDevice.DeviceFriendlyName + ")", "")
        DefaultAudioDevice.Manufacter = DefaultDevice.DeviceFriendlyName
        DefaultAudioDevice.ID = DefaultDevice.ID
        DefaultAudioDevice.IconPath = DefaultDevice.IconPath
        DefaultAudioDevice.Multimedia = True
        DefaultAudioDevice.Communications = GetDefault(DefaultDevice.ID, NAudio.CoreAudioApi.Role.Communications)
        DefaultAudioDevice.State = DefaultDevice.State.ToString

        Dim Contador As Integer
        For Each Device As NAudio.CoreAudioApi.MMDevice In DeviceEnumerator.EnumerateAudioEndPoints(NAudio.CoreAudioApi.DataFlow.Render, NAudio.CoreAudioApi.DeviceState.Active)
            ReDim Preserve AudioDevices(Contador)
            AudioDevices(Contador).Name = Device.FriendlyName.Replace("(" + Device.DeviceFriendlyName + ")", "")
            AudioDevices(Contador).Manufacter = Device.DeviceFriendlyName
            AudioDevices(Contador).ID = Device.ID
            AudioDevices(Contador).IconPath = Device.IconPath
            AudioDevices(Contador).Multimedia = GetDefault(Device.ID, NAudio.CoreAudioApi.Role.Multimedia)
            AudioDevices(Contador).Communications = GetDefault(Device.ID, NAudio.CoreAudioApi.Role.Communications)
            AudioDevices(Contador).State = Device.State.ToString
            Contador += 1
        Next
        RaiseEvent AudioDevices_Updated()
    End Sub

#End Region

    Public Sub UpdateAudioDevices()
        GetDefault()
        For Cuenta = 0 To AudioDevices.Length - 1
            AudioDevices(Cuenta).Multimedia = GetDefault(AudioDevices(Cuenta).ID, NAudio.CoreAudioApi.Role.Multimedia)
            AudioDevices(Cuenta).Communications = GetDefault(AudioDevices(Cuenta).ID, NAudio.CoreAudioApi.Role.Communications)
        Next
        RaiseEvent AudioDevices_Updated()
    End Sub

    Public Function Check_AudioDevices_Changed() As Boolean
        Dim DeviceEnumerator As New NAudio.CoreAudioApi.MMDeviceEnumerator()
        If AudioDevices.Count <> DeviceEnumerator.EnumerateAudioEndPoints(NAudio.CoreAudioApi.DataFlow.Render, NAudio.CoreAudioApi.DeviceState.Active).Count Then Return True Else Return False
    End Function

#Region " Get Default "

    Public Sub GetDefault()
        Dim DeviceEnumerator As New NAudio.CoreAudioApi.MMDeviceEnumerator()
        Dim DefaultDevice As NAudio.CoreAudioApi.MMDevice = DeviceEnumerator.GetDefaultAudioEndpoint(NAudio.CoreAudioApi.DataFlow.Render, NAudio.CoreAudioApi.Role.Multimedia)
        DefaultAudioDevice.Name = DefaultDevice.FriendlyName.Replace("(" + DefaultDevice.DeviceFriendlyName + ")", "")
        DefaultAudioDevice.Manufacter = DefaultDevice.DeviceFriendlyName
        DefaultAudioDevice.ID = DefaultDevice.ID
        DefaultAudioDevice.IconPath = DefaultDevice.IconPath
        DefaultAudioDevice.Multimedia = True
        DefaultAudioDevice.Communications = GetDefault(DefaultDevice.ID, NAudio.CoreAudioApi.Role.Communications)
        DefaultAudioDevice.State = DefaultDevice.State.ToString
    End Sub

    Public Function GetDefault(ID As String, Optional Role As NAudio.CoreAudioApi.Role = NAudio.CoreAudioApi.Role.Multimedia) As Boolean
        Dim DeviceEnumerator As New NAudio.CoreAudioApi.MMDeviceEnumerator()
        Dim DefaultDevice As NAudio.CoreAudioApi.MMDevice = DeviceEnumerator.GetDefaultAudioEndpoint(NAudio.CoreAudioApi.DataFlow.Render, Role)
        If ID = DefaultDevice.ID Then Return True Else Return False
    End Function

#End Region

    Public Function GetAudioDevice(ID As String) As AudioDeviceST
        Dim cAudioDevice As AudioDeviceST = Nothing
        For Cuenta = 0 To AudioDevices.Length - 1
            If AudioDevices(Cuenta).ID = ID Then Return AudioDevices(Cuenta)
        Next : Return cAudioDevice
    End Function

#Region " Set Default "

    Public Sub SetDefault(ID As String)
        Try : Dim Client As New CoreAudioApi.PolicyConfigClient()
            Client.SetDefaultEndpoint(ID, CoreAudioApi.ERole.eCommunications)
            Client.SetDefaultEndpoint(ID, CoreAudioApi.ERole.eMultimedia)
            UpdateAudioDevices()
        Catch : End Try
    End Sub

    Public Sub SetDefault(ID As String, Role As CoreAudioApi.ERole)
        Try : Dim Client As New CoreAudioApi.PolicyConfigClient()
            Client.SetDefaultEndpoint(ID, Role)
            UpdateAudioDevices()
        Catch : End Try
    End Sub

#End Region

#Region " Volume "

    Public Function Volume(Optional Role As NAudio.CoreAudioApi.Role = NAudio.CoreAudioApi.Role.Multimedia) As Integer
        Dim DeviceEnumerator = New NAudio.CoreAudioApi.MMDeviceEnumerator()
        Dim Device = DeviceEnumerator.GetDefaultAudioEndpoint(NAudio.CoreAudioApi.DataFlow.Render, Role)
        Return Device.AudioEndpointVolume.MasterVolumeLevelScalar * 100
    End Function

    Public Sub Volume(Volume As Integer, Optional Overlay As Boolean = True, Optional Role As NAudio.CoreAudioApi.Role = NAudio.CoreAudioApi.Role.Multimedia)
        Dim DeviceEnumerator = New NAudio.CoreAudioApi.MMDeviceEnumerator()
        Dim Device = DeviceEnumerator.GetDefaultAudioEndpoint(NAudio.CoreAudioApi.DataFlow.Render, Role)
        Device.AudioEndpointVolume.MasterVolumeLevelScalar = Volume / 100
        If Overlay = True Then
            Dim TempVolume As Integer = Device.AudioEndpointVolume.MasterVolumeLevelScalar * 100
            If TempVolume < 3 Then Keybd_event(Keys.VolumeUp, 0, &H0, 0) : Keybd_event(Keys.VolumeUp, 0, &H2, 0) Else Keybd_event(Keys.VolumeDown, 0, &H0, 0) : Keybd_event(Keys.VolumeDown, 0, &H2, 0)
            Application.DoEvents() : Threading.Thread.Sleep(100)
            Device.AudioEndpointVolume.MasterVolumeLevelScalar = Volume / 100
        Else
            Device.AudioEndpointVolume.Mute = False
            Device.AudioEndpointVolume.MasterVolumeLevelScalar = Volume / 100
        End If
    End Sub

    Public Function Volume_Muted(Optional Role As NAudio.CoreAudioApi.Role = NAudio.CoreAudioApi.Role.Multimedia) As Boolean
        Dim DeviceEnumerator = New NAudio.CoreAudioApi.MMDeviceEnumerator()
        Dim Device = DeviceEnumerator.GetDefaultAudioEndpoint(NAudio.CoreAudioApi.DataFlow.Render, Role)
        Return Device.AudioEndpointVolume.Mute
    End Function

    Public Sub Volume_Mute(Action As Boolean, Optional Overlay As Boolean = True, Optional Role As NAudio.CoreAudioApi.Role = NAudio.CoreAudioApi.Role.Multimedia)
        Dim DeviceEnumerator = New NAudio.CoreAudioApi.MMDeviceEnumerator()
        Dim Device = DeviceEnumerator.GetDefaultAudioEndpoint(NAudio.CoreAudioApi.DataFlow.Render, Role)

        If Device.AudioEndpointVolume.Mute <> Action Then
            If Overlay = True Then
                Device.AudioEndpointVolume.Mute = Not Action
                Keybd_event(Keys.VolumeMute, 0, &H0, 0) : Keybd_event(Keys.VolumeMute, 0, &H2, 0)
            Else
                Device.AudioEndpointVolume.Mute = Action
            End If
        End If
    End Sub

#End Region

End Class

#Region " Notification "

Class NotificationClient : Implements NAudio.CoreAudioApi.Interfaces.IMMNotificationClient

    Public Event AudioDevices_Update(ID As String, Action As String)

    Private Sub OnDeviceAdded(ID As String) Implements NAudio.CoreAudioApi.Interfaces.IMMNotificationClient.OnDeviceAdded
        RaiseEvent AudioDevices_Update(ID, "OnDeviceAdded")
    End Sub

    Private Sub OnDeviceRemoved(ID As String) Implements NAudio.CoreAudioApi.Interfaces.IMMNotificationClient.OnDeviceRemoved
        RaiseEvent AudioDevices_Update(ID, "OnDeviceRemoved")
    End Sub

    Private Sub OnDeviceStateChanged(ID As String, NewState As NAudio.CoreAudioApi.DeviceState) Implements NAudio.CoreAudioApi.Interfaces.IMMNotificationClient.OnDeviceStateChanged
        RaiseEvent AudioDevices_Update(ID, "OnDeviceStateChanged")
    End Sub

    Private Sub OnDefaultDeviceChanged(Flow As NAudio.CoreAudioApi.DataFlow, Role As NAudio.CoreAudioApi.Role, DefaultDeviceID As String) Implements NAudio.CoreAudioApi.Interfaces.IMMNotificationClient.OnDefaultDeviceChanged
        RaiseEvent AudioDevices_Update(DefaultDeviceID, "OnDefaultDeviceChanged")
    End Sub

    Private Sub OnPropertyValueChanged(ID As String, Key As NAudio.CoreAudioApi.PropertyKey) Implements NAudio.CoreAudioApi.Interfaces.IMMNotificationClient.OnPropertyValueChanged
        'RaiseEvent AudioDevices_Update(ID, "OnPropertyValueChanged")
    End Sub

End Class

#End Region

#End Region

#Region " Color Selector "

Public Class ColorSelectorCL : Inherits Form

    Private Ccolor() As Color = {Color.FromArgb(0, 0, 0), Color.FromArgb(153, 51, 0), Color.FromArgb(51, 51, 0), Color.FromArgb(0, 51, 0), Color.FromArgb(0, 51, 102), Color.FromArgb(0, 0, 128), Color.FromArgb(51, 51, 153), Color.FromArgb(51, 51, 51), Color.FromArgb(128, 0, 0), Color.FromArgb(255, 102, 0), Color.FromArgb(128, 128, 0), Color.FromArgb(0, 128, 0), Color.FromArgb(0, 128, 128), Color.FromArgb(0, 0, 255), Color.FromArgb(102, 102, 153), Color.FromArgb(128, 128, 128), Color.FromArgb(255, 0, 0), Color.FromArgb(205, 150, 0), Color.FromArgb(153, 204, 0), Color.FromArgb(51, 153, 102), Color.FromArgb(51, 204, 204), Color.FromArgb(51, 102, 255), Color.FromArgb(128, 0, 128), Color.FromArgb(153, 153, 153), Color.FromArgb(255, 0, 255), Color.FromArgb(255, 204, 0), Color.FromArgb(255, 255, 0), Color.FromArgb(0, 255, 0), Color.FromArgb(0, 255, 255), Color.FromArgb(0, 204, 255), Color.FromArgb(153, 51, 102), Color.FromArgb(192, 192, 192), Color.FromArgb(255, 153, 204), Color.FromArgb(255, 204, 153), Color.FromArgb(255, 255, 153), Color.FromArgb(204, 255, 204), Color.FromArgb(204, 255, 255), Color.FromArgb(153, 204, 255), Color.FromArgb(204, 153, 255), Color.FromArgb(255, 255, 255)}
    Private CcolorName() As String = {"Black", "Brown", "Olive Green", "Dark Green", "Dark Teal", "Dark Blue", "Indigo", "Gray-80%", "Dark Red", "Orange", "Dark Yellow", "Green", "Teal", "Blue", "Blue-Gray", "Gray-50%", "Red", "K-Destop", "Lime", "Sea Green", "Aqua", "Light Blue", "Violet", "Gray-40%", "Pink", "Gold", "Yellow", "Bright Green", "Turquoise", "Sky Blue", "Plum", "Gray-25%", "Rose", "Tan", "Light Yellow", "Light Green", "Light Turquoise", "Pale Blue", "Lavender", "White"}
    Private Panel(Ccolor.Length - 1) As Panel

    Private BMoreColors As New NSButton()
    Private FPanel As New Panel
    Private FTheme As New NSTheme

    Public SelectedColor As Color
    Public Event ColorChanged(NewColor As Color, DialogBox As Boolean)

    Sub New()
    End Sub

    Sub New(x As Integer, y As Integer)
        Size = New Size(170, 142)
        FTheme.Controls.Add(FPanel)
        FTheme.Sizable = False
        FPanel.BackColor = FTheme.BackColor
        FPanel.Location = New Point(1, 1)
        FPanel.Size = New Size(Width - 18, Height - 18)

        MinimizeBox = False
        MaximizeBox = False
        ControlBox = False
        ShowInTaskbar = False
        KeyPreview = True
        StartPosition = FormStartPosition.Manual
        Location = New Point(x - (Width / 2), y - Height)
        BuildPalette()

        BMoreColors.Text = "Más Colores..."
        BMoreColors.Rounded = 1
        BMoreColors.ForeColor1 = Color.Gray
        BMoreColors.ForeColor2 = Color.Black
        BMoreColors.ForeColor3 = Color.FromArgb(205, 150, 0)
        BMoreColors.DoubleText = True
        BMoreColors.Size = New Size(142, 22)
        BMoreColors.Location = New Point(5, 97)
        AddHandler BMoreColors.Click, AddressOf BMoreColors_Click
        FPanel.Controls.Add(BMoreColors)
        Controls.Add(FTheme)
        Show()
    End Sub

    Sub BuildPalette()
        Dim pwidth As Byte = 16
        Dim pheight As Byte = 16
        Dim pdistance As Byte = 2
        Dim border As Byte = 5
        Dim x As Integer = border
        Dim y As Integer = border
        Dim i As Integer
        Dim toolTip As New ToolTip()

        For i = 0 To Ccolor.Length - 1
            Panel(i) = New Panel()
            Panel(i).Height = pwidth
            Panel(i).Width = pheight
            Panel(i).Location = New Point(x, y)
            toolTip.SetToolTip(Panel(i), CcolorName(i))

            FPanel.Controls.Add(Panel(i))
            If x < 7 * (pwidth + pdistance) Then x += pwidth + pdistance Else x = border : y += pheight + pdistance
            Panel(i).BackColor = Ccolor(i)
            AddHandler Panel(i).MouseEnter, AddressOf OnMouseEnterPanel
            AddHandler Panel(i).MouseLeave, AddressOf OnMouseLeavePanel
            AddHandler Panel(i).MouseDown, AddressOf OnMouseDownPanel
            AddHandler Panel(i).MouseUp, AddressOf OnMouseUpPanel
            AddHandler Panel(i).Paint, AddressOf OnPanelPaint
        Next i
    End Sub

    Private Sub BMoreColors_Click(sender As Object, e As MouseEventArgs)
        If e.Button <> MouseButtons.Left Then Exit Sub
        RaiseEvent ColorChanged(SelectedColor, True) : Hide()
    End Sub

    Private Sub OnMouseEnterPanel(sender As Object, e As EventArgs)
        DrawPanel(sender, 1)
    End Sub


    Private Sub OnMouseLeavePanel(sender As Object, e As EventArgs)
        DrawPanel(sender, 0)
    End Sub


    Private Sub OnMouseDownPanel(sender As Object, e As MouseEventArgs)
        DrawPanel(sender, 2)
    End Sub

    Private Sub OnMouseUpPanel(sender As Object, e As MouseEventArgs)
        If e.Button <> MouseButtons.Left Then Exit Sub
        SelectedColor = sender.BackColor : RaiseEvent ColorChanged(SelectedColor, False) : Close()
    End Sub

    Sub OnPanelPaint(sender As Object, e As PaintEventArgs)
        DrawPanel(sender, 0)
    End Sub
    Private Sub ColorSelectorCL_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Me.KeyPress
        If Asc(e.KeyChar) = 27 Then e.Handled = True : Hide()
    End Sub

    Private Sub ColorSelectorCL_Deactivate(sender As Object, e As EventArgs) Handles Me.Deactivate
        Hide()
    End Sub

    Sub DrawPanel(sender As Object, state As Byte)
        Dim g As Graphics = sender.CreateGraphics()
        Dim pen1, pen2 As Pen
        If state = 1 Then 'mouse over
            pen1 = New Pen(SystemColors.ControlLightLight)
            pen2 = New Pen(SystemColors.ControlDarkDark)
        Else
            If state = 2 Then 'clicked
                pen1 = New Pen(SystemColors.ControlDarkDark)
                pen2 = New Pen(SystemColors.ControlLightLight)
            Else
                pen1 = New Pen(SystemColors.ControlDark)
                pen2 = New Pen(SystemColors.ControlDark)
            End If
        End If

        Dim r As Rectangle = sender.ClientRectangle
        Dim p1 As New Point(r.Left, r.Top)
        Dim p2 As New Point(r.Right - 1, r.Top)
        Dim p3 As New Point(r.Left, r.Bottom - 1)
        Dim p4 As New Point(r.Right - 1, r.Bottom - 1)
        g.DrawLine(pen1, p1, p2)
        g.DrawLine(pen1, p1, p3)
        g.DrawLine(pen2, p2, p4)
        g.DrawLine(pen2, p3, p4)
    End Sub

End Class

#End Region

#Region " Displays "

Public Class Displays

#Region " Variables "

#Region " Structures "

    <Runtime.InteropServices.StructLayout(Runtime.InteropServices.LayoutKind.Sequential)> Friend Structure POINTL : Private x As Long : Private y As Long : End Structure

    <Runtime.InteropServices.StructLayout(Runtime.InteropServices.LayoutKind.Sequential, CharSet:=Runtime.InteropServices.CharSet.Ansi)> Friend Structure DISPLAY_DEVICE
        <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.U4)> Public cb As Integer
        <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst:=32)> Public DeviceName As String
        <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst:=128)> Public DeviceString As String
        <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.U4)> Public StateFlags As DisplayDeviceStateFlags
        <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst:=128)> Public DeviceID As String
        <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst:=128)> Public DeviceKey As String
    End Structure

    <Runtime.InteropServices.StructLayout(Runtime.InteropServices.LayoutKind.Explicit, CharSet:=Runtime.InteropServices.CharSet.Ansi)> Friend Structure DEVMODE
        Public Const CCHDEVICENAME As Integer = 32 : Public Const CCHFORMNAME As Integer = 32
        <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst:=CCHDEVICENAME)>
        <Runtime.InteropServices.FieldOffset(0)> Public dmDeviceName As String
        <Runtime.InteropServices.FieldOffset(32)> Public dmSpecVersion As Short
        <Runtime.InteropServices.FieldOffset(34)> Public dmDriverVersion As Short
        <Runtime.InteropServices.FieldOffset(36)> Public dmSize As Short
        <Runtime.InteropServices.FieldOffset(38)> Public dmDriverExtra As Short
        <Runtime.InteropServices.FieldOffset(40)> Public dmFields As DM
        <Runtime.InteropServices.FieldOffset(44)> Private dmOrientation As Short
        <Runtime.InteropServices.FieldOffset(46)> Private dmPaperSize As Short
        <Runtime.InteropServices.FieldOffset(48)> Private dmPaperLength As Short
        <Runtime.InteropServices.FieldOffset(50)> Private dmPaperWidth As Short
        <Runtime.InteropServices.FieldOffset(52)> Private dmScale As Short
        <Runtime.InteropServices.FieldOffset(54)> Private dmCopies As Short
        <Runtime.InteropServices.FieldOffset(56)> Private dmDefaultSource As Short
        <Runtime.InteropServices.FieldOffset(58)> Private dmPrintQuality As Short
        <Runtime.InteropServices.FieldOffset(44)> Public dmPosition As POINTL
        <Runtime.InteropServices.FieldOffset(52)> Public dmDisplayOrientation As Integer
        <Runtime.InteropServices.FieldOffset(56)> Public dmDisplayFixedOutput As Integer
        <Runtime.InteropServices.FieldOffset(60)> Public dmColor As Short
        <Runtime.InteropServices.FieldOffset(62)> Public dmDuplex As Short
        <Runtime.InteropServices.FieldOffset(64)> Public dmYResolution As Short
        <Runtime.InteropServices.FieldOffset(66)> Public dmTTOption As Short
        <Runtime.InteropServices.FieldOffset(68)> Public dmCollate As Short
        <Runtime.InteropServices.FieldOffset(72)> <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst:=CCHFORMNAME)> Public dmFormName As String
        <Runtime.InteropServices.FieldOffset(102)> Public dmLogPixels As Short
        <Runtime.InteropServices.FieldOffset(104)> Public dmBitsPerPel As Integer
        <Runtime.InteropServices.FieldOffset(108)> Public dmPelsWidth As Integer
        <Runtime.InteropServices.FieldOffset(112)> Public dmPelsHeight As Integer
        <Runtime.InteropServices.FieldOffset(116)> Public dmDisplayFlags As Integer
        <Runtime.InteropServices.FieldOffset(116)> Public dmNup As Integer
        <Runtime.InteropServices.FieldOffset(120)> Public dmDisplayFrequency As Integer
    End Structure

#End Region

#Region " Enumerations "

    Public Enum Orientations
        DEGREES_CW_None = -1
        DEGREES_CW_0 = 0
        DEGREES_CW_90 = 3
        DEGREES_CW_180 = 2
        DEGREES_CW_270 = 1
    End Enum

    Friend Enum DISP_CHANGE
        Successful = 0
        Restart = 1
        Failed = -1
        BadMode = -2
        NotUpdated = -3
        BadFlags = -4
        BadParam = -5
        BadDualView = -6
    End Enum

    <Flags()> Friend Enum DisplayDeviceStateFlags
        AttachedToDesktop = &H1
        MultiDriver = &H2
        PrimaryDevice = &H4
        MirroringDriver = &H8
        VGACompatible = &H10
        Removable = &H20
        ModesPruned = &H8000000
        Remote = &H4000000
        Disconnect = &H2000000
    End Enum

    <Flags()> Friend Enum DisplaySettingsFlags
        CDS_NONE = 0
        CDS_UPDATEREGISTRY = &H1
        CDS_TEST = &H2
        CDS_FULLSCREEN = &H4
        CDS_GLOBAL = &H8
        CDS_SET_PRIMARY = &H10
        CDS_VIDEOPARAMETERS = &H20
        CDS_ENABLE_UNSAFE_MODES = &H100
        CDS_DISABLE_UNSAFE_MODES = &H200
        CDS_RESET = &H40000000
        CDS_RESET_EX = &H20000000
        CDS_NORESET = &H10000000
    End Enum

    <Flags()> Friend Enum DM
        Orientation = &H1
        PaperSize = &H2
        PaperLength = &H4
        PaperWidth = &H8
        Scale = &H10
        Position = &H20
        NUP = &H40
        DisplayOrientation = &H80
        Copies = &H100
        DefaultSource = &H200
        PrintQuality = &H400
        Color = &H800
        Duplex = &H1000
        YResolution = &H2000
        TTOption = &H4000
        Collate = &H8000
        FormName = &H10000
        LogPixels = &H20000
        BitsPerPixel = &H40000
        PelsWidth = &H80000
        PelsHeight = &H100000
        DisplayFlags = &H200000
        DisplayFrequency = &H400000
        ICMMethod = &H800000
        ICMIntent = &H1000000
        MediaType = &H2000000
        DitherType = &H4000000
        PanningWidth = &H8000000
        PanningHeight = &H10000000
        DisplayFixedOutput = &H20000000
    End Enum

#End Region

#Region " Native Methods "

    Friend Class NativeMethods

        <Runtime.InteropServices.DllImport("user32.dll")> Friend Shared Function ChangeDisplaySettingsEx(lpszDeviceName As String, ByRef lpDevMode As DEVMODE, hwnd As IntPtr, dwflags As DisplaySettingsFlags, lParam As IntPtr) As DISP_CHANGE : End Function
        <Runtime.InteropServices.DllImport("user32.dll")> Friend Shared Function EnumDisplayDevices(lpDevice As String, iDevNum As UInteger, ByRef lpDisplayDevice As DISPLAY_DEVICE, dwFlags As UInteger) As Boolean : End Function
        <Runtime.InteropServices.DllImport("user32.dll", CharSet:=Runtime.InteropServices.CharSet.Ansi)> Friend Shared Function EnumDisplaySettings(lpszDeviceName As String, iModeNum As Integer, ByRef lpDevMode As DEVMODE) As Integer : End Function

    End Class

#End Region

#End Region

#Region " Methods "

    Public Shared Function GetRotation(Display As UInteger) As Orientations
        If Display >= Screen.AllScreens.Length Then Return Orientations.DEGREES_CW_None
        Dim D As New DISPLAY_DEVICE() : Dim DM As New DEVMODE() : D.cb = Runtime.InteropServices.Marshal.SizeOf(D)
        If Not NativeMethods.EnumDisplayDevices(Nothing, Display, D, 0) Then Return Orientations.DEGREES_CW_None
        If NativeMethods.EnumDisplaySettings(D.DeviceName, -1, DM) <> 0 Then Return DM.dmDisplayOrientation
        Return Orientations.DEGREES_CW_None
    End Function

    Public Shared Sub Rotate(Display As UInteger, Orientation As Orientations)
        If Display >= Screen.AllScreens.Length Or Orientation = Orientations.DEGREES_CW_None Then Exit Sub
        Dim D As New DISPLAY_DEVICE() : Dim DM As New DEVMODE() : D.cb = Runtime.InteropServices.Marshal.SizeOf(D)
        If Not NativeMethods.EnumDisplayDevices(Nothing, Display, D, 0) Then Exit Sub
        If 0 <> NativeMethods.EnumDisplaySettings(D.DeviceName, -1, DM) Then
            If (DM.dmDisplayOrientation + Orientation) Mod 2 = 1 Then Dim Temp As Integer = DM.dmPelsHeight : DM.dmPelsHeight = DM.dmPelsWidth : DM.dmPelsWidth = Temp
            DM.dmDisplayOrientation = Orientation
            NativeMethods.ChangeDisplaySettingsEx(D.DeviceName, DM, IntPtr.Zero, DisplaySettingsFlags.CDS_UPDATEREGISTRY, IntPtr.Zero)
        End If
    End Sub

    Public Shared Sub ResetAllRotations()
        For Cuenta = 0 To Screen.AllScreens.Length - 1 : Rotate(Cuenta, Orientations.DEGREES_CW_0) : Next
    End Sub

#End Region

End Class

#End Region

#Region " Run Process "

Public Class RunProcess

#Region " Variables "

#Region " Declarations "

    <Runtime.InteropServices.DllImport("advapi32.dll", SetLastError:=True)> Private Shared Function OpenProcessToken(ByVal ProcessHandle As IntPtr, ByVal DesiredAccess As Integer, ByRef TokenHandle As IntPtr) As Boolean : End Function
    <Runtime.InteropServices.DllImport("advapi32.dll", SetLastError:=True)> Public Shared Function GetTokenInformation(ByVal TokenHandle As IntPtr, ByVal TokenInformationClass As TOKEN_INFORMATION_CLASS, ByVal TokenInformation As IntPtr, ByVal TokenInformationLength As System.UInt32, ByRef ReturnLength As System.UInt32) As Boolean : End Function
    <Runtime.InteropServices.DllImport("User32.dll", SetLastError:=True)> Public Shared Function GetShellWindow() As IntPtr : End Function
    <Runtime.InteropServices.DllImport("user32.dll", SetLastError:=True)> Private Shared Function GetWindowThreadProcessId(ByVal hwnd As IntPtr, ByRef lpdwProcessId As IntPtr) As Integer : End Function
    <Runtime.InteropServices.DllImport("kernel32.dll")> Private Shared Function OpenProcess(ByVal dwDesiredAccess As UInteger, <Runtime.InteropServices.MarshalAs(Runtime.InteropServices.UnmanagedType.Bool)> ByVal bInheritHandle As Boolean, ByVal dwProcessId As Integer) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("advapi32.dll", SetLastError:=True)> Private Shared Function DuplicateTokenEx(ByVal ExistingTokenHandle As IntPtr, ByVal dwDesiredAccess As UInt32, ByRef lpThreadAttributes As SECURITY_ATTRIBUTES, ByVal ImpersonationLevel As Integer, ByVal TokenType As Integer, ByRef DuplicateTokenHandle As System.IntPtr) As Boolean : End Function
    <Runtime.InteropServices.DllImport("advapi32.dll", SetLastError:=True)> Private Shared Function LookupPrivilegeValue(lpSystemName As String, lpName As String, ByRef lpLuid As LUID) As Boolean : End Function
    ' Use this signature if you want the previous state information returned
    <Runtime.InteropServices.DllImport("advapi32.dll", SetLastError:=True)> Private Shared Function AdjustTokenPrivileges(ByVal TokenHandle As IntPtr, ByVal DisableAllPrivileges As Boolean, ByRef NewState As TOKEN_PRIVILEGES, ByVal BufferLengthInBytes As Integer, ByRef PreviousState As TOKEN_PRIVILEGES, ByRef ReturnLengthInBytes As Integer) As Boolean : End Function
    <Runtime.InteropServices.DllImport("advapi32", SetLastError:=True, CharSet:=Runtime.InteropServices.CharSet.Unicode)> Public Shared Function CreateProcessWithTokenW(hToken As IntPtr, dwLogonFlags As Integer, lpApplicationName As String, lpCommandLine As String, dwCreationFlags As Integer, lpEnvironment As IntPtr, lpCurrentDirectory As IntPtr, ByRef lpStartupInfo As STARTUPINFO, ByRef lpProcessInformation As PROCESS_INFORMATION) As Boolean : End Function
    <Runtime.InteropServices.DllImport("kernel32.dll")> Shared Function CreateProcess(lpApplicationName As IntPtr, lpCommandLine As IntPtr, ByRef lpProcessAttributes As SECURITY_ATTRIBUTES, ByRef lpThreadAttributes As SECURITY_ATTRIBUTES, bInheritHandles As Boolean, dwCreationFlags As UInt32, lpEnvironment As IntPtr, lpCurrentDirectory As String, <Runtime.InteropServices.[In]()> ByRef lpStartupInfo As STARTUPINFO, <Runtime.InteropServices.[Out]()> ByRef lpProcessInformation As PROCESS_INFORMATION) As Boolean : End Function

#End Region

#Region " Enumerations "

    Public Enum TOKEN_INFORMATION_CLASS
        TokenUser = 1
        TokenGroups
        TokenPrivileges
        TokenOwner
        TokenPrimaryGroup
        TokenDefaultDacl
        TokenSource
        TokenType
        TokenImpersonationLevel
        TokenStatistics
        TokenRestrictedSids
        TokenSessionId
        TokenGroupsAndPrivileges
        TokenSessionReference
        TokenSandBoxInert
        TokenAuditPolicy
        TokenOrigin
        TokenElevationType
        TokenLinkedToken
        TokenElevation
        TokenHasRestrictions
        TokenAccessInformation
        TokenVirtualizationAllowed
        TokenVirtualizationEnabled
        TokenIntegrityLevel
        TokenUIAccess
        TokenMandatoryPolicy
        TokenLogonSid
        MaxTokenInfoClass
    End Enum

#End Region

#Region " Structures "

    <Runtime.InteropServices.StructLayout(Runtime.InteropServices.LayoutKind.Sequential)> Structure SECURITY_ATTRIBUTES : Public nLength As Integer : Public lpSecurityDescriptor As IntPtr : Public bInheritHandle As Integer : End Structure
    Structure TOKEN_PRIVILEGES : Public PrivilegeCount As Integer : Public TheLuid As LUID : Public Attributes As Integer : End Structure
    Structure LUID : Public LowPart As UInt32 : Public HighPart As UInt32 : End Structure
    Structure PROCESS_INFORMATION : Public hProcess As IntPtr : Public hThread As IntPtr : Public dwProcessId As Integer : Public dwThreadId As Integer : End Structure

    <Runtime.InteropServices.StructLayout(Runtime.InteropServices.LayoutKind.Sequential, CharSet:=Runtime.InteropServices.CharSet.Unicode)> Structure STARTUPINFO
        Public cb As Integer
        Public lpReserved As String
        Public lpDesktop As String
        Public lpTitle As String
        Public dwX As Integer
        Public dwY As Integer
        Public dwXSize As Integer
        Public dwYSize As Integer
        Public dwXCountChars As Integer
        Public dwYCountChars As Integer
        Public dwFillAttribute As Integer
        Public dwFlags As Integer
        Public wShowWindow As Short
        Public cbReserved2 As Short
        Public lpReserved2 As Integer
        Public hStdInput As Integer
        Public hStdOutput As Integer
        Public hStdError As Integer
    End Structure

#End Region

#Region " Constants "

    Public Const SE_PRIVILEGE_ENABLED = &H2L
    Public Const PROCESS_QUERY_INFORMATION = &H400
    Public Const TOKEN_ASSIGN_PRIMARY = &H1
    Public Const TOKEN_DUPLICATE = &H2
    Public Const TOKEN_IMPERSONATE = &H4
    Public Const TOKEN_QUERY = &H8
    Public Const TOKEN_QUERY_SOURCE = &H10
    Public Const TOKEN_ADJUST_PRIVILEGES = &H20
    Public Const TOKEN_ADJUST_GROUPS = &H40
    Public Const TOKEN_ADJUST_DEFAULT = &H80
    Public Const TOKEN_ADJUST_SESSIONID = &H100
    Public Const SecurityImpersonation = 2
    Public Const TokenPrimary = 1
    Public Const SE_INCREASE_QUOTA_NAME = "SeIncreaseQuotaPrivilege"

#End Region

#End Region

#Region " Methods "

    Public Shared Sub RunAsStandar(Proceso As String, Optional Parametros As String = "")
        Dim currentProcess As Process = Process.GetCurrentProcess
        'Enable SeIncreaseQuotaPrivilege in this process.  (This requires administrative privileges.)
        Dim hProcessToken As IntPtr = Nothing
        OpenProcessToken(currentProcess.Handle, TOKEN_ADJUST_PRIVILEGES, hProcessToken)
        Dim tkp As TOKEN_PRIVILEGES
        tkp.PrivilegeCount = 1
        LookupPrivilegeValue(Nothing, SE_INCREASE_QUOTA_NAME, tkp.TheLuid)
        tkp.Attributes = SE_PRIVILEGE_ENABLED

        AdjustTokenPrivileges(hProcessToken, False, tkp, 0, Nothing, Nothing)

        'Get window handle representing the desktop shell.  This might not work if there is no shell window, or when
        'using a custom shell.  Also note that we're assuming that the shell is not running elevated.
        Dim hShellWnd As IntPtr = GetShellWindow()

        'Get the ID of the desktop shell process.
        Dim dwShellPID As IntPtr
        GetWindowThreadProcessId(hShellWnd, dwShellPID)

        'Open the desktop shell process in order to get the process token.
        Dim hShellProcess As IntPtr = OpenProcess(PROCESS_QUERY_INFORMATION, False, dwShellPID)
        Dim hShellProcessToken As IntPtr = Nothing
        Dim hPrimaryToken As IntPtr = Nothing

        'Get the process token of the desktop shell.
        OpenProcessToken(hShellProcess, TOKEN_DUPLICATE, hShellProcessToken)

        'Duplicate the shell's process token to get a primary token.
        Dim dwTokenRights As Integer = TOKEN_QUERY Or TOKEN_ASSIGN_PRIMARY Or TOKEN_DUPLICATE Or TOKEN_ADJUST_DEFAULT Or TOKEN_ADJUST_SESSIONID
        DuplicateTokenEx(hShellProcessToken, dwTokenRights, Nothing, SecurityImpersonation, TokenPrimary, hPrimaryToken)

        Dim si As STARTUPINFO = Nothing : Dim pi As PROCESS_INFORMATION = Nothing
        si.cb = Runtime.InteropServices.Marshal.SizeOf(si)

        CreateProcessWithTokenW(hPrimaryToken, 0, Proceso, Parametros, 0, Nothing, Nothing, si, pi)
    End Sub

    Public Shared Sub RunAsAdmin(Proceso As String, Optional Parametros As String = "")
        Dim p As New Process
        p.StartInfo.FileName = Proceso : p.StartInfo.Arguments = Parametros : p.Start()
    End Sub

#End Region

End Class

#End Region

#Region " Sonidos "

Public Class Sonidos

#Region " Variables "

    Private Shared Sonidos() As String
    Private Shared MCIPlayer As New MciSafeCall(FMenu)
    Private Shared ComboSonidos As New List(Of String) From {"Sin Sonido", "Alarma 1", "Alarma 2", "Background", "Balloon", "Battery Critical", "Battery Low", "Calendar", "Camera", "Chimes", "Chord", "Connection", "Control", "Default", "Ding", "Email", "Error", "Exclamation", "Foreground", "Generic", "Hardware Fail", "Harware Insert", "Hardware Remove", "LogOff", "LogOn", "Message", "Messaging", "Notification 1", "Notification 2", "Notification 3", "Print", "Recycle", "Ring 1", "Ring 2", "Ring 3", "Shutdown", "Stop", "Tada", "Unlock"}

#End Region

#Region " Cargar "

    Public Shared Sub Cargar()
        FMenu.Comandos_Sonido_CSonido.Items.Clear() : FMenu.Comandos_Sonido_CSonido.Items.AddRange(ComboSonidos.ToArray)
        FMenu.GCapturaPantalla_CSonido.Items.Clear() : FMenu.GCapturaPantalla_CSonido.Items.AddRange(ComboSonidos.ToArray)
        FMenu.GGrabacionPantalla_CSonido.Items.Clear() : FMenu.GGrabacionPantalla_CSonido.Items.AddRange(ComboSonidos.ToArray)
        FMenu.GGrabacionAudio_CSonido.Items.Clear() : FMenu.GGrabacionAudio_CSonido.Items.AddRange(ComboSonidos.ToArray)
        FMenu.GReproducirSonido_CSonido.Items.Clear() : FMenu.GReproducirSonido_CSonido.Items.AddRange(ComboSonidos.ToArray)
        FMenu.GSalidaAudio_CSonido.Items.Clear() : FMenu.GSalidaAudio_CSonido.Items.AddRange(ComboSonidos.ToArray)
        FMenu.GRedAdHoc_CSonido.Items.Clear() : FMenu.GRedAdHoc_CSonido.Items.AddRange(ComboSonidos.ToArray)
        FMenu.GTopMost_CSonido.Items.Clear() : FMenu.GTopMost_CSonido.Items.AddRange(ComboSonidos.ToArray)
        FMenu.GArchivosOcultos_CSonido.Items.Clear() : FMenu.GArchivosOcultos_CSonido.Items.AddRange(ComboSonidos.ToArray)
        FMenu.GDesactivarEn_CSonido.Items.Clear() : FMenu.GDesactivarEn_CSonido.Items.AddRange(ComboSonidos.ToArray)
        FMenu.GMostrarMensaje_CSonido.Items.Clear() : FMenu.GMostrarMensaje_CSonido.Items.AddRange(ComboSonidos.ToArray)
        FMenu.GApagarEquipo_CSonido.Items.Clear() : FMenu.GApagarEquipo_CSonido.Items.AddRange(ComboSonidos.ToArray)
        FMenu.Opciones_MensajeIniciar_CSonido.Items.Clear() : FMenu.Opciones_MensajeIniciar_CSonido.Items.AddRange(ComboSonidos.ToArray)
    End Sub

#End Region

#Region " Play (Block) "

    Public Shared Function Play_Block(Sonido As String, Optional Wait As Boolean = False, Optional ExtraTime As Integer = 0) As Integer
        If Sonido <> "" Then
            If Sonido.Contains("NoSonar") = True Then Sonido = Sonido.Replace("Nosonar", "") : GoTo Salta1
            Dim Played As Boolean = True
            If Sonido.ToLower.Contains(".wav") = True Then
                If IO.File.Exists(Sonido) = True Then
                    Logros.Desbloquear("Personalizador del audio")
                    Try : My.Computer.Audio.Play(Sonido, AudioPlayMode.Background) : Catch : End Try
                Else
                    Played = False
                End If
            Else
                Select Case Sonido
                    Case "Sin Sonido" : Return 0
                    Case "Alarma 1" : My.Computer.Audio.Play(My.Resources.Alarma1, AudioPlayMode.Background)
                    Case "Alarma 2" : My.Computer.Audio.Play(My.Resources.Alarma2, AudioPlayMode.Background)
                    Case "Background" : My.Computer.Audio.Play(My.Resources.Background, AudioPlayMode.Background)
                    Case "Balloon" : My.Computer.Audio.Play(My.Resources.Balloon, AudioPlayMode.Background)
                    Case "Battery Critical" : My.Computer.Audio.Play(My.Resources.BatteryCritical, AudioPlayMode.Background)
                    Case "Battery Low" : My.Computer.Audio.Play(My.Resources.BatteryLow, AudioPlayMode.Background)
                    Case "Calendar" : My.Computer.Audio.Play(My.Resources.Calendar, AudioPlayMode.Background)
                    Case "Camera" : My.Computer.Audio.Play(My.Resources.Camera, AudioPlayMode.Background)
                    Case "Chimes" : My.Computer.Audio.Play(My.Resources.Chimes, AudioPlayMode.Background)
                    Case "Chord" : My.Computer.Audio.Play(My.Resources.Chord, AudioPlayMode.Background)
                    Case "Connection" : My.Computer.Audio.Play(My.Resources.Connection, AudioPlayMode.Background)
                    Case "Control" : My.Computer.Audio.Play(My.Resources.Control, AudioPlayMode.Background)
                    Case "Default" : My.Computer.Audio.Play(My.Resources._Default, AudioPlayMode.Background)
                    Case "Ding" : My.Computer.Audio.Play(My.Resources.Ding, AudioPlayMode.Background)
                    Case "Email" : My.Computer.Audio.Play(My.Resources.Email, AudioPlayMode.Background)
                    Case "Error" : My.Computer.Audio.Play(My.Resources._Error, AudioPlayMode.Background)
                    Case "Exclamation" : My.Computer.Audio.Play(My.Resources.Exclamation, AudioPlayMode.Background)
                    Case "Foreground" : My.Computer.Audio.Play(My.Resources.Foreground, AudioPlayMode.Background)
                    Case "Generic" : My.Computer.Audio.Play(My.Resources.Generic, AudioPlayMode.Background)
                    Case "Hardware Fail" : My.Computer.Audio.Play(My.Resources.Fail, AudioPlayMode.Background)
                    Case "Harware Insert" : My.Computer.Audio.Play(My.Resources.Insert, AudioPlayMode.Background)
                    Case "Hardware Remove" : My.Computer.Audio.Play(My.Resources.Remove, AudioPlayMode.Background)
                    Case "LogOff" : My.Computer.Audio.Play(My.Resources.LogOff, AudioPlayMode.Background)
                    Case "LogOn" : My.Computer.Audio.Play(My.Resources.LogOn, AudioPlayMode.Background)
                    Case "Message" : My.Computer.Audio.Play(My.Resources.Message, AudioPlayMode.Background)
                    Case "Messaging" : My.Computer.Audio.Play(My.Resources.Messaging, AudioPlayMode.Background)
                    Case "Notification 1" : My.Computer.Audio.Play(My.Resources.Notification, AudioPlayMode.Background)
                    Case "Notification 2" : My.Computer.Audio.Play(My.Resources.Notify1, AudioPlayMode.Background)
                    Case "Notification 3" : My.Computer.Audio.Play(My.Resources.Notify2, AudioPlayMode.Background)
                    Case "Print" : My.Computer.Audio.Play(My.Resources.Print, AudioPlayMode.Background)
                    Case "Recycle" : My.Computer.Audio.Play(My.Resources.Recycle, AudioPlayMode.Background)
                    Case "Ring 1" : My.Computer.Audio.Play(My.Resources.Ring1, AudioPlayMode.Background)
                    Case "Ring 2" : My.Computer.Audio.Play(My.Resources.Ring2, AudioPlayMode.Background)
                    Case "Ring 3" : My.Computer.Audio.Play(My.Resources.Ring3, AudioPlayMode.Background)
                    Case "Shutdown" : My.Computer.Audio.Play(My.Resources.Shutdown, AudioPlayMode.Background)
                    Case "Stop" : My.Computer.Audio.Play(My.Resources._Stop, AudioPlayMode.Background)
                    Case "Tada" : My.Computer.Audio.Play(My.Resources.Tada, AudioPlayMode.Background)
                    Case "Unlock" : My.Computer.Audio.Play(My.Resources.Unlock, AudioPlayMode.Background)
                    Case Else : Played = False
                End Select
            End If
            If Played = True Then Estadisticas.Estadisticas.Sonidos_Reproducidos += 1 : Estadisticas.Guardar()
Salta1:     Dim WaitSonido As Integer = Duracion(Sonido) + ExtraTime : If Wait = True Then FMenu.WaitTime(WaitSonido)
            Return WaitSonido
        End If : Return 0
    End Function

#End Region

#Region " Play (Async) "

    Public Shared Function Play(Sonido As String, SonidoID As String, Optional Wait As Boolean = False, Optional ExtraTime As Integer = 0) As Integer
        If Sonido Is Nothing OrElse (Sonido = "Sin Sonido" Or SonidoID.Trim = "") Then Return 0
        If Sonido.Contains("NoSonar") = True Then Sonido = Sonido.Replace("Nosonar", "") : GoTo Salta1
        If Play_Async(Sonido, SonidoID) = True Then Estadisticas.Estadisticas.Sonidos_Reproducidos += 1 : Estadisticas.Guardar()
Salta1: Dim WaitSonido As Integer = Duracion(Sonido) + ExtraTime : If Wait = True Then FMenu.WaitTime(WaitSonido)
        Return WaitSonido
    End Function

    Public Shared Function Play_Async(Sonido As String, SonidoID As String) As Boolean
        Try : If Sonido Is Nothing OrElse (Sonido = "Sin Sonido" Or SonidoID.Trim = "") Then Return False
            Dim SonidoIDF As String
            If Sonido.ToLower.Contains(".wav") = True AndAlso IO.File.Exists(Sonido) = True Then
                SonidoIDF = Sonido
                MCIPlayer.MciReplacement("stop " & SonidoID)
                MCIPlayer.MciReplacement("close " & SonidoID)
                Try : If IO.File.Exists(Sonido) = True Then IO.File.Delete(Sonido)
                Catch : End Try
                Logros.Desbloquear("Personalizador del audio")
                If IO.File.Exists(FMenu.KobaPathTemp + SonidoID + ".wav") = False Then IO.File.Copy(Sonido, SonidoID, True) : Play_Async(Sonido, SonidoID)
            ElseIf ComboSonidos.Contains(Sonido) = True Then
                SonidoIDF = FMenu.KobaPathTemp + SonidoID + ".wav"
                MCIPlayer.MciReplacement("stop " & SonidoID)
                MCIPlayer.MciReplacement("close " & SonidoID)
                Try : If IO.File.Exists(SonidoIDF) = True Then IO.File.Delete(SonidoIDF)
                Catch : End Try
                Select Case Sonido
                    Case "Hardware Fail" : Sonido = "Fail"
                    Case "Harware Insert" : Sonido = "Insert"
                    Case "Hardware Remove" : Sonido = "Remove"
                    Case "Notification 1" : Sonido = "Notification"
                    Case "Notification 2" : Sonido = "Notify1"
                    Case "Notification 3" : Sonido = "Notify2"
                End Select : Sonido = Sonido.Replace(" ", "")
                If IO.File.Exists(SonidoIDF) = False Then
                    If My.Resources.ResourceManager.GetObject("_" + Sonido) IsNot Nothing Then Sonido = "_" + Sonido
                    If My.Resources.ResourceManager.GetObject(Sonido) IsNot Nothing Then
                        Dim myMemStream As New IO.MemoryStream : My.Resources.ResourceManager.GetObject(Sonido).CopyTo(myMemStream) : Dim myBytes() As Byte = myMemStream.ToArray
                        IO.Directory.CreateDirectory(FMenu.KobaPathTemp) : IO.File.WriteAllBytes(SonidoIDF, myBytes)
                    End If
                End If
            Else : Return False
            End If
            If Sonidos Is Nothing OrElse Sonidos.Contains(SonidoID) = False Then
                If Sonidos Is Nothing Then ReDim Sonidos(0) Else ReDim Preserve Sonidos(Sonidos.Length)
                Sonidos(Sonidos.Length - 1) = SonidoID
            End If
            MCIPlayer.MciReplacement("open """ & SonidoIDF & """ alias " & SonidoID)
            MCIPlayer.MciReplacement("play " & SonidoID)
            Return True : Catch : End Try : Return False
    End Function

#End Region

#Region " Stop "

    Public Shared Sub [Stop]()
        My.Computer.Audio.Stop() : If Sonidos Is Nothing OrElse Sonidos.Length = 0 Then Exit Sub
        For Cuenta = 0 To Sonidos.Length - 1
            MCIPlayer.MciReplacement("stop " + Sonidos(Cuenta))
            MCIPlayer.MciReplacement("close " + Sonidos(Cuenta))
        Next
    End Sub

#End Region

#Region " Duracion "

    Public Shared Function Duracion(Sonido As String) As Double
        Dim Index As String = Now.ToString("HH.mm.ss")
        Try : If IO.File.Exists(Sonido) = False Then
                Select Case Sonido
                    Case "Hardware Fail" : Sonido = "Fail"
                    Case "Harware Insert" : Sonido = "Insert"
                    Case "Hardware Remove" : Sonido = "Remove"
                    Case "Notification 1" : Sonido = "Notification"
                    Case "Notification 2" : Sonido = "Notify1"
                    Case "Notification 3" : Sonido = "Notify2"
                End Select : Sonido = Sonido.Replace(" ", "")
                If My.Resources.ResourceManager.GetObject("_" + Sonido) IsNot Nothing Then Sonido = "_" + Sonido
                If My.Resources.ResourceManager.GetObject(Sonido) IsNot Nothing Then
                    Dim myMemStream As New IO.MemoryStream : My.Resources.ResourceManager.GetObject(Sonido).CopyTo(myMemStream) : Dim myBytes() As Byte = myMemStream.ToArray
                    IO.Directory.CreateDirectory(FMenu.KobaPathTemp) : IO.File.WriteAllBytes(FMenu.KobaPathTemp + "Temp" + Index + ".wav", myBytes) : Threading.Thread.Sleep(25) : Sonido = FMenu.KobaPathTemp + "Temp" + Index + ".wav"
                End If
            End If : If IO.File.Exists(Sonido) = False Then Return 0
            Dim wf As New NAudio.Wave.WaveFileReader(Sonido)
            Dim cDuracion As Double = wf.TotalTime.TotalMilliseconds : wf.Close()
            If IO.File.Exists(FMenu.KobaPathTemp + "Temp" + Index + ".wav") = True Then IO.File.Delete(FMenu.KobaPathTemp + "Temp" + Index + ".wav")
            Return cDuracion
        Catch : End Try : Return 0
    End Function

#End Region

End Class

#End Region

#Region " Iconos "

Public Class Iconos

#Region " Variables "

#Region " Declaraciones "

    <Runtime.InteropServices.DllImport("shell32.dll")> Public Shared Function ExtractIcon(hInst As Integer, lpszExeFileName As String, nIconIndex As Integer) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("shell32.dll")> Public Shared Function ExtractIconEx(szFileName As String, nIconIndex As Integer, ByRef phiconLarge() As IntPtr, ByRef phiconSmall() As IntPtr, nIcons As UInteger) As UInteger : End Function
    <Runtime.InteropServices.DllImport("shell32.dll")> Public Shared Function ExtractAssociatedIcon(hinst As IntPtr, lpiconpath As String, ByRef lpiicon As Integer) As IntPtr : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Public Shared Function GetClassLong(hWnd As IntPtr, nIndex As Integer) As Integer : End Function
    <Runtime.InteropServices.DllImport("user32.dll")> Public Shared Function DestroyIcon(hIcon As IntPtr) As Boolean : End Function


#End Region

    Private Shared isURL As Boolean

#End Region

#Region " Cargar  "

    ' Carga un icono
    Public Shared Function Cargar(Ruta As String) As Icon
        Try ' Verifica si el archivo especificado en la ruta existe
            If IO.File.Exists(Ruta) = True Then Return New Icon(Ruta)
        Catch : End Try : Return Nothing
    End Function

#End Region

#Region " Guardar "

    ' Guarda un icono
    Public Shared Sub Guardar(Icono As Bitmap, Ruta As String)
        Try ' Verifica si la ruta especificada está vacía
            If String.IsNullOrWhiteSpace(Ruta) Then Exit Sub

            ' Verifica si el directorio especificado en la ruta existe
            If Not IO.Directory.Exists(IO.Path.GetDirectoryName(Ruta)) Then IO.Directory.CreateDirectory(IO.Path.GetDirectoryName(Ruta))

            ' Verifica si el archivo especificado en la ruta existe
            If IO.File.Exists(Ruta) Then IO.File.Delete(Ruta)

            ' Crea una nueva instancia de la clase MultiIcon
            Dim myIcons As New Drawing.IconLib.MultiIcon()
            ' Agrega un nuevo SingleIcon al MultiIcon
            Dim sIco As Drawing.IconLib.SingleIcon = myIcons.Add("KDesktop")
            ' Crea un SingleIcon a partir del Bitmap especificado y le asigna el formato Vista
            sIco.CreateFrom(Icono, Drawing.IconLib.IconOutputFormat.Vista)
            ' Guarda el SingleIcon en la ruta especificada
            sIco.Save(Ruta)
        Catch : End Try
    End Sub


#End Region

#Region " Default Icon (Arreglar)"

    '    Private Sub Iconos_Update()
    '        For Cuenta = 0 To Lista.Items.Count - 1 : Lista.Items(Cuenta).Image = DefaultIcon(Comandos(Lista.Items(Cuenta).Tag).ID, 0) : Next
    '        For Cuenta = 0 To Comandos_Accion_ListaAccion.Items.Count - 1
    '            If ComandoActualID = "Negativo" Then
    '                Comandos_Accion_ListaAccion.Items(Cuenta).Image = DefaultIcon("Negativo", Cuenta, True)
    '            Else
    '                Dim Indice_ID As Integer = Comandos_GetByID(ComandoActualID)
    '                If Indice_ID <> -1 Then Comandos_Accion_ListaAccion.Items(Cuenta).Image = DefaultIcon(Comandos(Indice_ID).ID, Cuenta, True)
    '            End If
    '        Next : Lista.Invalidate() : Comandos_Accion_ListaAccion.Invalidate() : Lista.Update()
    '    End Sub

    Public Shared Function DefaultIcon(ItemTag As String, Optional ResetIcon As Boolean = False) As Image
        If Split(ItemTag, "|-|",, CompareMethod.Text).Length < 4 Then Return Nothing
        Dim QuickMenu_ID As String = Split(ItemTag, "|-|",, CompareMethod.Text)(0)
        Dim Comando_ID As String = Split(ItemTag, "|-|",, CompareMethod.Text)(1)
        Dim QuickMenu_Icono As String = Split(ItemTag, "|-|",, CompareMethod.Text)(3)
        If ResetIcon = True Then If IO.File.Exists(FMenu.KobaPath + "Iconos\QuickMenu\" + QuickMenu_ID + ".ico") = True Then IO.File.Delete(FMenu.KobaPath + "Iconos\QuickMenu\" + QuickMenu_ID + ".ico") : QuickMenu_Icono = "[DEFAULT]"
        Return DefaultIcon(Comando_ID, 0, False, QuickMenu_ID, QuickMenu_Icono)
    End Function

    Public Shared Function DefaultIcon(Comando_ID As String, Accion_Indice As Integer, Optional Accion As Boolean = False, Optional QuickMenu_ID As String = "", Optional QuickMenu_Icono As String = "[DEFAULT]") As Image
        'Try
        If QuickMenu_ID <> "" Then
            If QuickMenu_Icono = "[ELIMINADOICON]" Then Return Nothing
            If QuickMenu_Icono <> "[DEFAULT]" AndAlso IO.File.Exists(FMenu.KobaPath + "Iconos\QuickMenu\" + QuickMenu_ID + ".ico") = True Then Return Iconos.Cargar(FMenu.KobaPath + "Iconos\QuickMenu\" + QuickMenu_ID + ".ico").ToBitmap
        End If

        Dim Indice_ID As Integer = -1 : Dim TempAcciones() As FMenu.AccionST
        If Comando_ID = "Negativo" Then
            TempAcciones = FMenu.Comandos_Accion_AccionesTemporales
        Else
            Indice_ID = FMenu.Comandos_GetByID(Comando_ID) : If Indice_ID = -1 Then Return Nothing
            TempAcciones = FMenu.Comandos(Indice_ID).Accion
        End If

        If Accion = False AndAlso Indice_ID <> -1 AndAlso FMenu.Comandos(Indice_ID).CustomIcono = "[ELIMINADO]" Then Return Nothing
        If Accion = False AndAlso Indice_ID <> -1 AndAlso FMenu.Comandos(Indice_ID).CustomIcono = "[CUSTOM]" AndAlso IO.File.Exists(FMenu.KobaPath + "Iconos\Comandos\" + FMenu.Comandos(Indice_ID).ID + ".ico") = True Then Return Iconos.Cargar(FMenu.KobaPath + "Iconos\Comandos\" + FMenu.Comandos(Indice_ID).ID + ".ico").ToBitmap

        If Accion_Indice = -1 Then Return Nothing
        If TempAcciones Is Nothing Or (TempAcciones.Length = 0 OrElse TempAcciones(Accion_Indice).Tipo Is Nothing) Then Return Nothing
        Select Case TempAcciones(Accion_Indice).Tipo.ToLower
            Case "ejecutar aplicacion"
                Dim cIcon As Image = DefaultIcon_FileWeb(Split(TempAcciones(Accion_Indice).Settings, "|-|",, CompareMethod.Text)(0))
                If isURL = True AndAlso cIcon Is Nothing Then
                    Select Case FMenu.GetDefaultBrowser.ToLower
                        Case "google chrome"
                            Return My.Resources.Navegador_Chrome.ToBitmap
                        Case "mozilla firefox"
                            Return My.Resources.Navegador_Firefox.ToBitmap
                        Case "microsoft edge"
                            Return My.Resources.Navegador_Edge.ToBitmap
                        Case "opera"
                            Return My.Resources.Navegador_Opera.ToBitmap
                        Case "vivaldi"
                            Return My.Resources.Navegador_Vivaldi.ToBitmap
                        Case "uc browser"
                            Return My.Resources.Navegador_UCBrowser.ToBitmap
                        Case "brave"
                            Return My.Resources.Navegador_Brave.ToBitmap
                        Case Else
                            Return My.Resources.Navegador_Browser.ToBitmap
                    End Select
                ElseIf isURL = False AndAlso cIcon Is Nothing Then
                    Return My.Resources.Accion_Aplicacion.ToBitmap
                Else : Return cIcon
                End If
            Case "abrir carpeta"
                Select Case Split(TempAcciones(Accion_Indice).Settings, "|-|",, CompareMethod.Text)(0).ToLower
                    Case "equipo" : Return My.Resources.CE_Equipo.ToBitmap
                    Case "panel de control" : Return My.Resources.CE_PanelControl.ToBitmap
                    Case "control de volumen" : Return My.Resources.CE_ControlVolumen.ToBitmap
                    Case "ajustes de audio" : Return My.Resources.CE_AjustesAudio.ToBitmap
                    Case "papelera de reciclaje" : Return My.Resources.CE_Papelera.ToBitmap
                    Case "papelera (vaciar)" : Return My.Resources.CE_VaciarPapelera.ToBitmap
                    Case "modo 'god'" : Return My.Resources.CE_GodMode.ToBitmap
                    Case "documentos" : Return My.Resources.CE_Documentos.ToBitmap
                    Case "imagenes" : Return My.Resources.CE_Imagenes.ToBitmap
                    Case "musicas" : Return My.Resources.CE_Musicas.ToBitmap
                    Case "escritorio" : Return My.Resources.CE_Escritorio.ToBitmap
                    Case "videos" : Return My.Resources.CE_Videos.ToBitmap
                    Case "descargas" : Return My.Resources.CE_Descargas.ToBitmap
                    Case "k-temp" : Return My.Resources.CE_KTemp.ToBitmap
                    Case "k-desktop" : Return My.Resources.KDesktop.ToBitmap
                    Case "usuario" : Return My.Resources.CE_Usuario.ToBitmap
                    Case "fuentes" : Return My.Resources.CE_Fuentes.ToBitmap
                    Case "menu inicio (usuario)" : Return My.Resources.CE_MenuInicio.ToBitmap
                    Case "menu inicio" : Return My.Resources.CE_MenuInicio.ToBitmap
                    Case "directivas de grupo" : Return My.Resources.CE_GroupPolicy.ToBitmap
                    Case "programador de tareas" : Return My.Resources.CE_ProgramadorTareas.ToBitmap
                    Case "registro de windows" : Return My.Resources.CE_Regedit.ToBitmap
                    Case "teclado en pantalla" : Return My.Resources.CE_TecladoPantalla.ToBitmap
                    Case "conexiones de red" : Return My.Resources.CE_ConexionesRed.ToBitmap
                    Case "task switcher" : Return My.Resources.CE_TaskSwitcher.ToBitmap
                    Case "k-link" : Return My.Resources.CE_K_Link.ToBitmap
                    Case "powershell" : Return My.Resources.CE_PowerShell.ToBitmap
                    Case "windows apps" : Return My.Resources.CE_WindowsApps.ToBitmap
                    Case Else : Return My.Resources.Accion_AbrirCarpeta.ToBitmap
                End Select
            Case "pagina web"
                Dim cIcon As Image = DefaultIcon_FileWeb(Split(TempAcciones(Accion_Indice).Settings, "|-|",, CompareMethod.Text)(0))
                If cIcon Is Nothing Then
                    Select Case Split(TempAcciones(Accion_Indice).Settings, "|-|",, CompareMethod.Text)(1).ToLower
                        Case "google chrome"
                            Return My.Resources.Navegador_Chrome.ToBitmap
                        Case "mozilla firefox"
                            Return My.Resources.Navegador_Firefox.ToBitmap
                        Case "microsoft edge"
                            Return My.Resources.Navegador_Edge.ToBitmap
                        Case "opera"
                            Return My.Resources.Navegador_Opera.ToBitmap
                        Case "vivaldi"
                            Return My.Resources.Navegador_Vivaldi.ToBitmap
                        Case "uc browser"
                            Return My.Resources.Navegador_UCBrowser.ToBitmap
                        Case "brave"
                            Return My.Resources.Navegador_Brave.ToBitmap
                        Case Else
                            Return My.Resources.Navegador_Browser.ToBitmap
                    End Select
                Else : Return cIcon
                End If
            Case "aplicaciones" : Return My.Resources.Accion_Aplicaciones.ToBitmap
            Case "ejecutar bat" : Return My.Resources.Accion_BAT.ToBitmap
                        'Audio y Video
            Case "capturar pantalla" : Return My.Resources.Accion_Capturar_Pantalla.ToBitmap
            Case "grabar pantalla (on/off)" : Return My.Resources.Accion_Grabar_Pantalla.ToBitmap
            Case "grabar audio (on/off)" : Return My.Resources.Accion_Grabar_Audio.ToBitmap
            Case "reproducir sonido" : Return My.Resources.Accion_ReproducirSonido.ToBitmap
            Case "salida de audio" : Return My.Resources.Accion_Salida_Audio.ToBitmap
            Case "volumen" : Return My.Resources.Accion_Volumen.ToBitmap
                        'Utilidades
            Case "macros" : Return My.Resources.Accion_Macros.ToBitmap
            Case "k-board" : Return My.Resources.Accion_K_Board.ToBitmap
            Case "quickmenu" : Return My.Resources.Accion_QuickMenu.ToBitmap
            Case "red ad-hoc" : Return My.Resources.Accion_Ad_Hoc.ToBitmap
                        'Acciones
            Case "enviar pulsación" : Return My.Resources.Accion_EnviarPulsacion.ToBitmap
            Case "topmost (on/off)" : Return My.Resources.Accion_TopMost.ToBitmap
            Case "archivos ocultos (on/off)" : Return My.Resources.Accion_Archivos_Ocultos.ToBitmap
            Case "desactivar en (on/off)" : Return My.Resources.Accion_Desactivar.ToBitmap
            Case "mostrar mensaje" : Return My.Resources.Accion_Mensaje.ToBitmap
            Case "apagar equipo" : Return My.Resources.Accion_Apagar_Equipo.ToBitmap
            Case "comandos" : Return My.Resources.Accion_Comandos.ToBitmap
            Case "esperar" : Return My.Resources.Accion_Esperar.ToBitmap
            Case Else : Return My.Resources.Accion_Aplicacion.ToBitmap
        End Select
        'Catch : End Try
        Return Nothing
    End Function

    Private Shared Function DefaultIcon_FileWeb(Ruta As String) As Image
        isURL = False : If Ruta = "" Then Return Nothing
Repite: Ruta = FMenu.ReplaceSpecialFolder(Ruta)
        If IO.File.Exists(Ruta) = False And IO.Directory.Exists(Ruta) = False Then
            Ruta = Replace(Ruta, "http", "http", 1, -1, vbTextCompare) : If Internet.ValidarURL(Ruta) = True Then
                isURL = True : Ruta = FMenu.KobaPath + "Iconos\WebIcons\" + Ruta.Replace("\", "_").Replace("/", "_").Replace("?", "_").Replace(".", "_").Replace(":", "").Replace(";", "") + ".ico"
                If IO.File.Exists(Ruta) = True Then Return Cargar(Ruta).ToBitmap Else Return Nothing
            Else
                Ruta = Rutas.GetTargetPath(Ruta) : If IO.File.Exists(Ruta) = False Then Return My.Resources.Accion_Aplicacion.ToBitmap
            End If
        End If
        Dim Tipo_DefaultIcon As String = FileType(Ruta) : If Tipo_DefaultIcon = "Archivo" Then If IO.Directory.Exists(Ruta) = True Then Tipo_DefaultIcon = "Carpeta"
        Select Case Tipo_DefaultIcon
            Case "Carpeta" : Return My.Resources.Accion_AbrirCarpeta.ToBitmap
            Case "Disco local" : Return My.Resources.DiscoLocal.ToBitmap
            Case "Acceso directo" : Ruta = Rutas.GetTargetPath(Ruta) : GoTo Repite
            Case "Archivo por lotes de Windows" : Return My.Resources.Accion_BAT.ToBitmap
            Case Else : If Ruta.ToLower.EndsWith(".lnk") Then Return ExtraerIcono(Rutas.GetTargetPath(Ruta)) Else Return ExtraerIcono(Ruta)
        End Select : Return Nothing
    End Function

#End Region

#Region " Extraer Icono "

    ' Extrae un icono de un archivo y en caso de error devuelve Nothing o el icono especificado por el usuario (cIcon)
    Public Shared Function ExtraerIcono(Ruta As String, Optional cIcon As Bitmap = Nothing) As Bitmap
        Try : Dim Icono As IntPtr
            ' Recorre todos los iconos del archivo
            For Cuenta As Integer = 0 To ExtractIconEx(Ruta, -1, Nothing, Nothing, 0) - 1
                ' Obtiene un icono del archivo y lo asigna a Icono
                Icono = ExtractIcon(GetClassLong(IntPtr.Zero, -16), Ruta, Cuenta)
                ' Si Icono es un icono, lo devuelve como Bitmap y sale del bucle
                If Icono <> IntPtr.Zero Then Return Icon.FromHandle(Icono).ToBitmap
            Next
        Catch : End Try
        Try ' Intenta extraer el icono asociado al archivo especificado en la ruta
            Dim Icono As Icon = Icon.ExtractAssociatedIcon(Ruta)
            ' Si se ha extraído correctamente el icono, lo devuelve como Bitmap
            If Icono IsNot Nothing Then Return Icono.ToBitmap
        Catch : End Try
        ' Si no se ha podido extraer el icono, devuelve cIcon
        Return cIcon
    End Function

    ' Extrae un icono de un archivo con un Indice especificado y en caso de error devuelve Nothing o el icono especificado por el usuario (cIcon)
    Public Shared Function ExtraerIcono(Ruta As String, Indice As Integer, Optional cIcon As Bitmap = Nothing, Optional ExtraTry As Boolean = False) As Bitmap
        Try 'Extrae el icono del archivo con el Indice indicado
            Dim Icono As IntPtr = ExtractIcon(GetClassLong(IntPtr.Zero, -16), Ruta, Indice)
            ' Si Icono es un icono, lo devuelve como Bitmap
            If Icono <> IntPtr.Zero Then Return Icon.FromHandle(Icono).ToBitmap
            ' No se encuentra el icono y se devuelve el indicado por el usuario o se vuelve a intentar con el Indice 0 si ExtraTry es True
            If ExtraTry = False Then Return cIcon
            Return ExtraerIcono(Ruta, cIcon)
        Catch : End Try
        ' Si no se ha podido extraer el icono, devuelve cIcon
        Return cIcon
    End Function

#End Region

End Class

#End Region

#Region " Imagen "

Public Class Imagen

#Region " Load Image Clone "

    ' Carga una imagen sin bloquear el archivo.
    Public Shared Function LoadImageClone(sPath As String) As Image
        ' Comprueba si el archivo de imagen existe.
        If Not IO.File.Exists(sPath) Then Return Nothing

        ' Carga la imagen original desde el archivo.
        Dim bmpOriginal As Image = Image.FromFile(sPath)
        ' Crea una copia de la imagen.
        Dim bmpClone As New Bitmap(bmpOriginal.Width, bmpOriginal.Height)
        Dim g As Graphics = Graphics.FromImage(bmpClone)

        ' Establece las opciones de dibujo para optimizar el rendimiento.
        g.SmoothingMode = Drawing2D.SmoothingMode.None
        g.InterpolationMode = Drawing2D.InterpolationMode.NearestNeighbor
        g.PixelOffsetMode = Drawing2D.PixelOffsetMode.HighSpeed

        ' Dibuja la imagen original en la copia.
        g.DrawImage(bmpOriginal, 0, 0, bmpOriginal.Width, bmpOriginal.Height)

        ' Libera los recursos utilizados
        g.Dispose() : bmpOriginal.Dispose()

        ' Devuelve la copia de la imagen.
        Return bmpClone
    End Function

#End Region

#Region " Are Same Image "

    ' Comprueba si dos imagenes son identicas
    Public Shared Function AreSameImage(Imagen_1 As Image, Imagen_2 As Image, Optional PixelByPixel As Boolean = False) As Boolean
        Try
            If PixelByPixel = True Then
                ' Comprueba si las imágenes tienen el mismo tamaño.
                If Imagen_1.Width <> Imagen_2.Width OrElse Imagen_1.Height <> Imagen_2.Height Then Return False

                ' Convierte las imágenes a objetos Bitmap.
                Dim BM1 As Bitmap = CType(Imagen_1, Bitmap)
                Dim BM2 As Bitmap = CType(Imagen_2, Bitmap)

                ' Compara los píxeles de ambas imágenes.
                For X = 0 To BM1.Width - 1
                    For Y = 0 To BM2.Height - 1
                        If BM1.GetPixel(X, Y) <> BM2.GetPixel(X, Y) Then Return False
                    Next
                Next
                ' Si se han comparado todos los píxeles y ninguno es diferente, las imágenes son iguales.
                Return True
            Else
                ' Comprueba si las imágenes tienen el mismo tamaño.
                If Imagen_1.Width <> Imagen_2.Width OrElse Imagen_1.Height <> Imagen_2.Height Then Return False

                ' Calcula el hash de ambas imágenes.
                Dim Hash1 As Byte() = CalculateHash(Imagen_1)
                Dim Hash2 As Byte() = CalculateHash(Imagen_2)

                ' Compara los hashes.
                If Hash1.Length <> Hash2.Length Then Return False
                For i As Integer = 0 To Hash1.Length - 1
                    If Hash1(i) <> Hash2(i) Then Return False
                Next
                ' Si los hashes son iguales, las imágenes también lo son.
                Return True
            End If
        Catch  ' Se ha producido un error al intentar comparar las imágenes.
            Return False
        End Try
    End Function

    Private Shared Function CalculateHash(Imagen As Image) As Byte()
        ' Crea un MemoryStream a partir de la imagen.
        Dim ms As New IO.MemoryStream()
        Imagen.Save(ms, Imagen.RawFormat)
        ' Calcula el hash de la imagen y lo devuelve como un array de bytes.
        Return New Security.Cryptography.MD5CryptoServiceProvider().ComputeHash(ms)
    End Function

#End Region

End Class

#End Region

#Region " Rutas "

Public Class Rutas

#Region " Get Target Path "

    ' Devuelve la ruta de destino de un acceso directo, aplicaciones del sistema o Telegram
    Public Shared Function GetTargetPath(Ruta As String) As String
        If Ruta.ToLower.EndsWith(".lnk") AndAlso IO.File.Exists(Ruta) = True Then Return CreateObject("WScript.Shell").CreateShortcut(Ruta).TargetPath
        If Ruta.ToLower = "telegram" Then Return TelegramPath()
        If IO.File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.System) + "\" + Ruta + ".exe") Then Return Environment.GetFolderPath(Environment.SpecialFolder.System) + "\" + Ruta + ".exe"
        If IO.File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.Windows) + "\" + Ruta + ".exe") Then Return Environment.GetFolderPath(Environment.SpecialFolder.Windows) + "\" + Ruta + ".exe"
        If IO.File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.SystemX86) + "\" + Ruta + ".exe") Then Return Environment.GetFolderPath(Environment.SpecialFolder.SystemX86) + "\" + Ruta + ".exe"
        Return Ruta
    End Function

#End Region

#Region " Telegram Path "

    ' Devuelve la ruta de destino de Telegram
    Public Shared Function TelegramPath() As String
        Dim Telegram As String = ""
        ' Comprueba el usuario actual primero
        If IO.File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\Telegram Win (Unofficial)\Telegram.exe") = True Then Telegram = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\Telegram Win (Unofficial)\Telegram.exe"
        If IO.File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\Telegram Desktop\Telegram.exe") = True Then Telegram = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\Telegram Desktop\Telegram.exe"
        If Telegram <> "" Then Return Telegram
        ' If Telegram no se encuentra, comprueba otros usuarios
        Dim StartDrive As String = Environment.GetFolderPath(Environment.SpecialFolder.System).Substring(0, 1)
        For Each Dir As String In IO.Directory.GetDirectories(StartDrive + ":\users")
            If IO.File.Exists(Dir + "\AppData\Roaming\Telegram Win (Unofficial)\Telegram.exe") = True Then Telegram = Dir + "\AppData\Roaming\Telegram Win (Unofficial)\Telegram.exe"
            If IO.File.Exists(Dir + "\AppData\Roaming\Telegram Desktop\Telegram.exe") = True Then Telegram = Dir + "\AppData\Roaming\Telegram Desktop\Telegram.exe"
            If Telegram <> "" Then Return Telegram
        Next : Return Telegram
    End Function

#End Region

#Region " Crear Shortcut "

    ' Crea un acceso directo especificando sus parametros
    Public Shared Function CreateShortCut(ShortCutPath As String, ShortCutName As String, TargetPath As String, Optional StartInPath As String = "", Optional IconPath As String = "", Optional IconPath_Index As Integer = 0) As Boolean
        Try : If IO.File.Exists(TargetPath) = False Then Return False
            If IO.Directory.Exists(ShortCutPath) = False Then IO.Directory.CreateDirectory(ShortCutPath)
            If IO.File.Exists((ShortCutPath + "\" + ShortCutName + ".lnk").Replace("\\", "\")) = True Then IO.File.Delete((ShortCutPath + "\" + ShortCutName + ".lnk").Replace("\\", "\"))
            Dim oLink = CreateObject("WScript.Shell").CreateShortcut(ShortCutPath & "\" & ShortCutName & ".lnk")
            oLink.TargetPath = TargetPath : oLink.WindowStyle = 1
            If StartInPath <> "" AndAlso IO.Directory.Exists(StartInPath.Replace("\\", "\")) = True Then oLink.WorkingDirectory = StartInPath Else oLink.WorkingDirectory = IO.Path.GetDirectoryName(TargetPath)
            If IconPath <> "" AndAlso IO.File.Exists(IconPath) = True Then oLink.IconLocation = IconPath + ", " + IconPath_Index.ToString
            oLink.Save() : Return True
        Catch : End Try : Return False
    End Function

#End Region

#Region " Acortar Ruta "

    ' Acorta una ruta introduciendo ... para que entre en un control
    Public Shared Function Acortar_Ruta(Control As Object) As String
        If Control.Text = "" Then Return ""
        Return Acortar_Ruta(Control.Text, Control.Font, Control.Width)
    End Function

    Public Shared Function Acortar_Ruta(Ruta As String, Control As Object) As String
        If Ruta = "" Then Return ""
        Return Acortar_Ruta(Ruta, Control.Font, Control.Width)
    End Function

    Public Shared Function Acortar_Ruta(Ruta As String, Fuente As Font, Largo As Integer) As String
        If Ruta.Length = 1 AndAlso Char.IsLetter(Ruta.Substring(0, 1)) = True Then Ruta = Ruta.ToUpper + ":\"
        If Ruta.Length = 2 AndAlso Char.IsLetter(Ruta.Substring(0, 1)) = True AndAlso Ruta.Substring(1, 1) = ":" Then Ruta = Ruta.ToUpper + "\"
        If Ruta = "" OrElse Ruta.Length < 3 OrElse Ruta.ToLower.StartsWith("http") Then Return Ruta

        If TextRenderer.MeasureText(Ruta, New Font(Fuente.Name, Fuente.Size, FontStyle.Regular)).Width < Largo - 2 Then If Ruta.Length = 2 Then Return Ruta.Substring(0, 1).ToUpper + Ruta.Substring(1) + "\" Else Return Ruta.Substring(0, 1).ToUpper + Ruta.Substring(1)
        Dim NewRuta, cNewRuta As String : Dim cRuta() As String = Ruta.Split("\") : Dim Contador As Integer = cRuta.Length - 3
Repite: NewRuta = "" : For Cuenta = 0 To Math.Max(Contador, 0) : NewRuta += cRuta(Cuenta) + "\" : Next
        cNewRuta = NewRuta : NewRuta += "...\" + cRuta(cRuta.Length - 2) + "\" + cRuta(cRuta.Length - 1)
        If TextRenderer.MeasureText(NewRuta, New Font(Fuente.Name, Fuente.Size, FontStyle.Regular)).Width < Largo - 2 Then If NewRuta.Length = 2 Then Return NewRuta.Substring(0, 1).ToUpper + NewRuta.Substring(1) + "\" Else Return NewRuta.Substring(0, 1).ToUpper + NewRuta.Substring(1)
        If Contador > 0 Then Contador -= 1 : GoTo Repite
        NewRuta = cNewRuta : NewRuta += "...\" + cRuta(cRuta.Length - 1) : If NewRuta.Length = 2 Then Return NewRuta.Substring(0, 1).ToUpper + NewRuta.Substring(1) + "\" Else Return NewRuta.Substring(0, 1).ToUpper + NewRuta.Substring(1)
    End Function

#End Region

#Region " File Size "

    ' Da formato de texto a un tamaño de archivo
    Public Shared Function FileSize(FilePath As String) As String
        If IO.File.Exists(FilePath) = False Then Return "0 KB" Else Return FormatSize(My.Computer.FileSystem.GetFileInfo(FilePath).Length)
    End Function

    Public Shared Function FormatSize(TheSize As Long, Optional ShowBytes As Boolean = False) As String
        Try : Select Case TheSize
                Case Is >= 1099511627776 'TB
                    Return FormatNumber(TheSize / 1099511627776, 2) & " TB"
                Case 1073741824 To 1099511627775 'GB
                    Return FormatNumber(TheSize / 1073741824, 2) & " GB"
                Case 1048576 To 1073741823 'MB
                    Return FormatNumber(TheSize / 1048576, 1) & " MB"
                Case 1024 To 1048575 'KB
                    Return FormatNumber(TheSize / 1024, 0) & " KB"
                Case 1 To 1023 ' bytes
                    If ShowBytes = True Then Return FormatNumber(TheSize, 0) & " bytes" Else Return "0 KB"
            End Select
        Catch : End Try : Return "0 KB"
    End Function

#End Region

#Region " Font Size "

    ' Ajusta el tamaño de la fuente de un texto para que entre en un control
    Public Shared Sub SetFontSize(ByRef Control As Object, Optional MaxFontSize As Single = 0, Optional MinFontSize As Single = 5)
        If MaxFontSize = 0 Then MaxFontSize = Control.Font.Size
        Dim TextSize As Integer = MaxFontSize : Dim Fuente As Font = Control.Font : Dim Height As Integer = Control.Height
        Do Until TextRenderer.MeasureText(Control.Text, New Font(Fuente.Name, TextSize, FontStyle.Regular)).Width < Control.Width Or TextSize <= MinFontSize : TextSize -= 1 : Loop
        If TextSize < MinFontSize Then TextSize = MinFontSize
        Control.Font = New Font(Fuente.Name, TextSize, FontStyle.Regular) : Control.Height = Height
    End Sub

    ' Obtiene el tamaño de un texto en base a su fuente
    Public Shared Function GetTextSize(Control As Object) As Size
        Return New Size(TextRenderer.MeasureText(Control.Text, Control.Font).Width, TextRenderer.MeasureText(Control.Text, Control.Font).Height)
    End Function

    Public Shared Function GetTextSize(Texto As String, Fuente As Font) As Size
        Return New Size(TextRenderer.MeasureText(Texto, Fuente).Width, TextRenderer.MeasureText(Texto, Fuente).Height)
    End Function

    Public Shared Function GetTextSize(Texto As String, FontName As String, FontSize As Single, Optional FontStyle As FontStyle = FontStyle.Regular) As Size
        Return New Size(TextRenderer.MeasureText(Texto, New Font(FontName, FontSize, FontStyle)).Width, TextRenderer.MeasureText(Texto, New Font(FontName, FontSize, FontStyle)).Height)
    End Function

#End Region

End Class

#End Region

#Region " Internet "

Public Class Internet

#Region " Firewall "

    Public Shared Sub Firewall_AddRule(Name As String, Application_Name As String, Optional Description As String = "")
        Try
            Dim tNetFwPolicy2 As Type = Type.GetTypeFromProgID("HNetCfg.FwPolicy2")
            Dim fwPolicy2 As NetFwTypeLib.INetFwPolicy2 = CType(Activator.CreateInstance(tNetFwPolicy2), NetFwTypeLib.INetFwPolicy2)
            Dim CurrentProfiles = fwPolicy2.CurrentProfileTypes
            Dim RuleList As New List(Of NetFwTypeLib.INetFwRule)()
            Dim FirewallPolicy As NetFwTypeLib.INetFwPolicy2 = CType(Activator.CreateInstance(Type.GetTypeFromProgID("HNetCfg.FwPolicy2")), NetFwTypeLib.INetFwPolicy2)
            For Each Rule As NetFwTypeLib.INetFwRule In fwPolicy2.Rules
                If Rule.Name.IndexOf(Name) <> -1 AndAlso Rule.ApplicationName = Application_Name Then Exit Sub
            Next
            Dim FirewallRule As NetFwTypeLib.INetFwRule = CType(Activator.CreateInstance(Type.GetTypeFromProgID("HNetCfg.FWRule")), NetFwTypeLib.INetFwRule)
            FirewallRule.Name = Name
            FirewallRule.Action = NetFwTypeLib.NET_FW_ACTION_.NET_FW_ACTION_ALLOW
            FirewallRule.Description = Description
            FirewallRule.Direction = NetFwTypeLib.NET_FW_RULE_DIRECTION_.NET_FW_RULE_DIR_IN
            FirewallRule.Enabled = True
            FirewallRule.ApplicationName = Application_Name
            FirewallPolicy.Rules.Add(FirewallRule)
        Catch : End Try
    End Sub

    Public Shared Sub Firewall_RemoveRule(Name As String, Optional Application_Name As String = "")
        Try
            Dim tNetFwPolicy2 As Type = Type.GetTypeFromProgID("HNetCfg.FwPolicy2")
            Dim fwPolicy2 As NetFwTypeLib.INetFwPolicy2 = CType(Activator.CreateInstance(tNetFwPolicy2), NetFwTypeLib.INetFwPolicy2)
            Dim CurrentProfiles = fwPolicy2.CurrentProfileTypes
            Dim RuleList As New List(Of NetFwTypeLib.INetFwRule)()
            Dim FirewallPolicy As NetFwTypeLib.INetFwPolicy2 = CType(Activator.CreateInstance(Type.GetTypeFromProgID("HNetCfg.FwPolicy2")), NetFwTypeLib.INetFwPolicy2)
            For Each Rule As NetFwTypeLib.INetFwRule In fwPolicy2.Rules
                If Application_Name <> "" Then
                    If Rule.Name.IndexOf(Name) <> -1 AndAlso Rule.ApplicationName = Application_Name Then FirewallPolicy.Rules.Remove(Rule.Name)
                Else
                    If Rule.Name.IndexOf(Name) <> -1 Then FirewallPolicy.Rules.Remove(Rule.Name)
                End If
            Next
        Catch : End Try
    End Sub

    Public Shared Function Firewall_CheckRule(Name As String, Application_Name As String) As Boolean
        Try
            Dim tNetFwPolicy2 As Type = Type.GetTypeFromProgID("HNetCfg.FwPolicy2")
            Dim fwPolicy2 As NetFwTypeLib.INetFwPolicy2 = CType(Activator.CreateInstance(tNetFwPolicy2), NetFwTypeLib.INetFwPolicy2)
            Dim CurrentProfiles = fwPolicy2.CurrentProfileTypes
            Dim RuleList As New List(Of NetFwTypeLib.INetFwRule)()
            Dim FirewallPolicy As NetFwTypeLib.INetFwPolicy2 = CType(Activator.CreateInstance(Type.GetTypeFromProgID("HNetCfg.FwPolicy2")), NetFwTypeLib.INetFwPolicy2)
            For Each Rule As NetFwTypeLib.INetFwRule In fwPolicy2.Rules
                If Rule.Name.IndexOf(Name) <> -1 AndAlso Rule.ApplicationName = Application_Name Then Return True
            Next
        Catch : End Try : Return False
    End Function

#End Region

#Region " Is Connected  "

    ' Comprueba si el equipo está conectado a Internet
    Public Shared Function IsConnectedToInternet() As Boolean
        ' Obtiene una lista de interfaces de red disponibles
        Dim interfaces As Net.NetworkInformation.NetworkInterface() = Net.NetworkInformation.NetworkInterface.GetAllNetworkInterfaces()
        ' Recorre cada interfaz de red disponible
        For Each ni As Net.NetworkInformation.NetworkInterface In interfaces
            ' Si la interfaz está disponible y conectada, intenta resolver una dirección IP a partir de un nombre de host
            If ni.OperationalStatus = System.Net.NetworkInformation.OperationalStatus.Up AndAlso ni.NetworkInterfaceType <> Net.NetworkInformation.NetworkInterfaceType.Loopback Then
                Try
                    ' Intentao resolver una dirección IP a partir de un nombre de host
                    Dim ipAddresses As Net.IPAddress() = Net.Dns.GetHostAddresses("www.google.com")
                    ' Si se ha podido resolver al menos una dirección IP, devuelve True y sale de la función
                    If ipAddresses.Length > 0 Then Return True
                Catch
                    ' Si ha habido algún error al intentar resolver la dirección IP, continúa con la siguiente interfaz de red
                    Continue For
                End Try
            End If
        Next
        ' Si no se ha encontrado ninguna interfaz de red disponible y conectada, devuelve False
        Return False
    End Function

#End Region

#Region " Validar Web "

    Public Shared Function ValidarWeb(URL As String) As String
        If URL.ToLower.StartsWith("www.") = True Then URL = "http://" + Replace(URL, "www.", "", 1, -1, vbTextCompare)
        If URL.ToLower.StartsWith("https://") = False And URL.ToLower.StartsWith("http://") = False Then If ValidarURL(URL) = True Then URL = "http://" + URL
        If URL.ToLower.StartsWith("https://") = True Or URL.ToLower.StartsWith("http://") = True Then If URL.EndsWith("/") Then URL = URL.Substring(0, URL.Length - 1)
        URL = Replace(URL, "http://", "http://", 1, -1, vbTextCompare)
        URL = Replace(URL, "https://", "https://", 1, -1, vbTextCompare)
        URL = Replace(URL, "http://www.", "http://", 1, -1, vbTextCompare)
        URL = Replace(URL, "https://www.", "https://", 1, -1, vbTextCompare)
        URL = Replace(URL, "ftp://", "ftp://", 1, -1, vbTextCompare)
        Return URL
    End Function

#End Region

#Region " Validar URL "

    Public Shared Function ValidarURL(URL As String) As Boolean
        ' Dim Extensiones As New List(Of String) From {".com", ".org", ".net", ".info", ".ac", ".ad", ".ae", ".af", ".ag", ".ai", ".al", ".am", ".an", ".ao", ".aq", ".ar", ".as", ".at", ".au", ".aw", ".ax", ".az", ".ba", ".bb", ".bd", ".be", ".bf", ".bg", ".bh", ".bi", ".bj", ".bl", ".bm", ".bn", ".bo", ".br", ".bq", ".bs", ".bt", ".bv", ".bw", ".by", ".bz", ".ca", ".cc", ".cd", ".cf", ".cg", ".ch", ".ci", ".ck", ".cl", ".cm", ".cn", ".co", ".cr", ".cs", ".cu", ".cv", ".cw", ".cx", ".cy", ".cz", ".dd", ".de", ".dj", ".dk", ".dm", ".do", ".dz", ".ec", ".ee", ".eg", ".eh", ".er", ".es", ".et", ".eu", ".fi", ".fj", ".fk", ".fm", ".fo", ".fr", ".ga", ".gb", ".gd", ".ge", ".gf", ".gg", ".gh", ".gi", ".gl", ".gm", ".gn", ".gp", ".gq", ".gr", ".gs", ".gt", ".gu", ".gw", ".gy", ".hk", ".hm", ".hn", ".hr", ".ht", ".hu", ".id", ".ie", ".il", ".im", ".in", ".io", ".iq", ".ir", ".is", ".it", ".je", ".jm", ".jo", ".jp", ".ke", ".kg", ".kh", ".ki", ".km", ".kn", ".kp", ".kr", ".kw", ".ky", ".kz", ".la", ".lb", ".lc", ".li", ".lk", ".lr", ".ls", ".lt", ".lu", ".lv", ".ly", ".ma", ".mc", ".md", ".me", ".mf", ".mg", ".mh", ".mk", ".ml", ".mm", ".mn", ".mo", ".mp", ".mq", ".mr", ".ms", ".mt", ".mu", ".mv", ".mw", ".mx", ".my", ".mz", ".na", ".nc", ".ne", ".nf", ".ng", ".ni", ".nl", ".no", ".np", ".nr", ".nu", ".nz", ".om", ".pa", ".pe", ".pf", ".pg", ".ph", ".pk", ".pl", ".pm", ".pn", ".pr", ".ps", ".pt", ".pw", ".py", ".qa", ".re", ".ro", ".rs", ".ru", ".rw", ".sa", ".sb", ".sc", ".sd", ".se", ".sg", ".sh", ".si", ".sj", ".sk", ".sl", ".sm", ".sn", ".so", ".sr", ".ss", ".st", ".su", ".sv", ".sx", ".sy", ".sz", ".tc", ".td", ".tf", ".tg", ".th", ".tj", ".tk", ".tl", ".tm", ".tn", ".to", ".tp", ".tr", ".tt", ".tv", ".tw", ".tz", ".ua", ".ug", ".uk", ".um", ".us", ".uy", ".uz", ".va", ".vc", ".ve", ".vg", ".vi", ".vn", ".vu", ".wf", ".ws", ".ye", ".yt", ".yu", ".za", ".zm", ".zr", ".zw"}
        ' Verifica si la cadena de texto tiene un formato válido para una URL
        URL = URL.Replace("www.", "") : If Not URL.Contains("://") Then URL = "http://" + URL
        ' Devuelve True si es una URL válida o False si no lo es
        Return Text.RegularExpressions.Regex.IsMatch(URL, "^(http|https)://[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$")
    End Function

#End Region

End Class

#End Region

#Region " Registro "

Public Class Registro

#Region " SubKeys (carpetas) "

    ' Devuelve un array con los SubKeys (carpetas) de la ruta del registro indicada
    Public Shared Function GetRegKeyNames(SubKey As String) As String()
        Try : My.Computer.Registry.CurrentUser.CreateSubKey("Software\" + SubKey) : Using Reg = My.Computer.Registry.CurrentUser.OpenSubKey("Software\" + SubKey, True)
                Return Reg.GetSubKeyNames : End Using
        Catch : Return New String(0) {} : End Try
    End Function

    ' Elimina el SubKey (carpeta) de la ruta del registro indicada
    Public Shared Sub DelReg(SubKey As String)
        Try : My.Computer.Registry.CurrentUser.DeleteSubKeyTree("Software\" + SubKey, False)
        Catch : End Try
    End Sub

#End Region

#Region " ValueNames (archivos) "

    ' Devuelve un array con los ValueNames (archivos) de la ruta del registro indicada
    Public Shared Function GetRegValueNames(SubKey As String) As String()
        Try : My.Computer.Registry.CurrentUser.CreateSubKey("Software\" + SubKey) : Using Reg = My.Computer.Registry.CurrentUser.OpenSubKey("Software\" + SubKey, True)
                Return Reg.GetValueNames : End Using
        Catch : Return New String(0) {} : End Try
    End Function

    ' Devuelve el valor del ValueName (archivo) de la ruta del registro indicada
    Public Shared Function GetRegKey(SubKey As String, Name As String, Optional DefaultValue As String = "") As String
        Try : My.Computer.Registry.CurrentUser.CreateSubKey("Software\" + SubKey) : Using Reg = My.Computer.Registry.CurrentUser.OpenSubKey("Software\" + SubKey, True)
                If Reg.GetValue(Name) = "" Then Reg.SetValue(Name, DefaultValue)
                Return Reg.GetValue(Name) : End Using
        Catch : Return "" : End Try
    End Function

    ' Establece el valor del ValueName (archivo) de la ruta del registro indicada
    Public Shared Sub SetRegKey(SubKey As String, Name As String, Value As String)
        Try : My.Computer.Registry.CurrentUser.CreateSubKey("Software\" + SubKey) : Using Reg = My.Computer.Registry.CurrentUser.OpenSubKey("Software\" + SubKey, True)
                Reg.SetValue(Name, Value) : End Using
        Catch : End Try
    End Sub

    ' Elimina el ValueName (archivo) de la ruta del registro indicada
    Public Shared Sub DelRegKey(SubKey As String, Name As String)
        Try : My.Computer.Registry.CurrentUser.CreateSubKey("Software\" + SubKey) : Using Reg = My.Computer.Registry.CurrentUser.OpenSubKey("Software\" + SubKey, True)
                Reg.DeleteValue(Name, False) : End Using
        Catch : End Try
    End Sub

#End Region

#Region " Iniciar con Windows "

    ' Registra la aplicacion para que se inicie con Windows
    Public Shared Sub Registrar(Optional Nombre As String = "KDesktop", Optional Ruta As String = "")
        If Nombre = "" Then Nombre = Application.ProductName
        If Ruta = "" Then Ruta = Application.ExecutablePath
        Try : Using Reg = My.Computer.Registry.LocalMachine.CreateSubKey("Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Run", True) : Reg.SetValue(Nombre, Ruta) : End Using
        Catch : End Try
    End Sub

    'Elimina del registro la aplicacion para que no se inicie con Windows
    Public Shared Sub DesRegistrar(Optional Nombre As String = "KDesktop")
        If Nombre = "" Then Nombre = Application.ProductName
        If My.Computer.Registry.LocalMachine.CreateSubKey("Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Run", True).GetValue(Nombre) Is Nothing Then Exit Sub
        Try : Using Reg = My.Computer.Registry.LocalMachine.CreateSubKey("Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Run", True) : Reg.DeleteValue(Nombre) : End Using
        Catch : End Try
    End Sub

#End Region

End Class

#End Region

#Region " Logros y Estadisticas "

#Region " Logros "

Public Class Logros

#Region " Variables "

#Region " Estructuras "

    Structure LogroST
        Dim Nombre As String
        Dim Texto As String
        Dim Imagen As Image
        Dim MaxValue As Integer
        Dim Tipo As String
        Dim Oculto As Boolean
        Dim Desbloqueado As Boolean
        Dim Fecha As String
        Dim Ignorar As Boolean
    End Structure

#End Region

    Public Shared Logros() As LogroST
    Public Shared Check_Logros, Logro_Serial, NotificacionesLogros As Boolean

    Private Shared RegPath As String

#End Region

#Region " Cargar "

    Public Shared Sub Cargar(cRegPath As String)
        RegPath = cRegPath
        NotificacionesLogros = CBool(Registro.GetRegKey(RegPath + "\Opciones", "LogrosNotif", "True"))
        Dim Contador As Integer
        Contador = Logros_Comandos(Contador)
        Contador = Logros_Acciones(Contador)
        Contador = Logros_KBoard(Contador)
        Contador = Logros_QuickMenu(Contador)
        Contador = Logros_ComandoRemoto(Contador)
        Contador = Logros_ApagarEquipo(Contador)
        Contador = Logros_VaciarPapelera(Contador)
        Contador = Logros_Macros(Contador)
        Contador = Logros_Aplicaciones(Contador)
        Contador = Logros_PaginaWeb(Contador)
        Contador = Logros_Carpetas(Contador)
        Contador = Logros_CapturarPantalla(Contador)
        Contador = Logros_GrabarPantalla(Contador)
        Contador = Logros_GrabarAudio(Contador)
        Contador = Logros_EnviarTelegram(Contador)
        Contador = Logros_EjecutarBAT(Contador)
        Contador = Logros_ArchivosOcultos(Contador)
        Contador = Logros_DesactivarEn(Contador)
        Contador = Logros_Iconos(Contador)
        Contador = Logros_TopMost(Contador)
        Contador = Logros_SalidaAudio(Contador)
        Contador = Logros_TiempoUso(Contador)
        Contador = Logros_AccionesIndividuales(Contador)
        Logros_Varios(Contador)
    End Sub

#Region " Comandos "

    Private Shared Function Logros_Comandos(Contador As Integer) As Integer
        '   Crear Comandos
        ReDim Logros(Contador)
        Logros(Contador).Nombre = "Que empiece la fiesta"
        Logros(Contador).Texto = "Crea tu primer comando"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Que no pare la fiesta"
        Logros(Contador).Texto = "Crea 10 comandos"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "¡¡¡ Fiestero !!!"
        Logros(Contador).Texto = "Crea 100 comandos"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        '   Eliminar Comandos
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "No lo necesito"
        Logros(Contador).Texto = "Elimina un comando"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Me sobran"
        Logros(Contador).Texto = "Elimina 10 comandos"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        '   Ejecutar Comando
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "¡¡¡ Esto funciona !!!"
        Logros(Contador).Texto = "Ejecuta tu primer comando"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Pillandole el truco"
        Logros(Contador).Texto = "Ejecuta 10 comandos"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "El pán de cada día"
        Logros(Contador).Texto = "Ejecuta 100 comandos"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Comandante"
        Logros(Contador).Texto = "Ejecuta 1000 comandos"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Acciones "

    Private Shared Function Logros_Acciones(Contador As Integer) As Integer
        '   Crear Acciones
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Chico de acción"
        Logros(Contador).Texto = "Crea tu primera acción"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Jóven de acción"
        Logros(Contador).Texto = "Crea 10 acciones"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Hombre de acción"
        Logros(Contador).Texto = "Crea 100 acciones"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        '   Eliminar Acciones
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Una acción menos"
        Logros(Contador).Texto = "Elimina una acción"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Acción... reacción"
        Logros(Contador).Texto = "Elimina 10 acciones"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        '   Ejecutar Acciones
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Paso a paso"
        Logros(Contador).Texto = "Ejecuta una acción"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Vamos al trote"
        Logros(Contador).Texto = "Ejecuta 10 acciones"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Al galope"
        Logros(Contador).Texto = "Ejecuta 100 acciones"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Jinete experto"
        Logros(Contador).Texto = "Ejecuta 1000 acciones"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " K-Board "

    Private Shared Function Logros_KBoard(Contador As Integer) As Integer
        '   Crear K-Board
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Aprendiz del teclado"
        Logros(Contador).Texto = "Crea tu primera K-Board"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Genio del Teclado"
        Logros(Contador).Texto = "Crea 10 K-Board"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        '   Eliminar K-Board
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Vuelta atras"
        Logros(Contador).Texto = "Elimina un K-Board"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "No sin mi teclado"
        Logros(Contador).Texto = "Elimina 10 K-Board"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        '   Ejecutar K-Board
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Mi nuevo teclado"
        Logros(Contador).Texto = "Ejecuta un K-Board"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Mi teclado, mis normas"
        Logros(Contador).Texto = "Ejecuta 10 K-Board"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Adicto al teclado"
        Logros(Contador).Texto = "Ejecuta 100 K-Board"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " QuickMenu "

    Private Shared Function Logros_QuickMenu(Contador As Integer) As Integer
        '   Crear QuickMenu
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Rapidito y gruñon"
        Logros(Contador).Texto = "Crea tu primer QuickMenu"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Fast and Furious"
        Logros(Contador).Texto = "Crea 10 QuickMenus"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        '   Eliminar QuickMenu
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Uno menus... digo, uno menos"
        Logros(Contador).Texto = "Elimina un QuickMenu"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "No más menus"
        Logros(Contador).Texto = "Elimina 10 QuickMenus"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        '   Abrir QuickMenu
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Me gusta"
        Logros(Contador).Texto = "Abre un QuickMenu"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Me encanta"
        Logros(Contador).Texto = "Abre 10 QuickMenus"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Esto es lo más"
        Logros(Contador).Texto = "Abre 100 QuickMenus"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Profesional del Menu"
        Logros(Contador).Texto = "Abre 1000 QuickMenus"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Comando Remoto "

    Private Shared Function Logros_ComandoRemoto(Contador As Integer) As Integer
        '   Ejecutar Comandos Remotos
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Hacker"
        Logros(Contador).Texto = "Ejecuta un comando remoto"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Vago de sofá"
        Logros(Contador).Texto = "Ejecuta 10 comandos remotos"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Vagancia extrema"
        Logros(Contador).Texto = "Ejecuta 100 comandos remotos"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Apagar Equipo "

    Private Shared Function Logros_ApagarEquipo(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Shutdown"
        Logros(Contador).Texto = "Apaga el equipo desde K-Desktop"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Corte eléctrico"
        Logros(Contador).Texto = "Apaga el equipo desde K-Desktop 10 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Corto-Circuíto"
        Logros(Contador).Texto = "Apaga el equipo desde K-Desktop 100 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Vaciar Papelera "

    Private Shared Function Logros_VaciarPapelera(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Un poco de limpieza"
        Logros(Contador).Texto = "Vacia la papelera"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Barrendero"
        Logros(Contador).Texto = "Vacia la papelera 10 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Basurero novato"
        Logros(Contador).Texto = "Vacia la papelera 100 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Basurero profesional"
        Logros(Contador).Texto = "Vacia la papelera 1000 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Macros "

    Private Shared Function Logros_Macros(Contador As Integer) As Integer
        'Grabar Macro
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Repite conmigo"
        Logros(Contador).Texto = "Graba una macro"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Usuario experto"
        Logros(Contador).Texto = "Graba 10 macros"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        'Ejecutar Macro
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Mira maná, sin manos"
        Logros(Contador).Texto = "Ejecuta una macro"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Autómata"
        Logros(Contador).Texto = "Ejecuta 10 macros"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Aplicaciones "

    Private Shared Function Logros_Aplicaciones(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Práctico"
        Logros(Contador).Texto = "Ejecuta una aplicación"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Aplicado"
        Logros(Contador).Texto = "Ejecuta 10 aplicaciones"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Trabajador"
        Logros(Contador).Texto = "Ejecuta 100 aplicaciones"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Obsesivo"
        Logros(Contador).Texto = "Ejecuta 1000 aplicaciones"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Pagina Web "

    Private Shared Function Logros_PaginaWeb(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Surfero"
        Logros(Contador).Texto = "Abre una páginas web"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Navegante"
        Logros(Contador).Texto = "Abre 10 páginas web"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Adicto a la web"
        Logros(Contador).Texto = "Abre 100 páginas web"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Carpetas "

    Private Shared Function Logros_Carpetas(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Oficinista"
        Logros(Contador).Texto = "Abre una carpeta"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Directivo"
        Logros(Contador).Texto = "Abre 10 carpetas"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Rey de las carpetas"
        Logros(Contador).Texto = "Abre 100 carpetas"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Capturar Pantalla "

    Private Shared Function Logros_CapturarPantalla(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Fue mi idea..."
        Logros(Contador).Texto = "Captura la pantalla"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Aficionado a la fotografía"
        Logros(Contador).Texto = "Captura la pantalla 10 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Fotógrafo"
        Logros(Contador).Texto = "Captura la pantalla 100 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Fotógrafo profesional"
        Logros(Contador).Texto = "Captura la pantalla 1000 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Grabar Pantalla "

    Private Shared Function Logros_GrabarPantalla(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Reportero"
        Logros(Contador).Texto = "Graba la pantalla"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Reportero profesional"
        Logros(Contador).Texto = "Graba la pantalla 10 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Grabar Audio "

    Private Shared Function Logros_GrabarAudio(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Oye lo que digo"
        Logros(Contador).Texto = "Graba audio por primera vez"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Música par tus oidos"
        Logros(Contador).Texto = "Realiza 10 grabaciones de audio"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Envia por Telegram "

    Private Shared Function Logros_EnviarTelegram(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Compártelo"
        Logros(Contador).Texto = "Envía algo por Telegram"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Lo mío es tuyo"
        Logros(Contador).Texto = "Envía algo por Telegram 10 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Mejor por Telegram"
        Logros(Contador).Texto = "Envía algo por Telegram 100 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Bye bye... WhatsApp"
        Logros(Contador).Texto = "Envía algo por Telegram 1000 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Ejecutar BAT "

    Private Shared Function Logros_EjecutarBAT(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "BAT-Boy"
        Logros(Contador).Texto = "Ejecuta una accion BAT"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "BAT-Man"
        Logros(Contador).Texto = "Ejecuta 10 acciones BAT"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Archivos Ocultos "

    Private Shared Function Logros_ArchivosOcultos(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Nada se me escapa"
        Logros(Contador).Texto = "Muestra u oculta los archivos ocultos por primera vez"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Ocultista"
        Logros(Contador).Texto = "Muestra u oculta los archivos ocultos 10 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Sauron"
        Logros(Contador).Texto = "Muestra u oculta los archivos ocultos 100 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Desactivar en "

    Private Shared Function Logros_DesactivarEn(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Aquí no, por favor"
        Logros(Contador).Texto = "Usa 'Desactivar en' por primera vez"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Tikis Mikis"
        Logros(Contador).Texto = "Usa 'Desactivar en' 10 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Desactivador profesional"
        Logros(Contador).Texto = "Usa 'Desactivar en' 100 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Iconos "

    Private Shared Function Logros_Iconos(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "A mi gusto"
        Logros(Contador).Texto = "Modifica un icono"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Iconoclasta"
        Logros(Contador).Texto = "Modifica 10 iconos"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " TopMost "

    Private Shared Function Logros_TopMost(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Por encima de los demás"
        Logros(Contador).Texto = "Ejecuta la acción TopMost"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "No me ocultes"
        Logros(Contador).Texto = "Ejecuta la acción TopMost 10 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "El mas Top"
        Logros(Contador).Texto = "Ejecuta la acción TopMost 100 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Salida de Audio "

    Private Shared Function Logros_SalidaAudio(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Controlador del audio"
        Logros(Contador).Texto = "Cambia la salida de audio"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Maestro del audio"
        Logros(Contador).Texto = "Cambia la salida de audio 10 veces"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Tiempo de uso "

    Private Shared Function Logros_TiempoUso(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Usuario habitual"
        Logros(Contador).Texto = "Usa K-Desktop durante una semana"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Usuario fijo"
        Logros(Contador).Texto = "Usa K-Desktop durante un mes"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "¡¡¡ Cómo pasa el tiempo !!!"
        Logros(Contador).Texto = "Usa K-Desktop durante un año"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Acciones Individuales "

    Private Shared Function Logros_AccionesIndividuales(Contador As Integer) As Integer
        'Aplicaciones
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 1"
        Logros(Contador).Texto = "Ejecuta la acción 'Ejecutar Aplicación'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 2"
        Logros(Contador).Texto = "Ejecuta la acción 'Página Web'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 3"
        Logros(Contador).Texto = "Ejecuta la acción 'Abrir Carpeta'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 4"
        Logros(Contador).Texto = "Ejecuta la acción 'Aplicaciones'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 5"
        Logros(Contador).Texto = "Ejecuta la acción 'Ejecutar BAT'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        'Audio y Video
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 6"
        Logros(Contador).Texto = "Ejecuta la acción 'Capturar Pantalla'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 7"
        Logros(Contador).Texto = "Ejecuta la acción 'Grabar Pantalla'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 8"
        Logros(Contador).Texto = "Ejecuta la acción 'Grabar Audio'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 9"
        Logros(Contador).Texto = "Ejecuta la acción 'Salida de Audio'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 10"
        Logros(Contador).Texto = "Ejecuta la acción 'Reproducir Sonido'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 11"
        Logros(Contador).Texto = "Ejecuta la acción 'Volumen'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        'Utilidades
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 12"
        Logros(Contador).Texto = "Ejecuta la acción 'Red Ad-Hoc'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 13"
        Logros(Contador).Texto = "Ejecuta la acción 'K-Board'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 14"
        Logros(Contador).Texto = "Ejecuta la acción 'Macros'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 15"
        Logros(Contador).Texto = "Ejecuta la acción 'QuickMenu'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        'Acciones
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 16"
        Logros(Contador).Texto = "Ejecuta la acción 'Enviar Pulsación'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 17"
        Logros(Contador).Texto = "Ejecuta la acción 'TopMost'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 18"
        Logros(Contador).Texto = "Ejecuta la acción 'Internet'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 19"
        Logros(Contador).Texto = "Ejecuta la acción 'Archivos Ocultos'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 20"
        Logros(Contador).Texto = "Ejecuta la acción 'Desactivar en'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 21"
        Logros(Contador).Texto = "Ejecuta la acción 'Esperar'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 22"
        Logros(Contador).Texto = "Ejecuta la acción 'Mostrar Mensaje'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 23"
        Logros(Contador).Texto = "Ejecuta la acción 'Apagar Equipo'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Accionista 24"
        Logros(Contador).Texto = "Ejecuta la acción 'Comandos'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#Region " Varios "

    Private Shared Function Logros_Varios(Contador As Integer) As Integer
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Completista"
        Logros(Contador).Texto = "Ejecuta todos los tipos de acción"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Usuario Registrado"
        Logros(Contador).Texto = "Registra una licencia de K-Desktop"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Tomad ejemplo"
        Logros(Contador).Texto = "Cambia el icono de K-Desktop"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Bienvenidos a K-Desktop"
        Logros(Contador).Texto = "Inicia K-Desktop por primera vez"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "¡¡Really!!"
        Logros(Contador).Texto = "Desbloquea tu primer logro"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Arqueologo de los mensajes"
        Logros(Contador).Texto = "Encuentra 'Acerca de'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Emigrante"
        Logros(Contador).Texto = "Exporta los datos de K-Desktop"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Inmigrante"
        Logros(Contador).Texto = "Importa los datos de K-Desktop"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "¿Andas perdido?"
        Logros(Contador).Texto = "Abre la ayuda de K-Desktop"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Quick-Opener"
        Logros(Contador).Texto = "Abre K-Desktop desde un QuickMenu"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Tengo curiosidad"
        Logros(Contador).Texto = "Abre la carpeta de K-Desktop"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Especialista del enlace"
        Logros(Contador).Texto = "Crea un enlace especial K-Link"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Red abierta"
        Logros(Contador).Texto = "Crea una red Ad-Hoc"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Multifacético"
        Logros(Contador).Texto = "Ejecuta un comando con 5 o más acciones"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Personalizador del audio"
        Logros(Contador).Texto = "Ejecuta un sonido desde un archivo 'WAV'"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Aficionado al DOS"
        Logros(Contador).Texto = "Ejecuta tu primer comando CMD"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Profesional del DOS"
        Logros(Contador).Texto = "Ejecuta 10 comandos CMD"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Contador += 1 : ReDim Preserve Logros(Contador)
        Logros(Contador).Nombre = "Maestro de K-Desktop"
        Logros(Contador).Texto = "Desbloquea todos los logros"
        Logros(Contador).Imagen = My.Resources.Logro_Imagen
        Logros(Contador).Tipo = "Normal"
        Logros(Contador).Oculto = False
        Logros(Contador).Desbloqueado = Comprobar_Desbloqueado(Logros(Contador).Nombre)
        Return Contador
    End Function

#End Region

#End Region

#Region " Reset "

    Public Shared Sub Reset()
        For Cuenta = 0 To Logros.Length - 1
            Logros(Cuenta).Desbloqueado = False
            Registro.SetRegKey(RegPath + "\Logros", Simple_Encrypt(Logros(Cuenta).Nombre), Logro_RND(False))
            Registro.DelRegKey(RegPath + "\Logros", Simple_Encrypt(Logros(Cuenta).Nombre + "d"))
        Next : Actualizar()
    End Sub

#End Region

#Region " Comprobar "

    Public Shared Sub Comprobar()
        Dim Logro As String
        'Comandos
        Logro = "Que empiece la fiesta" : If Estadisticas.Estadisticas.Comandos_Creados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Que no pare la fiesta" : If Estadisticas.Estadisticas.Comandos_Creados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "¡¡¡ Fiestero !!!" : If Estadisticas.Estadisticas.Comandos_Creados >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "No lo necesito" : If Estadisticas.Estadisticas.Comandos_Eliminados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Me sobran" : If Estadisticas.Estadisticas.Comandos_Eliminados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "¡¡¡ Esto funciona !!!" : If Estadisticas.Estadisticas.Comandos_Ejecutados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Pillandole el truco" : If Estadisticas.Estadisticas.Comandos_Ejecutados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "El pán de cada día" : If Estadisticas.Estadisticas.Comandos_Ejecutados >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Comandante" : If Estadisticas.Estadisticas.Comandos_Ejecutados >= 1000 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Acciones
        Logro = "Chico de acción" : If Estadisticas.Estadisticas.Acciones_Creadas >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Jóven de acción" : If Estadisticas.Estadisticas.Acciones_Creadas >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Hombre de acción" : If Estadisticas.Estadisticas.Acciones_Creadas >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Una acción menos" : If Estadisticas.Estadisticas.Acciones_Eliminadas >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Acción... reacción" : If Estadisticas.Estadisticas.Acciones_Eliminadas >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Paso a paso" : If Estadisticas.Estadisticas.Acciones_Ejecutadas >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Vamos al trote" : If Estadisticas.Estadisticas.Acciones_Ejecutadas >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Al galope" : If Estadisticas.Estadisticas.Acciones_Ejecutadas >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Jinete experto" : If Estadisticas.Estadisticas.Acciones_Ejecutadas >= 1000 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'K-Board
        Logro = "Aprendiz del teclado" : If Estadisticas.Estadisticas.KBoard_Creados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Genio del Teclado" : If Estadisticas.Estadisticas.KBoard_Creados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Vuelta atras" : If Estadisticas.Estadisticas.KBoard_Eliminados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "No sin mi teclado" : If Estadisticas.Estadisticas.KBoard_Eliminados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Mi nuevo teclado" : If Estadisticas.Estadisticas.KBoard_Ejecutados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Mi teclado, mis normas" : If Estadisticas.Estadisticas.KBoard_Ejecutados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Adicto al teclado" : If Estadisticas.Estadisticas.KBoard_Ejecutados >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'QuickMenu
        Logro = "Rapidito y gruñon" : If Estadisticas.Estadisticas.QuickMenus_Creados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Fast and Furious" : If Estadisticas.Estadisticas.QuickMenus_Creados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Uno menus... digo, uno menos" : If Estadisticas.Estadisticas.QuickMenus_Eliminados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "No más menus" : If Estadisticas.Estadisticas.QuickMenus_Eliminados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Me gusta" : If Estadisticas.Estadisticas.QuickMenus_Abiertos >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Me encanta" : If Estadisticas.Estadisticas.QuickMenus_Abiertos >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Esto es lo más" : If Estadisticas.Estadisticas.QuickMenus_Abiertos >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Profesional del Menu" : If Estadisticas.Estadisticas.QuickMenus_Abiertos >= 1000 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Comando Remoto
        Logro = "Hacker" : If Estadisticas.Estadisticas.Comandos_UDP >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Vago de sofá" : If Estadisticas.Estadisticas.Comandos_UDP >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Vagancia extrema" : If Estadisticas.Estadisticas.Comandos_UDP >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        ' Apagar Equipo
        Logro = "Shutdown" : If Estadisticas.Estadisticas.Apagado_Equipo >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Corte eléctrico" : If Estadisticas.Estadisticas.Apagado_Equipo >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Corto-Circuito" : If Estadisticas.Estadisticas.Apagado_Equipo >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Vaciar Papelera
        Logro = "Un poco de limpieza" : If Estadisticas.Estadisticas.Papelera_Vaciada >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Barrendero" : If Estadisticas.Estadisticas.Papelera_Vaciada >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Basurero novato" : If Estadisticas.Estadisticas.Papelera_Vaciada >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Basurero profesional" : If Estadisticas.Estadisticas.Papelera_Vaciada >= 1000 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Macros
        Logro = "Repite conmigo" : If Estadisticas.Estadisticas.Macros_Grabadas >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Usuario experto" : If Estadisticas.Estadisticas.Macros_Grabadas >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Mira maná, sin manos" : If Estadisticas.Estadisticas.Macros_Ejecutadas >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Autómata" : If Estadisticas.Estadisticas.Macros_Ejecutadas >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Aplicaciones
        Logro = "Práctico" : If Estadisticas.Estadisticas.Aplicaciones_Ejecutadas >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Aplicado" : If Estadisticas.Estadisticas.Aplicaciones_Ejecutadas >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Trabajador" : If Estadisticas.Estadisticas.Aplicaciones_Ejecutadas >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Obsesivo" : If Estadisticas.Estadisticas.Aplicaciones_Ejecutadas >= 1000 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Paginas Web
        Logro = "surfero" : If Estadisticas.Estadisticas.Paginas_Webs >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Navegante" : If Estadisticas.Estadisticas.Paginas_Webs >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Adicto a la web" : If Estadisticas.Estadisticas.Paginas_Webs >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Carpetas
        Logro = "Oficinista" : If Estadisticas.Estadisticas.Carpetas_Abiertas >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Directivo" : If Estadisticas.Estadisticas.Carpetas_Abiertas >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Rey de las carpetas" : If Estadisticas.Estadisticas.Carpetas_Abiertas >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Capturar Pantalla
        Logro = "Fue mi idea..." : If Estadisticas.Estadisticas.Capturas_Pantalla >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Aficionado a la fotografía" : If Estadisticas.Estadisticas.Capturas_Pantalla >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Fotógrafo" : If Estadisticas.Estadisticas.Capturas_Pantalla >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Fotógrafo profesional" : If Estadisticas.Estadisticas.Capturas_Pantalla >= 1000 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Grabar Pantalla
        Logro = "Reportero" : If Estadisticas.Estadisticas.Grabaciones_Pantalla >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Reportero profesional" : If Estadisticas.Estadisticas.Grabaciones_Pantalla >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Grabar Audio
        Logro = "Oye lo que digo" : If Estadisticas.Estadisticas.Grabaciones_Audio >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Música par tus oidos" : If Estadisticas.Estadisticas.Grabaciones_Audio >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Enviar por Telegram
        Logro = "Compártelo" : If Estadisticas.Estadisticas.Enviado_Telegram >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Lo mío es tuyo" : If Estadisticas.Estadisticas.Enviado_Telegram >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Mejor por Telegram" : If Estadisticas.Estadisticas.Enviado_Telegram >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Bye bye... WhatsApp" : If Estadisticas.Estadisticas.Enviado_Telegram >= 1000 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Ejecutar BAT
        Logro = "BAT-Boy" : If Estadisticas.Estadisticas.BAT_Ejecutados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "BAT-Man" : If Estadisticas.Estadisticas.BAT_Ejecutados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Iconos
        Logro = "A mi gusto" : If Estadisticas.Estadisticas.Iconos_Modificados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Iconoclasta" : If Estadisticas.Estadisticas.Iconos_Modificados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'TopMost
        Logro = "Por encima de los demás" : If Estadisticas.Estadisticas.TopMost_Ejecutados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "No me ocultes" : If Estadisticas.Estadisticas.TopMost_Ejecutados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "El mas Top" : If Estadisticas.Estadisticas.TopMost_Ejecutados >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Salida de Audio
        Logro = "Controlador del audio" : If Estadisticas.Estadisticas.Salidas_Audio >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Maestro del audio" : If Estadisticas.Estadisticas.Salidas_Audio >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'CMDs
        Logro = "Aficionado al DOS" : If Estadisticas.Estadisticas.CMD_Ejecutados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Profesional del DOS" : If Estadisticas.Estadisticas.CMD_Ejecutados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Archivos Ocultos
        Logro = "Nada se me escapa" : If Estadisticas.Estadisticas.Archivos_Ocultados >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Ocultista" : If Estadisticas.Estadisticas.Archivos_Ocultados >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Sauron" : If Estadisticas.Estadisticas.Archivos_Ocultados >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Desactivar en
        Logro = "Aquí no, por favor" : If Estadisticas.Estadisticas.DesactivadoEn >= 1 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Tikis Mikis" : If Estadisticas.Estadisticas.DesactivadoEn >= 10 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Desactivador profesional" : If Estadisticas.Estadisticas.DesactivadoEn >= 100 AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Timepo de uso
        Logro = "Usuario habitual" : If Now >= FMenu.KDesktop_Instalado.AddDays(7) AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "Usuario fijo" : If Now >= FMenu.KDesktop_Instalado.AddDays(30) AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        Logro = "¡¡¡ Cómo pasa el tiempo !!!" : If Now >= FMenu.KDesktop_Instalado.AddDays(365) AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Acciones Unicas
        Logro = "Completista" : Dim Contador As Integer : For Cuenta = 0 To FMenu.Comandos_Accion_CAccion.Items.Count - 1
            If FMenu.Comandos_Accion_CAccion.Items(Cuenta).ToString.Substring(0, 1) <> "@" Then Contador += 1
        Next : If Estadisticas.Estadisticas.Acciones_Unicas.ToString.Length >= Contador AndAlso Comprobar_Desbloqueado(Logro) = False Then Desbloquear(Logro)
        'Todos los Logros desbloqueados
        If Comprobar_Desbloqueado("Maestro de K-Desktop") = False Then
            For Cuenta = 0 To Logros.Length - 1
                If Logros(Cuenta).Nombre <> "Maestro de K-Desktop" AndAlso Logros(Cuenta).Desbloqueado = False Then Exit Sub
            Next : Desbloquear("Maestro de K-Desktop")
        End If
    End Sub

    Public Shared Function Comprobar_Desbloqueado(Nombre As String) As Boolean
        If Logros Is Nothing Then Return False
        For Cuenta = 0 To Logros.Length - 1
            If Logros(Cuenta).Nombre = Nombre Then
                Logros(Cuenta).Fecha = Registro.GetRegKey(RegPath + "\Logros", Simple_Encrypt(Logros(Cuenta).Nombre + "d"), "")
                If RND_Check(Registro.GetRegKey(RegPath + "\Logros", Simple_Encrypt(Logros(Cuenta).Nombre), Logro_RND(False))) = True Then Return True Else Return False
            End If
        Next : Return False
    End Function

    Private Shared Function RND_Check(Numero As String) As Boolean
        Dim cNumber As Integer = Numero.Substring(0, 1) : If cNumber = 9 Then cNumber = 8
        Dim mNumber As Integer = Numero.Substring(cNumber, 1)
        If mNumber Mod 2 = 0 Then Return True Else Return False
    End Function

    Private Shared Function Logro_RND(Optional Par As Boolean = True) As String
Repite: Randomize()
        Dim r As New Random(Int((100000000 * Rnd()) + 1))
        Dim Numero As Integer = r.Next(100000000, 999999999)
        Dim cNumber As Integer = Numero.ToString.Substring(0, 1) : If cNumber = 9 Then cNumber = 8
        Dim mNumber As Integer = Numero.ToString.Substring(cNumber, 1)
        If Par = True Then
            If mNumber Mod 2 = 0 Then Return Numero.ToString Else mNumber -= 1 : Return Numero.ToString.Substring(0, cNumber) + mNumber.ToString + Numero.ToString.Substring(cNumber + 1)
            'If Numero Mod 2 = 0 Then Return Numero.ToString Else Application.DoEvents() : GoTo Repite
        Else
            If mNumber Mod 2 <> 0 Then Return Numero.ToString Else mNumber += 1 : Return Numero.ToString.Substring(0, cNumber) + mNumber.ToString + Numero.ToString.Substring(cNumber + 1)
            'If Numero Mod 2 <> 0 Then Return Numero.ToString Else Application.DoEvents() : GoTo Repite
        End If
    End Function

#End Region

#Region " Actualizar "

    Public Shared Sub Actualizar()
        If FLogros.Visible = True Then FLogros.Actualizar_Logros()
    End Sub

#End Region

#Region " Desbloquear "

    Public Shared Sub Desbloquear(Nombre As String)
        If Logros Is Nothing Then Exit Sub
        For Cuenta = 0 To Logros.Length - 1
            If Logros(Cuenta).Nombre = Nombre Then
                Logros(Cuenta).Fecha = Registro.GetRegKey(RegPath + "\Logros", Simple_Encrypt(Logros(Cuenta).Nombre + "d"), "")
                If RND_Check(Registro.GetRegKey(RegPath + "\Logros", Simple_Encrypt(Logros(Cuenta).Nombre), Logro_RND(False))) = True Then Exit Sub
                If Nombre = "Usuario Registrado" AndAlso Logro_Serial = False Then Exit Sub
                Logros(Cuenta).Desbloqueado = True
                Registro.SetRegKey(RegPath + "\Logros", Simple_Encrypt(Logros(Cuenta).Nombre), Logro_RND)
                Logros(Cuenta).Fecha = Now.ToString("dd/MM/yyyy")
                Registro.SetRegKey(RegPath + "\Logros", Simple_Encrypt(Logros(Cuenta).Nombre + "d"), Logros(Cuenta).Fecha)
                Logro_Mostrar(Logros(Cuenta).Nombre, Logros(Cuenta).Texto, Logros(Cuenta).Imagen, 5000, 2500)
                If Comprobar_Desbloqueado("¡¡Really!!") = False Then Desbloquear("¡¡Really!!")
                Actualizar()
                Exit Sub
            End If
        Next
    End Sub

    Private Shared Sub Logro_Mostrar(Nombre As String, Texto As String, Imagen As Image, Optional Duracion As Integer = 5000, Optional Espera As Integer = 2500)
        If NotificacionesLogros = False Then Exit Sub
        Dim Notification As New FrmNotification(Duracion, Nombre, Imagen, Texto, Espera) : Notification.Show()
    End Sub

#End Region

#Region " Simple Encrypt / Decrypt "

    Private Shared arLetterChars() As Char = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890"
    Private Shared arEncryptedChars() As Char = "¿s¢çc‹i˜Ö´åÄÚKÍìæ¯~4Ûÿ5ÑûÏÉí³èô§ŠÀÙ9ÒÓ?þ.äƒ%*š¾†±HI2@Ã¦Œ,Ôuû^]·"

    Private Shared Function Simple_Encrypt(Texto As String) As String
        If Texto.Trim = "" Then Return ""
        For Each myTextBoxChar As Char In Texto
            For i As Integer = 0 To arLetterChars.Length - 1
                If myTextBoxChar = arLetterChars(i) Then Texto = Texto.Replace(myTextBoxChar, arEncryptedChars(i))
            Next
        Next : Return Texto
    End Function

    Private Shared Function Simple_Decrypt(Texto As String) As String
        If Texto.Trim = "" Then Return ""
        For Each myTextBoxChar As Char In Texto
            For i As Integer = 0 To arEncryptedChars.Length - 1
                If myTextBoxChar = arEncryptedChars(i) Then Texto = Texto.Replace(myTextBoxChar, arLetterChars(i))
            Next
        Next : Return Texto
    End Function

#End Region

End Class

#End Region

#Region " Estadisticas "

Public Class Estadisticas

#Region " Variables "

#Region " Estructuras "

    Structure EstadisticasST
        Dim Comandos_Creados As Integer
        Dim Comandos_Eliminados As Integer
        Dim Comandos_Ejecutados As Integer

        Dim Acciones_Creadas As Integer
        Dim Acciones_Eliminadas As Integer
        Dim Acciones_Ejecutadas As Integer

        Dim KBoard_Creados As Integer
        Dim KBoard_Eliminados As Integer
        Dim KBoard_Ejecutados As Integer

        Dim QuickMenus_Creados As Integer
        Dim QuickMenus_Eliminados As Integer
        Dim QuickMenus_Abiertos As Integer

        Dim KDesktop_Iniciado As Integer
        Dim Papelera_Vaciada As Integer
        Dim Apagado_Equipo As Integer
        Dim DesactivadoEn As Integer
        Dim Archivos_Ocultados As Integer
        Dim Capturas_Pantalla As Integer
        Dim Grabaciones_Pantalla As Integer
        Dim Grabaciones_Audio As Integer
        Dim Enviado_Telegram As Integer
        Dim Comandos_UDP As Integer
        Dim Acciones_Unicas As String
        Dim Sonidos_Reproducidos As Integer

        Dim Macros_Grabadas As Integer
        Dim Macros_Ejecutadas As Integer
        Dim CMD_Ejecutados As Integer
        Dim Aplicaciones_Ejecutadas As Integer
        Dim Paginas_Webs As Integer
        Dim Carpetas_Abiertas As Integer
        Dim BAT_Ejecutados As Integer
        Dim Salidas_Audio As Integer
        Dim TopMost_Ejecutados As Integer
        Dim Iconos_Modificados As Integer
    End Structure

#End Region

    Public Shared Estadisticas As EstadisticasST

    Private Shared RegPath As String

#End Region

#Region " Cargar "

    Public Shared Sub Cargar(cRegPath As String)
        RegPath = cRegPath
        Estadisticas.Comandos_Creados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Comandos_Creados"), Encrypt_Estadisticas_Value(Estadisticas.Comandos_Creados)))
        Estadisticas.Comandos_Eliminados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Comandos_Eliminados"), Encrypt_Estadisticas_Value(Estadisticas.Comandos_Eliminados)))
        Estadisticas.Comandos_Ejecutados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Comandos_Ejecutados"), Encrypt_Estadisticas_Value(Estadisticas.Comandos_Ejecutados)))

        Estadisticas.Acciones_Creadas = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Acciones_Creadas"), Encrypt_Estadisticas_Value(Estadisticas.Acciones_Creadas)))
        Estadisticas.Acciones_Eliminadas = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Acciones_Eliminadas"), Encrypt_Estadisticas_Value(Estadisticas.Acciones_Eliminadas)))
        Estadisticas.Acciones_Ejecutadas = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Acciones_Ejecutadas"), Encrypt_Estadisticas_Value(Estadisticas.Acciones_Ejecutadas)))

        Estadisticas.KBoard_Creados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("KBoard_Creados"), Encrypt_Estadisticas_Value(Estadisticas.KBoard_Creados)))
        Estadisticas.KBoard_Eliminados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("KBoard_Eliminados"), Encrypt_Estadisticas_Value(Estadisticas.KBoard_Eliminados)))
        Estadisticas.KBoard_Ejecutados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("KBoard_Ejecutados"), Encrypt_Estadisticas_Value(Estadisticas.KBoard_Ejecutados)))

        Estadisticas.QuickMenus_Creados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("QuickMenus_Creados"), Encrypt_Estadisticas_Value(Estadisticas.QuickMenus_Creados)))
        Estadisticas.QuickMenus_Eliminados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("QuickMenus_Eliminados"), Encrypt_Estadisticas_Value(Estadisticas.QuickMenus_Eliminados)))
        Estadisticas.QuickMenus_Abiertos = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("QuickMenus_Abiertos"), Encrypt_Estadisticas_Value(Estadisticas.QuickMenus_Abiertos)))

        Estadisticas.KDesktop_Iniciado = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("KDesktop_Iniciado"), Encrypt_Estadisticas_Value(Estadisticas.KDesktop_Iniciado)))
        Estadisticas.Papelera_Vaciada = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Papelera_Vaciada"), Encrypt_Estadisticas_Value(Estadisticas.Papelera_Vaciada)))
        Estadisticas.Apagado_Equipo = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Apagado_Equipo"), Encrypt_Estadisticas_Value(Estadisticas.Apagado_Equipo)))
        Estadisticas.Capturas_Pantalla = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Capturas_Pantalla"), Encrypt_Estadisticas_Value(Estadisticas.Capturas_Pantalla)))
        Estadisticas.Grabaciones_Pantalla = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Grabaciones_Pantalla"), Encrypt_Estadisticas_Value(Estadisticas.Grabaciones_Pantalla)))
        Estadisticas.Grabaciones_Audio = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Grabaciones_Audio"), Encrypt_Estadisticas_Value(Estadisticas.Grabaciones_Audio)))
        Estadisticas.Enviado_Telegram = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Enviado_Telegram"), Encrypt_Estadisticas_Value(Estadisticas.Enviado_Telegram)))
        Estadisticas.Comandos_UDP = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Comandos_UDP"), Encrypt_Estadisticas_Value(Estadisticas.Comandos_UDP)))
        Estadisticas.Acciones_Unicas = Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Acciones_Unicas"), "")

        Estadisticas.Macros_Grabadas = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Macros_Grabadas"), Encrypt_Estadisticas_Value(Estadisticas.Macros_Grabadas)))
        Estadisticas.Macros_Ejecutadas = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Macros_Ejecutadas"), Encrypt_Estadisticas_Value(Estadisticas.Macros_Ejecutadas)))
        Estadisticas.Sonidos_Reproducidos = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Sonidos_Reproducidos"), Encrypt_Estadisticas_Value(Estadisticas.Sonidos_Reproducidos)))
        Estadisticas.CMD_Ejecutados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("CMD_Ejecutados"), Encrypt_Estadisticas_Value(Estadisticas.CMD_Ejecutados)))

        Estadisticas.DesactivadoEn = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("DesactivadoEn"), Encrypt_Estadisticas_Value(Estadisticas.DesactivadoEn)))
        Estadisticas.Aplicaciones_Ejecutadas = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Aplicaciones_Ejecutadas"), Encrypt_Estadisticas_Value(Estadisticas.Aplicaciones_Ejecutadas)))
        Estadisticas.Paginas_Webs = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Paginas_Webs"), Encrypt_Estadisticas_Value(Estadisticas.Paginas_Webs)))
        Estadisticas.Carpetas_Abiertas = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Carpetas_Abiertas"), Encrypt_Estadisticas_Value(Estadisticas.Carpetas_Abiertas)))
        Estadisticas.BAT_Ejecutados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("BAT_Ejecutados"), Encrypt_Estadisticas_Value(Estadisticas.BAT_Ejecutados)))
        Estadisticas.Archivos_Ocultados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Archivos_Ocultados"), Encrypt_Estadisticas_Value(Estadisticas.Archivos_Ocultados)))
        Estadisticas.Salidas_Audio = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Salidas_Audio"), Encrypt_Estadisticas_Value(Estadisticas.Salidas_Audio)))
        Estadisticas.TopMost_Ejecutados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("TopMost_Ejecutados"), Encrypt_Estadisticas_Value(Estadisticas.TopMost_Ejecutados)))
        Estadisticas.Iconos_Modificados = Decrypt_Estadisticas_Value(Registro.GetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Iconos_Modificados"), Encrypt_Estadisticas_Value(Estadisticas.Iconos_Modificados)))

        'Logro_Comprobar()
    End Sub

    Private Shared Function Encrypt_Estadisticas_Value(Valor As Integer) As String
        Return "&H" + Hex(Valor).Replace("0", "d").Replace("1", "p").Replace("2", "v").Replace("3", "m").Replace("4", "q").Replace("5", "r").Replace("6", "y").Replace("7", "h").Replace("8", "g").Replace("9", "a")
    End Function

    Private Shared Function Decrypt_Estadisticas_Value(Valor As String) As Integer
        Try : Return Convert.ToInt32(Valor.Replace("&H", "").Replace("d", "0").Replace("p", "1").Replace("v", "2").Replace("m", "3").Replace("q", "4").Replace("r", "5").Replace("y", "6").Replace("h", "7").Replace("g", "8").Replace("a", "9"), 16)
        Catch : Return 0 : End Try
    End Function

#End Region

#Region " Guardar "

    Public Shared Sub Guardar()
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Comandos_Creados"), Encrypt_Estadisticas_Value(Estadisticas.Comandos_Creados))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Comandos_Eliminados"), Encrypt_Estadisticas_Value(Estadisticas.Comandos_Eliminados))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Comandos_Ejecutados"), Encrypt_Estadisticas_Value(Estadisticas.Comandos_Ejecutados))

        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Acciones_Creadas"), Encrypt_Estadisticas_Value(Estadisticas.Acciones_Creadas))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Acciones_Eliminadas"), Encrypt_Estadisticas_Value(Estadisticas.Acciones_Eliminadas))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Acciones_Ejecutadas"), Encrypt_Estadisticas_Value(Estadisticas.Acciones_Ejecutadas))

        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("KBoard_Creados"), Encrypt_Estadisticas_Value(Estadisticas.KBoard_Creados))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("KBoard_Eliminados"), Encrypt_Estadisticas_Value(Estadisticas.KBoard_Eliminados))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("KBoard_Ejecutados"), Encrypt_Estadisticas_Value(Estadisticas.KBoard_Ejecutados))

        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("QuickMenus_Creados"), Encrypt_Estadisticas_Value(Estadisticas.QuickMenus_Creados))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("QuickMenus_Eliminados"), Encrypt_Estadisticas_Value(Estadisticas.QuickMenus_Eliminados))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("QuickMenus_Abiertos"), Encrypt_Estadisticas_Value(Estadisticas.QuickMenus_Abiertos))

        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("KDesktop_Iniciado"), Encrypt_Estadisticas_Value(Estadisticas.KDesktop_Iniciado))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Papelera_Vaciada"), Encrypt_Estadisticas_Value(Estadisticas.Papelera_Vaciada))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Apagado_Equipo"), Encrypt_Estadisticas_Value(Estadisticas.Apagado_Equipo))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Capturas_Pantalla"), Encrypt_Estadisticas_Value(Estadisticas.Capturas_Pantalla))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Grabaciones_Pantalla"), Encrypt_Estadisticas_Value(Estadisticas.Grabaciones_Pantalla))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Grabaciones_Audio"), Encrypt_Estadisticas_Value(Estadisticas.Grabaciones_Audio))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Enviado_Telegram"), Encrypt_Estadisticas_Value(Estadisticas.Enviado_Telegram))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Comandos_UDP"), Encrypt_Estadisticas_Value(Estadisticas.Comandos_UDP))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Acciones_Unicas"), Estadisticas.Acciones_Unicas)

        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Macros_Grabadas"), Encrypt_Estadisticas_Value(Estadisticas.Macros_Grabadas))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Macros_Ejecutadas"), Encrypt_Estadisticas_Value(Estadisticas.Macros_Ejecutadas))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Sonidos_Reproducidos"), Encrypt_Estadisticas_Value(Estadisticas.Sonidos_Reproducidos))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("CMD_Ejecutados"), Encrypt_Estadisticas_Value(Estadisticas.CMD_Ejecutados))

        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("DesactivadoEn"), Encrypt_Estadisticas_Value(Estadisticas.DesactivadoEn))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Aplicaciones_Ejecutadas"), Encrypt_Estadisticas_Value(Estadisticas.Aplicaciones_Ejecutadas))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Paginas_Webs"), Encrypt_Estadisticas_Value(Estadisticas.Paginas_Webs))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Carpetas_Abiertas"), Encrypt_Estadisticas_Value(Estadisticas.Carpetas_Abiertas))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("BAT_Ejecutados"), Encrypt_Estadisticas_Value(Estadisticas.BAT_Ejecutados))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Archivos_Ocultados"), Encrypt_Estadisticas_Value(Estadisticas.Archivos_Ocultados))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Salidas_Audio"), Encrypt_Estadisticas_Value(Estadisticas.Salidas_Audio))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("TopMost_Ejecutados"), Encrypt_Estadisticas_Value(Estadisticas.TopMost_Ejecutados))
        Registro.SetRegKey(RegPath + "\Estadisticas", Simple_Encrypt("Iconos_Modificados"), Encrypt_Estadisticas_Value(Estadisticas.Iconos_Modificados))

        Estadisticas_Actualizar()
    End Sub

#End Region

#Region " Reset "

    Public Shared Sub Reset()
        Estadisticas.Comandos_Creados = 0
        Estadisticas.Comandos_Eliminados = 0
        Estadisticas.Comandos_Ejecutados = 0

        Estadisticas.Acciones_Creadas = 0
        Estadisticas.Acciones_Eliminadas = 0
        Estadisticas.Acciones_Ejecutadas = 0

        Estadisticas.KBoard_Creados = 0
        Estadisticas.KBoard_Eliminados = 0
        Estadisticas.KBoard_Ejecutados = 0

        Estadisticas.QuickMenus_Creados = 0
        Estadisticas.QuickMenus_Eliminados = 0
        Estadisticas.QuickMenus_Abiertos = 0

        Estadisticas.KDesktop_Iniciado = 0
        Estadisticas.Papelera_Vaciada = 0
        Estadisticas.Apagado_Equipo = 0
        Estadisticas.Capturas_Pantalla = 0
        Estadisticas.Grabaciones_Pantalla = 0
        Estadisticas.Grabaciones_Audio = 0
        Estadisticas.Enviado_Telegram = 0
        Estadisticas.Comandos_UDP = 0
        Estadisticas.Acciones_Unicas = ""

        Estadisticas.Macros_Grabadas = 0
        Estadisticas.Macros_Ejecutadas = 0
        Estadisticas.CMD_Ejecutados = 0
        Estadisticas.DesactivadoEn = 0
        Estadisticas.Archivos_Ocultados = 0
        Estadisticas.Aplicaciones_Ejecutadas = 0
        Estadisticas.Paginas_Webs = 0
        Estadisticas.Carpetas_Abiertas = 0
        Estadisticas.BAT_Ejecutados = 0
        Estadisticas.Sonidos_Reproducidos = 0
        Estadisticas.Salidas_Audio = 0
        Estadisticas.TopMost_Ejecutados = 0
        Estadisticas.Iconos_Modificados = 0
        Estadisticas.KDesktop_Iniciado = 0

        Guardar()
    End Sub

#End Region

#Region " Actualizar "

    Public Shared Sub Estadisticas_Actualizar()
        If FLogros.Visible = True Then FLogros.Actualizar_Estadisticas()
        Logros.Check_Logros = True
    End Sub

#End Region

#Region " Simple Encrypt / Decrypt "

    Private Shared arLetterChars() As Char = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890"
    Private Shared arEncryptedChars() As Char = "¿s¢çc‹i˜Ö´åÄÚKÍìæ¯~4Ûÿ5ÑûÏÉí³èô§ŠÀÙ9ÒÓ?þ.äƒ%*š¾†±HI2@Ã¦Œ,Ôuû^]·"

    Private Shared Function Simple_Encrypt(Texto As String) As String
        If Texto.Trim = "" Then Return ""
        For Each myTextBoxChar As Char In Texto
            For i As Integer = 0 To arLetterChars.Length - 1
                If myTextBoxChar = arLetterChars(i) Then Texto = Texto.Replace(myTextBoxChar, arEncryptedChars(i))
            Next
        Next : Return Texto
    End Function

    'Private Shared Function Simple_Decrypt(Texto As String) As String
    '    If Texto.Trim = "" Then Return ""
    '    For Each myTextBoxChar As Char In Texto
    '        For i As Integer = 0 To arEncryptedChars.Length - 1
    '            If myTextBoxChar = arEncryptedChars(i) Then Texto = Texto.Replace(myTextBoxChar, arLetterChars(i))
    '        Next
    '    Next : Return Texto
    'End Function

#End Region

End Class

#End Region

#End Region

#End Region